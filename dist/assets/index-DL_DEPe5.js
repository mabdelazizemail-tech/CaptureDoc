(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(s){if(s.ep)return;s.ep=!0;const l=r(s);fetch(s.href,l)}})();function nx(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var sm={exports:{}},tc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ev;function sT(){if(Ev)return tc;Ev=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(a,s,l){var o=null;if(l!==void 0&&(o=""+l),s.key!==void 0&&(o=""+s.key),"key"in s){l={};for(var u in s)u!=="key"&&(l[u]=s[u])}else l=s;return s=l.ref,{$$typeof:e,type:a,key:o,ref:s!==void 0?s:null,props:l}}return tc.Fragment=t,tc.jsx=r,tc.jsxs=r,tc}var Tv;function iT(){return Tv||(Tv=1,sm.exports=sT()),sm.exports}var f=iT(),im={exports:{}},pt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kv;function lT(){if(kv)return pt;kv=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),p=Symbol.iterator;function y(W){return W===null||typeof W!="object"?null:(W=p&&W[p]||W["@@iterator"],typeof W=="function"?W:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,S={};function T(W,O,P){this.props=W,this.context=O,this.refs=S,this.updater=P||w}T.prototype.isReactComponent={},T.prototype.setState=function(W,O){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,O,"setState")},T.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function N(){}N.prototype=T.prototype;function E(W,O,P){this.props=W,this.context=O,this.refs=S,this.updater=P||w}var D=E.prototype=new N;D.constructor=E,_(D,T.prototype),D.isPureReactComponent=!0;var G=Array.isArray;function V(){}var A={H:null,A:null,T:null,S:null},M=Object.prototype.hasOwnProperty;function C(W,O,P){var z=P.ref;return{$$typeof:e,type:W,key:O,ref:z!==void 0?z:null,props:P}}function U(W,O){return C(W.type,O,W.props)}function Z(W){return typeof W=="object"&&W!==null&&W.$$typeof===e}function q(W){var O={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(P){return O[P]})}var le=/\/+/g;function ge(W,O){return typeof W=="object"&&W!==null&&W.key!=null?q(""+W.key):O.toString(36)}function Se(W){switch(W.status){case"fulfilled":return W.value;case"rejected":throw W.reason;default:switch(typeof W.status=="string"?W.then(V,V):(W.status="pending",W.then(function(O){W.status==="pending"&&(W.status="fulfilled",W.value=O)},function(O){W.status==="pending"&&(W.status="rejected",W.reason=O)})),W.status){case"fulfilled":return W.value;case"rejected":throw W.reason}}throw W}function te(W,O,P,z,F){var Q=typeof W;(Q==="undefined"||Q==="boolean")&&(W=null);var re=!1;if(W===null)re=!0;else switch(Q){case"bigint":case"string":case"number":re=!0;break;case"object":switch(W.$$typeof){case e:case t:re=!0;break;case x:return re=W._init,te(re(W._payload),O,P,z,F)}}if(re)return F=F(W),re=z===""?"."+ge(W,0):z,G(F)?(P="",re!=null&&(P=re.replace(le,"$&/")+"/"),te(F,O,P,"",function(Oe){return Oe})):F!=null&&(Z(F)&&(F=U(F,P+(F.key==null||W&&W.key===F.key?"":(""+F.key).replace(le,"$&/")+"/")+re)),O.push(F)),1;re=0;var Ee=z===""?".":z+":";if(G(W))for(var ye=0;ye<W.length;ye++)z=W[ye],Q=Ee+ge(z,ye),re+=te(z,O,P,Q,F);else if(ye=y(W),typeof ye=="function")for(W=ye.call(W),ye=0;!(z=W.next()).done;)z=z.value,Q=Ee+ge(z,ye++),re+=te(z,O,P,Q,F);else if(Q==="object"){if(typeof W.then=="function")return te(Se(W),O,P,z,F);throw O=String(W),Error("Objects are not valid as a React child (found: "+(O==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":O)+"). If you meant to render a collection of children, use an array instead.")}return re}function ae(W,O,P){if(W==null)return W;var z=[],F=0;return te(W,z,"","",function(Q){return O.call(P,Q,F++)}),z}function De(W){if(W._status===-1){var O=W._result;O=O(),O.then(function(P){(W._status===0||W._status===-1)&&(W._status=1,W._result=P)},function(P){(W._status===0||W._status===-1)&&(W._status=2,W._result=P)}),W._status===-1&&(W._status=0,W._result=O)}if(W._status===1)return W._result.default;throw W._result}var ie=typeof reportError=="function"?reportError:function(W){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var O=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof W=="object"&&W!==null&&typeof W.message=="string"?String(W.message):String(W),error:W});if(!window.dispatchEvent(O))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",W);return}console.error(W)},Me={map:ae,forEach:function(W,O,P){ae(W,function(){O.apply(this,arguments)},P)},count:function(W){var O=0;return ae(W,function(){O++}),O},toArray:function(W){return ae(W,function(O){return O})||[]},only:function(W){if(!Z(W))throw Error("React.Children.only expected to receive a single React element child.");return W}};return pt.Activity=g,pt.Children=Me,pt.Component=T,pt.Fragment=r,pt.Profiler=s,pt.PureComponent=E,pt.StrictMode=a,pt.Suspense=h,pt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,pt.__COMPILER_RUNTIME={__proto__:null,c:function(W){return A.H.useMemoCache(W)}},pt.cache=function(W){return function(){return W.apply(null,arguments)}},pt.cacheSignal=function(){return null},pt.cloneElement=function(W,O,P){if(W==null)throw Error("The argument must be a React element, but you passed "+W+".");var z=_({},W.props),F=W.key;if(O!=null)for(Q in O.key!==void 0&&(F=""+O.key),O)!M.call(O,Q)||Q==="key"||Q==="__self"||Q==="__source"||Q==="ref"&&O.ref===void 0||(z[Q]=O[Q]);var Q=arguments.length-2;if(Q===1)z.children=P;else if(1<Q){for(var re=Array(Q),Ee=0;Ee<Q;Ee++)re[Ee]=arguments[Ee+2];z.children=re}return C(W.type,F,z)},pt.createContext=function(W){return W={$$typeof:o,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null},W.Provider=W,W.Consumer={$$typeof:l,_context:W},W},pt.createElement=function(W,O,P){var z,F={},Q=null;if(O!=null)for(z in O.key!==void 0&&(Q=""+O.key),O)M.call(O,z)&&z!=="key"&&z!=="__self"&&z!=="__source"&&(F[z]=O[z]);var re=arguments.length-2;if(re===1)F.children=P;else if(1<re){for(var Ee=Array(re),ye=0;ye<re;ye++)Ee[ye]=arguments[ye+2];F.children=Ee}if(W&&W.defaultProps)for(z in re=W.defaultProps,re)F[z]===void 0&&(F[z]=re[z]);return C(W,Q,F)},pt.createRef=function(){return{current:null}},pt.forwardRef=function(W){return{$$typeof:u,render:W}},pt.isValidElement=Z,pt.lazy=function(W){return{$$typeof:x,_payload:{_status:-1,_result:W},_init:De}},pt.memo=function(W,O){return{$$typeof:d,type:W,compare:O===void 0?null:O}},pt.startTransition=function(W){var O=A.T,P={};A.T=P;try{var z=W(),F=A.S;F!==null&&F(P,z),typeof z=="object"&&z!==null&&typeof z.then=="function"&&z.then(V,ie)}catch(Q){ie(Q)}finally{O!==null&&P.types!==null&&(O.types=P.types),A.T=O}},pt.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},pt.use=function(W){return A.H.use(W)},pt.useActionState=function(W,O,P){return A.H.useActionState(W,O,P)},pt.useCallback=function(W,O){return A.H.useCallback(W,O)},pt.useContext=function(W){return A.H.useContext(W)},pt.useDebugValue=function(){},pt.useDeferredValue=function(W,O){return A.H.useDeferredValue(W,O)},pt.useEffect=function(W,O){return A.H.useEffect(W,O)},pt.useEffectEvent=function(W){return A.H.useEffectEvent(W)},pt.useId=function(){return A.H.useId()},pt.useImperativeHandle=function(W,O,P){return A.H.useImperativeHandle(W,O,P)},pt.useInsertionEffect=function(W,O){return A.H.useInsertionEffect(W,O)},pt.useLayoutEffect=function(W,O){return A.H.useLayoutEffect(W,O)},pt.useMemo=function(W,O){return A.H.useMemo(W,O)},pt.useOptimistic=function(W,O){return A.H.useOptimistic(W,O)},pt.useReducer=function(W,O,P){return A.H.useReducer(W,O,P)},pt.useRef=function(W){return A.H.useRef(W)},pt.useState=function(W){return A.H.useState(W)},pt.useSyncExternalStore=function(W,O,P){return A.H.useSyncExternalStore(W,O,P)},pt.useTransition=function(){return A.H.useTransition()},pt.version="19.2.4",pt}var Nv;function Pf(){return Nv||(Nv=1,im.exports=lT()),im.exports}var ne=Pf();const oT=nx(ne);var lm={exports:{}},rc={},om={exports:{}},cm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jv;function cT(){return jv||(jv=1,(function(e){function t(te,ae){var De=te.length;te.push(ae);e:for(;0<De;){var ie=De-1>>>1,Me=te[ie];if(0<s(Me,ae))te[ie]=ae,te[De]=Me,De=ie;else break e}}function r(te){return te.length===0?null:te[0]}function a(te){if(te.length===0)return null;var ae=te[0],De=te.pop();if(De!==ae){te[0]=De;e:for(var ie=0,Me=te.length,W=Me>>>1;ie<W;){var O=2*(ie+1)-1,P=te[O],z=O+1,F=te[z];if(0>s(P,De))z<Me&&0>s(F,P)?(te[ie]=F,te[z]=De,ie=z):(te[ie]=P,te[O]=De,ie=O);else if(z<Me&&0>s(F,De))te[ie]=F,te[z]=De,ie=z;else break e}}return ae}function s(te,ae){var De=te.sortIndex-ae.sortIndex;return De!==0?De:te.id-ae.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var o=Date,u=o.now();e.unstable_now=function(){return o.now()-u}}var h=[],d=[],x=1,g=null,p=3,y=!1,w=!1,_=!1,S=!1,T=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function D(te){for(var ae=r(d);ae!==null;){if(ae.callback===null)a(d);else if(ae.startTime<=te)a(d),ae.sortIndex=ae.expirationTime,t(h,ae);else break;ae=r(d)}}function G(te){if(_=!1,D(te),!w)if(r(h)!==null)w=!0,V||(V=!0,q());else{var ae=r(d);ae!==null&&Se(G,ae.startTime-te)}}var V=!1,A=-1,M=5,C=-1;function U(){return S?!0:!(e.unstable_now()-C<M)}function Z(){if(S=!1,V){var te=e.unstable_now();C=te;var ae=!0;try{e:{w=!1,_&&(_=!1,N(A),A=-1),y=!0;var De=p;try{t:{for(D(te),g=r(h);g!==null&&!(g.expirationTime>te&&U());){var ie=g.callback;if(typeof ie=="function"){g.callback=null,p=g.priorityLevel;var Me=ie(g.expirationTime<=te);if(te=e.unstable_now(),typeof Me=="function"){g.callback=Me,D(te),ae=!0;break t}g===r(h)&&a(h),D(te)}else a(h);g=r(h)}if(g!==null)ae=!0;else{var W=r(d);W!==null&&Se(G,W.startTime-te),ae=!1}}break e}finally{g=null,p=De,y=!1}ae=void 0}}finally{ae?q():V=!1}}}var q;if(typeof E=="function")q=function(){E(Z)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,ge=le.port2;le.port1.onmessage=Z,q=function(){ge.postMessage(null)}}else q=function(){T(Z,0)};function Se(te,ae){A=T(function(){te(e.unstable_now())},ae)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(te){te.callback=null},e.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<te?Math.floor(1e3/te):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_next=function(te){switch(p){case 1:case 2:case 3:var ae=3;break;default:ae=p}var De=p;p=ae;try{return te()}finally{p=De}},e.unstable_requestPaint=function(){S=!0},e.unstable_runWithPriority=function(te,ae){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var De=p;p=te;try{return ae()}finally{p=De}},e.unstable_scheduleCallback=function(te,ae,De){var ie=e.unstable_now();switch(typeof De=="object"&&De!==null?(De=De.delay,De=typeof De=="number"&&0<De?ie+De:ie):De=ie,te){case 1:var Me=-1;break;case 2:Me=250;break;case 5:Me=1073741823;break;case 4:Me=1e4;break;default:Me=5e3}return Me=De+Me,te={id:x++,callback:ae,priorityLevel:te,startTime:De,expirationTime:Me,sortIndex:-1},De>ie?(te.sortIndex=De,t(d,te),r(h)===null&&te===r(d)&&(_?(N(A),A=-1):_=!0,Se(G,De-ie))):(te.sortIndex=Me,t(h,te),w||y||(w=!0,V||(V=!0,q()))),te},e.unstable_shouldYield=U,e.unstable_wrapCallback=function(te){var ae=p;return function(){var De=p;p=ae;try{return te.apply(this,arguments)}finally{p=De}}}})(cm)),cm}var Av;function uT(){return Av||(Av=1,om.exports=cT()),om.exports}var um={exports:{}},xa={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ov;function fT(){if(Ov)return xa;Ov=1;var e=Pf();function t(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)d+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var a={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},s=Symbol.for("react.portal");function l(h,d,x){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:g==null?null:""+g,children:h,containerInfo:d,implementation:x}}var o=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return xa.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,xa.createPortal=function(h,d){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return l(h,d,null,x)},xa.flushSync=function(h){var d=o.T,x=a.p;try{if(o.T=null,a.p=2,h)return h()}finally{o.T=d,a.p=x,a.d.f()}},xa.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,a.d.C(h,d))},xa.prefetchDNS=function(h){typeof h=="string"&&a.d.D(h)},xa.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var x=d.as,g=u(x,d.crossOrigin),p=typeof d.integrity=="string"?d.integrity:void 0,y=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;x==="style"?a.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:g,integrity:p,fetchPriority:y}):x==="script"&&a.d.X(h,{crossOrigin:g,integrity:p,fetchPriority:y,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},xa.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var x=u(d.as,d.crossOrigin);a.d.M(h,{crossOrigin:x,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&a.d.M(h)},xa.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var x=d.as,g=u(x,d.crossOrigin);a.d.L(h,x,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},xa.preloadModule=function(h,d){if(typeof h=="string")if(d){var x=u(d.as,d.crossOrigin);a.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:x,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else a.d.m(h)},xa.requestFormReset=function(h){a.d.r(h)},xa.unstable_batchedUpdates=function(h,d){return h(d)},xa.useFormState=function(h,d,x){return o.H.useFormState(h,d,x)},xa.useFormStatus=function(){return o.H.useHostTransitionStatus()},xa.version="19.2.4",xa}var Cv;function dT(){if(Cv)return um.exports;Cv=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),um.exports=fT(),um.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rv;function hT(){if(Rv)return rc;Rv=1;var e=uT(),t=Pf(),r=dT();function a(n){var i="https://react.dev/errors/"+n;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function l(n){var i=n,c=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(c=i.return),n=i.return;while(n)}return i.tag===3?c:null}function o(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function u(n){if(n.tag===31){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function h(n){if(l(n)!==n)throw Error(a(188))}function d(n){var i=n.alternate;if(!i){if(i=l(n),i===null)throw Error(a(188));return i!==n?null:n}for(var c=n,m=i;;){var v=c.return;if(v===null)break;var b=v.alternate;if(b===null){if(m=v.return,m!==null){c=m;continue}break}if(v.child===b.child){for(b=v.child;b;){if(b===c)return h(v),n;if(b===m)return h(v),i;b=b.sibling}throw Error(a(188))}if(c.return!==m.return)c=v,m=b;else{for(var k=!1,R=v.child;R;){if(R===c){k=!0,c=v,m=b;break}if(R===m){k=!0,m=v,c=b;break}R=R.sibling}if(!k){for(R=b.child;R;){if(R===c){k=!0,c=b,m=v;break}if(R===m){k=!0,m=b,c=v;break}R=R.sibling}if(!k)throw Error(a(189))}}if(c.alternate!==m)throw Error(a(190))}if(c.tag!==3)throw Error(a(188));return c.stateNode.current===c?n:i}function x(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n;for(n=n.child;n!==null;){if(i=x(n),i!==null)return i;n=n.sibling}return null}var g=Object.assign,p=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),N=Symbol.for("react.consumer"),E=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),G=Symbol.for("react.suspense"),V=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),C=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),Z=Symbol.iterator;function q(n){return n===null||typeof n!="object"?null:(n=Z&&n[Z]||n["@@iterator"],typeof n=="function"?n:null)}var le=Symbol.for("react.client.reference");function ge(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===le?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case _:return"Fragment";case T:return"Profiler";case S:return"StrictMode";case G:return"Suspense";case V:return"SuspenseList";case C:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case w:return"Portal";case E:return n.displayName||"Context";case N:return(n._context.displayName||"Context")+".Consumer";case D:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case A:return i=n.displayName||null,i!==null?i:ge(n.type)||"Memo";case M:i=n._payload,n=n._init;try{return ge(n(i))}catch{}}return null}var Se=Array.isArray,te=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,De={pending:!1,data:null,method:null,action:null},ie=[],Me=-1;function W(n){return{current:n}}function O(n){0>Me||(n.current=ie[Me],ie[Me]=null,Me--)}function P(n,i){Me++,ie[Me]=n.current,n.current=i}var z=W(null),F=W(null),Q=W(null),re=W(null);function Ee(n,i){switch(P(Q,i),P(F,n),P(z,null),i.nodeType){case 9:case 11:n=(n=i.documentElement)&&(n=n.namespaceURI)?X1(n):0;break;default:if(n=i.tagName,i=i.namespaceURI)i=X1(i),n=W1(i,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}O(z),P(z,n)}function ye(){O(z),O(F),O(Q)}function Oe(n){n.memoizedState!==null&&P(re,n);var i=z.current,c=W1(i,n.type);i!==c&&(P(F,n),P(z,c))}function tt(n){F.current===n&&(O(z),O(F)),re.current===n&&(O(re),Jo._currentValue=De)}var J,wt;function et(n){if(J===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);J=i&&i[1]||"",wt=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+J+n+wt}var gt=!1;function it(n,i){if(!n||gt)return"";gt=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(i){var je=function(){throw Error()};if(Object.defineProperty(je.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(je,[])}catch(ve){var xe=ve}Reflect.construct(n,[],je)}else{try{je.call()}catch(ve){xe=ve}n.call(je.prototype)}}else{try{throw Error()}catch(ve){xe=ve}(je=n())&&typeof je.catch=="function"&&je.catch(function(){})}}catch(ve){if(ve&&xe&&typeof ve.stack=="string")return[ve.stack,xe.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=m.DetermineComponentFrameRoot(),k=b[0],R=b[1];if(k&&R){var ee=k.split(`
`),de=R.split(`
`);for(v=m=0;m<ee.length&&!ee[m].includes("DetermineComponentFrameRoot");)m++;for(;v<de.length&&!de[v].includes("DetermineComponentFrameRoot");)v++;if(m===ee.length||v===de.length)for(m=ee.length-1,v=de.length-1;1<=m&&0<=v&&ee[m]!==de[v];)v--;for(;1<=m&&0<=v;m--,v--)if(ee[m]!==de[v]){if(m!==1||v!==1)do if(m--,v--,0>v||ee[m]!==de[v]){var we=`
`+ee[m].replace(" at new "," at ");return n.displayName&&we.includes("<anonymous>")&&(we=we.replace("<anonymous>",n.displayName)),we}while(1<=m&&0<=v);break}}}finally{gt=!1,Error.prepareStackTrace=c}return(c=n?n.displayName||n.name:"")?et(c):""}function Ce(n,i){switch(n.tag){case 26:case 27:case 5:return et(n.type);case 16:return et("Lazy");case 13:return n.child!==i&&i!==null?et("Suspense Fallback"):et("Suspense");case 19:return et("SuspenseList");case 0:case 15:return it(n.type,!1);case 11:return it(n.type.render,!1);case 1:return it(n.type,!0);case 31:return et("Activity");default:return""}}function Ae(n){try{var i="",c=null;do i+=Ce(n,c),c=n,n=n.return;while(n);return i}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}var Ge=Object.prototype.hasOwnProperty,mt=e.unstable_scheduleCallback,Ue=e.unstable_cancelCallback,Ve=e.unstable_shouldYield,Tt=e.unstable_requestPaint,Ke=e.unstable_now,Rt=e.unstable_getCurrentPriorityLevel,zt=e.unstable_ImmediatePriority,ua=e.unstable_UserBlockingPriority,ir=e.unstable_NormalPriority,or=e.unstable_LowPriority,nt=e.unstable_IdlePriority,Ht=e.log,Hr=e.unstable_setDisableYieldValue,It=null,Gt=null;function qr(n){if(typeof Ht=="function"&&Hr(n),Gt&&typeof Gt.setStrictMode=="function")try{Gt.setStrictMode(It,n)}catch{}}var Vt=Math.clz32?Math.clz32:es,Ns=Math.log,Zn=Math.LN2;function es(n){return n>>>=0,n===0?32:31-(Ns(n)/Zn|0)|0}var qa=256,zn=262144,cn=4194304;function fa(n){var i=n&42;if(i!==0)return i;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function ea(n,i,c){var m=n.pendingLanes;if(m===0)return 0;var v=0,b=n.suspendedLanes,k=n.pingedLanes;n=n.warmLanes;var R=m&134217727;return R!==0?(m=R&~b,m!==0?v=fa(m):(k&=R,k!==0?v=fa(k):c||(c=R&~n,c!==0&&(v=fa(c))))):(R=m&~b,R!==0?v=fa(R):k!==0?v=fa(k):c||(c=m&~n,c!==0&&(v=fa(c)))),v===0?0:i!==0&&i!==v&&(i&b)===0&&(b=v&-v,c=i&-i,b>=c||b===32&&(c&4194048)!==0)?i:v}function Ea(n,i){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&i)===0}function st(n,i){switch(n){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _r(){var n=cn;return cn<<=1,(cn&62914560)===0&&(cn=4194304),n}function tr(n){for(var i=[],c=0;31>c;c++)i.push(n);return i}function $a(n,i){n.pendingLanes|=i,i!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Ca(n,i,c,m,v,b){var k=n.pendingLanes;n.pendingLanes=c,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=c,n.entangledLanes&=c,n.errorRecoveryDisabledLanes&=c,n.shellSuspendCounter=0;var R=n.entanglements,ee=n.expirationTimes,de=n.hiddenUpdates;for(c=k&~c;0<c;){var we=31-Vt(c),je=1<<we;R[we]=0,ee[we]=-1;var xe=de[we];if(xe!==null)for(de[we]=null,we=0;we<xe.length;we++){var ve=xe[we];ve!==null&&(ve.lane&=-536870913)}c&=~je}m!==0&&K(n,m,0),b!==0&&v===0&&n.tag!==0&&(n.suspendedLanes|=b&~(k&~i))}function K(n,i,c){n.pendingLanes|=i,n.suspendedLanes&=~i;var m=31-Vt(i);n.entangledLanes|=i,n.entanglements[m]=n.entanglements[m]|1073741824|c&261930}function Ie(n,i){var c=n.entangledLanes|=i;for(n=n.entanglements;c;){var m=31-Vt(c),v=1<<m;v&i|n[m]&i&&(n[m]|=i),c&=~v}}function ft(n,i){var c=i&-i;return c=(c&42)!==0?1:qt(c),(c&(n.suspendedLanes|i))!==0?0:c}function qt(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function gr(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function j(){var n=ae.p;return n!==0?n:(n=window.event,n===void 0?32:gv(n.type))}function H(n,i){var c=ae.p;try{return ae.p=n,i()}finally{ae.p=c}}var I=Math.random().toString(36).slice(2),L="__reactFiber$"+I,B="__reactProps$"+I,X="__reactContainer$"+I,ce="__reactEvents$"+I,_e="__reactListeners$"+I,ue="__reactHandles$"+I,he="__reactResources$"+I,me="__reactMarker$"+I;function Fe(n){delete n[L],delete n[B],delete n[ce],delete n[_e],delete n[ue]}function Be(n){var i=n[L];if(i)return i;for(var c=n.parentNode;c;){if(i=c[X]||c[L]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(n=tv(n);n!==null;){if(c=n[L])return c;n=tv(n)}return i}n=c,c=n.parentNode}return null}function qe(n){if(n=n[L]||n[X]){var i=n.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return n}return null}function Le(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n.stateNode;throw Error(a(33))}function $e(n){var i=n[he];return i||(i=n[he]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function Ye(n){n[me]=!0}var Ot=new Set,Lt={};function Xt(n,i){Ta(n,i),Ta(n+"Capture",i)}function Ta(n,i){for(Lt[n]=i,n=0;n<i.length;n++)Ot.add(i[n])}var Hn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Nn={},$r={};function fi(n){return Ge.call($r,n)?!0:Ge.call(Nn,n)?!1:Hn.test(n)?$r[n]=!0:(Nn[n]=!0,!1)}function da(n,i,c){if(fi(i))if(c===null)n.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":n.removeAttribute(i);return;case"boolean":var m=i.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){n.removeAttribute(i);return}}n.setAttribute(i,""+c)}}function tl(n,i,c){if(c===null)n.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(i);return}n.setAttribute(i,""+c)}}function ha(n,i,c,m){if(m===null)n.removeAttribute(c);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(c);return}n.setAttributeNS(i,c,""+m)}}function Ra(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function su(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function ad(n,i,c){var m=Object.getOwnPropertyDescriptor(n.constructor.prototype,i);if(!n.hasOwnProperty(i)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var v=m.get,b=m.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return v.call(this)},set:function(k){c=""+k,b.call(this,k)}}),Object.defineProperty(n,i,{enumerable:m.enumerable}),{getValue:function(){return c},setValue:function(k){c=""+k},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function ho(n){if(!n._valueTracker){var i=su(n)?"checked":"value";n._valueTracker=ad(n,i,""+n[i])}}function iu(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var c=i.getValue(),m="";return n&&(m=su(n)?n.checked?"true":"false":n.value),n=m,n!==c?(i.setValue(n),!0):!1}function rl(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var nd=/[\n"\\]/g;function Da(n){return n.replace(nd,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function di(n,i,c,m,v,b,k,R){n.name="",k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?n.type=k:n.removeAttribute("type"),i!=null?k==="number"?(i===0&&n.value===""||n.value!=i)&&(n.value=""+Ra(i)):n.value!==""+Ra(i)&&(n.value=""+Ra(i)):k!=="submit"&&k!=="reset"||n.removeAttribute("value"),i!=null?mo(n,k,Ra(i)):c!=null?mo(n,k,Ra(c)):m!=null&&n.removeAttribute("value"),v==null&&b!=null&&(n.defaultChecked=!!b),v!=null&&(n.checked=v&&typeof v!="function"&&typeof v!="symbol"),R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?n.name=""+Ra(R):n.removeAttribute("name")}function al(n,i,c,m,v,b,k,R){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(n.type=b),i!=null||c!=null){if(!(b!=="submit"&&b!=="reset"||i!=null)){ho(n);return}c=c!=null?""+Ra(c):"",i=i!=null?""+Ra(i):c,R||i===n.value||(n.value=i),n.defaultValue=i}m=m??v,m=typeof m!="function"&&typeof m!="symbol"&&!!m,n.checked=R?n.checked:!!m,n.defaultChecked=!!m,k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(n.name=k),ho(n)}function mo(n,i,c){i==="number"&&rl(n.ownerDocument)===n||n.defaultValue===""+c||(n.defaultValue=""+c)}function js(n,i,c,m){if(n=n.options,i){i={};for(var v=0;v<c.length;v++)i["$"+c[v]]=!0;for(c=0;c<n.length;c++)v=i.hasOwnProperty("$"+n[c].value),n[c].selected!==v&&(n[c].selected=v),v&&m&&(n[c].defaultSelected=!0)}else{for(c=""+Ra(c),i=null,v=0;v<n.length;v++){if(n[v].value===c){n[v].selected=!0,m&&(n[v].defaultSelected=!0);return}i!==null||n[v].disabled||(i=n[v])}i!==null&&(i.selected=!0)}}function lu(n,i,c){if(i!=null&&(i=""+Ra(i),i!==n.value&&(n.value=i),c==null)){n.defaultValue!==i&&(n.defaultValue=i);return}n.defaultValue=c!=null?""+Ra(c):""}function ou(n,i,c,m){if(i==null){if(m!=null){if(c!=null)throw Error(a(92));if(Se(m)){if(1<m.length)throw Error(a(93));m=m[0]}c=m}c==null&&(c=""),i=c}c=Ra(i),n.defaultValue=c,m=n.textContent,m===c&&m!==""&&m!==null&&(n.value=m),ho(n)}function As(n,i){if(i){var c=n.firstChild;if(c&&c===n.lastChild&&c.nodeType===3){c.nodeValue=i;return}}n.textContent=i}var sd=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function cu(n,i,c){var m=i.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?m?n.setProperty(i,""):i==="float"?n.cssFloat="":n[i]="":m?n.setProperty(i,c):typeof c!="number"||c===0||sd.has(i)?i==="float"?n.cssFloat=c:n[i]=(""+c).trim():n[i]=c+"px"}function uu(n,i,c){if(i!=null&&typeof i!="object")throw Error(a(62));if(n=n.style,c!=null){for(var m in c)!c.hasOwnProperty(m)||i!=null&&i.hasOwnProperty(m)||(m.indexOf("--")===0?n.setProperty(m,""):m==="float"?n.cssFloat="":n[m]="");for(var v in i)m=i[v],i.hasOwnProperty(v)&&c[v]!==m&&cu(n,v,m)}else for(var b in i)i.hasOwnProperty(b)&&cu(n,b,i[b])}function xo(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var id=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),fu=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function nl(n){return fu.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function jn(){}var Y=null;function pe(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Ne=null,Pe=null;function Qe(n){var i=qe(n);if(i&&(n=i.stateNode)){var c=n[B]||null;e:switch(n=i.stateNode,i.type){case"input":if(di(n,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),i=c.name,c.type==="radio"&&i!=null){for(c=n;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Da(""+i)+'"][type="radio"]'),i=0;i<c.length;i++){var m=c[i];if(m!==n&&m.form===n.form){var v=m[B]||null;if(!v)throw Error(a(90));di(m,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(i=0;i<c.length;i++)m=c[i],m.form===n.form&&iu(m)}break e;case"textarea":lu(n,c.value,c.defaultValue);break e;case"select":i=c.value,i!=null&&js(n,!!c.multiple,i,!1)}}}var xt=!1;function xr(n,i,c){if(xt)return n(i,c);xt=!0;try{var m=n(i);return m}finally{if(xt=!1,(Ne!==null||Pe!==null)&&(Qu(),Ne&&(i=Ne,n=Pe,Pe=Ne=null,Qe(i),n)))for(i=0;i<n.length;i++)Qe(n[i])}}function Dt(n,i){var c=n.stateNode;if(c===null)return null;var m=c[B]||null;if(m===null)return null;c=m[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(n=n.type,m=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!m;break e;default:n=!1}if(n)return null;if(c&&typeof c!="function")throw Error(a(231,i,typeof c));return c}var Wt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ma=!1;if(Wt)try{var Gr={};Object.defineProperty(Gr,"passive",{get:function(){ma=!0}}),window.addEventListener("test",Gr,Gr),window.removeEventListener("test",Gr,Gr)}catch{ma=!1}var Kt=null,br=null,du=null;function Wx(){if(du)return du;var n,i=br,c=i.length,m,v="value"in Kt?Kt.value:Kt.textContent,b=v.length;for(n=0;n<c&&i[n]===v[n];n++);var k=c-n;for(m=1;m<=k&&i[c-m]===v[b-m];m++);return du=v.slice(n,1<m?1-m:void 0)}function hu(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function mu(){return!0}function Kx(){return!1}function Fa(n){function i(c,m,v,b,k){this._reactName=c,this._targetInst=v,this.type=m,this.nativeEvent=b,this.target=k,this.currentTarget=null;for(var R in n)n.hasOwnProperty(R)&&(c=n[R],this[R]=c?c(b):b[R]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?mu:Kx,this.isPropagationStopped=Kx,this}return g(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=mu)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=mu)},persist:function(){},isPersistent:mu}),i}var hi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xu=Fa(hi),po=g({},hi,{view:0,detail:0}),aS=Fa(po),ld,od,go,pu=g({},po,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ud,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==go&&(go&&n.type==="mousemove"?(ld=n.screenX-go.screenX,od=n.screenY-go.screenY):od=ld=0,go=n),ld)},movementY:function(n){return"movementY"in n?n.movementY:od}}),Yx=Fa(pu),nS=g({},pu,{dataTransfer:0}),sS=Fa(nS),iS=g({},po,{relatedTarget:0}),cd=Fa(iS),lS=g({},hi,{animationName:0,elapsedTime:0,pseudoElement:0}),oS=Fa(lS),cS=g({},hi,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),uS=Fa(cS),fS=g({},hi,{data:0}),Jx=Fa(fS),dS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xS(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=mS[n])?!!i[n]:!1}function ud(){return xS}var pS=g({},po,{key:function(n){if(n.key){var i=dS[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=hu(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?hS[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ud,charCode:function(n){return n.type==="keypress"?hu(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?hu(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),gS=Fa(pS),vS=g({},pu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qx=Fa(vS),yS=g({},po,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ud}),_S=Fa(yS),bS=g({},hi,{propertyName:0,elapsedTime:0,pseudoElement:0}),wS=Fa(bS),SS=g({},pu,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),ES=Fa(SS),TS=g({},hi,{newState:0,oldState:0}),kS=Fa(TS),NS=[9,13,27,32],fd=Wt&&"CompositionEvent"in window,vo=null;Wt&&"documentMode"in document&&(vo=document.documentMode);var jS=Wt&&"TextEvent"in window&&!vo,Zx=Wt&&(!fd||vo&&8<vo&&11>=vo),ep=" ",tp=!1;function rp(n,i){switch(n){case"keyup":return NS.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ap(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var sl=!1;function AS(n,i){switch(n){case"compositionend":return ap(i);case"keypress":return i.which!==32?null:(tp=!0,ep);case"textInput":return n=i.data,n===ep&&tp?null:n;default:return null}}function OS(n,i){if(sl)return n==="compositionend"||!fd&&rp(n,i)?(n=Wx(),du=br=Kt=null,sl=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Zx&&i.locale!=="ko"?null:i.data;default:return null}}var CS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function np(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!CS[n.type]:i==="textarea"}function sp(n,i,c,m){Ne?Pe?Pe.push(m):Pe=[m]:Ne=m,i=s0(i,"onChange"),0<i.length&&(c=new xu("onChange","change",null,c,m),n.push({event:c,listeners:i}))}var yo=null,_o=null;function RS(n){z1(n,0)}function gu(n){var i=Le(n);if(iu(i))return n}function ip(n,i){if(n==="change")return i}var lp=!1;if(Wt){var dd;if(Wt){var hd="oninput"in document;if(!hd){var op=document.createElement("div");op.setAttribute("oninput","return;"),hd=typeof op.oninput=="function"}dd=hd}else dd=!1;lp=dd&&(!document.documentMode||9<document.documentMode)}function cp(){yo&&(yo.detachEvent("onpropertychange",up),_o=yo=null)}function up(n){if(n.propertyName==="value"&&gu(_o)){var i=[];sp(i,_o,n,pe(n)),xr(RS,i)}}function DS(n,i,c){n==="focusin"?(cp(),yo=i,_o=c,yo.attachEvent("onpropertychange",up)):n==="focusout"&&cp()}function FS(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return gu(_o)}function MS(n,i){if(n==="click")return gu(i)}function IS(n,i){if(n==="input"||n==="change")return gu(i)}function LS(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var Ga=typeof Object.is=="function"?Object.is:LS;function bo(n,i){if(Ga(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var c=Object.keys(n),m=Object.keys(i);if(c.length!==m.length)return!1;for(m=0;m<c.length;m++){var v=c[m];if(!Ge.call(i,v)||!Ga(n[v],i[v]))return!1}return!0}function fp(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function dp(n,i){var c=fp(n);n=0;for(var m;c;){if(c.nodeType===3){if(m=n+c.textContent.length,n<=i&&m>=i)return{node:c,offset:i-n};n=m}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=fp(c)}}function hp(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?hp(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function mp(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var i=rl(n.document);i instanceof n.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)n=i.contentWindow;else break;i=rl(n.document)}return i}function md(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}var BS=Wt&&"documentMode"in document&&11>=document.documentMode,il=null,xd=null,wo=null,pd=!1;function xp(n,i,c){var m=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;pd||il==null||il!==rl(m)||(m=il,"selectionStart"in m&&md(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),wo&&bo(wo,m)||(wo=m,m=s0(xd,"onSelect"),0<m.length&&(i=new xu("onSelect","select",null,i,c),n.push({event:i,listeners:m}),i.target=il)))}function mi(n,i){var c={};return c[n.toLowerCase()]=i.toLowerCase(),c["Webkit"+n]="webkit"+i,c["Moz"+n]="moz"+i,c}var ll={animationend:mi("Animation","AnimationEnd"),animationiteration:mi("Animation","AnimationIteration"),animationstart:mi("Animation","AnimationStart"),transitionrun:mi("Transition","TransitionRun"),transitionstart:mi("Transition","TransitionStart"),transitioncancel:mi("Transition","TransitionCancel"),transitionend:mi("Transition","TransitionEnd")},gd={},pp={};Wt&&(pp=document.createElement("div").style,"AnimationEvent"in window||(delete ll.animationend.animation,delete ll.animationiteration.animation,delete ll.animationstart.animation),"TransitionEvent"in window||delete ll.transitionend.transition);function xi(n){if(gd[n])return gd[n];if(!ll[n])return n;var i=ll[n],c;for(c in i)if(i.hasOwnProperty(c)&&c in pp)return gd[n]=i[c];return n}var gp=xi("animationend"),vp=xi("animationiteration"),yp=xi("animationstart"),PS=xi("transitionrun"),US=xi("transitionstart"),zS=xi("transitioncancel"),_p=xi("transitionend"),bp=new Map,vd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");vd.push("scrollEnd");function An(n,i){bp.set(n,i),Xt(i,[n])}var vu=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},un=[],ol=0,yd=0;function yu(){for(var n=ol,i=yd=ol=0;i<n;){var c=un[i];un[i++]=null;var m=un[i];un[i++]=null;var v=un[i];un[i++]=null;var b=un[i];if(un[i++]=null,m!==null&&v!==null){var k=m.pending;k===null?v.next=v:(v.next=k.next,k.next=v),m.pending=v}b!==0&&wp(c,v,b)}}function _u(n,i,c,m){un[ol++]=n,un[ol++]=i,un[ol++]=c,un[ol++]=m,yd|=m,n.lanes|=m,n=n.alternate,n!==null&&(n.lanes|=m)}function _d(n,i,c,m){return _u(n,i,c,m),bu(n)}function pi(n,i){return _u(n,null,null,i),bu(n)}function wp(n,i,c){n.lanes|=c;var m=n.alternate;m!==null&&(m.lanes|=c);for(var v=!1,b=n.return;b!==null;)b.childLanes|=c,m=b.alternate,m!==null&&(m.childLanes|=c),b.tag===22&&(n=b.stateNode,n===null||n._visibility&1||(v=!0)),n=b,b=b.return;return n.tag===3?(b=n.stateNode,v&&i!==null&&(v=31-Vt(c),n=b.hiddenUpdates,m=n[v],m===null?n[v]=[i]:m.push(i),i.lane=c|536870912),b):null}function bu(n){if(50<$o)throw $o=0,Ah=null,Error(a(185));for(var i=n.return;i!==null;)n=i,i=n.return;return n.tag===3?n.stateNode:null}var cl={};function HS(n,i,c,m){this.tag=n,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Va(n,i,c,m){return new HS(n,i,c,m)}function bd(n){return n=n.prototype,!(!n||!n.isReactComponent)}function ts(n,i){var c=n.alternate;return c===null?(c=Va(n.tag,i,n.key,n.mode),c.elementType=n.elementType,c.type=n.type,c.stateNode=n.stateNode,c.alternate=n,n.alternate=c):(c.pendingProps=i,c.type=n.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=n.flags&65011712,c.childLanes=n.childLanes,c.lanes=n.lanes,c.child=n.child,c.memoizedProps=n.memoizedProps,c.memoizedState=n.memoizedState,c.updateQueue=n.updateQueue,i=n.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=n.sibling,c.index=n.index,c.ref=n.ref,c.refCleanup=n.refCleanup,c}function Sp(n,i){n.flags&=65011714;var c=n.alternate;return c===null?(n.childLanes=0,n.lanes=i,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=c.childLanes,n.lanes=c.lanes,n.child=c.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=c.memoizedProps,n.memoizedState=c.memoizedState,n.updateQueue=c.updateQueue,n.type=c.type,i=c.dependencies,n.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),n}function wu(n,i,c,m,v,b){var k=0;if(m=n,typeof n=="function")bd(n)&&(k=1);else if(typeof n=="string")k=XE(n,c,z.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case C:return n=Va(31,c,i,v),n.elementType=C,n.lanes=b,n;case _:return gi(c.children,v,b,i);case S:k=8,v|=24;break;case T:return n=Va(12,c,i,v|2),n.elementType=T,n.lanes=b,n;case G:return n=Va(13,c,i,v),n.elementType=G,n.lanes=b,n;case V:return n=Va(19,c,i,v),n.elementType=V,n.lanes=b,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case E:k=10;break e;case N:k=9;break e;case D:k=11;break e;case A:k=14;break e;case M:k=16,m=null;break e}k=29,c=Error(a(130,n===null?"null":typeof n,"")),m=null}return i=Va(k,c,i,v),i.elementType=n,i.type=m,i.lanes=b,i}function gi(n,i,c,m){return n=Va(7,n,m,i),n.lanes=c,n}function wd(n,i,c){return n=Va(6,n,null,i),n.lanes=c,n}function Ep(n){var i=Va(18,null,null,0);return i.stateNode=n,i}function Sd(n,i,c){return i=Va(4,n.children!==null?n.children:[],n.key,i),i.lanes=c,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}var Tp=new WeakMap;function fn(n,i){if(typeof n=="object"&&n!==null){var c=Tp.get(n);return c!==void 0?c:(i={value:n,source:i,stack:Ae(i)},Tp.set(n,i),i)}return{value:n,source:i,stack:Ae(i)}}var ul=[],fl=0,Su=null,So=0,dn=[],hn=0,Os=null,qn=1,$n="";function rs(n,i){ul[fl++]=So,ul[fl++]=Su,Su=n,So=i}function kp(n,i,c){dn[hn++]=qn,dn[hn++]=$n,dn[hn++]=Os,Os=n;var m=qn;n=$n;var v=32-Vt(m)-1;m&=~(1<<v),c+=1;var b=32-Vt(i)+v;if(30<b){var k=v-v%5;b=(m&(1<<k)-1).toString(32),m>>=k,v-=k,qn=1<<32-Vt(i)+v|c<<v|m,$n=b+n}else qn=1<<b|c<<v|m,$n=n}function Ed(n){n.return!==null&&(rs(n,1),kp(n,1,0))}function Td(n){for(;n===Su;)Su=ul[--fl],ul[fl]=null,So=ul[--fl],ul[fl]=null;for(;n===Os;)Os=dn[--hn],dn[hn]=null,$n=dn[--hn],dn[hn]=null,qn=dn[--hn],dn[hn]=null}function Np(n,i){dn[hn++]=qn,dn[hn++]=$n,dn[hn++]=Os,qn=i.id,$n=i.overflow,Os=n}var ta=null,ur=null,Ct=!1,Cs=null,mn=!1,kd=Error(a(519));function Rs(n){var i=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Eo(fn(i,n)),kd}function jp(n){var i=n.stateNode,c=n.type,m=n.memoizedProps;switch(i[L]=n,i[B]=m,c){case"dialog":Nt("cancel",i),Nt("close",i);break;case"iframe":case"object":case"embed":Nt("load",i);break;case"video":case"audio":for(c=0;c<Vo.length;c++)Nt(Vo[c],i);break;case"source":Nt("error",i);break;case"img":case"image":case"link":Nt("error",i),Nt("load",i);break;case"details":Nt("toggle",i);break;case"input":Nt("invalid",i),al(i,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0);break;case"select":Nt("invalid",i);break;case"textarea":Nt("invalid",i),ou(i,m.value,m.defaultValue,m.children)}c=m.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||i.textContent===""+c||m.suppressHydrationWarning===!0||G1(i.textContent,c)?(m.popover!=null&&(Nt("beforetoggle",i),Nt("toggle",i)),m.onScroll!=null&&Nt("scroll",i),m.onScrollEnd!=null&&Nt("scrollend",i),m.onClick!=null&&(i.onclick=jn),i=!0):i=!1,i||Rs(n,!0)}function Ap(n){for(ta=n.return;ta;)switch(ta.tag){case 5:case 31:case 13:mn=!1;return;case 27:case 3:mn=!0;return;default:ta=ta.return}}function dl(n){if(n!==ta)return!1;if(!Ct)return Ap(n),Ct=!0,!1;var i=n.tag,c;if((c=i!==3&&i!==27)&&((c=i===5)&&(c=n.type,c=!(c!=="form"&&c!=="button")||$h(n.type,n.memoizedProps)),c=!c),c&&ur&&Rs(n),Ap(n),i===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));ur=ev(n)}else if(i===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));ur=ev(n)}else i===27?(i=ur,Vs(n.type)?(n=Kh,Kh=null,ur=n):ur=i):ur=ta?pn(n.stateNode.nextSibling):null;return!0}function vi(){ur=ta=null,Ct=!1}function Nd(){var n=Cs;return n!==null&&(Ba===null?Ba=n:Ba.push.apply(Ba,n),Cs=null),n}function Eo(n){Cs===null?Cs=[n]:Cs.push(n)}var jd=W(null),yi=null,as=null;function Ds(n,i,c){P(jd,i._currentValue),i._currentValue=c}function ns(n){n._currentValue=jd.current,O(jd)}function Ad(n,i,c){for(;n!==null;){var m=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,m!==null&&(m.childLanes|=i)):m!==null&&(m.childLanes&i)!==i&&(m.childLanes|=i),n===c)break;n=n.return}}function Od(n,i,c,m){var v=n.child;for(v!==null&&(v.return=n);v!==null;){var b=v.dependencies;if(b!==null){var k=v.child;b=b.firstContext;e:for(;b!==null;){var R=b;b=v;for(var ee=0;ee<i.length;ee++)if(R.context===i[ee]){b.lanes|=c,R=b.alternate,R!==null&&(R.lanes|=c),Ad(b.return,c,n),m||(k=null);break e}b=R.next}}else if(v.tag===18){if(k=v.return,k===null)throw Error(a(341));k.lanes|=c,b=k.alternate,b!==null&&(b.lanes|=c),Ad(k,c,n),k=null}else k=v.child;if(k!==null)k.return=v;else for(k=v;k!==null;){if(k===n){k=null;break}if(v=k.sibling,v!==null){v.return=k.return,k=v;break}k=k.return}v=k}}function hl(n,i,c,m){n=null;for(var v=i,b=!1;v!==null;){if(!b){if((v.flags&524288)!==0)b=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var k=v.alternate;if(k===null)throw Error(a(387));if(k=k.memoizedProps,k!==null){var R=v.type;Ga(v.pendingProps.value,k.value)||(n!==null?n.push(R):n=[R])}}else if(v===re.current){if(k=v.alternate,k===null)throw Error(a(387));k.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(n!==null?n.push(Jo):n=[Jo])}v=v.return}n!==null&&Od(i,n,c,m),i.flags|=262144}function Eu(n){for(n=n.firstContext;n!==null;){if(!Ga(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function _i(n){yi=n,as=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function ra(n){return Op(yi,n)}function Tu(n,i){return yi===null&&_i(n),Op(n,i)}function Op(n,i){var c=i._currentValue;if(i={context:i,memoizedValue:c,next:null},as===null){if(n===null)throw Error(a(308));as=i,n.dependencies={lanes:0,firstContext:i},n.flags|=524288}else as=as.next=i;return c}var qS=typeof AbortController<"u"?AbortController:function(){var n=[],i=this.signal={aborted:!1,addEventListener:function(c,m){n.push(m)}};this.abort=function(){i.aborted=!0,n.forEach(function(c){return c()})}},$S=e.unstable_scheduleCallback,GS=e.unstable_NormalPriority,Fr={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Cd(){return{controller:new qS,data:new Map,refCount:0}}function To(n){n.refCount--,n.refCount===0&&$S(GS,function(){n.controller.abort()})}var ko=null,Rd=0,ml=0,xl=null;function VS(n,i){if(ko===null){var c=ko=[];Rd=0,ml=Mh(),xl={status:"pending",value:void 0,then:function(m){c.push(m)}}}return Rd++,i.then(Cp,Cp),i}function Cp(){if(--Rd===0&&ko!==null){xl!==null&&(xl.status="fulfilled");var n=ko;ko=null,ml=0,xl=null;for(var i=0;i<n.length;i++)(0,n[i])()}}function XS(n,i){var c=[],m={status:"pending",value:null,reason:null,then:function(v){c.push(v)}};return n.then(function(){m.status="fulfilled",m.value=i;for(var v=0;v<c.length;v++)(0,c[v])(i)},function(v){for(m.status="rejected",m.reason=v,v=0;v<c.length;v++)(0,c[v])(void 0)}),m}var Rp=te.S;te.S=function(n,i){x1=Ke(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&VS(n,i),Rp!==null&&Rp(n,i)};var bi=W(null);function Dd(){var n=bi.current;return n!==null?n:lr.pooledCache}function ku(n,i){i===null?P(bi,bi.current):P(bi,i.pool)}function Dp(){var n=Dd();return n===null?null:{parent:Fr._currentValue,pool:n}}var pl=Error(a(460)),Fd=Error(a(474)),Nu=Error(a(542)),ju={then:function(){}};function Fp(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Mp(n,i,c){switch(c=n[c],c===void 0?n.push(i):c!==i&&(i.then(jn,jn),i=c),i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,Lp(n),n;default:if(typeof i.status=="string")i.then(jn,jn);else{if(n=lr,n!==null&&100<n.shellSuspendCounter)throw Error(a(482));n=i,n.status="pending",n.then(function(m){if(i.status==="pending"){var v=i;v.status="fulfilled",v.value=m}},function(m){if(i.status==="pending"){var v=i;v.status="rejected",v.reason=m}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,Lp(n),n}throw Si=i,pl}}function wi(n){try{var i=n._init;return i(n._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Si=c,pl):c}}var Si=null;function Ip(){if(Si===null)throw Error(a(459));var n=Si;return Si=null,n}function Lp(n){if(n===pl||n===Nu)throw Error(a(483))}var gl=null,No=0;function Au(n){var i=No;return No+=1,gl===null&&(gl=[]),Mp(gl,n,i)}function jo(n,i){i=i.props.ref,n.ref=i!==void 0?i:null}function Ou(n,i){throw i.$$typeof===p?Error(a(525)):(n=Object.prototype.toString.call(i),Error(a(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n)))}function Bp(n){function i(oe,se){if(n){var fe=oe.deletions;fe===null?(oe.deletions=[se],oe.flags|=16):fe.push(se)}}function c(oe,se){if(!n)return null;for(;se!==null;)i(oe,se),se=se.sibling;return null}function m(oe){for(var se=new Map;oe!==null;)oe.key!==null?se.set(oe.key,oe):se.set(oe.index,oe),oe=oe.sibling;return se}function v(oe,se){return oe=ts(oe,se),oe.index=0,oe.sibling=null,oe}function b(oe,se,fe){return oe.index=fe,n?(fe=oe.alternate,fe!==null?(fe=fe.index,fe<se?(oe.flags|=67108866,se):fe):(oe.flags|=67108866,se)):(oe.flags|=1048576,se)}function k(oe){return n&&oe.alternate===null&&(oe.flags|=67108866),oe}function R(oe,se,fe,ke){return se===null||se.tag!==6?(se=wd(fe,oe.mode,ke),se.return=oe,se):(se=v(se,fe),se.return=oe,se)}function ee(oe,se,fe,ke){var rt=fe.type;return rt===_?we(oe,se,fe.props.children,ke,fe.key):se!==null&&(se.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===M&&wi(rt)===se.type)?(se=v(se,fe.props),jo(se,fe),se.return=oe,se):(se=wu(fe.type,fe.key,fe.props,null,oe.mode,ke),jo(se,fe),se.return=oe,se)}function de(oe,se,fe,ke){return se===null||se.tag!==4||se.stateNode.containerInfo!==fe.containerInfo||se.stateNode.implementation!==fe.implementation?(se=Sd(fe,oe.mode,ke),se.return=oe,se):(se=v(se,fe.children||[]),se.return=oe,se)}function we(oe,se,fe,ke,rt){return se===null||se.tag!==7?(se=gi(fe,oe.mode,ke,rt),se.return=oe,se):(se=v(se,fe),se.return=oe,se)}function je(oe,se,fe){if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return se=wd(""+se,oe.mode,fe),se.return=oe,se;if(typeof se=="object"&&se!==null){switch(se.$$typeof){case y:return fe=wu(se.type,se.key,se.props,null,oe.mode,fe),jo(fe,se),fe.return=oe,fe;case w:return se=Sd(se,oe.mode,fe),se.return=oe,se;case M:return se=wi(se),je(oe,se,fe)}if(Se(se)||q(se))return se=gi(se,oe.mode,fe,null),se.return=oe,se;if(typeof se.then=="function")return je(oe,Au(se),fe);if(se.$$typeof===E)return je(oe,Tu(oe,se),fe);Ou(oe,se)}return null}function xe(oe,se,fe,ke){var rt=se!==null?se.key:null;if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return rt!==null?null:R(oe,se,""+fe,ke);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case y:return fe.key===rt?ee(oe,se,fe,ke):null;case w:return fe.key===rt?de(oe,se,fe,ke):null;case M:return fe=wi(fe),xe(oe,se,fe,ke)}if(Se(fe)||q(fe))return rt!==null?null:we(oe,se,fe,ke,null);if(typeof fe.then=="function")return xe(oe,se,Au(fe),ke);if(fe.$$typeof===E)return xe(oe,se,Tu(oe,fe),ke);Ou(oe,fe)}return null}function ve(oe,se,fe,ke,rt){if(typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint")return oe=oe.get(fe)||null,R(se,oe,""+ke,rt);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case y:return oe=oe.get(ke.key===null?fe:ke.key)||null,ee(se,oe,ke,rt);case w:return oe=oe.get(ke.key===null?fe:ke.key)||null,de(se,oe,ke,rt);case M:return ke=wi(ke),ve(oe,se,fe,ke,rt)}if(Se(ke)||q(ke))return oe=oe.get(fe)||null,we(se,oe,ke,rt,null);if(typeof ke.then=="function")return ve(oe,se,fe,Au(ke),rt);if(ke.$$typeof===E)return ve(oe,se,fe,Tu(se,ke),rt);Ou(se,ke)}return null}function We(oe,se,fe,ke){for(var rt=null,Bt=null,Je=se,_t=se=0,At=null;Je!==null&&_t<fe.length;_t++){Je.index>_t?(At=Je,Je=null):At=Je.sibling;var Pt=xe(oe,Je,fe[_t],ke);if(Pt===null){Je===null&&(Je=At);break}n&&Je&&Pt.alternate===null&&i(oe,Je),se=b(Pt,se,_t),Bt===null?rt=Pt:Bt.sibling=Pt,Bt=Pt,Je=At}if(_t===fe.length)return c(oe,Je),Ct&&rs(oe,_t),rt;if(Je===null){for(;_t<fe.length;_t++)Je=je(oe,fe[_t],ke),Je!==null&&(se=b(Je,se,_t),Bt===null?rt=Je:Bt.sibling=Je,Bt=Je);return Ct&&rs(oe,_t),rt}for(Je=m(Je);_t<fe.length;_t++)At=ve(Je,oe,_t,fe[_t],ke),At!==null&&(n&&At.alternate!==null&&Je.delete(At.key===null?_t:At.key),se=b(At,se,_t),Bt===null?rt=At:Bt.sibling=At,Bt=At);return n&&Je.forEach(function(Js){return i(oe,Js)}),Ct&&rs(oe,_t),rt}function lt(oe,se,fe,ke){if(fe==null)throw Error(a(151));for(var rt=null,Bt=null,Je=se,_t=se=0,At=null,Pt=fe.next();Je!==null&&!Pt.done;_t++,Pt=fe.next()){Je.index>_t?(At=Je,Je=null):At=Je.sibling;var Js=xe(oe,Je,Pt.value,ke);if(Js===null){Je===null&&(Je=At);break}n&&Je&&Js.alternate===null&&i(oe,Je),se=b(Js,se,_t),Bt===null?rt=Js:Bt.sibling=Js,Bt=Js,Je=At}if(Pt.done)return c(oe,Je),Ct&&rs(oe,_t),rt;if(Je===null){for(;!Pt.done;_t++,Pt=fe.next())Pt=je(oe,Pt.value,ke),Pt!==null&&(se=b(Pt,se,_t),Bt===null?rt=Pt:Bt.sibling=Pt,Bt=Pt);return Ct&&rs(oe,_t),rt}for(Je=m(Je);!Pt.done;_t++,Pt=fe.next())Pt=ve(Je,oe,_t,Pt.value,ke),Pt!==null&&(n&&Pt.alternate!==null&&Je.delete(Pt.key===null?_t:Pt.key),se=b(Pt,se,_t),Bt===null?rt=Pt:Bt.sibling=Pt,Bt=Pt);return n&&Je.forEach(function(nT){return i(oe,nT)}),Ct&&rs(oe,_t),rt}function nr(oe,se,fe,ke){if(typeof fe=="object"&&fe!==null&&fe.type===_&&fe.key===null&&(fe=fe.props.children),typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case y:e:{for(var rt=fe.key;se!==null;){if(se.key===rt){if(rt=fe.type,rt===_){if(se.tag===7){c(oe,se.sibling),ke=v(se,fe.props.children),ke.return=oe,oe=ke;break e}}else if(se.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===M&&wi(rt)===se.type){c(oe,se.sibling),ke=v(se,fe.props),jo(ke,fe),ke.return=oe,oe=ke;break e}c(oe,se);break}else i(oe,se);se=se.sibling}fe.type===_?(ke=gi(fe.props.children,oe.mode,ke,fe.key),ke.return=oe,oe=ke):(ke=wu(fe.type,fe.key,fe.props,null,oe.mode,ke),jo(ke,fe),ke.return=oe,oe=ke)}return k(oe);case w:e:{for(rt=fe.key;se!==null;){if(se.key===rt)if(se.tag===4&&se.stateNode.containerInfo===fe.containerInfo&&se.stateNode.implementation===fe.implementation){c(oe,se.sibling),ke=v(se,fe.children||[]),ke.return=oe,oe=ke;break e}else{c(oe,se);break}else i(oe,se);se=se.sibling}ke=Sd(fe,oe.mode,ke),ke.return=oe,oe=ke}return k(oe);case M:return fe=wi(fe),nr(oe,se,fe,ke)}if(Se(fe))return We(oe,se,fe,ke);if(q(fe)){if(rt=q(fe),typeof rt!="function")throw Error(a(150));return fe=rt.call(fe),lt(oe,se,fe,ke)}if(typeof fe.then=="function")return nr(oe,se,Au(fe),ke);if(fe.$$typeof===E)return nr(oe,se,Tu(oe,fe),ke);Ou(oe,fe)}return typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint"?(fe=""+fe,se!==null&&se.tag===6?(c(oe,se.sibling),ke=v(se,fe),ke.return=oe,oe=ke):(c(oe,se),ke=wd(fe,oe.mode,ke),ke.return=oe,oe=ke),k(oe)):c(oe,se)}return function(oe,se,fe,ke){try{No=0;var rt=nr(oe,se,fe,ke);return gl=null,rt}catch(Je){if(Je===pl||Je===Nu)throw Je;var Bt=Va(29,Je,null,oe.mode);return Bt.lanes=ke,Bt.return=oe,Bt}finally{}}}var Ei=Bp(!0),Pp=Bp(!1),Fs=!1;function Md(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Id(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Ms(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Is(n,i,c){var m=n.updateQueue;if(m===null)return null;if(m=m.shared,($t&2)!==0){var v=m.pending;return v===null?i.next=i:(i.next=v.next,v.next=i),m.pending=i,i=bu(n),wp(n,null,c),i}return _u(n,m,i,c),bu(n)}function Ao(n,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194048)!==0)){var m=i.lanes;m&=n.pendingLanes,c|=m,i.lanes=c,Ie(n,c)}}function Ld(n,i){var c=n.updateQueue,m=n.alternate;if(m!==null&&(m=m.updateQueue,c===m)){var v=null,b=null;if(c=c.firstBaseUpdate,c!==null){do{var k={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};b===null?v=b=k:b=b.next=k,c=c.next}while(c!==null);b===null?v=b=i:b=b.next=i}else v=b=i;c={baseState:m.baseState,firstBaseUpdate:v,lastBaseUpdate:b,shared:m.shared,callbacks:m.callbacks},n.updateQueue=c;return}n=c.lastBaseUpdate,n===null?c.firstBaseUpdate=i:n.next=i,c.lastBaseUpdate=i}var Bd=!1;function Oo(){if(Bd){var n=xl;if(n!==null)throw n}}function Co(n,i,c,m){Bd=!1;var v=n.updateQueue;Fs=!1;var b=v.firstBaseUpdate,k=v.lastBaseUpdate,R=v.shared.pending;if(R!==null){v.shared.pending=null;var ee=R,de=ee.next;ee.next=null,k===null?b=de:k.next=de,k=ee;var we=n.alternate;we!==null&&(we=we.updateQueue,R=we.lastBaseUpdate,R!==k&&(R===null?we.firstBaseUpdate=de:R.next=de,we.lastBaseUpdate=ee))}if(b!==null){var je=v.baseState;k=0,we=de=ee=null,R=b;do{var xe=R.lane&-536870913,ve=xe!==R.lane;if(ve?(jt&xe)===xe:(m&xe)===xe){xe!==0&&xe===ml&&(Bd=!0),we!==null&&(we=we.next={lane:0,tag:R.tag,payload:R.payload,callback:null,next:null});e:{var We=n,lt=R;xe=i;var nr=c;switch(lt.tag){case 1:if(We=lt.payload,typeof We=="function"){je=We.call(nr,je,xe);break e}je=We;break e;case 3:We.flags=We.flags&-65537|128;case 0:if(We=lt.payload,xe=typeof We=="function"?We.call(nr,je,xe):We,xe==null)break e;je=g({},je,xe);break e;case 2:Fs=!0}}xe=R.callback,xe!==null&&(n.flags|=64,ve&&(n.flags|=8192),ve=v.callbacks,ve===null?v.callbacks=[xe]:ve.push(xe))}else ve={lane:xe,tag:R.tag,payload:R.payload,callback:R.callback,next:null},we===null?(de=we=ve,ee=je):we=we.next=ve,k|=xe;if(R=R.next,R===null){if(R=v.shared.pending,R===null)break;ve=R,R=ve.next,ve.next=null,v.lastBaseUpdate=ve,v.shared.pending=null}}while(!0);we===null&&(ee=je),v.baseState=ee,v.firstBaseUpdate=de,v.lastBaseUpdate=we,b===null&&(v.shared.lanes=0),zs|=k,n.lanes=k,n.memoizedState=je}}function Up(n,i){if(typeof n!="function")throw Error(a(191,n));n.call(i)}function zp(n,i){var c=n.callbacks;if(c!==null)for(n.callbacks=null,n=0;n<c.length;n++)Up(c[n],i)}var vl=W(null),Cu=W(0);function Hp(n,i){n=hs,P(Cu,n),P(vl,i),hs=n|i.baseLanes}function Pd(){P(Cu,hs),P(vl,vl.current)}function Ud(){hs=Cu.current,O(vl),O(Cu)}var Xa=W(null),xn=null;function Ls(n){var i=n.alternate;P(Ar,Ar.current&1),P(Xa,n),xn===null&&(i===null||vl.current!==null||i.memoizedState!==null)&&(xn=n)}function zd(n){P(Ar,Ar.current),P(Xa,n),xn===null&&(xn=n)}function qp(n){n.tag===22?(P(Ar,Ar.current),P(Xa,n),xn===null&&(xn=n)):Bs()}function Bs(){P(Ar,Ar.current),P(Xa,Xa.current)}function Wa(n){O(Xa),xn===n&&(xn=null),O(Ar)}var Ar=W(0);function Ru(n){for(var i=n;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||Xh(c)||Wh(c)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var ss=0,vt=null,rr=null,Mr=null,Du=!1,yl=!1,Ti=!1,Fu=0,Ro=0,_l=null,WS=0;function wr(){throw Error(a(321))}function Hd(n,i){if(i===null)return!1;for(var c=0;c<i.length&&c<n.length;c++)if(!Ga(n[c],i[c]))return!1;return!0}function qd(n,i,c,m,v,b){return ss=b,vt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,te.H=n===null||n.memoizedState===null?kg:nh,Ti=!1,b=c(m,v),Ti=!1,yl&&(b=Gp(i,c,m,v)),$p(n),b}function $p(n){te.H=Mo;var i=rr!==null&&rr.next!==null;if(ss=0,Mr=rr=vt=null,Du=!1,Ro=0,_l=null,i)throw Error(a(300));n===null||Ir||(n=n.dependencies,n!==null&&Eu(n)&&(Ir=!0))}function Gp(n,i,c,m){vt=n;var v=0;do{if(yl&&(_l=null),Ro=0,yl=!1,25<=v)throw Error(a(301));if(v+=1,Mr=rr=null,n.updateQueue!=null){var b=n.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}te.H=Ng,b=i(c,m)}while(yl);return b}function KS(){var n=te.H,i=n.useState()[0];return i=typeof i.then=="function"?Do(i):i,n=n.useState()[0],(rr!==null?rr.memoizedState:null)!==n&&(vt.flags|=1024),i}function $d(){var n=Fu!==0;return Fu=0,n}function Gd(n,i,c){i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~c}function Vd(n){if(Du){for(n=n.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Du=!1}ss=0,Mr=rr=vt=null,yl=!1,Ro=Fu=0,_l=null}function ka(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mr===null?vt.memoizedState=Mr=n:Mr=Mr.next=n,Mr}function Or(){if(rr===null){var n=vt.alternate;n=n!==null?n.memoizedState:null}else n=rr.next;var i=Mr===null?vt.memoizedState:Mr.next;if(i!==null)Mr=i,rr=n;else{if(n===null)throw vt.alternate===null?Error(a(467)):Error(a(310));rr=n,n={memoizedState:rr.memoizedState,baseState:rr.baseState,baseQueue:rr.baseQueue,queue:rr.queue,next:null},Mr===null?vt.memoizedState=Mr=n:Mr=Mr.next=n}return Mr}function Mu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Do(n){var i=Ro;return Ro+=1,_l===null&&(_l=[]),n=Mp(_l,n,i),i=vt,(Mr===null?i.memoizedState:Mr.next)===null&&(i=i.alternate,te.H=i===null||i.memoizedState===null?kg:nh),n}function Iu(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Do(n);if(n.$$typeof===E)return ra(n)}throw Error(a(438,String(n)))}function Xd(n){var i=null,c=vt.updateQueue;if(c!==null&&(i=c.memoCache),i==null){var m=vt.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(i={data:m.data.map(function(v){return v.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),c===null&&(c=Mu(),vt.updateQueue=c),c.memoCache=i,c=i.data[i.index],c===void 0)for(c=i.data[i.index]=Array(n),m=0;m<n;m++)c[m]=U;return i.index++,c}function is(n,i){return typeof i=="function"?i(n):i}function Lu(n){var i=Or();return Wd(i,rr,n)}function Wd(n,i,c){var m=n.queue;if(m===null)throw Error(a(311));m.lastRenderedReducer=c;var v=n.baseQueue,b=m.pending;if(b!==null){if(v!==null){var k=v.next;v.next=b.next,b.next=k}i.baseQueue=v=b,m.pending=null}if(b=n.baseState,v===null)n.memoizedState=b;else{i=v.next;var R=k=null,ee=null,de=i,we=!1;do{var je=de.lane&-536870913;if(je!==de.lane?(jt&je)===je:(ss&je)===je){var xe=de.revertLane;if(xe===0)ee!==null&&(ee=ee.next={lane:0,revertLane:0,gesture:null,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null}),je===ml&&(we=!0);else if((ss&xe)===xe){de=de.next,xe===ml&&(we=!0);continue}else je={lane:0,revertLane:de.revertLane,gesture:null,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},ee===null?(R=ee=je,k=b):ee=ee.next=je,vt.lanes|=xe,zs|=xe;je=de.action,Ti&&c(b,je),b=de.hasEagerState?de.eagerState:c(b,je)}else xe={lane:je,revertLane:de.revertLane,gesture:de.gesture,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},ee===null?(R=ee=xe,k=b):ee=ee.next=xe,vt.lanes|=je,zs|=je;de=de.next}while(de!==null&&de!==i);if(ee===null?k=b:ee.next=R,!Ga(b,n.memoizedState)&&(Ir=!0,we&&(c=xl,c!==null)))throw c;n.memoizedState=b,n.baseState=k,n.baseQueue=ee,m.lastRenderedState=b}return v===null&&(m.lanes=0),[n.memoizedState,m.dispatch]}function Kd(n){var i=Or(),c=i.queue;if(c===null)throw Error(a(311));c.lastRenderedReducer=n;var m=c.dispatch,v=c.pending,b=i.memoizedState;if(v!==null){c.pending=null;var k=v=v.next;do b=n(b,k.action),k=k.next;while(k!==v);Ga(b,i.memoizedState)||(Ir=!0),i.memoizedState=b,i.baseQueue===null&&(i.baseState=b),c.lastRenderedState=b}return[b,m]}function Vp(n,i,c){var m=vt,v=Or(),b=Ct;if(b){if(c===void 0)throw Error(a(407));c=c()}else c=i();var k=!Ga((rr||v).memoizedState,c);if(k&&(v.memoizedState=c,Ir=!0),v=v.queue,Qd(Kp.bind(null,m,v,n),[n]),v.getSnapshot!==i||k||Mr!==null&&Mr.memoizedState.tag&1){if(m.flags|=2048,bl(9,{destroy:void 0},Wp.bind(null,m,v,c,i),null),lr===null)throw Error(a(349));b||(ss&127)!==0||Xp(m,i,c)}return c}function Xp(n,i,c){n.flags|=16384,n={getSnapshot:i,value:c},i=vt.updateQueue,i===null?(i=Mu(),vt.updateQueue=i,i.stores=[n]):(c=i.stores,c===null?i.stores=[n]:c.push(n))}function Wp(n,i,c,m){i.value=c,i.getSnapshot=m,Yp(i)&&Jp(n)}function Kp(n,i,c){return c(function(){Yp(i)&&Jp(n)})}function Yp(n){var i=n.getSnapshot;n=n.value;try{var c=i();return!Ga(n,c)}catch{return!0}}function Jp(n){var i=pi(n,2);i!==null&&Pa(i,n,2)}function Yd(n){var i=ka();if(typeof n=="function"){var c=n;if(n=c(),Ti){qr(!0);try{c()}finally{qr(!1)}}}return i.memoizedState=i.baseState=n,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:is,lastRenderedState:n},i}function Qp(n,i,c,m){return n.baseState=c,Wd(n,rr,typeof m=="function"?m:is)}function YS(n,i,c,m,v){if(Uu(n))throw Error(a(485));if(n=i.action,n!==null){var b={payload:v,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(k){b.listeners.push(k)}};te.T!==null?c(!0):b.isTransition=!1,m(b),c=i.pending,c===null?(b.next=i.pending=b,Zp(i,b)):(b.next=c.next,i.pending=c.next=b)}}function Zp(n,i){var c=i.action,m=i.payload,v=n.state;if(i.isTransition){var b=te.T,k={};te.T=k;try{var R=c(v,m),ee=te.S;ee!==null&&ee(k,R),eg(n,i,R)}catch(de){Jd(n,i,de)}finally{b!==null&&k.types!==null&&(b.types=k.types),te.T=b}}else try{b=c(v,m),eg(n,i,b)}catch(de){Jd(n,i,de)}}function eg(n,i,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(m){tg(n,i,m)},function(m){return Jd(n,i,m)}):tg(n,i,c)}function tg(n,i,c){i.status="fulfilled",i.value=c,rg(i),n.state=c,i=n.pending,i!==null&&(c=i.next,c===i?n.pending=null:(c=c.next,i.next=c,Zp(n,c)))}function Jd(n,i,c){var m=n.pending;if(n.pending=null,m!==null){m=m.next;do i.status="rejected",i.reason=c,rg(i),i=i.next;while(i!==m)}n.action=null}function rg(n){n=n.listeners;for(var i=0;i<n.length;i++)(0,n[i])()}function ag(n,i){return i}function ng(n,i){if(Ct){var c=lr.formState;if(c!==null){e:{var m=vt;if(Ct){if(ur){t:{for(var v=ur,b=mn;v.nodeType!==8;){if(!b){v=null;break t}if(v=pn(v.nextSibling),v===null){v=null;break t}}b=v.data,v=b==="F!"||b==="F"?v:null}if(v){ur=pn(v.nextSibling),m=v.data==="F!";break e}}Rs(m)}m=!1}m&&(i=c[0])}}return c=ka(),c.memoizedState=c.baseState=i,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ag,lastRenderedState:i},c.queue=m,c=Sg.bind(null,vt,m),m.dispatch=c,m=Yd(!1),b=ah.bind(null,vt,!1,m.queue),m=ka(),v={state:i,dispatch:null,action:n,pending:null},m.queue=v,c=YS.bind(null,vt,v,b,c),v.dispatch=c,m.memoizedState=n,[i,c,!1]}function sg(n){var i=Or();return ig(i,rr,n)}function ig(n,i,c){if(i=Wd(n,i,ag)[0],n=Lu(is)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var m=Do(i)}catch(k){throw k===pl?Nu:k}else m=i;i=Or();var v=i.queue,b=v.dispatch;return c!==i.memoizedState&&(vt.flags|=2048,bl(9,{destroy:void 0},JS.bind(null,v,c),null)),[m,b,n]}function JS(n,i){n.action=i}function lg(n){var i=Or(),c=rr;if(c!==null)return ig(i,c,n);Or(),i=i.memoizedState,c=Or();var m=c.queue.dispatch;return c.memoizedState=n,[i,m,!1]}function bl(n,i,c,m){return n={tag:n,create:c,deps:m,inst:i,next:null},i=vt.updateQueue,i===null&&(i=Mu(),vt.updateQueue=i),c=i.lastEffect,c===null?i.lastEffect=n.next=n:(m=c.next,c.next=n,n.next=m,i.lastEffect=n),n}function og(){return Or().memoizedState}function Bu(n,i,c,m){var v=ka();vt.flags|=n,v.memoizedState=bl(1|i,{destroy:void 0},c,m===void 0?null:m)}function Pu(n,i,c,m){var v=Or();m=m===void 0?null:m;var b=v.memoizedState.inst;rr!==null&&m!==null&&Hd(m,rr.memoizedState.deps)?v.memoizedState=bl(i,b,c,m):(vt.flags|=n,v.memoizedState=bl(1|i,b,c,m))}function cg(n,i){Bu(8390656,8,n,i)}function Qd(n,i){Pu(2048,8,n,i)}function QS(n){vt.flags|=4;var i=vt.updateQueue;if(i===null)i=Mu(),vt.updateQueue=i,i.events=[n];else{var c=i.events;c===null?i.events=[n]:c.push(n)}}function ug(n){var i=Or().memoizedState;return QS({ref:i,nextImpl:n}),function(){if(($t&2)!==0)throw Error(a(440));return i.impl.apply(void 0,arguments)}}function fg(n,i){return Pu(4,2,n,i)}function dg(n,i){return Pu(4,4,n,i)}function hg(n,i){if(typeof i=="function"){n=n();var c=i(n);return function(){typeof c=="function"?c():i(null)}}if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function mg(n,i,c){c=c!=null?c.concat([n]):null,Pu(4,4,hg.bind(null,i,n),c)}function Zd(){}function xg(n,i){var c=Or();i=i===void 0?null:i;var m=c.memoizedState;return i!==null&&Hd(i,m[1])?m[0]:(c.memoizedState=[n,i],n)}function pg(n,i){var c=Or();i=i===void 0?null:i;var m=c.memoizedState;if(i!==null&&Hd(i,m[1]))return m[0];if(m=n(),Ti){qr(!0);try{n()}finally{qr(!1)}}return c.memoizedState=[m,i],m}function eh(n,i,c){return c===void 0||(ss&1073741824)!==0&&(jt&261930)===0?n.memoizedState=i:(n.memoizedState=c,n=g1(),vt.lanes|=n,zs|=n,c)}function gg(n,i,c,m){return Ga(c,i)?c:vl.current!==null?(n=eh(n,c,m),Ga(n,i)||(Ir=!0),n):(ss&42)===0||(ss&1073741824)!==0&&(jt&261930)===0?(Ir=!0,n.memoizedState=c):(n=g1(),vt.lanes|=n,zs|=n,i)}function vg(n,i,c,m,v){var b=ae.p;ae.p=b!==0&&8>b?b:8;var k=te.T,R={};te.T=R,ah(n,!1,i,c);try{var ee=v(),de=te.S;if(de!==null&&de(R,ee),ee!==null&&typeof ee=="object"&&typeof ee.then=="function"){var we=XS(ee,m);Fo(n,i,we,Ja(n))}else Fo(n,i,m,Ja(n))}catch(je){Fo(n,i,{then:function(){},status:"rejected",reason:je},Ja())}finally{ae.p=b,k!==null&&R.types!==null&&(k.types=R.types),te.T=k}}function ZS(){}function th(n,i,c,m){if(n.tag!==5)throw Error(a(476));var v=yg(n).queue;vg(n,v,i,De,c===null?ZS:function(){return _g(n),c(m)})}function yg(n){var i=n.memoizedState;if(i!==null)return i;i={memoizedState:De,baseState:De,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:is,lastRenderedState:De},next:null};var c={};return i.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:is,lastRenderedState:c},next:null},n.memoizedState=i,n=n.alternate,n!==null&&(n.memoizedState=i),i}function _g(n){var i=yg(n);i.next===null&&(i=n.alternate.memoizedState),Fo(n,i.next.queue,{},Ja())}function rh(){return ra(Jo)}function bg(){return Or().memoizedState}function wg(){return Or().memoizedState}function eE(n){for(var i=n.return;i!==null;){switch(i.tag){case 24:case 3:var c=Ja();n=Ms(c);var m=Is(i,n,c);m!==null&&(Pa(m,i,c),Ao(m,i,c)),i={cache:Cd()},n.payload=i;return}i=i.return}}function tE(n,i,c){var m=Ja();c={lane:m,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Uu(n)?Eg(i,c):(c=_d(n,i,c,m),c!==null&&(Pa(c,n,m),Tg(c,i,m)))}function Sg(n,i,c){var m=Ja();Fo(n,i,c,m)}function Fo(n,i,c,m){var v={lane:m,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Uu(n))Eg(i,v);else{var b=n.alternate;if(n.lanes===0&&(b===null||b.lanes===0)&&(b=i.lastRenderedReducer,b!==null))try{var k=i.lastRenderedState,R=b(k,c);if(v.hasEagerState=!0,v.eagerState=R,Ga(R,k))return _u(n,i,v,0),lr===null&&yu(),!1}catch{}finally{}if(c=_d(n,i,v,m),c!==null)return Pa(c,n,m),Tg(c,i,m),!0}return!1}function ah(n,i,c,m){if(m={lane:2,revertLane:Mh(),gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},Uu(n)){if(i)throw Error(a(479))}else i=_d(n,c,m,2),i!==null&&Pa(i,n,2)}function Uu(n){var i=n.alternate;return n===vt||i!==null&&i===vt}function Eg(n,i){yl=Du=!0;var c=n.pending;c===null?i.next=i:(i.next=c.next,c.next=i),n.pending=i}function Tg(n,i,c){if((c&4194048)!==0){var m=i.lanes;m&=n.pendingLanes,c|=m,i.lanes=c,Ie(n,c)}}var Mo={readContext:ra,use:Iu,useCallback:wr,useContext:wr,useEffect:wr,useImperativeHandle:wr,useLayoutEffect:wr,useInsertionEffect:wr,useMemo:wr,useReducer:wr,useRef:wr,useState:wr,useDebugValue:wr,useDeferredValue:wr,useTransition:wr,useSyncExternalStore:wr,useId:wr,useHostTransitionStatus:wr,useFormState:wr,useActionState:wr,useOptimistic:wr,useMemoCache:wr,useCacheRefresh:wr};Mo.useEffectEvent=wr;var kg={readContext:ra,use:Iu,useCallback:function(n,i){return ka().memoizedState=[n,i===void 0?null:i],n},useContext:ra,useEffect:cg,useImperativeHandle:function(n,i,c){c=c!=null?c.concat([n]):null,Bu(4194308,4,hg.bind(null,i,n),c)},useLayoutEffect:function(n,i){return Bu(4194308,4,n,i)},useInsertionEffect:function(n,i){Bu(4,2,n,i)},useMemo:function(n,i){var c=ka();i=i===void 0?null:i;var m=n();if(Ti){qr(!0);try{n()}finally{qr(!1)}}return c.memoizedState=[m,i],m},useReducer:function(n,i,c){var m=ka();if(c!==void 0){var v=c(i);if(Ti){qr(!0);try{c(i)}finally{qr(!1)}}}else v=i;return m.memoizedState=m.baseState=v,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:v},m.queue=n,n=n.dispatch=tE.bind(null,vt,n),[m.memoizedState,n]},useRef:function(n){var i=ka();return n={current:n},i.memoizedState=n},useState:function(n){n=Yd(n);var i=n.queue,c=Sg.bind(null,vt,i);return i.dispatch=c,[n.memoizedState,c]},useDebugValue:Zd,useDeferredValue:function(n,i){var c=ka();return eh(c,n,i)},useTransition:function(){var n=Yd(!1);return n=vg.bind(null,vt,n.queue,!0,!1),ka().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,i,c){var m=vt,v=ka();if(Ct){if(c===void 0)throw Error(a(407));c=c()}else{if(c=i(),lr===null)throw Error(a(349));(jt&127)!==0||Xp(m,i,c)}v.memoizedState=c;var b={value:c,getSnapshot:i};return v.queue=b,cg(Kp.bind(null,m,b,n),[n]),m.flags|=2048,bl(9,{destroy:void 0},Wp.bind(null,m,b,c,i),null),c},useId:function(){var n=ka(),i=lr.identifierPrefix;if(Ct){var c=$n,m=qn;c=(m&~(1<<32-Vt(m)-1)).toString(32)+c,i="_"+i+"R_"+c,c=Fu++,0<c&&(i+="H"+c.toString(32)),i+="_"}else c=WS++,i="_"+i+"r_"+c.toString(32)+"_";return n.memoizedState=i},useHostTransitionStatus:rh,useFormState:ng,useActionState:ng,useOptimistic:function(n){var i=ka();i.memoizedState=i.baseState=n;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=c,i=ah.bind(null,vt,!0,c),c.dispatch=i,[n,i]},useMemoCache:Xd,useCacheRefresh:function(){return ka().memoizedState=eE.bind(null,vt)},useEffectEvent:function(n){var i=ka(),c={impl:n};return i.memoizedState=c,function(){if(($t&2)!==0)throw Error(a(440));return c.impl.apply(void 0,arguments)}}},nh={readContext:ra,use:Iu,useCallback:xg,useContext:ra,useEffect:Qd,useImperativeHandle:mg,useInsertionEffect:fg,useLayoutEffect:dg,useMemo:pg,useReducer:Lu,useRef:og,useState:function(){return Lu(is)},useDebugValue:Zd,useDeferredValue:function(n,i){var c=Or();return gg(c,rr.memoizedState,n,i)},useTransition:function(){var n=Lu(is)[0],i=Or().memoizedState;return[typeof n=="boolean"?n:Do(n),i]},useSyncExternalStore:Vp,useId:bg,useHostTransitionStatus:rh,useFormState:sg,useActionState:sg,useOptimistic:function(n,i){var c=Or();return Qp(c,rr,n,i)},useMemoCache:Xd,useCacheRefresh:wg};nh.useEffectEvent=ug;var Ng={readContext:ra,use:Iu,useCallback:xg,useContext:ra,useEffect:Qd,useImperativeHandle:mg,useInsertionEffect:fg,useLayoutEffect:dg,useMemo:pg,useReducer:Kd,useRef:og,useState:function(){return Kd(is)},useDebugValue:Zd,useDeferredValue:function(n,i){var c=Or();return rr===null?eh(c,n,i):gg(c,rr.memoizedState,n,i)},useTransition:function(){var n=Kd(is)[0],i=Or().memoizedState;return[typeof n=="boolean"?n:Do(n),i]},useSyncExternalStore:Vp,useId:bg,useHostTransitionStatus:rh,useFormState:lg,useActionState:lg,useOptimistic:function(n,i){var c=Or();return rr!==null?Qp(c,rr,n,i):(c.baseState=n,[n,c.queue.dispatch])},useMemoCache:Xd,useCacheRefresh:wg};Ng.useEffectEvent=ug;function sh(n,i,c,m){i=n.memoizedState,c=c(m,i),c=c==null?i:g({},i,c),n.memoizedState=c,n.lanes===0&&(n.updateQueue.baseState=c)}var ih={enqueueSetState:function(n,i,c){n=n._reactInternals;var m=Ja(),v=Ms(m);v.payload=i,c!=null&&(v.callback=c),i=Is(n,v,m),i!==null&&(Pa(i,n,m),Ao(i,n,m))},enqueueReplaceState:function(n,i,c){n=n._reactInternals;var m=Ja(),v=Ms(m);v.tag=1,v.payload=i,c!=null&&(v.callback=c),i=Is(n,v,m),i!==null&&(Pa(i,n,m),Ao(i,n,m))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var c=Ja(),m=Ms(c);m.tag=2,i!=null&&(m.callback=i),i=Is(n,m,c),i!==null&&(Pa(i,n,c),Ao(i,n,c))}};function jg(n,i,c,m,v,b,k){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(m,b,k):i.prototype&&i.prototype.isPureReactComponent?!bo(c,m)||!bo(v,b):!0}function Ag(n,i,c,m){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,m),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,m),i.state!==n&&ih.enqueueReplaceState(i,i.state,null)}function ki(n,i){var c=i;if("ref"in i){c={};for(var m in i)m!=="ref"&&(c[m]=i[m])}if(n=n.defaultProps){c===i&&(c=g({},c));for(var v in n)c[v]===void 0&&(c[v]=n[v])}return c}function Og(n){vu(n)}function Cg(n){console.error(n)}function Rg(n){vu(n)}function zu(n,i){try{var c=n.onUncaughtError;c(i.value,{componentStack:i.stack})}catch(m){setTimeout(function(){throw m})}}function Dg(n,i,c){try{var m=n.onCaughtError;m(c.value,{componentStack:c.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function lh(n,i,c){return c=Ms(c),c.tag=3,c.payload={element:null},c.callback=function(){zu(n,i)},c}function Fg(n){return n=Ms(n),n.tag=3,n}function Mg(n,i,c,m){var v=c.type.getDerivedStateFromError;if(typeof v=="function"){var b=m.value;n.payload=function(){return v(b)},n.callback=function(){Dg(i,c,m)}}var k=c.stateNode;k!==null&&typeof k.componentDidCatch=="function"&&(n.callback=function(){Dg(i,c,m),typeof v!="function"&&(Hs===null?Hs=new Set([this]):Hs.add(this));var R=m.stack;this.componentDidCatch(m.value,{componentStack:R!==null?R:""})})}function rE(n,i,c,m,v){if(c.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(i=c.alternate,i!==null&&hl(i,c,v,!0),c=Xa.current,c!==null){switch(c.tag){case 31:case 13:return xn===null?Zu():c.alternate===null&&Sr===0&&(Sr=3),c.flags&=-257,c.flags|=65536,c.lanes=v,m===ju?c.flags|=16384:(i=c.updateQueue,i===null?c.updateQueue=new Set([m]):i.add(m),Rh(n,m,v)),!1;case 22:return c.flags|=65536,m===ju?c.flags|=16384:(i=c.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([m])},c.updateQueue=i):(c=i.retryQueue,c===null?i.retryQueue=new Set([m]):c.add(m)),Rh(n,m,v)),!1}throw Error(a(435,c.tag))}return Rh(n,m,v),Zu(),!1}if(Ct)return i=Xa.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=v,m!==kd&&(n=Error(a(422),{cause:m}),Eo(fn(n,c)))):(m!==kd&&(i=Error(a(423),{cause:m}),Eo(fn(i,c))),n=n.current.alternate,n.flags|=65536,v&=-v,n.lanes|=v,m=fn(m,c),v=lh(n.stateNode,m,v),Ld(n,v),Sr!==4&&(Sr=2)),!1;var b=Error(a(520),{cause:m});if(b=fn(b,c),qo===null?qo=[b]:qo.push(b),Sr!==4&&(Sr=2),i===null)return!0;m=fn(m,c),c=i;do{switch(c.tag){case 3:return c.flags|=65536,n=v&-v,c.lanes|=n,n=lh(c.stateNode,m,n),Ld(c,n),!1;case 1:if(i=c.type,b=c.stateNode,(c.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Hs===null||!Hs.has(b))))return c.flags|=65536,v&=-v,c.lanes|=v,v=Fg(v),Mg(v,n,c,m),Ld(c,v),!1}c=c.return}while(c!==null);return!1}var oh=Error(a(461)),Ir=!1;function aa(n,i,c,m){i.child=n===null?Pp(i,null,c,m):Ei(i,n.child,c,m)}function Ig(n,i,c,m,v){c=c.render;var b=i.ref;if("ref"in m){var k={};for(var R in m)R!=="ref"&&(k[R]=m[R])}else k=m;return _i(i),m=qd(n,i,c,k,b,v),R=$d(),n!==null&&!Ir?(Gd(n,i,v),ls(n,i,v)):(Ct&&R&&Ed(i),i.flags|=1,aa(n,i,m,v),i.child)}function Lg(n,i,c,m,v){if(n===null){var b=c.type;return typeof b=="function"&&!bd(b)&&b.defaultProps===void 0&&c.compare===null?(i.tag=15,i.type=b,Bg(n,i,b,m,v)):(n=wu(c.type,null,m,i,i.mode,v),n.ref=i.ref,n.return=i,i.child=n)}if(b=n.child,!ph(n,v)){var k=b.memoizedProps;if(c=c.compare,c=c!==null?c:bo,c(k,m)&&n.ref===i.ref)return ls(n,i,v)}return i.flags|=1,n=ts(b,m),n.ref=i.ref,n.return=i,i.child=n}function Bg(n,i,c,m,v){if(n!==null){var b=n.memoizedProps;if(bo(b,m)&&n.ref===i.ref)if(Ir=!1,i.pendingProps=m=b,ph(n,v))(n.flags&131072)!==0&&(Ir=!0);else return i.lanes=n.lanes,ls(n,i,v)}return ch(n,i,c,m,v)}function Pg(n,i,c,m){var v=m.children,b=n!==null?n.memoizedState:null;if(n===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),m.mode==="hidden"){if((i.flags&128)!==0){if(b=b!==null?b.baseLanes|c:c,n!==null){for(m=i.child=n.child,v=0;m!==null;)v=v|m.lanes|m.childLanes,m=m.sibling;m=v&~b}else m=0,i.child=null;return Ug(n,i,b,c,m)}if((c&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},n!==null&&ku(i,b!==null?b.cachePool:null),b!==null?Hp(i,b):Pd(),qp(i);else return m=i.lanes=536870912,Ug(n,i,b!==null?b.baseLanes|c:c,c,m)}else b!==null?(ku(i,b.cachePool),Hp(i,b),Bs(),i.memoizedState=null):(n!==null&&ku(i,null),Pd(),Bs());return aa(n,i,v,c),i.child}function Io(n,i){return n!==null&&n.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function Ug(n,i,c,m,v){var b=Dd();return b=b===null?null:{parent:Fr._currentValue,pool:b},i.memoizedState={baseLanes:c,cachePool:b},n!==null&&ku(i,null),Pd(),qp(i),n!==null&&hl(n,i,m,!0),i.childLanes=v,null}function Hu(n,i){return i=$u({mode:i.mode,children:i.children},n.mode),i.ref=n.ref,n.child=i,i.return=n,i}function zg(n,i,c){return Ei(i,n.child,null,c),n=Hu(i,i.pendingProps),n.flags|=2,Wa(i),i.memoizedState=null,n}function aE(n,i,c){var m=i.pendingProps,v=(i.flags&128)!==0;if(i.flags&=-129,n===null){if(Ct){if(m.mode==="hidden")return n=Hu(i,m),i.lanes=536870912,Io(null,n);if(zd(i),(n=ur)?(n=Z1(n,mn),n=n!==null&&n.data==="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:Os!==null?{id:qn,overflow:$n}:null,retryLane:536870912,hydrationErrors:null},c=Ep(n),c.return=i,i.child=c,ta=i,ur=null)):n=null,n===null)throw Rs(i);return i.lanes=536870912,null}return Hu(i,m)}var b=n.memoizedState;if(b!==null){var k=b.dehydrated;if(zd(i),v)if(i.flags&256)i.flags&=-257,i=zg(n,i,c);else if(i.memoizedState!==null)i.child=n.child,i.flags|=128,i=null;else throw Error(a(558));else if(Ir||hl(n,i,c,!1),v=(c&n.childLanes)!==0,Ir||v){if(m=lr,m!==null&&(k=ft(m,c),k!==0&&k!==b.retryLane))throw b.retryLane=k,pi(n,k),Pa(m,n,k),oh;Zu(),i=zg(n,i,c)}else n=b.treeContext,ur=pn(k.nextSibling),ta=i,Ct=!0,Cs=null,mn=!1,n!==null&&Np(i,n),i=Hu(i,m),i.flags|=4096;return i}return n=ts(n.child,{mode:m.mode,children:m.children}),n.ref=i.ref,i.child=n,n.return=i,n}function qu(n,i){var c=i.ref;if(c===null)n!==null&&n.ref!==null&&(i.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(a(284));(n===null||n.ref!==c)&&(i.flags|=4194816)}}function ch(n,i,c,m,v){return _i(i),c=qd(n,i,c,m,void 0,v),m=$d(),n!==null&&!Ir?(Gd(n,i,v),ls(n,i,v)):(Ct&&m&&Ed(i),i.flags|=1,aa(n,i,c,v),i.child)}function Hg(n,i,c,m,v,b){return _i(i),i.updateQueue=null,c=Gp(i,m,c,v),$p(n),m=$d(),n!==null&&!Ir?(Gd(n,i,b),ls(n,i,b)):(Ct&&m&&Ed(i),i.flags|=1,aa(n,i,c,b),i.child)}function qg(n,i,c,m,v){if(_i(i),i.stateNode===null){var b=cl,k=c.contextType;typeof k=="object"&&k!==null&&(b=ra(k)),b=new c(m,b),i.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=ih,i.stateNode=b,b._reactInternals=i,b=i.stateNode,b.props=m,b.state=i.memoizedState,b.refs={},Md(i),k=c.contextType,b.context=typeof k=="object"&&k!==null?ra(k):cl,b.state=i.memoizedState,k=c.getDerivedStateFromProps,typeof k=="function"&&(sh(i,c,k,m),b.state=i.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(k=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),k!==b.state&&ih.enqueueReplaceState(b,b.state,null),Co(i,m,b,v),Oo(),b.state=i.memoizedState),typeof b.componentDidMount=="function"&&(i.flags|=4194308),m=!0}else if(n===null){b=i.stateNode;var R=i.memoizedProps,ee=ki(c,R);b.props=ee;var de=b.context,we=c.contextType;k=cl,typeof we=="object"&&we!==null&&(k=ra(we));var je=c.getDerivedStateFromProps;we=typeof je=="function"||typeof b.getSnapshotBeforeUpdate=="function",R=i.pendingProps!==R,we||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(R||de!==k)&&Ag(i,b,m,k),Fs=!1;var xe=i.memoizedState;b.state=xe,Co(i,m,b,v),Oo(),de=i.memoizedState,R||xe!==de||Fs?(typeof je=="function"&&(sh(i,c,je,m),de=i.memoizedState),(ee=Fs||jg(i,c,ee,m,xe,de,k))?(we||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(i.flags|=4194308)):(typeof b.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=m,i.memoizedState=de),b.props=m,b.state=de,b.context=k,m=ee):(typeof b.componentDidMount=="function"&&(i.flags|=4194308),m=!1)}else{b=i.stateNode,Id(n,i),k=i.memoizedProps,we=ki(c,k),b.props=we,je=i.pendingProps,xe=b.context,de=c.contextType,ee=cl,typeof de=="object"&&de!==null&&(ee=ra(de)),R=c.getDerivedStateFromProps,(de=typeof R=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(k!==je||xe!==ee)&&Ag(i,b,m,ee),Fs=!1,xe=i.memoizedState,b.state=xe,Co(i,m,b,v),Oo();var ve=i.memoizedState;k!==je||xe!==ve||Fs||n!==null&&n.dependencies!==null&&Eu(n.dependencies)?(typeof R=="function"&&(sh(i,c,R,m),ve=i.memoizedState),(we=Fs||jg(i,c,we,m,xe,ve,ee)||n!==null&&n.dependencies!==null&&Eu(n.dependencies))?(de||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(m,ve,ee),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(m,ve,ee)),typeof b.componentDidUpdate=="function"&&(i.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof b.componentDidUpdate!="function"||k===n.memoizedProps&&xe===n.memoizedState||(i.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||k===n.memoizedProps&&xe===n.memoizedState||(i.flags|=1024),i.memoizedProps=m,i.memoizedState=ve),b.props=m,b.state=ve,b.context=ee,m=we):(typeof b.componentDidUpdate!="function"||k===n.memoizedProps&&xe===n.memoizedState||(i.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||k===n.memoizedProps&&xe===n.memoizedState||(i.flags|=1024),m=!1)}return b=m,qu(n,i),m=(i.flags&128)!==0,b||m?(b=i.stateNode,c=m&&typeof c.getDerivedStateFromError!="function"?null:b.render(),i.flags|=1,n!==null&&m?(i.child=Ei(i,n.child,null,v),i.child=Ei(i,null,c,v)):aa(n,i,c,v),i.memoizedState=b.state,n=i.child):n=ls(n,i,v),n}function $g(n,i,c,m){return vi(),i.flags|=256,aa(n,i,c,m),i.child}var uh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function fh(n){return{baseLanes:n,cachePool:Dp()}}function dh(n,i,c){return n=n!==null?n.childLanes&~c:0,i&&(n|=Ya),n}function Gg(n,i,c){var m=i.pendingProps,v=!1,b=(i.flags&128)!==0,k;if((k=b)||(k=n!==null&&n.memoizedState===null?!1:(Ar.current&2)!==0),k&&(v=!0,i.flags&=-129),k=(i.flags&32)!==0,i.flags&=-33,n===null){if(Ct){if(v?Ls(i):Bs(),(n=ur)?(n=Z1(n,mn),n=n!==null&&n.data!=="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:Os!==null?{id:qn,overflow:$n}:null,retryLane:536870912,hydrationErrors:null},c=Ep(n),c.return=i,i.child=c,ta=i,ur=null)):n=null,n===null)throw Rs(i);return Wh(n)?i.lanes=32:i.lanes=536870912,null}var R=m.children;return m=m.fallback,v?(Bs(),v=i.mode,R=$u({mode:"hidden",children:R},v),m=gi(m,v,c,null),R.return=i,m.return=i,R.sibling=m,i.child=R,m=i.child,m.memoizedState=fh(c),m.childLanes=dh(n,k,c),i.memoizedState=uh,Io(null,m)):(Ls(i),hh(i,R))}var ee=n.memoizedState;if(ee!==null&&(R=ee.dehydrated,R!==null)){if(b)i.flags&256?(Ls(i),i.flags&=-257,i=mh(n,i,c)):i.memoizedState!==null?(Bs(),i.child=n.child,i.flags|=128,i=null):(Bs(),R=m.fallback,v=i.mode,m=$u({mode:"visible",children:m.children},v),R=gi(R,v,c,null),R.flags|=2,m.return=i,R.return=i,m.sibling=R,i.child=m,Ei(i,n.child,null,c),m=i.child,m.memoizedState=fh(c),m.childLanes=dh(n,k,c),i.memoizedState=uh,i=Io(null,m));else if(Ls(i),Wh(R)){if(k=R.nextSibling&&R.nextSibling.dataset,k)var de=k.dgst;k=de,m=Error(a(419)),m.stack="",m.digest=k,Eo({value:m,source:null,stack:null}),i=mh(n,i,c)}else if(Ir||hl(n,i,c,!1),k=(c&n.childLanes)!==0,Ir||k){if(k=lr,k!==null&&(m=ft(k,c),m!==0&&m!==ee.retryLane))throw ee.retryLane=m,pi(n,m),Pa(k,n,m),oh;Xh(R)||Zu(),i=mh(n,i,c)}else Xh(R)?(i.flags|=192,i.child=n.child,i=null):(n=ee.treeContext,ur=pn(R.nextSibling),ta=i,Ct=!0,Cs=null,mn=!1,n!==null&&Np(i,n),i=hh(i,m.children),i.flags|=4096);return i}return v?(Bs(),R=m.fallback,v=i.mode,ee=n.child,de=ee.sibling,m=ts(ee,{mode:"hidden",children:m.children}),m.subtreeFlags=ee.subtreeFlags&65011712,de!==null?R=ts(de,R):(R=gi(R,v,c,null),R.flags|=2),R.return=i,m.return=i,m.sibling=R,i.child=m,Io(null,m),m=i.child,R=n.child.memoizedState,R===null?R=fh(c):(v=R.cachePool,v!==null?(ee=Fr._currentValue,v=v.parent!==ee?{parent:ee,pool:ee}:v):v=Dp(),R={baseLanes:R.baseLanes|c,cachePool:v}),m.memoizedState=R,m.childLanes=dh(n,k,c),i.memoizedState=uh,Io(n.child,m)):(Ls(i),c=n.child,n=c.sibling,c=ts(c,{mode:"visible",children:m.children}),c.return=i,c.sibling=null,n!==null&&(k=i.deletions,k===null?(i.deletions=[n],i.flags|=16):k.push(n)),i.child=c,i.memoizedState=null,c)}function hh(n,i){return i=$u({mode:"visible",children:i},n.mode),i.return=n,n.child=i}function $u(n,i){return n=Va(22,n,null,i),n.lanes=0,n}function mh(n,i,c){return Ei(i,n.child,null,c),n=hh(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function Vg(n,i,c){n.lanes|=i;var m=n.alternate;m!==null&&(m.lanes|=i),Ad(n.return,i,c)}function xh(n,i,c,m,v,b){var k=n.memoizedState;k===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:m,tail:c,tailMode:v,treeForkCount:b}:(k.isBackwards=i,k.rendering=null,k.renderingStartTime=0,k.last=m,k.tail=c,k.tailMode=v,k.treeForkCount=b)}function Xg(n,i,c){var m=i.pendingProps,v=m.revealOrder,b=m.tail;m=m.children;var k=Ar.current,R=(k&2)!==0;if(R?(k=k&1|2,i.flags|=128):k&=1,P(Ar,k),aa(n,i,m,c),m=Ct?So:0,!R&&n!==null&&(n.flags&128)!==0)e:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Vg(n,c,i);else if(n.tag===19)Vg(n,c,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(v){case"forwards":for(c=i.child,v=null;c!==null;)n=c.alternate,n!==null&&Ru(n)===null&&(v=c),c=c.sibling;c=v,c===null?(v=i.child,i.child=null):(v=c.sibling,c.sibling=null),xh(i,!1,v,c,b,m);break;case"backwards":case"unstable_legacy-backwards":for(c=null,v=i.child,i.child=null;v!==null;){if(n=v.alternate,n!==null&&Ru(n)===null){i.child=v;break}n=v.sibling,v.sibling=c,c=v,v=n}xh(i,!0,c,null,b,m);break;case"together":xh(i,!1,null,null,void 0,m);break;default:i.memoizedState=null}return i.child}function ls(n,i,c){if(n!==null&&(i.dependencies=n.dependencies),zs|=i.lanes,(c&i.childLanes)===0)if(n!==null){if(hl(n,i,c,!1),(c&i.childLanes)===0)return null}else return null;if(n!==null&&i.child!==n.child)throw Error(a(153));if(i.child!==null){for(n=i.child,c=ts(n,n.pendingProps),i.child=c,c.return=i;n.sibling!==null;)n=n.sibling,c=c.sibling=ts(n,n.pendingProps),c.return=i;c.sibling=null}return i.child}function ph(n,i){return(n.lanes&i)!==0?!0:(n=n.dependencies,!!(n!==null&&Eu(n)))}function nE(n,i,c){switch(i.tag){case 3:Ee(i,i.stateNode.containerInfo),Ds(i,Fr,n.memoizedState.cache),vi();break;case 27:case 5:Oe(i);break;case 4:Ee(i,i.stateNode.containerInfo);break;case 10:Ds(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,zd(i),null;break;case 13:var m=i.memoizedState;if(m!==null)return m.dehydrated!==null?(Ls(i),i.flags|=128,null):(c&i.child.childLanes)!==0?Gg(n,i,c):(Ls(i),n=ls(n,i,c),n!==null?n.sibling:null);Ls(i);break;case 19:var v=(n.flags&128)!==0;if(m=(c&i.childLanes)!==0,m||(hl(n,i,c,!1),m=(c&i.childLanes)!==0),v){if(m)return Xg(n,i,c);i.flags|=128}if(v=i.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),P(Ar,Ar.current),m)break;return null;case 22:return i.lanes=0,Pg(n,i,c,i.pendingProps);case 24:Ds(i,Fr,n.memoizedState.cache)}return ls(n,i,c)}function Wg(n,i,c){if(n!==null)if(n.memoizedProps!==i.pendingProps)Ir=!0;else{if(!ph(n,c)&&(i.flags&128)===0)return Ir=!1,nE(n,i,c);Ir=(n.flags&131072)!==0}else Ir=!1,Ct&&(i.flags&1048576)!==0&&kp(i,So,i.index);switch(i.lanes=0,i.tag){case 16:e:{var m=i.pendingProps;if(n=wi(i.elementType),i.type=n,typeof n=="function")bd(n)?(m=ki(n,m),i.tag=1,i=qg(null,i,n,m,c)):(i.tag=0,i=ch(null,i,n,m,c));else{if(n!=null){var v=n.$$typeof;if(v===D){i.tag=11,i=Ig(null,i,n,m,c);break e}else if(v===A){i.tag=14,i=Lg(null,i,n,m,c);break e}}throw i=ge(n)||n,Error(a(306,i,""))}}return i;case 0:return ch(n,i,i.type,i.pendingProps,c);case 1:return m=i.type,v=ki(m,i.pendingProps),qg(n,i,m,v,c);case 3:e:{if(Ee(i,i.stateNode.containerInfo),n===null)throw Error(a(387));m=i.pendingProps;var b=i.memoizedState;v=b.element,Id(n,i),Co(i,m,null,c);var k=i.memoizedState;if(m=k.cache,Ds(i,Fr,m),m!==b.cache&&Od(i,[Fr],c,!0),Oo(),m=k.element,b.isDehydrated)if(b={element:m,isDehydrated:!1,cache:k.cache},i.updateQueue.baseState=b,i.memoizedState=b,i.flags&256){i=$g(n,i,m,c);break e}else if(m!==v){v=fn(Error(a(424)),i),Eo(v),i=$g(n,i,m,c);break e}else{switch(n=i.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(ur=pn(n.firstChild),ta=i,Ct=!0,Cs=null,mn=!0,c=Pp(i,null,m,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(vi(),m===v){i=ls(n,i,c);break e}aa(n,i,m,c)}i=i.child}return i;case 26:return qu(n,i),n===null?(c=sv(i.type,null,i.pendingProps,null))?i.memoizedState=c:Ct||(c=i.type,n=i.pendingProps,m=i0(Q.current).createElement(c),m[L]=i,m[B]=n,na(m,c,n),Ye(m),i.stateNode=m):i.memoizedState=sv(i.type,n.memoizedProps,i.pendingProps,n.memoizedState),null;case 27:return Oe(i),n===null&&Ct&&(m=i.stateNode=rv(i.type,i.pendingProps,Q.current),ta=i,mn=!0,v=ur,Vs(i.type)?(Kh=v,ur=pn(m.firstChild)):ur=v),aa(n,i,i.pendingProps.children,c),qu(n,i),n===null&&(i.flags|=4194304),i.child;case 5:return n===null&&Ct&&((v=m=ur)&&(m=FE(m,i.type,i.pendingProps,mn),m!==null?(i.stateNode=m,ta=i,ur=pn(m.firstChild),mn=!1,v=!0):v=!1),v||Rs(i)),Oe(i),v=i.type,b=i.pendingProps,k=n!==null?n.memoizedProps:null,m=b.children,$h(v,b)?m=null:k!==null&&$h(v,k)&&(i.flags|=32),i.memoizedState!==null&&(v=qd(n,i,KS,null,null,c),Jo._currentValue=v),qu(n,i),aa(n,i,m,c),i.child;case 6:return n===null&&Ct&&((n=c=ur)&&(c=ME(c,i.pendingProps,mn),c!==null?(i.stateNode=c,ta=i,ur=null,n=!0):n=!1),n||Rs(i)),null;case 13:return Gg(n,i,c);case 4:return Ee(i,i.stateNode.containerInfo),m=i.pendingProps,n===null?i.child=Ei(i,null,m,c):aa(n,i,m,c),i.child;case 11:return Ig(n,i,i.type,i.pendingProps,c);case 7:return aa(n,i,i.pendingProps,c),i.child;case 8:return aa(n,i,i.pendingProps.children,c),i.child;case 12:return aa(n,i,i.pendingProps.children,c),i.child;case 10:return m=i.pendingProps,Ds(i,i.type,m.value),aa(n,i,m.children,c),i.child;case 9:return v=i.type._context,m=i.pendingProps.children,_i(i),v=ra(v),m=m(v),i.flags|=1,aa(n,i,m,c),i.child;case 14:return Lg(n,i,i.type,i.pendingProps,c);case 15:return Bg(n,i,i.type,i.pendingProps,c);case 19:return Xg(n,i,c);case 31:return aE(n,i,c);case 22:return Pg(n,i,c,i.pendingProps);case 24:return _i(i),m=ra(Fr),n===null?(v=Dd(),v===null&&(v=lr,b=Cd(),v.pooledCache=b,b.refCount++,b!==null&&(v.pooledCacheLanes|=c),v=b),i.memoizedState={parent:m,cache:v},Md(i),Ds(i,Fr,v)):((n.lanes&c)!==0&&(Id(n,i),Co(i,null,null,c),Oo()),v=n.memoizedState,b=i.memoizedState,v.parent!==m?(v={parent:m,cache:m},i.memoizedState=v,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=v),Ds(i,Fr,m)):(m=b.cache,Ds(i,Fr,m),m!==v.cache&&Od(i,[Fr],c,!0))),aa(n,i,i.pendingProps.children,c),i.child;case 29:throw i.pendingProps}throw Error(a(156,i.tag))}function os(n){n.flags|=4}function gh(n,i,c,m,v){if((i=(n.mode&32)!==0)&&(i=!1),i){if(n.flags|=16777216,(v&335544128)===v)if(n.stateNode.complete)n.flags|=8192;else if(b1())n.flags|=8192;else throw Si=ju,Fd}else n.flags&=-16777217}function Kg(n,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!uv(i))if(b1())n.flags|=8192;else throw Si=ju,Fd}function Gu(n,i){i!==null&&(n.flags|=4),n.flags&16384&&(i=n.tag!==22?_r():536870912,n.lanes|=i,Tl|=i)}function Lo(n,i){if(!Ct)switch(n.tailMode){case"hidden":i=n.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?n.tail=null:c.sibling=null;break;case"collapsed":c=n.tail;for(var m=null;c!==null;)c.alternate!==null&&(m=c),c=c.sibling;m===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:m.sibling=null}}function fr(n){var i=n.alternate!==null&&n.alternate.child===n.child,c=0,m=0;if(i)for(var v=n.child;v!==null;)c|=v.lanes|v.childLanes,m|=v.subtreeFlags&65011712,m|=v.flags&65011712,v.return=n,v=v.sibling;else for(v=n.child;v!==null;)c|=v.lanes|v.childLanes,m|=v.subtreeFlags,m|=v.flags,v.return=n,v=v.sibling;return n.subtreeFlags|=m,n.childLanes=c,i}function sE(n,i,c){var m=i.pendingProps;switch(Td(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fr(i),null;case 1:return fr(i),null;case 3:return c=i.stateNode,m=null,n!==null&&(m=n.memoizedState.cache),i.memoizedState.cache!==m&&(i.flags|=2048),ns(Fr),ye(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(n===null||n.child===null)&&(dl(i)?os(i):n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Nd())),fr(i),null;case 26:var v=i.type,b=i.memoizedState;return n===null?(os(i),b!==null?(fr(i),Kg(i,b)):(fr(i),gh(i,v,null,m,c))):b?b!==n.memoizedState?(os(i),fr(i),Kg(i,b)):(fr(i),i.flags&=-16777217):(n=n.memoizedProps,n!==m&&os(i),fr(i),gh(i,v,n,m,c)),null;case 27:if(tt(i),c=Q.current,v=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==m&&os(i);else{if(!m){if(i.stateNode===null)throw Error(a(166));return fr(i),null}n=z.current,dl(i)?jp(i):(n=rv(v,m,c),i.stateNode=n,os(i))}return fr(i),null;case 5:if(tt(i),v=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==m&&os(i);else{if(!m){if(i.stateNode===null)throw Error(a(166));return fr(i),null}if(b=z.current,dl(i))jp(i);else{var k=i0(Q.current);switch(b){case 1:b=k.createElementNS("http://www.w3.org/2000/svg",v);break;case 2:b=k.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;default:switch(v){case"svg":b=k.createElementNS("http://www.w3.org/2000/svg",v);break;case"math":b=k.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;case"script":b=k.createElement("div"),b.innerHTML="<script><\/script>",b=b.removeChild(b.firstChild);break;case"select":b=typeof m.is=="string"?k.createElement("select",{is:m.is}):k.createElement("select"),m.multiple?b.multiple=!0:m.size&&(b.size=m.size);break;default:b=typeof m.is=="string"?k.createElement(v,{is:m.is}):k.createElement(v)}}b[L]=i,b[B]=m;e:for(k=i.child;k!==null;){if(k.tag===5||k.tag===6)b.appendChild(k.stateNode);else if(k.tag!==4&&k.tag!==27&&k.child!==null){k.child.return=k,k=k.child;continue}if(k===i)break e;for(;k.sibling===null;){if(k.return===null||k.return===i)break e;k=k.return}k.sibling.return=k.return,k=k.sibling}i.stateNode=b;e:switch(na(b,v,m),v){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}m&&os(i)}}return fr(i),gh(i,i.type,n===null?null:n.memoizedProps,i.pendingProps,c),null;case 6:if(n&&i.stateNode!=null)n.memoizedProps!==m&&os(i);else{if(typeof m!="string"&&i.stateNode===null)throw Error(a(166));if(n=Q.current,dl(i)){if(n=i.stateNode,c=i.memoizedProps,m=null,v=ta,v!==null)switch(v.tag){case 27:case 5:m=v.memoizedProps}n[L]=i,n=!!(n.nodeValue===c||m!==null&&m.suppressHydrationWarning===!0||G1(n.nodeValue,c)),n||Rs(i,!0)}else n=i0(n).createTextNode(m),n[L]=i,i.stateNode=n}return fr(i),null;case 31:if(c=i.memoizedState,n===null||n.memoizedState!==null){if(m=dl(i),c!==null){if(n===null){if(!m)throw Error(a(318));if(n=i.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(557));n[L]=i}else vi(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;fr(i),n=!1}else c=Nd(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=c),n=!0;if(!n)return i.flags&256?(Wa(i),i):(Wa(i),null);if((i.flags&128)!==0)throw Error(a(558))}return fr(i),null;case 13:if(m=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(v=dl(i),m!==null&&m.dehydrated!==null){if(n===null){if(!v)throw Error(a(318));if(v=i.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(a(317));v[L]=i}else vi(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;fr(i),v=!1}else v=Nd(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=v),v=!0;if(!v)return i.flags&256?(Wa(i),i):(Wa(i),null)}return Wa(i),(i.flags&128)!==0?(i.lanes=c,i):(c=m!==null,n=n!==null&&n.memoizedState!==null,c&&(m=i.child,v=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(v=m.alternate.memoizedState.cachePool.pool),b=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(b=m.memoizedState.cachePool.pool),b!==v&&(m.flags|=2048)),c!==n&&c&&(i.child.flags|=8192),Gu(i,i.updateQueue),fr(i),null);case 4:return ye(),n===null&&Ph(i.stateNode.containerInfo),fr(i),null;case 10:return ns(i.type),fr(i),null;case 19:if(O(Ar),m=i.memoizedState,m===null)return fr(i),null;if(v=(i.flags&128)!==0,b=m.rendering,b===null)if(v)Lo(m,!1);else{if(Sr!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(b=Ru(n),b!==null){for(i.flags|=128,Lo(m,!1),n=b.updateQueue,i.updateQueue=n,Gu(i,n),i.subtreeFlags=0,n=c,c=i.child;c!==null;)Sp(c,n),c=c.sibling;return P(Ar,Ar.current&1|2),Ct&&rs(i,m.treeForkCount),i.child}n=n.sibling}m.tail!==null&&Ke()>Yu&&(i.flags|=128,v=!0,Lo(m,!1),i.lanes=4194304)}else{if(!v)if(n=Ru(b),n!==null){if(i.flags|=128,v=!0,n=n.updateQueue,i.updateQueue=n,Gu(i,n),Lo(m,!0),m.tail===null&&m.tailMode==="hidden"&&!b.alternate&&!Ct)return fr(i),null}else 2*Ke()-m.renderingStartTime>Yu&&c!==536870912&&(i.flags|=128,v=!0,Lo(m,!1),i.lanes=4194304);m.isBackwards?(b.sibling=i.child,i.child=b):(n=m.last,n!==null?n.sibling=b:i.child=b,m.last=b)}return m.tail!==null?(n=m.tail,m.rendering=n,m.tail=n.sibling,m.renderingStartTime=Ke(),n.sibling=null,c=Ar.current,P(Ar,v?c&1|2:c&1),Ct&&rs(i,m.treeForkCount),n):(fr(i),null);case 22:case 23:return Wa(i),Ud(),m=i.memoizedState!==null,n!==null?n.memoizedState!==null!==m&&(i.flags|=8192):m&&(i.flags|=8192),m?(c&536870912)!==0&&(i.flags&128)===0&&(fr(i),i.subtreeFlags&6&&(i.flags|=8192)):fr(i),c=i.updateQueue,c!==null&&Gu(i,c.retryQueue),c=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),m=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(m=i.memoizedState.cachePool.pool),m!==c&&(i.flags|=2048),n!==null&&O(bi),null;case 24:return c=null,n!==null&&(c=n.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),ns(Fr),fr(i),null;case 25:return null;case 30:return null}throw Error(a(156,i.tag))}function iE(n,i){switch(Td(i),i.tag){case 1:return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return ns(Fr),ye(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 26:case 27:case 5:return tt(i),null;case 31:if(i.memoizedState!==null){if(Wa(i),i.alternate===null)throw Error(a(340));vi()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 13:if(Wa(i),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(a(340));vi()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return O(Ar),null;case 4:return ye(),null;case 10:return ns(i.type),null;case 22:case 23:return Wa(i),Ud(),n!==null&&O(bi),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 24:return ns(Fr),null;case 25:return null;default:return null}}function Yg(n,i){switch(Td(i),i.tag){case 3:ns(Fr),ye();break;case 26:case 27:case 5:tt(i);break;case 4:ye();break;case 31:i.memoizedState!==null&&Wa(i);break;case 13:Wa(i);break;case 19:O(Ar);break;case 10:ns(i.type);break;case 22:case 23:Wa(i),Ud(),n!==null&&O(bi);break;case 24:ns(Fr)}}function Bo(n,i){try{var c=i.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var v=m.next;c=v;do{if((c.tag&n)===n){m=void 0;var b=c.create,k=c.inst;m=b(),k.destroy=m}c=c.next}while(c!==v)}}catch(R){Jt(i,i.return,R)}}function Ps(n,i,c){try{var m=i.updateQueue,v=m!==null?m.lastEffect:null;if(v!==null){var b=v.next;m=b;do{if((m.tag&n)===n){var k=m.inst,R=k.destroy;if(R!==void 0){k.destroy=void 0,v=i;var ee=c,de=R;try{de()}catch(we){Jt(v,ee,we)}}}m=m.next}while(m!==b)}}catch(we){Jt(i,i.return,we)}}function Jg(n){var i=n.updateQueue;if(i!==null){var c=n.stateNode;try{zp(i,c)}catch(m){Jt(n,n.return,m)}}}function Qg(n,i,c){c.props=ki(n.type,n.memoizedProps),c.state=n.memoizedState;try{c.componentWillUnmount()}catch(m){Jt(n,i,m)}}function Po(n,i){try{var c=n.ref;if(c!==null){switch(n.tag){case 26:case 27:case 5:var m=n.stateNode;break;case 30:m=n.stateNode;break;default:m=n.stateNode}typeof c=="function"?n.refCleanup=c(m):c.current=m}}catch(v){Jt(n,i,v)}}function Gn(n,i){var c=n.ref,m=n.refCleanup;if(c!==null)if(typeof m=="function")try{m()}catch(v){Jt(n,i,v)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(v){Jt(n,i,v)}else c.current=null}function Zg(n){var i=n.type,c=n.memoizedProps,m=n.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":c.autoFocus&&m.focus();break e;case"img":c.src?m.src=c.src:c.srcSet&&(m.srcset=c.srcSet)}}catch(v){Jt(n,n.return,v)}}function vh(n,i,c){try{var m=n.stateNode;jE(m,n.type,c,i),m[B]=i}catch(v){Jt(n,n.return,v)}}function e1(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Vs(n.type)||n.tag===4}function yh(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||e1(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Vs(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function _h(n,i,c){var m=n.tag;if(m===5||m===6)n=n.stateNode,i?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(n,i):(i=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,i.appendChild(n),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=jn));else if(m!==4&&(m===27&&Vs(n.type)&&(c=n.stateNode,i=null),n=n.child,n!==null))for(_h(n,i,c),n=n.sibling;n!==null;)_h(n,i,c),n=n.sibling}function Vu(n,i,c){var m=n.tag;if(m===5||m===6)n=n.stateNode,i?c.insertBefore(n,i):c.appendChild(n);else if(m!==4&&(m===27&&Vs(n.type)&&(c=n.stateNode),n=n.child,n!==null))for(Vu(n,i,c),n=n.sibling;n!==null;)Vu(n,i,c),n=n.sibling}function t1(n){var i=n.stateNode,c=n.memoizedProps;try{for(var m=n.type,v=i.attributes;v.length;)i.removeAttributeNode(v[0]);na(i,m,c),i[L]=n,i[B]=c}catch(b){Jt(n,n.return,b)}}var cs=!1,Lr=!1,bh=!1,r1=typeof WeakSet=="function"?WeakSet:Set,Yr=null;function lE(n,i){if(n=n.containerInfo,Hh=h0,n=mp(n),md(n)){if("selectionStart"in n)var c={start:n.selectionStart,end:n.selectionEnd};else e:{c=(c=n.ownerDocument)&&c.defaultView||window;var m=c.getSelection&&c.getSelection();if(m&&m.rangeCount!==0){c=m.anchorNode;var v=m.anchorOffset,b=m.focusNode;m=m.focusOffset;try{c.nodeType,b.nodeType}catch{c=null;break e}var k=0,R=-1,ee=-1,de=0,we=0,je=n,xe=null;t:for(;;){for(var ve;je!==c||v!==0&&je.nodeType!==3||(R=k+v),je!==b||m!==0&&je.nodeType!==3||(ee=k+m),je.nodeType===3&&(k+=je.nodeValue.length),(ve=je.firstChild)!==null;)xe=je,je=ve;for(;;){if(je===n)break t;if(xe===c&&++de===v&&(R=k),xe===b&&++we===m&&(ee=k),(ve=je.nextSibling)!==null)break;je=xe,xe=je.parentNode}je=ve}c=R===-1||ee===-1?null:{start:R,end:ee}}else c=null}c=c||{start:0,end:0}}else c=null;for(qh={focusedElem:n,selectionRange:c},h0=!1,Yr=i;Yr!==null;)if(i=Yr,n=i.child,(i.subtreeFlags&1028)!==0&&n!==null)n.return=i,Yr=n;else for(;Yr!==null;){switch(i=Yr,b=i.alternate,n=i.flags,i.tag){case 0:if((n&4)!==0&&(n=i.updateQueue,n=n!==null?n.events:null,n!==null))for(c=0;c<n.length;c++)v=n[c],v.ref.impl=v.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&b!==null){n=void 0,c=i,v=b.memoizedProps,b=b.memoizedState,m=c.stateNode;try{var We=ki(c.type,v);n=m.getSnapshotBeforeUpdate(We,b),m.__reactInternalSnapshotBeforeUpdate=n}catch(lt){Jt(c,c.return,lt)}}break;case 3:if((n&1024)!==0){if(n=i.stateNode.containerInfo,c=n.nodeType,c===9)Vh(n);else if(c===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Vh(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(a(163))}if(n=i.sibling,n!==null){n.return=i.return,Yr=n;break}Yr=i.return}}function a1(n,i,c){var m=c.flags;switch(c.tag){case 0:case 11:case 15:fs(n,c),m&4&&Bo(5,c);break;case 1:if(fs(n,c),m&4)if(n=c.stateNode,i===null)try{n.componentDidMount()}catch(k){Jt(c,c.return,k)}else{var v=ki(c.type,i.memoizedProps);i=i.memoizedState;try{n.componentDidUpdate(v,i,n.__reactInternalSnapshotBeforeUpdate)}catch(k){Jt(c,c.return,k)}}m&64&&Jg(c),m&512&&Po(c,c.return);break;case 3:if(fs(n,c),m&64&&(n=c.updateQueue,n!==null)){if(i=null,c.child!==null)switch(c.child.tag){case 27:case 5:i=c.child.stateNode;break;case 1:i=c.child.stateNode}try{zp(n,i)}catch(k){Jt(c,c.return,k)}}break;case 27:i===null&&m&4&&t1(c);case 26:case 5:fs(n,c),i===null&&m&4&&Zg(c),m&512&&Po(c,c.return);break;case 12:fs(n,c);break;case 31:fs(n,c),m&4&&i1(n,c);break;case 13:fs(n,c),m&4&&l1(n,c),m&64&&(n=c.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(c=pE.bind(null,c),IE(n,c))));break;case 22:if(m=c.memoizedState!==null||cs,!m){i=i!==null&&i.memoizedState!==null||Lr,v=cs;var b=Lr;cs=m,(Lr=i)&&!b?ds(n,c,(c.subtreeFlags&8772)!==0):fs(n,c),cs=v,Lr=b}break;case 30:break;default:fs(n,c)}}function n1(n){var i=n.alternate;i!==null&&(n.alternate=null,n1(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&Fe(i)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var pr=null,Ma=!1;function us(n,i,c){for(c=c.child;c!==null;)s1(n,i,c),c=c.sibling}function s1(n,i,c){if(Gt&&typeof Gt.onCommitFiberUnmount=="function")try{Gt.onCommitFiberUnmount(It,c)}catch{}switch(c.tag){case 26:Lr||Gn(c,i),us(n,i,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Lr||Gn(c,i);var m=pr,v=Ma;Vs(c.type)&&(pr=c.stateNode,Ma=!1),us(n,i,c),Wo(c.stateNode),pr=m,Ma=v;break;case 5:Lr||Gn(c,i);case 6:if(m=pr,v=Ma,pr=null,us(n,i,c),pr=m,Ma=v,pr!==null)if(Ma)try{(pr.nodeType===9?pr.body:pr.nodeName==="HTML"?pr.ownerDocument.body:pr).removeChild(c.stateNode)}catch(b){Jt(c,i,b)}else try{pr.removeChild(c.stateNode)}catch(b){Jt(c,i,b)}break;case 18:pr!==null&&(Ma?(n=pr,J1(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,c.stateNode),Dl(n)):J1(pr,c.stateNode));break;case 4:m=pr,v=Ma,pr=c.stateNode.containerInfo,Ma=!0,us(n,i,c),pr=m,Ma=v;break;case 0:case 11:case 14:case 15:Ps(2,c,i),Lr||Ps(4,c,i),us(n,i,c);break;case 1:Lr||(Gn(c,i),m=c.stateNode,typeof m.componentWillUnmount=="function"&&Qg(c,i,m)),us(n,i,c);break;case 21:us(n,i,c);break;case 22:Lr=(m=Lr)||c.memoizedState!==null,us(n,i,c),Lr=m;break;default:us(n,i,c)}}function i1(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Dl(n)}catch(c){Jt(i,i.return,c)}}}function l1(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Dl(n)}catch(c){Jt(i,i.return,c)}}function oE(n){switch(n.tag){case 31:case 13:case 19:var i=n.stateNode;return i===null&&(i=n.stateNode=new r1),i;case 22:return n=n.stateNode,i=n._retryCache,i===null&&(i=n._retryCache=new r1),i;default:throw Error(a(435,n.tag))}}function Xu(n,i){var c=oE(n);i.forEach(function(m){if(!c.has(m)){c.add(m);var v=gE.bind(null,n,m);m.then(v,v)}})}function Ia(n,i){var c=i.deletions;if(c!==null)for(var m=0;m<c.length;m++){var v=c[m],b=n,k=i,R=k;e:for(;R!==null;){switch(R.tag){case 27:if(Vs(R.type)){pr=R.stateNode,Ma=!1;break e}break;case 5:pr=R.stateNode,Ma=!1;break e;case 3:case 4:pr=R.stateNode.containerInfo,Ma=!0;break e}R=R.return}if(pr===null)throw Error(a(160));s1(b,k,v),pr=null,Ma=!1,b=v.alternate,b!==null&&(b.return=null),v.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)o1(i,n),i=i.sibling}var On=null;function o1(n,i){var c=n.alternate,m=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Ia(i,n),La(n),m&4&&(Ps(3,n,n.return),Bo(3,n),Ps(5,n,n.return));break;case 1:Ia(i,n),La(n),m&512&&(Lr||c===null||Gn(c,c.return)),m&64&&cs&&(n=n.updateQueue,n!==null&&(m=n.callbacks,m!==null&&(c=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=c===null?m:c.concat(m))));break;case 26:var v=On;if(Ia(i,n),La(n),m&512&&(Lr||c===null||Gn(c,c.return)),m&4){var b=c!==null?c.memoizedState:null;if(m=n.memoizedState,c===null)if(m===null)if(n.stateNode===null){e:{m=n.type,c=n.memoizedProps,v=v.ownerDocument||v;t:switch(m){case"title":b=v.getElementsByTagName("title")[0],(!b||b[me]||b[L]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=v.createElement(m),v.head.insertBefore(b,v.querySelector("head > title"))),na(b,m,c),b[L]=n,Ye(b),m=b;break e;case"link":var k=ov("link","href",v).get(m+(c.href||""));if(k){for(var R=0;R<k.length;R++)if(b=k[R],b.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&b.getAttribute("rel")===(c.rel==null?null:c.rel)&&b.getAttribute("title")===(c.title==null?null:c.title)&&b.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){k.splice(R,1);break t}}b=v.createElement(m),na(b,m,c),v.head.appendChild(b);break;case"meta":if(k=ov("meta","content",v).get(m+(c.content||""))){for(R=0;R<k.length;R++)if(b=k[R],b.getAttribute("content")===(c.content==null?null:""+c.content)&&b.getAttribute("name")===(c.name==null?null:c.name)&&b.getAttribute("property")===(c.property==null?null:c.property)&&b.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&b.getAttribute("charset")===(c.charSet==null?null:c.charSet)){k.splice(R,1);break t}}b=v.createElement(m),na(b,m,c),v.head.appendChild(b);break;default:throw Error(a(468,m))}b[L]=n,Ye(b),m=b}n.stateNode=m}else cv(v,n.type,n.stateNode);else n.stateNode=lv(v,m,n.memoizedProps);else b!==m?(b===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):b.count--,m===null?cv(v,n.type,n.stateNode):lv(v,m,n.memoizedProps)):m===null&&n.stateNode!==null&&vh(n,n.memoizedProps,c.memoizedProps)}break;case 27:Ia(i,n),La(n),m&512&&(Lr||c===null||Gn(c,c.return)),c!==null&&m&4&&vh(n,n.memoizedProps,c.memoizedProps);break;case 5:if(Ia(i,n),La(n),m&512&&(Lr||c===null||Gn(c,c.return)),n.flags&32){v=n.stateNode;try{As(v,"")}catch(We){Jt(n,n.return,We)}}m&4&&n.stateNode!=null&&(v=n.memoizedProps,vh(n,v,c!==null?c.memoizedProps:v)),m&1024&&(bh=!0);break;case 6:if(Ia(i,n),La(n),m&4){if(n.stateNode===null)throw Error(a(162));m=n.memoizedProps,c=n.stateNode;try{c.nodeValue=m}catch(We){Jt(n,n.return,We)}}break;case 3:if(c0=null,v=On,On=l0(i.containerInfo),Ia(i,n),On=v,La(n),m&4&&c!==null&&c.memoizedState.isDehydrated)try{Dl(i.containerInfo)}catch(We){Jt(n,n.return,We)}bh&&(bh=!1,c1(n));break;case 4:m=On,On=l0(n.stateNode.containerInfo),Ia(i,n),La(n),On=m;break;case 12:Ia(i,n),La(n);break;case 31:Ia(i,n),La(n),m&4&&(m=n.updateQueue,m!==null&&(n.updateQueue=null,Xu(n,m)));break;case 13:Ia(i,n),La(n),n.child.flags&8192&&n.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Ku=Ke()),m&4&&(m=n.updateQueue,m!==null&&(n.updateQueue=null,Xu(n,m)));break;case 22:v=n.memoizedState!==null;var ee=c!==null&&c.memoizedState!==null,de=cs,we=Lr;if(cs=de||v,Lr=we||ee,Ia(i,n),Lr=we,cs=de,La(n),m&8192)e:for(i=n.stateNode,i._visibility=v?i._visibility&-2:i._visibility|1,v&&(c===null||ee||cs||Lr||Ni(n)),c=null,i=n;;){if(i.tag===5||i.tag===26){if(c===null){ee=c=i;try{if(b=ee.stateNode,v)k=b.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none";else{R=ee.stateNode;var je=ee.memoizedProps.style,xe=je!=null&&je.hasOwnProperty("display")?je.display:null;R.style.display=xe==null||typeof xe=="boolean"?"":(""+xe).trim()}}catch(We){Jt(ee,ee.return,We)}}}else if(i.tag===6){if(c===null){ee=i;try{ee.stateNode.nodeValue=v?"":ee.memoizedProps}catch(We){Jt(ee,ee.return,We)}}}else if(i.tag===18){if(c===null){ee=i;try{var ve=ee.stateNode;v?Q1(ve,!0):Q1(ee.stateNode,!1)}catch(We){Jt(ee,ee.return,We)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===n)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break e;for(;i.sibling===null;){if(i.return===null||i.return===n)break e;c===i&&(c=null),i=i.return}c===i&&(c=null),i.sibling.return=i.return,i=i.sibling}m&4&&(m=n.updateQueue,m!==null&&(c=m.retryQueue,c!==null&&(m.retryQueue=null,Xu(n,c))));break;case 19:Ia(i,n),La(n),m&4&&(m=n.updateQueue,m!==null&&(n.updateQueue=null,Xu(n,m)));break;case 30:break;case 21:break;default:Ia(i,n),La(n)}}function La(n){var i=n.flags;if(i&2){try{for(var c,m=n.return;m!==null;){if(e1(m)){c=m;break}m=m.return}if(c==null)throw Error(a(160));switch(c.tag){case 27:var v=c.stateNode,b=yh(n);Vu(n,b,v);break;case 5:var k=c.stateNode;c.flags&32&&(As(k,""),c.flags&=-33);var R=yh(n);Vu(n,R,k);break;case 3:case 4:var ee=c.stateNode.containerInfo,de=yh(n);_h(n,de,ee);break;default:throw Error(a(161))}}catch(we){Jt(n,n.return,we)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function c1(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var i=n;c1(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),n=n.sibling}}function fs(n,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)a1(n,i.alternate,i),i=i.sibling}function Ni(n){for(n=n.child;n!==null;){var i=n;switch(i.tag){case 0:case 11:case 14:case 15:Ps(4,i,i.return),Ni(i);break;case 1:Gn(i,i.return);var c=i.stateNode;typeof c.componentWillUnmount=="function"&&Qg(i,i.return,c),Ni(i);break;case 27:Wo(i.stateNode);case 26:case 5:Gn(i,i.return),Ni(i);break;case 22:i.memoizedState===null&&Ni(i);break;case 30:Ni(i);break;default:Ni(i)}n=n.sibling}}function ds(n,i,c){for(c=c&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var m=i.alternate,v=n,b=i,k=b.flags;switch(b.tag){case 0:case 11:case 15:ds(v,b,c),Bo(4,b);break;case 1:if(ds(v,b,c),m=b,v=m.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(de){Jt(m,m.return,de)}if(m=b,v=m.updateQueue,v!==null){var R=m.stateNode;try{var ee=v.shared.hiddenCallbacks;if(ee!==null)for(v.shared.hiddenCallbacks=null,v=0;v<ee.length;v++)Up(ee[v],R)}catch(de){Jt(m,m.return,de)}}c&&k&64&&Jg(b),Po(b,b.return);break;case 27:t1(b);case 26:case 5:ds(v,b,c),c&&m===null&&k&4&&Zg(b),Po(b,b.return);break;case 12:ds(v,b,c);break;case 31:ds(v,b,c),c&&k&4&&i1(v,b);break;case 13:ds(v,b,c),c&&k&4&&l1(v,b);break;case 22:b.memoizedState===null&&ds(v,b,c),Po(b,b.return);break;case 30:break;default:ds(v,b,c)}i=i.sibling}}function wh(n,i){var c=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),n=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(n=i.memoizedState.cachePool.pool),n!==c&&(n!=null&&n.refCount++,c!=null&&To(c))}function Sh(n,i){n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&To(n))}function Cn(n,i,c,m){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)u1(n,i,c,m),i=i.sibling}function u1(n,i,c,m){var v=i.flags;switch(i.tag){case 0:case 11:case 15:Cn(n,i,c,m),v&2048&&Bo(9,i);break;case 1:Cn(n,i,c,m);break;case 3:Cn(n,i,c,m),v&2048&&(n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&To(n)));break;case 12:if(v&2048){Cn(n,i,c,m),n=i.stateNode;try{var b=i.memoizedProps,k=b.id,R=b.onPostCommit;typeof R=="function"&&R(k,i.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(ee){Jt(i,i.return,ee)}}else Cn(n,i,c,m);break;case 31:Cn(n,i,c,m);break;case 13:Cn(n,i,c,m);break;case 23:break;case 22:b=i.stateNode,k=i.alternate,i.memoizedState!==null?b._visibility&2?Cn(n,i,c,m):Uo(n,i):b._visibility&2?Cn(n,i,c,m):(b._visibility|=2,wl(n,i,c,m,(i.subtreeFlags&10256)!==0||!1)),v&2048&&wh(k,i);break;case 24:Cn(n,i,c,m),v&2048&&Sh(i.alternate,i);break;default:Cn(n,i,c,m)}}function wl(n,i,c,m,v){for(v=v&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var b=n,k=i,R=c,ee=m,de=k.flags;switch(k.tag){case 0:case 11:case 15:wl(b,k,R,ee,v),Bo(8,k);break;case 23:break;case 22:var we=k.stateNode;k.memoizedState!==null?we._visibility&2?wl(b,k,R,ee,v):Uo(b,k):(we._visibility|=2,wl(b,k,R,ee,v)),v&&de&2048&&wh(k.alternate,k);break;case 24:wl(b,k,R,ee,v),v&&de&2048&&Sh(k.alternate,k);break;default:wl(b,k,R,ee,v)}i=i.sibling}}function Uo(n,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var c=n,m=i,v=m.flags;switch(m.tag){case 22:Uo(c,m),v&2048&&wh(m.alternate,m);break;case 24:Uo(c,m),v&2048&&Sh(m.alternate,m);break;default:Uo(c,m)}i=i.sibling}}var zo=8192;function Sl(n,i,c){if(n.subtreeFlags&zo)for(n=n.child;n!==null;)f1(n,i,c),n=n.sibling}function f1(n,i,c){switch(n.tag){case 26:Sl(n,i,c),n.flags&zo&&n.memoizedState!==null&&WE(c,On,n.memoizedState,n.memoizedProps);break;case 5:Sl(n,i,c);break;case 3:case 4:var m=On;On=l0(n.stateNode.containerInfo),Sl(n,i,c),On=m;break;case 22:n.memoizedState===null&&(m=n.alternate,m!==null&&m.memoizedState!==null?(m=zo,zo=16777216,Sl(n,i,c),zo=m):Sl(n,i,c));break;default:Sl(n,i,c)}}function d1(n){var i=n.alternate;if(i!==null&&(n=i.child,n!==null)){i.child=null;do i=n.sibling,n.sibling=null,n=i;while(n!==null)}}function Ho(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var m=i[c];Yr=m,m1(m,n)}d1(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)h1(n),n=n.sibling}function h1(n){switch(n.tag){case 0:case 11:case 15:Ho(n),n.flags&2048&&Ps(9,n,n.return);break;case 3:Ho(n);break;case 12:Ho(n);break;case 22:var i=n.stateNode;n.memoizedState!==null&&i._visibility&2&&(n.return===null||n.return.tag!==13)?(i._visibility&=-3,Wu(n)):Ho(n);break;default:Ho(n)}}function Wu(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var m=i[c];Yr=m,m1(m,n)}d1(n)}for(n=n.child;n!==null;){switch(i=n,i.tag){case 0:case 11:case 15:Ps(8,i,i.return),Wu(i);break;case 22:c=i.stateNode,c._visibility&2&&(c._visibility&=-3,Wu(i));break;default:Wu(i)}n=n.sibling}}function m1(n,i){for(;Yr!==null;){var c=Yr;switch(c.tag){case 0:case 11:case 15:Ps(8,c,i);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var m=c.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:To(c.memoizedState.cache)}if(m=c.child,m!==null)m.return=c,Yr=m;else e:for(c=n;Yr!==null;){m=Yr;var v=m.sibling,b=m.return;if(n1(m),m===c){Yr=null;break e}if(v!==null){v.return=b,Yr=v;break e}Yr=b}}}var cE={getCacheForType:function(n){var i=ra(Fr),c=i.data.get(n);return c===void 0&&(c=n(),i.data.set(n,c)),c},cacheSignal:function(){return ra(Fr).controller.signal}},uE=typeof WeakMap=="function"?WeakMap:Map,$t=0,lr=null,kt=null,jt=0,Yt=0,Ka=null,Us=!1,El=!1,Eh=!1,hs=0,Sr=0,zs=0,ji=0,Th=0,Ya=0,Tl=0,qo=null,Ba=null,kh=!1,Ku=0,x1=0,Yu=1/0,Ju=null,Hs=null,Vr=0,qs=null,kl=null,ms=0,Nh=0,jh=null,p1=null,$o=0,Ah=null;function Ja(){return($t&2)!==0&&jt!==0?jt&-jt:te.T!==null?Mh():j()}function g1(){if(Ya===0)if((jt&536870912)===0||Ct){var n=zn;zn<<=1,(zn&3932160)===0&&(zn=262144),Ya=n}else Ya=536870912;return n=Xa.current,n!==null&&(n.flags|=32),Ya}function Pa(n,i,c){(n===lr&&(Yt===2||Yt===9)||n.cancelPendingCommit!==null)&&(Nl(n,0),$s(n,jt,Ya,!1)),$a(n,c),(($t&2)===0||n!==lr)&&(n===lr&&(($t&2)===0&&(ji|=c),Sr===4&&$s(n,jt,Ya,!1)),Vn(n))}function v1(n,i,c){if(($t&6)!==0)throw Error(a(327));var m=!c&&(i&127)===0&&(i&n.expiredLanes)===0||Ea(n,i),v=m?hE(n,i):Ch(n,i,!0),b=m;do{if(v===0){El&&!m&&$s(n,i,0,!1);break}else{if(c=n.current.alternate,b&&!fE(c)){v=Ch(n,i,!1),b=!1;continue}if(v===2){if(b=i,n.errorRecoveryDisabledLanes&b)var k=0;else k=n.pendingLanes&-536870913,k=k!==0?k:k&536870912?536870912:0;if(k!==0){i=k;e:{var R=n;v=qo;var ee=R.current.memoizedState.isDehydrated;if(ee&&(Nl(R,k).flags|=256),k=Ch(R,k,!1),k!==2){if(Eh&&!ee){R.errorRecoveryDisabledLanes|=b,ji|=b,v=4;break e}b=Ba,Ba=v,b!==null&&(Ba===null?Ba=b:Ba.push.apply(Ba,b))}v=k}if(b=!1,v!==2)continue}}if(v===1){Nl(n,0),$s(n,i,0,!0);break}e:{switch(m=n,b=v,b){case 0:case 1:throw Error(a(345));case 4:if((i&4194048)!==i)break;case 6:$s(m,i,Ya,!Us);break e;case 2:Ba=null;break;case 3:case 5:break;default:throw Error(a(329))}if((i&62914560)===i&&(v=Ku+300-Ke(),10<v)){if($s(m,i,Ya,!Us),ea(m,0,!0)!==0)break e;ms=i,m.timeoutHandle=K1(y1.bind(null,m,c,Ba,Ju,kh,i,Ya,ji,Tl,Us,b,"Throttled",-0,0),v);break e}y1(m,c,Ba,Ju,kh,i,Ya,ji,Tl,Us,b,null,-0,0)}}break}while(!0);Vn(n)}function y1(n,i,c,m,v,b,k,R,ee,de,we,je,xe,ve){if(n.timeoutHandle=-1,je=i.subtreeFlags,je&8192||(je&16785408)===16785408){je={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:jn},f1(i,b,je);var We=(b&62914560)===b?Ku-Ke():(b&4194048)===b?x1-Ke():0;if(We=KE(je,We),We!==null){ms=b,n.cancelPendingCommit=We(N1.bind(null,n,i,b,c,m,v,k,R,ee,we,je,null,xe,ve)),$s(n,b,k,!de);return}}N1(n,i,b,c,m,v,k,R,ee)}function fE(n){for(var i=n;;){var c=i.tag;if((c===0||c===11||c===15)&&i.flags&16384&&(c=i.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var m=0;m<c.length;m++){var v=c[m],b=v.getSnapshot;v=v.value;try{if(!Ga(b(),v))return!1}catch{return!1}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function $s(n,i,c,m){i&=~Th,i&=~ji,n.suspendedLanes|=i,n.pingedLanes&=~i,m&&(n.warmLanes|=i),m=n.expirationTimes;for(var v=i;0<v;){var b=31-Vt(v),k=1<<b;m[b]=-1,v&=~k}c!==0&&K(n,c,i)}function Qu(){return($t&6)===0?(Go(0),!1):!0}function Oh(){if(kt!==null){if(Yt===0)var n=kt.return;else n=kt,as=yi=null,Vd(n),gl=null,No=0,n=kt;for(;n!==null;)Yg(n.alternate,n),n=n.return;kt=null}}function Nl(n,i){var c=n.timeoutHandle;c!==-1&&(n.timeoutHandle=-1,CE(c)),c=n.cancelPendingCommit,c!==null&&(n.cancelPendingCommit=null,c()),ms=0,Oh(),lr=n,kt=c=ts(n.current,null),jt=i,Yt=0,Ka=null,Us=!1,El=Ea(n,i),Eh=!1,Tl=Ya=Th=ji=zs=Sr=0,Ba=qo=null,kh=!1,(i&8)!==0&&(i|=i&32);var m=n.entangledLanes;if(m!==0)for(n=n.entanglements,m&=i;0<m;){var v=31-Vt(m),b=1<<v;i|=n[v],m&=~b}return hs=i,yu(),c}function _1(n,i){vt=null,te.H=Mo,i===pl||i===Nu?(i=Ip(),Yt=3):i===Fd?(i=Ip(),Yt=4):Yt=i===oh?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Ka=i,kt===null&&(Sr=1,zu(n,fn(i,n.current)))}function b1(){var n=Xa.current;return n===null?!0:(jt&4194048)===jt?xn===null:(jt&62914560)===jt||(jt&536870912)!==0?n===xn:!1}function w1(){var n=te.H;return te.H=Mo,n===null?Mo:n}function S1(){var n=te.A;return te.A=cE,n}function Zu(){Sr=4,Us||(jt&4194048)!==jt&&Xa.current!==null||(El=!0),(zs&134217727)===0&&(ji&134217727)===0||lr===null||$s(lr,jt,Ya,!1)}function Ch(n,i,c){var m=$t;$t|=2;var v=w1(),b=S1();(lr!==n||jt!==i)&&(Ju=null,Nl(n,i)),i=!1;var k=Sr;e:do try{if(Yt!==0&&kt!==null){var R=kt,ee=Ka;switch(Yt){case 8:Oh(),k=6;break e;case 3:case 2:case 9:case 6:Xa.current===null&&(i=!0);var de=Yt;if(Yt=0,Ka=null,jl(n,R,ee,de),c&&El){k=0;break e}break;default:de=Yt,Yt=0,Ka=null,jl(n,R,ee,de)}}dE(),k=Sr;break}catch(we){_1(n,we)}while(!0);return i&&n.shellSuspendCounter++,as=yi=null,$t=m,te.H=v,te.A=b,kt===null&&(lr=null,jt=0,yu()),k}function dE(){for(;kt!==null;)E1(kt)}function hE(n,i){var c=$t;$t|=2;var m=w1(),v=S1();lr!==n||jt!==i?(Ju=null,Yu=Ke()+500,Nl(n,i)):El=Ea(n,i);e:do try{if(Yt!==0&&kt!==null){i=kt;var b=Ka;t:switch(Yt){case 1:Yt=0,Ka=null,jl(n,i,b,1);break;case 2:case 9:if(Fp(b)){Yt=0,Ka=null,T1(i);break}i=function(){Yt!==2&&Yt!==9||lr!==n||(Yt=7),Vn(n)},b.then(i,i);break e;case 3:Yt=7;break e;case 4:Yt=5;break e;case 7:Fp(b)?(Yt=0,Ka=null,T1(i)):(Yt=0,Ka=null,jl(n,i,b,7));break;case 5:var k=null;switch(kt.tag){case 26:k=kt.memoizedState;case 5:case 27:var R=kt;if(k?uv(k):R.stateNode.complete){Yt=0,Ka=null;var ee=R.sibling;if(ee!==null)kt=ee;else{var de=R.return;de!==null?(kt=de,e0(de)):kt=null}break t}}Yt=0,Ka=null,jl(n,i,b,5);break;case 6:Yt=0,Ka=null,jl(n,i,b,6);break;case 8:Oh(),Sr=6;break e;default:throw Error(a(462))}}mE();break}catch(we){_1(n,we)}while(!0);return as=yi=null,te.H=m,te.A=v,$t=c,kt!==null?0:(lr=null,jt=0,yu(),Sr)}function mE(){for(;kt!==null&&!Ve();)E1(kt)}function E1(n){var i=Wg(n.alternate,n,hs);n.memoizedProps=n.pendingProps,i===null?e0(n):kt=i}function T1(n){var i=n,c=i.alternate;switch(i.tag){case 15:case 0:i=Hg(c,i,i.pendingProps,i.type,void 0,jt);break;case 11:i=Hg(c,i,i.pendingProps,i.type.render,i.ref,jt);break;case 5:Vd(i);default:Yg(c,i),i=kt=Sp(i,hs),i=Wg(c,i,hs)}n.memoizedProps=n.pendingProps,i===null?e0(n):kt=i}function jl(n,i,c,m){as=yi=null,Vd(i),gl=null,No=0;var v=i.return;try{if(rE(n,v,i,c,jt)){Sr=1,zu(n,fn(c,n.current)),kt=null;return}}catch(b){if(v!==null)throw kt=v,b;Sr=1,zu(n,fn(c,n.current)),kt=null;return}i.flags&32768?(Ct||m===1?n=!0:El||(jt&536870912)!==0?n=!1:(Us=n=!0,(m===2||m===9||m===3||m===6)&&(m=Xa.current,m!==null&&m.tag===13&&(m.flags|=16384))),k1(i,n)):e0(i)}function e0(n){var i=n;do{if((i.flags&32768)!==0){k1(i,Us);return}n=i.return;var c=sE(i.alternate,i,hs);if(c!==null){kt=c;return}if(i=i.sibling,i!==null){kt=i;return}kt=i=n}while(i!==null);Sr===0&&(Sr=5)}function k1(n,i){do{var c=iE(n.alternate,n);if(c!==null){c.flags&=32767,kt=c;return}if(c=n.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!i&&(n=n.sibling,n!==null)){kt=n;return}kt=n=c}while(n!==null);Sr=6,kt=null}function N1(n,i,c,m,v,b,k,R,ee){n.cancelPendingCommit=null;do t0();while(Vr!==0);if(($t&6)!==0)throw Error(a(327));if(i!==null){if(i===n.current)throw Error(a(177));if(b=i.lanes|i.childLanes,b|=yd,Ca(n,c,b,k,R,ee),n===lr&&(kt=lr=null,jt=0),kl=i,qs=n,ms=c,Nh=b,jh=v,p1=m,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,vE(ir,function(){return R1(),null})):(n.callbackNode=null,n.callbackPriority=0),m=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||m){m=te.T,te.T=null,v=ae.p,ae.p=2,k=$t,$t|=4;try{lE(n,i,c)}finally{$t=k,ae.p=v,te.T=m}}Vr=1,j1(),A1(),O1()}}function j1(){if(Vr===1){Vr=0;var n=qs,i=kl,c=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||c){c=te.T,te.T=null;var m=ae.p;ae.p=2;var v=$t;$t|=4;try{o1(i,n);var b=qh,k=mp(n.containerInfo),R=b.focusedElem,ee=b.selectionRange;if(k!==R&&R&&R.ownerDocument&&hp(R.ownerDocument.documentElement,R)){if(ee!==null&&md(R)){var de=ee.start,we=ee.end;if(we===void 0&&(we=de),"selectionStart"in R)R.selectionStart=de,R.selectionEnd=Math.min(we,R.value.length);else{var je=R.ownerDocument||document,xe=je&&je.defaultView||window;if(xe.getSelection){var ve=xe.getSelection(),We=R.textContent.length,lt=Math.min(ee.start,We),nr=ee.end===void 0?lt:Math.min(ee.end,We);!ve.extend&&lt>nr&&(k=nr,nr=lt,lt=k);var oe=dp(R,lt),se=dp(R,nr);if(oe&&se&&(ve.rangeCount!==1||ve.anchorNode!==oe.node||ve.anchorOffset!==oe.offset||ve.focusNode!==se.node||ve.focusOffset!==se.offset)){var fe=je.createRange();fe.setStart(oe.node,oe.offset),ve.removeAllRanges(),lt>nr?(ve.addRange(fe),ve.extend(se.node,se.offset)):(fe.setEnd(se.node,se.offset),ve.addRange(fe))}}}}for(je=[],ve=R;ve=ve.parentNode;)ve.nodeType===1&&je.push({element:ve,left:ve.scrollLeft,top:ve.scrollTop});for(typeof R.focus=="function"&&R.focus(),R=0;R<je.length;R++){var ke=je[R];ke.element.scrollLeft=ke.left,ke.element.scrollTop=ke.top}}h0=!!Hh,qh=Hh=null}finally{$t=v,ae.p=m,te.T=c}}n.current=i,Vr=2}}function A1(){if(Vr===2){Vr=0;var n=qs,i=kl,c=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||c){c=te.T,te.T=null;var m=ae.p;ae.p=2;var v=$t;$t|=4;try{a1(n,i.alternate,i)}finally{$t=v,ae.p=m,te.T=c}}Vr=3}}function O1(){if(Vr===4||Vr===3){Vr=0,Tt();var n=qs,i=kl,c=ms,m=p1;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Vr=5:(Vr=0,kl=qs=null,C1(n,n.pendingLanes));var v=n.pendingLanes;if(v===0&&(Hs=null),gr(c),i=i.stateNode,Gt&&typeof Gt.onCommitFiberRoot=="function")try{Gt.onCommitFiberRoot(It,i,void 0,(i.current.flags&128)===128)}catch{}if(m!==null){i=te.T,v=ae.p,ae.p=2,te.T=null;try{for(var b=n.onRecoverableError,k=0;k<m.length;k++){var R=m[k];b(R.value,{componentStack:R.stack})}}finally{te.T=i,ae.p=v}}(ms&3)!==0&&t0(),Vn(n),v=n.pendingLanes,(c&261930)!==0&&(v&42)!==0?n===Ah?$o++:($o=0,Ah=n):$o=0,Go(0)}}function C1(n,i){(n.pooledCacheLanes&=i)===0&&(i=n.pooledCache,i!=null&&(n.pooledCache=null,To(i)))}function t0(){return j1(),A1(),O1(),R1()}function R1(){if(Vr!==5)return!1;var n=qs,i=Nh;Nh=0;var c=gr(ms),m=te.T,v=ae.p;try{ae.p=32>c?32:c,te.T=null,c=jh,jh=null;var b=qs,k=ms;if(Vr=0,kl=qs=null,ms=0,($t&6)!==0)throw Error(a(331));var R=$t;if($t|=4,h1(b.current),u1(b,b.current,k,c),$t=R,Go(0,!1),Gt&&typeof Gt.onPostCommitFiberRoot=="function")try{Gt.onPostCommitFiberRoot(It,b)}catch{}return!0}finally{ae.p=v,te.T=m,C1(n,i)}}function D1(n,i,c){i=fn(c,i),i=lh(n.stateNode,i,2),n=Is(n,i,2),n!==null&&($a(n,2),Vn(n))}function Jt(n,i,c){if(n.tag===3)D1(n,n,c);else for(;i!==null;){if(i.tag===3){D1(i,n,c);break}else if(i.tag===1){var m=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Hs===null||!Hs.has(m))){n=fn(c,n),c=Fg(2),m=Is(i,c,2),m!==null&&(Mg(c,m,i,n),$a(m,2),Vn(m));break}}i=i.return}}function Rh(n,i,c){var m=n.pingCache;if(m===null){m=n.pingCache=new uE;var v=new Set;m.set(i,v)}else v=m.get(i),v===void 0&&(v=new Set,m.set(i,v));v.has(c)||(Eh=!0,v.add(c),n=xE.bind(null,n,i,c),i.then(n,n))}function xE(n,i,c){var m=n.pingCache;m!==null&&m.delete(i),n.pingedLanes|=n.suspendedLanes&c,n.warmLanes&=~c,lr===n&&(jt&c)===c&&(Sr===4||Sr===3&&(jt&62914560)===jt&&300>Ke()-Ku?($t&2)===0&&Nl(n,0):Th|=c,Tl===jt&&(Tl=0)),Vn(n)}function F1(n,i){i===0&&(i=_r()),n=pi(n,i),n!==null&&($a(n,i),Vn(n))}function pE(n){var i=n.memoizedState,c=0;i!==null&&(c=i.retryLane),F1(n,c)}function gE(n,i){var c=0;switch(n.tag){case 31:case 13:var m=n.stateNode,v=n.memoizedState;v!==null&&(c=v.retryLane);break;case 19:m=n.stateNode;break;case 22:m=n.stateNode._retryCache;break;default:throw Error(a(314))}m!==null&&m.delete(i),F1(n,c)}function vE(n,i){return mt(n,i)}var r0=null,Al=null,Dh=!1,a0=!1,Fh=!1,Gs=0;function Vn(n){n!==Al&&n.next===null&&(Al===null?r0=Al=n:Al=Al.next=n),a0=!0,Dh||(Dh=!0,_E())}function Go(n,i){if(!Fh&&a0){Fh=!0;do for(var c=!1,m=r0;m!==null;){if(n!==0){var v=m.pendingLanes;if(v===0)var b=0;else{var k=m.suspendedLanes,R=m.pingedLanes;b=(1<<31-Vt(42|n)+1)-1,b&=v&~(k&~R),b=b&201326741?b&201326741|1:b?b|2:0}b!==0&&(c=!0,B1(m,b))}else b=jt,b=ea(m,m===lr?b:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(b&3)===0||Ea(m,b)||(c=!0,B1(m,b));m=m.next}while(c);Fh=!1}}function yE(){M1()}function M1(){a0=Dh=!1;var n=0;Gs!==0&&OE()&&(n=Gs);for(var i=Ke(),c=null,m=r0;m!==null;){var v=m.next,b=I1(m,i);b===0?(m.next=null,c===null?r0=v:c.next=v,v===null&&(Al=c)):(c=m,(n!==0||(b&3)!==0)&&(a0=!0)),m=v}Vr!==0&&Vr!==5||Go(n),Gs!==0&&(Gs=0)}function I1(n,i){for(var c=n.suspendedLanes,m=n.pingedLanes,v=n.expirationTimes,b=n.pendingLanes&-62914561;0<b;){var k=31-Vt(b),R=1<<k,ee=v[k];ee===-1?((R&c)===0||(R&m)!==0)&&(v[k]=st(R,i)):ee<=i&&(n.expiredLanes|=R),b&=~R}if(i=lr,c=jt,c=ea(n,n===i?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),m=n.callbackNode,c===0||n===i&&(Yt===2||Yt===9)||n.cancelPendingCommit!==null)return m!==null&&m!==null&&Ue(m),n.callbackNode=null,n.callbackPriority=0;if((c&3)===0||Ea(n,c)){if(i=c&-c,i===n.callbackPriority)return i;switch(m!==null&&Ue(m),gr(c)){case 2:case 8:c=ua;break;case 32:c=ir;break;case 268435456:c=nt;break;default:c=ir}return m=L1.bind(null,n),c=mt(c,m),n.callbackPriority=i,n.callbackNode=c,i}return m!==null&&m!==null&&Ue(m),n.callbackPriority=2,n.callbackNode=null,2}function L1(n,i){if(Vr!==0&&Vr!==5)return n.callbackNode=null,n.callbackPriority=0,null;var c=n.callbackNode;if(t0()&&n.callbackNode!==c)return null;var m=jt;return m=ea(n,n===lr?m:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),m===0?null:(v1(n,m,i),I1(n,Ke()),n.callbackNode!=null&&n.callbackNode===c?L1.bind(null,n):null)}function B1(n,i){if(t0())return null;v1(n,i,!0)}function _E(){RE(function(){($t&6)!==0?mt(zt,yE):M1()})}function Mh(){if(Gs===0){var n=ml;n===0&&(n=qa,qa<<=1,(qa&261888)===0&&(qa=256)),Gs=n}return Gs}function P1(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:nl(""+n)}function U1(n,i){var c=i.ownerDocument.createElement("input");return c.name=i.name,c.value=i.value,n.id&&c.setAttribute("form",n.id),i.parentNode.insertBefore(c,i),n=new FormData(n),c.parentNode.removeChild(c),n}function bE(n,i,c,m,v){if(i==="submit"&&c&&c.stateNode===v){var b=P1((v[B]||null).action),k=m.submitter;k&&(i=(i=k[B]||null)?P1(i.formAction):k.getAttribute("formAction"),i!==null&&(b=i,k=null));var R=new xu("action","action",null,m,v);n.push({event:R,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(Gs!==0){var ee=k?U1(v,k):new FormData(v);th(c,{pending:!0,data:ee,method:v.method,action:b},null,ee)}}else typeof b=="function"&&(R.preventDefault(),ee=k?U1(v,k):new FormData(v),th(c,{pending:!0,data:ee,method:v.method,action:b},b,ee))},currentTarget:v}]})}}for(var Ih=0;Ih<vd.length;Ih++){var Lh=vd[Ih],wE=Lh.toLowerCase(),SE=Lh[0].toUpperCase()+Lh.slice(1);An(wE,"on"+SE)}An(gp,"onAnimationEnd"),An(vp,"onAnimationIteration"),An(yp,"onAnimationStart"),An("dblclick","onDoubleClick"),An("focusin","onFocus"),An("focusout","onBlur"),An(PS,"onTransitionRun"),An(US,"onTransitionStart"),An(zS,"onTransitionCancel"),An(_p,"onTransitionEnd"),Ta("onMouseEnter",["mouseout","mouseover"]),Ta("onMouseLeave",["mouseout","mouseover"]),Ta("onPointerEnter",["pointerout","pointerover"]),Ta("onPointerLeave",["pointerout","pointerover"]),Xt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Xt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Xt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Xt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Xt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Xt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),EE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Vo));function z1(n,i){i=(i&4)!==0;for(var c=0;c<n.length;c++){var m=n[c],v=m.event;m=m.listeners;e:{var b=void 0;if(i)for(var k=m.length-1;0<=k;k--){var R=m[k],ee=R.instance,de=R.currentTarget;if(R=R.listener,ee!==b&&v.isPropagationStopped())break e;b=R,v.currentTarget=de;try{b(v)}catch(we){vu(we)}v.currentTarget=null,b=ee}else for(k=0;k<m.length;k++){if(R=m[k],ee=R.instance,de=R.currentTarget,R=R.listener,ee!==b&&v.isPropagationStopped())break e;b=R,v.currentTarget=de;try{b(v)}catch(we){vu(we)}v.currentTarget=null,b=ee}}}}function Nt(n,i){var c=i[ce];c===void 0&&(c=i[ce]=new Set);var m=n+"__bubble";c.has(m)||(H1(i,n,2,!1),c.add(m))}function Bh(n,i,c){var m=0;i&&(m|=4),H1(c,n,m,i)}var n0="_reactListening"+Math.random().toString(36).slice(2);function Ph(n){if(!n[n0]){n[n0]=!0,Ot.forEach(function(c){c!=="selectionchange"&&(EE.has(c)||Bh(c,!1,n),Bh(c,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[n0]||(i[n0]=!0,Bh("selectionchange",!1,i))}}function H1(n,i,c,m){switch(gv(i)){case 2:var v=QE;break;case 8:v=ZE;break;default:v=em}c=v.bind(null,i,c,n),v=void 0,!ma||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(v=!0),m?v!==void 0?n.addEventListener(i,c,{capture:!0,passive:v}):n.addEventListener(i,c,!0):v!==void 0?n.addEventListener(i,c,{passive:v}):n.addEventListener(i,c,!1)}function Uh(n,i,c,m,v){var b=m;if((i&1)===0&&(i&2)===0&&m!==null)e:for(;;){if(m===null)return;var k=m.tag;if(k===3||k===4){var R=m.stateNode.containerInfo;if(R===v)break;if(k===4)for(k=m.return;k!==null;){var ee=k.tag;if((ee===3||ee===4)&&k.stateNode.containerInfo===v)return;k=k.return}for(;R!==null;){if(k=Be(R),k===null)return;if(ee=k.tag,ee===5||ee===6||ee===26||ee===27){m=b=k;continue e}R=R.parentNode}}m=m.return}xr(function(){var de=b,we=pe(c),je=[];e:{var xe=bp.get(n);if(xe!==void 0){var ve=xu,We=n;switch(n){case"keypress":if(hu(c)===0)break e;case"keydown":case"keyup":ve=gS;break;case"focusin":We="focus",ve=cd;break;case"focusout":We="blur",ve=cd;break;case"beforeblur":case"afterblur":ve=cd;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ve=Yx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ve=sS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ve=_S;break;case gp:case vp:case yp:ve=oS;break;case _p:ve=wS;break;case"scroll":case"scrollend":ve=aS;break;case"wheel":ve=ES;break;case"copy":case"cut":case"paste":ve=uS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ve=Qx;break;case"toggle":case"beforetoggle":ve=kS}var lt=(i&4)!==0,nr=!lt&&(n==="scroll"||n==="scrollend"),oe=lt?xe!==null?xe+"Capture":null:xe;lt=[];for(var se=de,fe;se!==null;){var ke=se;if(fe=ke.stateNode,ke=ke.tag,ke!==5&&ke!==26&&ke!==27||fe===null||oe===null||(ke=Dt(se,oe),ke!=null&&lt.push(Xo(se,ke,fe))),nr)break;se=se.return}0<lt.length&&(xe=new ve(xe,We,null,c,we),je.push({event:xe,listeners:lt}))}}if((i&7)===0){e:{if(xe=n==="mouseover"||n==="pointerover",ve=n==="mouseout"||n==="pointerout",xe&&c!==Y&&(We=c.relatedTarget||c.fromElement)&&(Be(We)||We[X]))break e;if((ve||xe)&&(xe=we.window===we?we:(xe=we.ownerDocument)?xe.defaultView||xe.parentWindow:window,ve?(We=c.relatedTarget||c.toElement,ve=de,We=We?Be(We):null,We!==null&&(nr=l(We),lt=We.tag,We!==nr||lt!==5&&lt!==27&&lt!==6)&&(We=null)):(ve=null,We=de),ve!==We)){if(lt=Yx,ke="onMouseLeave",oe="onMouseEnter",se="mouse",(n==="pointerout"||n==="pointerover")&&(lt=Qx,ke="onPointerLeave",oe="onPointerEnter",se="pointer"),nr=ve==null?xe:Le(ve),fe=We==null?xe:Le(We),xe=new lt(ke,se+"leave",ve,c,we),xe.target=nr,xe.relatedTarget=fe,ke=null,Be(we)===de&&(lt=new lt(oe,se+"enter",We,c,we),lt.target=fe,lt.relatedTarget=nr,ke=lt),nr=ke,ve&&We)t:{for(lt=TE,oe=ve,se=We,fe=0,ke=oe;ke;ke=lt(ke))fe++;ke=0;for(var rt=se;rt;rt=lt(rt))ke++;for(;0<fe-ke;)oe=lt(oe),fe--;for(;0<ke-fe;)se=lt(se),ke--;for(;fe--;){if(oe===se||se!==null&&oe===se.alternate){lt=oe;break t}oe=lt(oe),se=lt(se)}lt=null}else lt=null;ve!==null&&q1(je,xe,ve,lt,!1),We!==null&&nr!==null&&q1(je,nr,We,lt,!0)}}e:{if(xe=de?Le(de):window,ve=xe.nodeName&&xe.nodeName.toLowerCase(),ve==="select"||ve==="input"&&xe.type==="file")var Bt=ip;else if(np(xe))if(lp)Bt=IS;else{Bt=FS;var Je=DS}else ve=xe.nodeName,!ve||ve.toLowerCase()!=="input"||xe.type!=="checkbox"&&xe.type!=="radio"?de&&xo(de.elementType)&&(Bt=ip):Bt=MS;if(Bt&&(Bt=Bt(n,de))){sp(je,Bt,c,we);break e}Je&&Je(n,xe,de),n==="focusout"&&de&&xe.type==="number"&&de.memoizedProps.value!=null&&mo(xe,"number",xe.value)}switch(Je=de?Le(de):window,n){case"focusin":(np(Je)||Je.contentEditable==="true")&&(il=Je,xd=de,wo=null);break;case"focusout":wo=xd=il=null;break;case"mousedown":pd=!0;break;case"contextmenu":case"mouseup":case"dragend":pd=!1,xp(je,c,we);break;case"selectionchange":if(BS)break;case"keydown":case"keyup":xp(je,c,we)}var _t;if(fd)e:{switch(n){case"compositionstart":var At="onCompositionStart";break e;case"compositionend":At="onCompositionEnd";break e;case"compositionupdate":At="onCompositionUpdate";break e}At=void 0}else sl?rp(n,c)&&(At="onCompositionEnd"):n==="keydown"&&c.keyCode===229&&(At="onCompositionStart");At&&(Zx&&c.locale!=="ko"&&(sl||At!=="onCompositionStart"?At==="onCompositionEnd"&&sl&&(_t=Wx()):(Kt=we,br="value"in Kt?Kt.value:Kt.textContent,sl=!0)),Je=s0(de,At),0<Je.length&&(At=new Jx(At,n,null,c,we),je.push({event:At,listeners:Je}),_t?At.data=_t:(_t=ap(c),_t!==null&&(At.data=_t)))),(_t=jS?AS(n,c):OS(n,c))&&(At=s0(de,"onBeforeInput"),0<At.length&&(Je=new Jx("onBeforeInput","beforeinput",null,c,we),je.push({event:Je,listeners:At}),Je.data=_t)),bE(je,n,de,c,we)}z1(je,i)})}function Xo(n,i,c){return{instance:n,listener:i,currentTarget:c}}function s0(n,i){for(var c=i+"Capture",m=[];n!==null;){var v=n,b=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||b===null||(v=Dt(n,c),v!=null&&m.unshift(Xo(n,v,b)),v=Dt(n,i),v!=null&&m.push(Xo(n,v,b))),n.tag===3)return m;n=n.return}return[]}function TE(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function q1(n,i,c,m,v){for(var b=i._reactName,k=[];c!==null&&c!==m;){var R=c,ee=R.alternate,de=R.stateNode;if(R=R.tag,ee!==null&&ee===m)break;R!==5&&R!==26&&R!==27||de===null||(ee=de,v?(de=Dt(c,b),de!=null&&k.unshift(Xo(c,de,ee))):v||(de=Dt(c,b),de!=null&&k.push(Xo(c,de,ee)))),c=c.return}k.length!==0&&n.push({event:i,listeners:k})}var kE=/\r\n?/g,NE=/\u0000|\uFFFD/g;function $1(n){return(typeof n=="string"?n:""+n).replace(kE,`
`).replace(NE,"")}function G1(n,i){return i=$1(i),$1(n)===i}function ar(n,i,c,m,v,b){switch(c){case"children":typeof m=="string"?i==="body"||i==="textarea"&&m===""||As(n,m):(typeof m=="number"||typeof m=="bigint")&&i!=="body"&&As(n,""+m);break;case"className":tl(n,"class",m);break;case"tabIndex":tl(n,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":tl(n,c,m);break;case"style":uu(n,m,b);break;case"data":if(i!=="object"){tl(n,"data",m);break}case"src":case"href":if(m===""&&(i!=="a"||c!=="href")){n.removeAttribute(c);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){n.removeAttribute(c);break}m=nl(""+m),n.setAttribute(c,m);break;case"action":case"formAction":if(typeof m=="function"){n.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(c==="formAction"?(i!=="input"&&ar(n,i,"name",v.name,v,null),ar(n,i,"formEncType",v.formEncType,v,null),ar(n,i,"formMethod",v.formMethod,v,null),ar(n,i,"formTarget",v.formTarget,v,null)):(ar(n,i,"encType",v.encType,v,null),ar(n,i,"method",v.method,v,null),ar(n,i,"target",v.target,v,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){n.removeAttribute(c);break}m=nl(""+m),n.setAttribute(c,m);break;case"onClick":m!=null&&(n.onclick=jn);break;case"onScroll":m!=null&&Nt("scroll",n);break;case"onScrollEnd":m!=null&&Nt("scrollend",n);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(a(61));if(c=m.__html,c!=null){if(v.children!=null)throw Error(a(60));n.innerHTML=c}}break;case"multiple":n.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":n.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){n.removeAttribute("xlink:href");break}c=nl(""+m),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?n.setAttribute(c,""+m):n.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?n.setAttribute(c,""):n.removeAttribute(c);break;case"capture":case"download":m===!0?n.setAttribute(c,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?n.setAttribute(c,m):n.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?n.setAttribute(c,m):n.removeAttribute(c);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?n.removeAttribute(c):n.setAttribute(c,m);break;case"popover":Nt("beforetoggle",n),Nt("toggle",n),da(n,"popover",m);break;case"xlinkActuate":ha(n,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":ha(n,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":ha(n,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":ha(n,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":ha(n,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":ha(n,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":ha(n,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":ha(n,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":ha(n,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":da(n,"is",m);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=id.get(c)||c,da(n,c,m))}}function zh(n,i,c,m,v,b){switch(c){case"style":uu(n,m,b);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(a(61));if(c=m.__html,c!=null){if(v.children!=null)throw Error(a(60));n.innerHTML=c}}break;case"children":typeof m=="string"?As(n,m):(typeof m=="number"||typeof m=="bigint")&&As(n,""+m);break;case"onScroll":m!=null&&Nt("scroll",n);break;case"onScrollEnd":m!=null&&Nt("scrollend",n);break;case"onClick":m!=null&&(n.onclick=jn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Lt.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(v=c.endsWith("Capture"),i=c.slice(2,v?c.length-7:void 0),b=n[B]||null,b=b!=null?b[c]:null,typeof b=="function"&&n.removeEventListener(i,b,v),typeof m=="function")){typeof b!="function"&&b!==null&&(c in n?n[c]=null:n.hasAttribute(c)&&n.removeAttribute(c)),n.addEventListener(i,m,v);break e}c in n?n[c]=m:m===!0?n.setAttribute(c,""):da(n,c,m)}}}function na(n,i,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Nt("error",n),Nt("load",n);var m=!1,v=!1,b;for(b in c)if(c.hasOwnProperty(b)){var k=c[b];if(k!=null)switch(b){case"src":m=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:ar(n,i,b,k,c,null)}}v&&ar(n,i,"srcSet",c.srcSet,c,null),m&&ar(n,i,"src",c.src,c,null);return;case"input":Nt("invalid",n);var R=b=k=v=null,ee=null,de=null;for(m in c)if(c.hasOwnProperty(m)){var we=c[m];if(we!=null)switch(m){case"name":v=we;break;case"type":k=we;break;case"checked":ee=we;break;case"defaultChecked":de=we;break;case"value":b=we;break;case"defaultValue":R=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(a(137,i));break;default:ar(n,i,m,we,c,null)}}al(n,b,R,ee,de,k,v,!1);return;case"select":Nt("invalid",n),m=k=b=null;for(v in c)if(c.hasOwnProperty(v)&&(R=c[v],R!=null))switch(v){case"value":b=R;break;case"defaultValue":k=R;break;case"multiple":m=R;default:ar(n,i,v,R,c,null)}i=b,c=k,n.multiple=!!m,i!=null?js(n,!!m,i,!1):c!=null&&js(n,!!m,c,!0);return;case"textarea":Nt("invalid",n),b=v=m=null;for(k in c)if(c.hasOwnProperty(k)&&(R=c[k],R!=null))switch(k){case"value":m=R;break;case"defaultValue":v=R;break;case"children":b=R;break;case"dangerouslySetInnerHTML":if(R!=null)throw Error(a(91));break;default:ar(n,i,k,R,c,null)}ou(n,m,v,b);return;case"option":for(ee in c)if(c.hasOwnProperty(ee)&&(m=c[ee],m!=null))switch(ee){case"selected":n.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:ar(n,i,ee,m,c,null)}return;case"dialog":Nt("beforetoggle",n),Nt("toggle",n),Nt("cancel",n),Nt("close",n);break;case"iframe":case"object":Nt("load",n);break;case"video":case"audio":for(m=0;m<Vo.length;m++)Nt(Vo[m],n);break;case"image":Nt("error",n),Nt("load",n);break;case"details":Nt("toggle",n);break;case"embed":case"source":case"link":Nt("error",n),Nt("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(de in c)if(c.hasOwnProperty(de)&&(m=c[de],m!=null))switch(de){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:ar(n,i,de,m,c,null)}return;default:if(xo(i)){for(we in c)c.hasOwnProperty(we)&&(m=c[we],m!==void 0&&zh(n,i,we,m,c,void 0));return}}for(R in c)c.hasOwnProperty(R)&&(m=c[R],m!=null&&ar(n,i,R,m,c,null))}function jE(n,i,c,m){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,b=null,k=null,R=null,ee=null,de=null,we=null;for(ve in c){var je=c[ve];if(c.hasOwnProperty(ve)&&je!=null)switch(ve){case"checked":break;case"value":break;case"defaultValue":ee=je;default:m.hasOwnProperty(ve)||ar(n,i,ve,null,m,je)}}for(var xe in m){var ve=m[xe];if(je=c[xe],m.hasOwnProperty(xe)&&(ve!=null||je!=null))switch(xe){case"type":b=ve;break;case"name":v=ve;break;case"checked":de=ve;break;case"defaultChecked":we=ve;break;case"value":k=ve;break;case"defaultValue":R=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(a(137,i));break;default:ve!==je&&ar(n,i,xe,ve,m,je)}}di(n,k,R,ee,de,we,b,v);return;case"select":ve=k=R=xe=null;for(b in c)if(ee=c[b],c.hasOwnProperty(b)&&ee!=null)switch(b){case"value":break;case"multiple":ve=ee;default:m.hasOwnProperty(b)||ar(n,i,b,null,m,ee)}for(v in m)if(b=m[v],ee=c[v],m.hasOwnProperty(v)&&(b!=null||ee!=null))switch(v){case"value":xe=b;break;case"defaultValue":R=b;break;case"multiple":k=b;default:b!==ee&&ar(n,i,v,b,m,ee)}i=R,c=k,m=ve,xe!=null?js(n,!!c,xe,!1):!!m!=!!c&&(i!=null?js(n,!!c,i,!0):js(n,!!c,c?[]:"",!1));return;case"textarea":ve=xe=null;for(R in c)if(v=c[R],c.hasOwnProperty(R)&&v!=null&&!m.hasOwnProperty(R))switch(R){case"value":break;case"children":break;default:ar(n,i,R,null,m,v)}for(k in m)if(v=m[k],b=c[k],m.hasOwnProperty(k)&&(v!=null||b!=null))switch(k){case"value":xe=v;break;case"defaultValue":ve=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(a(91));break;default:v!==b&&ar(n,i,k,v,m,b)}lu(n,xe,ve);return;case"option":for(var We in c)if(xe=c[We],c.hasOwnProperty(We)&&xe!=null&&!m.hasOwnProperty(We))switch(We){case"selected":n.selected=!1;break;default:ar(n,i,We,null,m,xe)}for(ee in m)if(xe=m[ee],ve=c[ee],m.hasOwnProperty(ee)&&xe!==ve&&(xe!=null||ve!=null))switch(ee){case"selected":n.selected=xe&&typeof xe!="function"&&typeof xe!="symbol";break;default:ar(n,i,ee,xe,m,ve)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var lt in c)xe=c[lt],c.hasOwnProperty(lt)&&xe!=null&&!m.hasOwnProperty(lt)&&ar(n,i,lt,null,m,xe);for(de in m)if(xe=m[de],ve=c[de],m.hasOwnProperty(de)&&xe!==ve&&(xe!=null||ve!=null))switch(de){case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(a(137,i));break;default:ar(n,i,de,xe,m,ve)}return;default:if(xo(i)){for(var nr in c)xe=c[nr],c.hasOwnProperty(nr)&&xe!==void 0&&!m.hasOwnProperty(nr)&&zh(n,i,nr,void 0,m,xe);for(we in m)xe=m[we],ve=c[we],!m.hasOwnProperty(we)||xe===ve||xe===void 0&&ve===void 0||zh(n,i,we,xe,m,ve);return}}for(var oe in c)xe=c[oe],c.hasOwnProperty(oe)&&xe!=null&&!m.hasOwnProperty(oe)&&ar(n,i,oe,null,m,xe);for(je in m)xe=m[je],ve=c[je],!m.hasOwnProperty(je)||xe===ve||xe==null&&ve==null||ar(n,i,je,xe,m,ve)}function V1(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function AE(){if(typeof performance.getEntriesByType=="function"){for(var n=0,i=0,c=performance.getEntriesByType("resource"),m=0;m<c.length;m++){var v=c[m],b=v.transferSize,k=v.initiatorType,R=v.duration;if(b&&R&&V1(k)){for(k=0,R=v.responseEnd,m+=1;m<c.length;m++){var ee=c[m],de=ee.startTime;if(de>R)break;var we=ee.transferSize,je=ee.initiatorType;we&&V1(je)&&(ee=ee.responseEnd,k+=we*(ee<R?1:(R-de)/(ee-de)))}if(--m,i+=8*(b+k)/(v.duration/1e3),n++,10<n)break}}if(0<n)return i/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Hh=null,qh=null;function i0(n){return n.nodeType===9?n:n.ownerDocument}function X1(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function W1(n,i){if(n===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&i==="foreignObject"?0:n}function $h(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Gh=null;function OE(){var n=window.event;return n&&n.type==="popstate"?n===Gh?!1:(Gh=n,!0):(Gh=null,!1)}var K1=typeof setTimeout=="function"?setTimeout:void 0,CE=typeof clearTimeout=="function"?clearTimeout:void 0,Y1=typeof Promise=="function"?Promise:void 0,RE=typeof queueMicrotask=="function"?queueMicrotask:typeof Y1<"u"?function(n){return Y1.resolve(null).then(n).catch(DE)}:K1;function DE(n){setTimeout(function(){throw n})}function Vs(n){return n==="head"}function J1(n,i){var c=i,m=0;do{var v=c.nextSibling;if(n.removeChild(c),v&&v.nodeType===8)if(c=v.data,c==="/$"||c==="/&"){if(m===0){n.removeChild(v),Dl(i);return}m--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")m++;else if(c==="html")Wo(n.ownerDocument.documentElement);else if(c==="head"){c=n.ownerDocument.head,Wo(c);for(var b=c.firstChild;b;){var k=b.nextSibling,R=b.nodeName;b[me]||R==="SCRIPT"||R==="STYLE"||R==="LINK"&&b.rel.toLowerCase()==="stylesheet"||c.removeChild(b),b=k}}else c==="body"&&Wo(n.ownerDocument.body);c=v}while(c);Dl(i)}function Q1(n,i){var c=n;n=0;do{var m=c.nextSibling;if(c.nodeType===1?i?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(i?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),m&&m.nodeType===8)if(c=m.data,c==="/$"){if(n===0)break;n--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||n++;c=m}while(c)}function Vh(n){var i=n.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var c=i;switch(i=i.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Vh(c),Fe(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}n.removeChild(c)}}function FE(n,i,c,m){for(;n.nodeType===1;){var v=c;if(n.nodeName.toLowerCase()!==i.toLowerCase()){if(!m&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(m){if(!n[me])switch(i){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(b=n.getAttribute("rel"),b==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(b!==v.rel||n.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||n.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||n.getAttribute("title")!==(v.title==null?null:v.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(b=n.getAttribute("src"),(b!==(v.src==null?null:v.src)||n.getAttribute("type")!==(v.type==null?null:v.type)||n.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&b&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(i==="input"&&n.type==="hidden"){var b=v.name==null?null:""+v.name;if(v.type==="hidden"&&n.getAttribute("name")===b)return n}else return n;if(n=pn(n.nextSibling),n===null)break}return null}function ME(n,i,c){if(i==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!c||(n=pn(n.nextSibling),n===null))return null;return n}function Z1(n,i){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!i||(n=pn(n.nextSibling),n===null))return null;return n}function Xh(n){return n.data==="$?"||n.data==="$~"}function Wh(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function IE(n,i){var c=n.ownerDocument;if(n.data==="$~")n._reactRetry=i;else if(n.data!=="$?"||c.readyState!=="loading")i();else{var m=function(){i(),c.removeEventListener("DOMContentLoaded",m)};c.addEventListener("DOMContentLoaded",m),n._reactRetry=m}}function pn(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return n}var Kh=null;function ev(n){n=n.nextSibling;for(var i=0;n;){if(n.nodeType===8){var c=n.data;if(c==="/$"||c==="/&"){if(i===0)return pn(n.nextSibling);i--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||i++}n=n.nextSibling}return null}function tv(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var c=n.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(i===0)return n;i--}else c!=="/$"&&c!=="/&"||i++}n=n.previousSibling}return null}function rv(n,i,c){switch(i=i0(c),n){case"html":if(n=i.documentElement,!n)throw Error(a(452));return n;case"head":if(n=i.head,!n)throw Error(a(453));return n;case"body":if(n=i.body,!n)throw Error(a(454));return n;default:throw Error(a(451))}}function Wo(n){for(var i=n.attributes;i.length;)n.removeAttributeNode(i[0]);Fe(n)}var gn=new Map,av=new Set;function l0(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var xs=ae.d;ae.d={f:LE,r:BE,D:PE,C:UE,L:zE,m:HE,X:$E,S:qE,M:GE};function LE(){var n=xs.f(),i=Qu();return n||i}function BE(n){var i=qe(n);i!==null&&i.tag===5&&i.type==="form"?_g(i):xs.r(n)}var Ol=typeof document>"u"?null:document;function nv(n,i,c){var m=Ol;if(m&&typeof i=="string"&&i){var v=Da(i);v='link[rel="'+n+'"][href="'+v+'"]',typeof c=="string"&&(v+='[crossorigin="'+c+'"]'),av.has(v)||(av.add(v),n={rel:n,crossOrigin:c,href:i},m.querySelector(v)===null&&(i=m.createElement("link"),na(i,"link",n),Ye(i),m.head.appendChild(i)))}}function PE(n){xs.D(n),nv("dns-prefetch",n,null)}function UE(n,i){xs.C(n,i),nv("preconnect",n,i)}function zE(n,i,c){xs.L(n,i,c);var m=Ol;if(m&&n&&i){var v='link[rel="preload"][as="'+Da(i)+'"]';i==="image"&&c&&c.imageSrcSet?(v+='[imagesrcset="'+Da(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(v+='[imagesizes="'+Da(c.imageSizes)+'"]')):v+='[href="'+Da(n)+'"]';var b=v;switch(i){case"style":b=Cl(n);break;case"script":b=Rl(n)}gn.has(b)||(n=g({rel:"preload",href:i==="image"&&c&&c.imageSrcSet?void 0:n,as:i},c),gn.set(b,n),m.querySelector(v)!==null||i==="style"&&m.querySelector(Ko(b))||i==="script"&&m.querySelector(Yo(b))||(i=m.createElement("link"),na(i,"link",n),Ye(i),m.head.appendChild(i)))}}function HE(n,i){xs.m(n,i);var c=Ol;if(c&&n){var m=i&&typeof i.as=="string"?i.as:"script",v='link[rel="modulepreload"][as="'+Da(m)+'"][href="'+Da(n)+'"]',b=v;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=Rl(n)}if(!gn.has(b)&&(n=g({rel:"modulepreload",href:n},i),gn.set(b,n),c.querySelector(v)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Yo(b)))return}m=c.createElement("link"),na(m,"link",n),Ye(m),c.head.appendChild(m)}}}function qE(n,i,c){xs.S(n,i,c);var m=Ol;if(m&&n){var v=$e(m).hoistableStyles,b=Cl(n);i=i||"default";var k=v.get(b);if(!k){var R={loading:0,preload:null};if(k=m.querySelector(Ko(b)))R.loading=5;else{n=g({rel:"stylesheet",href:n,"data-precedence":i},c),(c=gn.get(b))&&Yh(n,c);var ee=k=m.createElement("link");Ye(ee),na(ee,"link",n),ee._p=new Promise(function(de,we){ee.onload=de,ee.onerror=we}),ee.addEventListener("load",function(){R.loading|=1}),ee.addEventListener("error",function(){R.loading|=2}),R.loading|=4,o0(k,i,m)}k={type:"stylesheet",instance:k,count:1,state:R},v.set(b,k)}}}function $E(n,i){xs.X(n,i);var c=Ol;if(c&&n){var m=$e(c).hoistableScripts,v=Rl(n),b=m.get(v);b||(b=c.querySelector(Yo(v)),b||(n=g({src:n,async:!0},i),(i=gn.get(v))&&Jh(n,i),b=c.createElement("script"),Ye(b),na(b,"link",n),c.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},m.set(v,b))}}function GE(n,i){xs.M(n,i);var c=Ol;if(c&&n){var m=$e(c).hoistableScripts,v=Rl(n),b=m.get(v);b||(b=c.querySelector(Yo(v)),b||(n=g({src:n,async:!0,type:"module"},i),(i=gn.get(v))&&Jh(n,i),b=c.createElement("script"),Ye(b),na(b,"link",n),c.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},m.set(v,b))}}function sv(n,i,c,m){var v=(v=Q.current)?l0(v):null;if(!v)throw Error(a(446));switch(n){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(i=Cl(c.href),c=$e(v).hoistableStyles,m=c.get(i),m||(m={type:"style",instance:null,count:0,state:null},c.set(i,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){n=Cl(c.href);var b=$e(v).hoistableStyles,k=b.get(n);if(k||(v=v.ownerDocument||v,k={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(n,k),(b=v.querySelector(Ko(n)))&&!b._p&&(k.instance=b,k.state.loading=5),gn.has(n)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},gn.set(n,c),b||VE(v,n,c,k.state))),i&&m===null)throw Error(a(528,""));return k}if(i&&m!==null)throw Error(a(529,""));return null;case"script":return i=c.async,c=c.src,typeof c=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Rl(c),c=$e(v).hoistableScripts,m=c.get(i),m||(m={type:"script",instance:null,count:0,state:null},c.set(i,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,n))}}function Cl(n){return'href="'+Da(n)+'"'}function Ko(n){return'link[rel="stylesheet"]['+n+"]"}function iv(n){return g({},n,{"data-precedence":n.precedence,precedence:null})}function VE(n,i,c,m){n.querySelector('link[rel="preload"][as="style"]['+i+"]")?m.loading=1:(i=n.createElement("link"),m.preload=i,i.addEventListener("load",function(){return m.loading|=1}),i.addEventListener("error",function(){return m.loading|=2}),na(i,"link",c),Ye(i),n.head.appendChild(i))}function Rl(n){return'[src="'+Da(n)+'"]'}function Yo(n){return"script[async]"+n}function lv(n,i,c){if(i.count++,i.instance===null)switch(i.type){case"style":var m=n.querySelector('style[data-href~="'+Da(c.href)+'"]');if(m)return i.instance=m,Ye(m),m;var v=g({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return m=(n.ownerDocument||n).createElement("style"),Ye(m),na(m,"style",v),o0(m,c.precedence,n),i.instance=m;case"stylesheet":v=Cl(c.href);var b=n.querySelector(Ko(v));if(b)return i.state.loading|=4,i.instance=b,Ye(b),b;m=iv(c),(v=gn.get(v))&&Yh(m,v),b=(n.ownerDocument||n).createElement("link"),Ye(b);var k=b;return k._p=new Promise(function(R,ee){k.onload=R,k.onerror=ee}),na(b,"link",m),i.state.loading|=4,o0(b,c.precedence,n),i.instance=b;case"script":return b=Rl(c.src),(v=n.querySelector(Yo(b)))?(i.instance=v,Ye(v),v):(m=c,(v=gn.get(b))&&(m=g({},c),Jh(m,v)),n=n.ownerDocument||n,v=n.createElement("script"),Ye(v),na(v,"link",m),n.head.appendChild(v),i.instance=v);case"void":return null;default:throw Error(a(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(m=i.instance,i.state.loading|=4,o0(m,c.precedence,n));return i.instance}function o0(n,i,c){for(var m=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=m.length?m[m.length-1]:null,b=v,k=0;k<m.length;k++){var R=m[k];if(R.dataset.precedence===i)b=R;else if(b!==v)break}b?b.parentNode.insertBefore(n,b.nextSibling):(i=c.nodeType===9?c.head:c,i.insertBefore(n,i.firstChild))}function Yh(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.title==null&&(n.title=i.title)}function Jh(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.integrity==null&&(n.integrity=i.integrity)}var c0=null;function ov(n,i,c){if(c0===null){var m=new Map,v=c0=new Map;v.set(c,m)}else v=c0,m=v.get(c),m||(m=new Map,v.set(c,m));if(m.has(n))return m;for(m.set(n,null),c=c.getElementsByTagName(n),v=0;v<c.length;v++){var b=c[v];if(!(b[me]||b[L]||n==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var k=b.getAttribute(i)||"";k=n+k;var R=m.get(k);R?R.push(b):m.set(k,[b])}}return m}function cv(n,i,c){n=n.ownerDocument||n,n.head.insertBefore(c,i==="title"?n.querySelector("head > title"):null)}function XE(n,i,c){if(c===1||i.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return n=i.disabled,typeof i.precedence=="string"&&n==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function uv(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function WE(n,i,c,m){if(c.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var v=Cl(m.href),b=i.querySelector(Ko(v));if(b){i=b._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(n.count++,n=u0.bind(n),i.then(n,n)),c.state.loading|=4,c.instance=b,Ye(b);return}b=i.ownerDocument||i,m=iv(m),(v=gn.get(v))&&Yh(m,v),b=b.createElement("link"),Ye(b);var k=b;k._p=new Promise(function(R,ee){k.onload=R,k.onerror=ee}),na(b,"link",m),c.instance=b}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(c,i),(i=c.state.preload)&&(c.state.loading&3)===0&&(n.count++,c=u0.bind(n),i.addEventListener("load",c),i.addEventListener("error",c))}}var Qh=0;function KE(n,i){return n.stylesheets&&n.count===0&&d0(n,n.stylesheets),0<n.count||0<n.imgCount?function(c){var m=setTimeout(function(){if(n.stylesheets&&d0(n,n.stylesheets),n.unsuspend){var b=n.unsuspend;n.unsuspend=null,b()}},6e4+i);0<n.imgBytes&&Qh===0&&(Qh=62500*AE());var v=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&d0(n,n.stylesheets),n.unsuspend)){var b=n.unsuspend;n.unsuspend=null,b()}},(n.imgBytes>Qh?50:800)+i);return n.unsuspend=c,function(){n.unsuspend=null,clearTimeout(m),clearTimeout(v)}}:null}function u0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)d0(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var f0=null;function d0(n,i){n.stylesheets=null,n.unsuspend!==null&&(n.count++,f0=new Map,i.forEach(YE,n),f0=null,u0.call(n))}function YE(n,i){if(!(i.state.loading&4)){var c=f0.get(n);if(c)var m=c.get(null);else{c=new Map,f0.set(n,c);for(var v=n.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<v.length;b++){var k=v[b];(k.nodeName==="LINK"||k.getAttribute("media")!=="not all")&&(c.set(k.dataset.precedence,k),m=k)}m&&c.set(null,m)}v=i.instance,k=v.getAttribute("data-precedence"),b=c.get(k)||m,b===m&&c.set(null,v),c.set(k,v),this.count++,m=u0.bind(this),v.addEventListener("load",m),v.addEventListener("error",m),b?b.parentNode.insertBefore(v,b.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(v,n.firstChild)),i.state.loading|=4}}var Jo={$$typeof:E,Provider:null,Consumer:null,_currentValue:De,_currentValue2:De,_threadCount:0};function JE(n,i,c,m,v,b,k,R,ee){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=tr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tr(0),this.hiddenUpdates=tr(null),this.identifierPrefix=m,this.onUncaughtError=v,this.onCaughtError=b,this.onRecoverableError=k,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ee,this.incompleteTransitions=new Map}function fv(n,i,c,m,v,b,k,R,ee,de,we,je){return n=new JE(n,i,c,k,ee,de,we,je,R),i=1,b===!0&&(i|=24),b=Va(3,null,null,i),n.current=b,b.stateNode=n,i=Cd(),i.refCount++,n.pooledCache=i,i.refCount++,b.memoizedState={element:m,isDehydrated:c,cache:i},Md(b),n}function dv(n){return n?(n=cl,n):cl}function hv(n,i,c,m,v,b){v=dv(v),m.context===null?m.context=v:m.pendingContext=v,m=Ms(i),m.payload={element:c},b=b===void 0?null:b,b!==null&&(m.callback=b),c=Is(n,m,i),c!==null&&(Pa(c,n,i),Ao(c,n,i))}function mv(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var c=n.retryLane;n.retryLane=c!==0&&c<i?c:i}}function Zh(n,i){mv(n,i),(n=n.alternate)&&mv(n,i)}function xv(n){if(n.tag===13||n.tag===31){var i=pi(n,67108864);i!==null&&Pa(i,n,67108864),Zh(n,67108864)}}function pv(n){if(n.tag===13||n.tag===31){var i=Ja();i=qt(i);var c=pi(n,i);c!==null&&Pa(c,n,i),Zh(n,i)}}var h0=!0;function QE(n,i,c,m){var v=te.T;te.T=null;var b=ae.p;try{ae.p=2,em(n,i,c,m)}finally{ae.p=b,te.T=v}}function ZE(n,i,c,m){var v=te.T;te.T=null;var b=ae.p;try{ae.p=8,em(n,i,c,m)}finally{ae.p=b,te.T=v}}function em(n,i,c,m){if(h0){var v=tm(m);if(v===null)Uh(n,i,m,m0,c),vv(n,m);else if(tT(v,n,i,c,m))m.stopPropagation();else if(vv(n,m),i&4&&-1<eT.indexOf(n)){for(;v!==null;){var b=qe(v);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var k=fa(b.pendingLanes);if(k!==0){var R=b;for(R.pendingLanes|=2,R.entangledLanes|=2;k;){var ee=1<<31-Vt(k);R.entanglements[1]|=ee,k&=~ee}Vn(b),($t&6)===0&&(Yu=Ke()+500,Go(0))}}break;case 31:case 13:R=pi(b,2),R!==null&&Pa(R,b,2),Qu(),Zh(b,2)}if(b=tm(m),b===null&&Uh(n,i,m,m0,c),b===v)break;v=b}v!==null&&m.stopPropagation()}else Uh(n,i,m,null,c)}}function tm(n){return n=pe(n),rm(n)}var m0=null;function rm(n){if(m0=null,n=Be(n),n!==null){var i=l(n);if(i===null)n=null;else{var c=i.tag;if(c===13){if(n=o(i),n!==null)return n;n=null}else if(c===31){if(n=u(i),n!==null)return n;n=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}return m0=n,null}function gv(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Rt()){case zt:return 2;case ua:return 8;case ir:case or:return 32;case nt:return 268435456;default:return 32}default:return 32}}var am=!1,Xs=null,Ws=null,Ks=null,Qo=new Map,Zo=new Map,Ys=[],eT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function vv(n,i){switch(n){case"focusin":case"focusout":Xs=null;break;case"dragenter":case"dragleave":Ws=null;break;case"mouseover":case"mouseout":Ks=null;break;case"pointerover":case"pointerout":Qo.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zo.delete(i.pointerId)}}function ec(n,i,c,m,v,b){return n===null||n.nativeEvent!==b?(n={blockedOn:i,domEventName:c,eventSystemFlags:m,nativeEvent:b,targetContainers:[v]},i!==null&&(i=qe(i),i!==null&&xv(i)),n):(n.eventSystemFlags|=m,i=n.targetContainers,v!==null&&i.indexOf(v)===-1&&i.push(v),n)}function tT(n,i,c,m,v){switch(i){case"focusin":return Xs=ec(Xs,n,i,c,m,v),!0;case"dragenter":return Ws=ec(Ws,n,i,c,m,v),!0;case"mouseover":return Ks=ec(Ks,n,i,c,m,v),!0;case"pointerover":var b=v.pointerId;return Qo.set(b,ec(Qo.get(b)||null,n,i,c,m,v)),!0;case"gotpointercapture":return b=v.pointerId,Zo.set(b,ec(Zo.get(b)||null,n,i,c,m,v)),!0}return!1}function yv(n){var i=Be(n.target);if(i!==null){var c=l(i);if(c!==null){if(i=c.tag,i===13){if(i=o(c),i!==null){n.blockedOn=i,H(n.priority,function(){pv(c)});return}}else if(i===31){if(i=u(c),i!==null){n.blockedOn=i,H(n.priority,function(){pv(c)});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){n.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}n.blockedOn=null}function x0(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var c=tm(n.nativeEvent);if(c===null){c=n.nativeEvent;var m=new c.constructor(c.type,c);Y=m,c.target.dispatchEvent(m),Y=null}else return i=qe(c),i!==null&&xv(i),n.blockedOn=c,!1;i.shift()}return!0}function _v(n,i,c){x0(n)&&c.delete(i)}function rT(){am=!1,Xs!==null&&x0(Xs)&&(Xs=null),Ws!==null&&x0(Ws)&&(Ws=null),Ks!==null&&x0(Ks)&&(Ks=null),Qo.forEach(_v),Zo.forEach(_v)}function p0(n,i){n.blockedOn===i&&(n.blockedOn=null,am||(am=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,rT)))}var g0=null;function bv(n){g0!==n&&(g0=n,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){g0===n&&(g0=null);for(var i=0;i<n.length;i+=3){var c=n[i],m=n[i+1],v=n[i+2];if(typeof m!="function"){if(rm(m||c)===null)continue;break}var b=qe(c);b!==null&&(n.splice(i,3),i-=3,th(b,{pending:!0,data:v,method:c.method,action:m},m,v))}}))}function Dl(n){function i(ee){return p0(ee,n)}Xs!==null&&p0(Xs,n),Ws!==null&&p0(Ws,n),Ks!==null&&p0(Ks,n),Qo.forEach(i),Zo.forEach(i);for(var c=0;c<Ys.length;c++){var m=Ys[c];m.blockedOn===n&&(m.blockedOn=null)}for(;0<Ys.length&&(c=Ys[0],c.blockedOn===null);)yv(c),c.blockedOn===null&&Ys.shift();if(c=(n.ownerDocument||n).$$reactFormReplay,c!=null)for(m=0;m<c.length;m+=3){var v=c[m],b=c[m+1],k=v[B]||null;if(typeof b=="function")k||bv(c);else if(k){var R=null;if(b&&b.hasAttribute("formAction")){if(v=b,k=b[B]||null)R=k.formAction;else if(rm(v)!==null)continue}else R=k.action;typeof R=="function"?c[m+1]=R:(c.splice(m,3),m-=3),bv(c)}}}function wv(){function n(b){b.canIntercept&&b.info==="react-transition"&&b.intercept({handler:function(){return new Promise(function(k){return v=k})},focusReset:"manual",scroll:"manual"})}function i(){v!==null&&(v(),v=null),m||setTimeout(c,20)}function c(){if(!m&&!navigation.transition){var b=navigation.currentEntry;b&&b.url!=null&&navigation.navigate(b.url,{state:b.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var m=!1,v=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(c,100),function(){m=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),v!==null&&(v(),v=null)}}}function nm(n){this._internalRoot=n}v0.prototype.render=nm.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(a(409));var c=i.current,m=Ja();hv(c,m,n,i,null,null)},v0.prototype.unmount=nm.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;hv(n.current,2,null,n,null,null),Qu(),i[X]=null}};function v0(n){this._internalRoot=n}v0.prototype.unstable_scheduleHydration=function(n){if(n){var i=j();n={blockedOn:null,target:n,priority:i};for(var c=0;c<Ys.length&&i!==0&&i<Ys[c].priority;c++);Ys.splice(c,0,n),c===0&&yv(n)}};var Sv=t.version;if(Sv!=="19.2.4")throw Error(a(527,Sv,"19.2.4"));ae.findDOMNode=function(n){var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(a(188)):(n=Object.keys(n).join(","),Error(a(268,n)));return n=d(i),n=n!==null?x(n):null,n=n===null?null:n.stateNode,n};var aT={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:te,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var y0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!y0.isDisabled&&y0.supportsFiber)try{It=y0.inject(aT),Gt=y0}catch{}}return rc.createRoot=function(n,i){if(!s(n))throw Error(a(299));var c=!1,m="",v=Og,b=Cg,k=Rg;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(m=i.identifierPrefix),i.onUncaughtError!==void 0&&(v=i.onUncaughtError),i.onCaughtError!==void 0&&(b=i.onCaughtError),i.onRecoverableError!==void 0&&(k=i.onRecoverableError)),i=fv(n,1,!1,null,null,c,m,null,v,b,k,wv),n[X]=i.current,Ph(n),new nm(i)},rc.hydrateRoot=function(n,i,c){if(!s(n))throw Error(a(299));var m=!1,v="",b=Og,k=Cg,R=Rg,ee=null;return c!=null&&(c.unstable_strictMode===!0&&(m=!0),c.identifierPrefix!==void 0&&(v=c.identifierPrefix),c.onUncaughtError!==void 0&&(b=c.onUncaughtError),c.onCaughtError!==void 0&&(k=c.onCaughtError),c.onRecoverableError!==void 0&&(R=c.onRecoverableError),c.formState!==void 0&&(ee=c.formState)),i=fv(n,1,!0,i,c??null,m,v,ee,b,k,R,wv),i.context=dv(null),c=i.current,m=Ja(),m=qt(m),v=Ms(m),v.callback=null,Is(c,v,m),c=m,i.current.lanes=c,$a(i,c),Vn(i),n[X]=i.current,Ph(n),new v0(i)},rc.version="19.2.4",rc}var Dv;function mT(){if(Dv)return lm.exports;Dv=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),lm.exports=hT(),lm.exports}var xT=mT();const pT=nx(xT);function Uf(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(r[a[s]]=e[a[s]]);return r}function gT(e,t,r,a){function s(l){return l instanceof r?l:new r(function(o){o(l)})}return new(r||(r=Promise))(function(l,o){function u(x){try{d(a.next(x))}catch(g){o(g)}}function h(x){try{d(a.throw(x))}catch(g){o(g)}}function d(x){x.done?l(x.value):s(x.value).then(u,h)}d((a=a.apply(e,t||[])).next())})}const vT=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class sx extends Error{constructor(t,r="FunctionsError",a){super(t),this.name=r,this.context=a}}class yT extends sx{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Fv extends sx{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Mv extends sx{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Lm;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Lm||(Lm={}));class _T{constructor(t,{headers:r={},customFetch:a,region:s=Lm.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=vT(a)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return gT(this,arguments,void 0,function*(r,a={}){var s;let l,o;try{const{headers:u,method:h,body:d,signal:x,timeout:g}=a;let p={},{region:y}=a;y||(y=this.region);const w=new URL(`${this.url}/${r}`);y&&y!=="any"&&(p["x-region"]=y,w.searchParams.set("forceFunctionRegion",y));let _;d&&(u&&!Object.prototype.hasOwnProperty.call(u,"Content-Type")||!u)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(p["Content-Type"]="application/octet-stream",_=d):typeof d=="string"?(p["Content-Type"]="text/plain",_=d):typeof FormData<"u"&&d instanceof FormData?_=d:(p["Content-Type"]="application/json",_=JSON.stringify(d)):d&&typeof d!="string"&&!(typeof Blob<"u"&&d instanceof Blob)&&!(d instanceof ArrayBuffer)&&!(typeof FormData<"u"&&d instanceof FormData)?_=JSON.stringify(d):_=d;let S=x;g&&(o=new AbortController,l=setTimeout(()=>o.abort(),g),x?(S=o.signal,x.addEventListener("abort",()=>o.abort())):S=o.signal);const T=yield this.fetch(w.toString(),{method:h||"POST",headers:Object.assign(Object.assign(Object.assign({},p),this.headers),u),body:_,signal:S}).catch(G=>{throw new yT(G)}),N=T.headers.get("x-relay-error");if(N&&N==="true")throw new Fv(T);if(!T.ok)throw new Mv(T);let E=((s=T.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),D;return E==="application/json"?D=yield T.json():E==="application/octet-stream"||E==="application/pdf"?D=yield T.blob():E==="text/event-stream"?D=T:E==="multipart/form-data"?D=yield T.formData():D=yield T.text(),{data:D,error:null,response:T}}catch(u){return{data:null,error:u,response:u instanceof Mv||u instanceof Fv?u.context:void 0}}finally{l&&clearTimeout(l)}})}}var bT=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},wT=class{constructor(e){var t,r,a;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,this.urlLengthLimit=(a=e.urlLengthLimit)!==null&&a!==void 0?a:8e3,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let s=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{let o=null,u=null,h=null,d=l.status,x=l.statusText;if(l.ok){var g,p;if(r.method!=="HEAD"){var y;const T=await l.text();T===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((y=r.headers.get("Accept"))===null||y===void 0)&&y.includes("application/vnd.pgrst.plan+text"))?u=T:u=JSON.parse(T))}const _=(g=r.headers.get("Prefer"))===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),S=(p=l.headers.get("content-range"))===null||p===void 0?void 0:p.split("/");_&&S&&S.length>1&&(h=parseInt(S[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(u)&&(u.length>1?(o={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,d=406,x="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{var w;const _=await l.text();try{o=JSON.parse(_),Array.isArray(o)&&l.status===404&&(u=[],o=null,d=200,x="OK")}catch{l.status===404&&_===""?(d=204,x="No Content"):o={message:_}}if(o&&r.isMaybeSingle&&(!(o==null||(w=o.details)===null||w===void 0)&&w.includes("0 rows"))&&(o=null,d=200,x="OK"),o&&r.shouldThrowOnError)throw new bT(o)}return{error:o,data:u,count:h,status:d,statusText:x}});return this.shouldThrowOnError||(s=s.catch(l=>{var o;let u="",h="",d="";const x=l==null?void 0:l.cause;if(x){var g,p,y,w;const T=(g=x==null?void 0:x.message)!==null&&g!==void 0?g:"",N=(p=x==null?void 0:x.code)!==null&&p!==void 0?p:"";u=`${(y=l==null?void 0:l.name)!==null&&y!==void 0?y:"FetchError"}: ${l==null?void 0:l.message}`,u+=`

Caused by: ${(w=x==null?void 0:x.name)!==null&&w!==void 0?w:"Error"}: ${T}`,N&&(u+=` (${N})`),x!=null&&x.stack&&(u+=`
${x.stack}`)}else{var _;u=(_=l==null?void 0:l.stack)!==null&&_!==void 0?_:""}const S=this.url.toString().length;return(l==null?void 0:l.name)==="AbortError"||(l==null?void 0:l.code)==="ABORT_ERR"?(d="",h="Request was aborted (timeout or manual cancellation)",S>this.urlLengthLimit&&(h+=`. Note: Your request URL is ${S} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):((x==null?void 0:x.name)==="HeadersOverflowError"||(x==null?void 0:x.code)==="UND_ERR_HEADERS_OVERFLOW")&&(d="",h="HTTP headers exceeded server limits (typically 16KB)",S>this.urlLengthLimit&&(h+=`. Your request URL is ${S} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${(o=l==null?void 0:l.name)!==null&&o!==void 0?o:"FetchError"}: ${l==null?void 0:l.message}`,details:u,hint:h,code:d},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}},ST=class extends wT{select(e){let t=!1;const r=(e??"*").split("").map(a=>/\s/.test(a)&&!t?"":(a==='"'&&(t=!t),a)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:a,referencedTable:s=a}={}){const l=s?`${s}.order`:"order",o=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:a=r}={}){const s=typeof a>"u"?"offset":`${a}.offset`,l=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(l,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:a=!1,wal:s=!1,format:l="text"}={}){var o;const u=[e?"analyze":null,t?"verbose":null,r?"settings":null,a?"buffers":null,s?"wal":null].filter(Boolean).join("|"),h=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${l}; for="${h}"; options=${u};`),l==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const Iv=new RegExp("[,()]");var Vl=class extends ST{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(a=>typeof a=="string"&&Iv.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(a=>typeof a=="string"&&Iv.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:a}={}){let s="";a==="plain"?s="pl":a==="phrase"?s="ph":a==="websearch"&&(s="w");const l=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${s}fts${l}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const a=r?`${r}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},ET=class{constructor(e,{headers:t={},schema:r,fetch:a,urlLengthLimit:s=8e3}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=a,this.urlLengthLimit=s}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:a}=t??{},s=r?"HEAD":"GET";let l=!1;const o=(e??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join(""),{url:u,headers:h}=this.cloneRequestState();return u.searchParams.set("select",o),a&&h.append("Prefer",`count=${a}`),new Vl({method:s,url:u,headers:h,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(e,{count:t,defaultToNull:r=!0}={}){var a;const s="POST",{url:l,headers:o}=this.cloneRequestState();if(t&&o.append("Prefer",`count=${t}`),r||o.append("Prefer","missing=default"),Array.isArray(e)){const u=e.reduce((h,d)=>h.concat(Object.keys(d)),[]);if(u.length>0){const h=[...new Set(u)].map(d=>`"${d}"`);l.searchParams.set("columns",h.join(","))}}return new Vl({method:s,url:l,headers:o,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:a,defaultToNull:s=!0}={}){var l;const o="POST",{url:u,headers:h}=this.cloneRequestState();if(h.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&u.searchParams.set("on_conflict",t),a&&h.append("Prefer",`count=${a}`),s||h.append("Prefer","missing=default"),Array.isArray(e)){const d=e.reduce((x,g)=>x.concat(Object.keys(g)),[]);if(d.length>0){const x=[...new Set(d)].map(g=>`"${g}"`);u.searchParams.set("columns",x.join(","))}}return new Vl({method:o,url:u,headers:h,schema:this.schema,body:e,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch,urlLengthLimit:this.urlLengthLimit})}update(e,{count:t}={}){var r;const a="PATCH",{url:s,headers:l}=this.cloneRequestState();return t&&l.append("Prefer",`count=${t}`),new Vl({method:a,url:s,headers:l,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:e}={}){var t;const r="DELETE",{url:a,headers:s}=this.cloneRequestState();return e&&s.append("Prefer",`count=${e}`),new Vl({method:r,url:a,headers:s,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch,urlLengthLimit:this.urlLengthLimit})}};function Tc(e){"@babel/helpers - typeof";return Tc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tc(e)}function TT(e,t){if(Tc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Tc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kT(e){var t=TT(e,"string");return Tc(t)=="symbol"?t:t+""}function NT(e,t,r){return(t=kT(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function _0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Lv(Object(r),!0).forEach(function(a){NT(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lv(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}var jT=class wb{constructor(t,{headers:r={},schema:a,fetch:s,timeout:l,urlLengthLimit:o=8e3}={}){this.url=t,this.headers=new Headers(r),this.schemaName=a,this.urlLengthLimit=o;const u=s??globalThis.fetch;l!==void 0&&l>0?this.fetch=(h,d)=>{const x=new AbortController,g=setTimeout(()=>x.abort(),l),p=d==null?void 0:d.signal;if(p){if(p.aborted)return clearTimeout(g),u(h,d);const y=()=>{clearTimeout(g),x.abort()};return p.addEventListener("abort",y,{once:!0}),u(h,_0(_0({},d),{},{signal:x.signal})).finally(()=>{clearTimeout(g),p.removeEventListener("abort",y)})}return u(h,_0(_0({},d),{},{signal:x.signal})).finally(()=>clearTimeout(g))}:this.fetch=u}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new ET(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(t){return new wb(this.url,{headers:this.headers,schema:t,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(t,r={},{head:a=!1,get:s=!1,count:l}={}){var o;let u;const h=new URL(`${this.url}/rpc/${t}`);let d;const x=y=>y!==null&&typeof y=="object"&&(!Array.isArray(y)||y.some(x)),g=a&&Object.values(r).some(x);g?(u="POST",d=r):a||s?(u=a?"HEAD":"GET",Object.entries(r).filter(([y,w])=>w!==void 0).map(([y,w])=>[y,Array.isArray(w)?`{${w.join(",")}}`:`${w}`]).forEach(([y,w])=>{h.searchParams.append(y,w)})):(u="POST",d=r);const p=new Headers(this.headers);return g?p.set("Prefer",l?`count=${l},return=minimal`:"return=minimal"):l&&p.set("Prefer",`count=${l}`),new Vl({method:u,url:h,headers:p,schema:this.schemaName,body:d,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch,urlLengthLimit:this.urlLengthLimit})}};class AT{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const a=r.versions;if(a&&a.node){const s=a.node,l=parseInt(s.replace(/^v/,"").split(".")[0]);return l>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${l} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${l} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const a=this.getWebSocketConstructor();return new a(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const OT="2.97.0",CT=`realtime-js/${OT}`,RT="1.0.0",Sb="2.0.0",Bv=Sb,Bm=1e4,DT=1e3,FT=100;var Zs;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Zs||(Zs={}));var Xr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Xr||(Xr={}));var In;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(In||(In={}));var Pm;(function(e){e.websocket="websocket"})(Pm||(Pm={}));var Fi;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Fi||(Fi={}));class MT{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let a=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(a))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,a;const s=(a=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(t){var r,a;const s=(a=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:{},o=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(t,r,a){var s,l;const o=t.topic,u=(s=t.ref)!==null&&s!==void 0?s:"",h=(l=t.join_ref)!==null&&l!==void 0?l:"",d=t.payload.event,x=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},g=Object.keys(x).length===0?"":JSON.stringify(x);if(h.length>255)throw new Error(`joinRef length ${h.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`ref length ${u.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`userEvent length ${d.length} exceeds maximum of 255`);if(g.length>255)throw new Error(`metadata length ${g.length} exceeds maximum of 255`);const p=this.USER_BROADCAST_PUSH_META_LENGTH+h.length+u.length+o.length+d.length+g.length,y=new ArrayBuffer(this.HEADER_LENGTH+p);let w=new DataView(y),_=0;w.setUint8(_++,this.KINDS.userBroadcastPush),w.setUint8(_++,h.length),w.setUint8(_++,u.length),w.setUint8(_++,o.length),w.setUint8(_++,d.length),w.setUint8(_++,g.length),w.setUint8(_++,r),Array.from(h,T=>w.setUint8(_++,T.charCodeAt(0))),Array.from(u,T=>w.setUint8(_++,T.charCodeAt(0))),Array.from(o,T=>w.setUint8(_++,T.charCodeAt(0))),Array.from(d,T=>w.setUint8(_++,T.charCodeAt(0))),Array.from(g,T=>w.setUint8(_++,T.charCodeAt(0)));var S=new Uint8Array(y.byteLength+a.byteLength);return S.set(new Uint8Array(y),0),S.set(new Uint8Array(a),y.byteLength),S.buffer}decode(t,r){if(this._isArrayBuffer(t)){let a=this._binaryDecode(t);return r(a)}if(typeof t=="string"){const a=JSON.parse(t),[s,l,o,u,h]=a;return r({join_ref:s,ref:l,topic:o,event:u,payload:h})}return r({})}_binaryDecode(t){const r=new DataView(t),a=r.getUint8(0),s=new TextDecoder;switch(a){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,s)}}_decodeUserBroadcast(t,r,a){const s=r.getUint8(1),l=r.getUint8(2),o=r.getUint8(3),u=r.getUint8(4);let h=this.HEADER_LENGTH+4;const d=a.decode(t.slice(h,h+s));h=h+s;const x=a.decode(t.slice(h,h+l));h=h+l;const g=a.decode(t.slice(h,h+o));h=h+o;const p=t.slice(h,t.byteLength),y=u===this.JSON_ENCODING?JSON.parse(a.decode(p)):p,w={type:this.BROADCAST_EVENT,event:x,payload:y};return o>0&&(w.meta=JSON.parse(g)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST_EVENT,payload:w}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([a])=>r.includes(a)))}}class Eb{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var cr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(cr||(cr={}));const Pv=(e,t,r={})=>{var a;const s=(a=r.skipTypes)!==null&&a!==void 0?a:[];return t?Object.keys(t).reduce((l,o)=>(l[o]=IT(o,e,t,s),l),{}):{}},IT=(e,t,r,a)=>{const s=t.find(u=>u.name===e),l=s==null?void 0:s.type,o=r[e];return l&&!a.includes(l)?Tb(l,o):Um(o)},Tb=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return UT(t,r)}switch(e){case cr.bool:return LT(t);case cr.float4:case cr.float8:case cr.int2:case cr.int4:case cr.int8:case cr.numeric:case cr.oid:return BT(t);case cr.json:case cr.jsonb:return PT(t);case cr.timestamp:return zT(t);case cr.abstime:case cr.date:case cr.daterange:case cr.int4range:case cr.int8range:case cr.money:case cr.reltime:case cr.text:case cr.time:case cr.timestamptz:case cr.timetz:case cr.tsrange:case cr.tstzrange:return Um(t);default:return Um(t)}},Um=e=>e,LT=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},BT=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},PT=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},UT=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,a=e[r];if(e[0]==="{"&&a==="}"){let l;const o=e.slice(1,r);try{l=JSON.parse("["+o+"]")}catch{l=o?o.split(","):[]}return l.map(u=>Tb(t,u))}return e},zT=e=>typeof e=="string"?e.replace(" ","T"):e,kb=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class fm{constructor(t,r,a={},s=Bm){this.channel=t,this.event=r,this.payload=a,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var a;return this._hasReceived(t)&&r((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(a=>a.status===t).forEach(a=>a.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Uv;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Uv||(Uv={}));class xc{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},s=>{const{onJoin:l,onLeave:o,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=xc.syncState(this.state,s,l,o),this.pendingDiffs.forEach(h=>{this.state=xc.syncDiff(this.state,h,l,o)}),this.pendingDiffs=[],u()}),this.channel._on(a.diff,{},s=>{const{onJoin:l,onLeave:o,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=xc.syncDiff(this.state,s,l,o),u())}),this.onJoin((s,l,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:l,newPresences:o})}),this.onLeave((s,l,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:l,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,a,s){const l=this.cloneDeep(t),o=this.transformState(r),u={},h={};return this.map(l,(d,x)=>{o[d]||(h[d]=x)}),this.map(o,(d,x)=>{const g=l[d];if(g){const p=x.map(S=>S.presence_ref),y=g.map(S=>S.presence_ref),w=x.filter(S=>y.indexOf(S.presence_ref)<0),_=g.filter(S=>p.indexOf(S.presence_ref)<0);w.length>0&&(u[d]=w),_.length>0&&(h[d]=_)}else u[d]=x}),this.syncDiff(l,{joins:u,leaves:h},a,s)}static syncDiff(t,r,a,s){const{joins:l,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return a||(a=()=>{}),s||(s=()=>{}),this.map(l,(u,h)=>{var d;const x=(d=t[u])!==null&&d!==void 0?d:[];if(t[u]=this.cloneDeep(h),x.length>0){const g=t[u].map(y=>y.presence_ref),p=x.filter(y=>g.indexOf(y.presence_ref)<0);t[u].unshift(...p)}a(u,x,h)}),this.map(o,(u,h)=>{let d=t[u];if(!d)return;const x=h.map(g=>g.presence_ref);d=d.filter(g=>x.indexOf(g.presence_ref)<0),t[u]=d,s(u,d,h),d.length===0&&delete t[u]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(a=>r(a,t[a]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,a)=>{const s=t[a];return"metas"in s?r[a]=s.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):r[a]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var zv;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(zv||(zv={}));var pc;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(pc||(pc={}));var gs;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(gs||(gs={}));class Yl{constructor(t,r={config:{}},a){var s,l;if(this.topic=t,this.params=r,this.socket=a,this.bindings={},this.state=Xr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new fm(this,In.join,this.params,this.timeout),this.rejoinTimer=new Eb(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Xr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Xr.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Xr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Xr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Xr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(In.reply,{},(o,u)=>{this._trigger(this._replyEventName(u),o)}),this.presence=new xc(this),this.broadcastEndpointURL=kb(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var a,s,l;if(this.socket.isConnected()||this.socket.connect(),this.state==Xr.closed){const{config:{broadcast:o,presence:u,private:h}}=this.params,d=(s=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(y=>y.filter))!==null&&s!==void 0?s:[],x=!!this.bindings[pc.PRESENCE]&&this.bindings[pc.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,g={},p={broadcast:o,presence:Object.assign(Object.assign({},u),{enabled:x}),postgres_changes:d,private:h};this.socket.accessTokenValue&&(g.access_token=this.socket.accessTokenValue),this._onError(y=>t==null?void 0:t(gs.CHANNEL_ERROR,y)),this._onClose(()=>t==null?void 0:t(gs.CLOSED)),this.updateJoinPayload(Object.assign({config:p},g)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:y})=>{var w;if(this.socket._isManualToken()||this.socket.setAuth(),y===void 0){t==null||t(gs.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,S=(w=_==null?void 0:_.length)!==null&&w!==void 0?w:0,T=[];for(let N=0;N<S;N++){const E=_[N],{filter:{event:D,schema:G,table:V,filter:A}}=E,M=y&&y[N];if(M&&M.event===D&&Yl.isFilterValueEqual(M.schema,G)&&Yl.isFilterValueEqual(M.table,V)&&Yl.isFilterValueEqual(M.filter,A))T.push(Object.assign(Object.assign({},E),{id:M.id}));else{this.unsubscribe(),this.state=Xr.errored,t==null||t(gs.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=T,t&&t(gs.SUBSCRIBED);return}}).receive("error",y=>{this.state=Xr.errored,t==null||t(gs.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(y).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(gs.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,a){return this.state===Xr.joined&&t===pc.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,a)}async httpSend(t,r,a={}){var s;if(r==null)return Promise.reject("Payload is required for httpSend()");const l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},u=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(s=a.timeout)!==null&&s!==void 0?s:this.timeout);if(u.status===202)return{success:!0};let h=u.statusText;try{const d=await u.json();h=d.error||d.message||h}catch{}return Promise.reject(new Error(h))}async send(t,r={}){var a,s;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:o}=t,u={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(u.Authorization=`Bearer ${this.socket.accessTokenValue}`);const h={method:"POST",headers:u,body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var o,u,h;const d=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((h=(u=(o=this.params)===null||o===void 0?void 0:o.config)===null||u===void 0?void 0:u.broadcast)===null||h===void 0)&&h.ack)&&l("ok"),d.receive("ok",()=>l("ok")),d.receive("error",()=>l("error")),d.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Xr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(In.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(s=>{a=new fm(this,In.leave,{},t),a.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a==null||a.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Xr.closed,this.bindings={}}async _fetchWithTimeout(t,r,a){const s=new AbortController,l=setTimeout(()=>s.abort(),a),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(l),o}_push(t,r,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new fm(this,t,r,a);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>FT){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,a){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,a){var s,l;const o=t.toLocaleLowerCase(),{close:u,error:h,leave:d,join:x}=In;if(a&&[u,h,d,x].indexOf(o)>=0&&a!==this._joinRef())return;let p=this._onMessage(o,r,a);if(r&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(y=>{var w,_,S;return((w=y.filter)===null||w===void 0?void 0:w.event)==="*"||((S=(_=y.filter)===null||_===void 0?void 0:_.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===o}).map(y=>y.callback(p,a)):(l=this.bindings[o])===null||l===void 0||l.filter(y=>{var w,_,S,T,N,E;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in y){const D=y.id,G=(w=y.filter)===null||w===void 0?void 0:w.event;return D&&((_=r.ids)===null||_===void 0?void 0:_.includes(D))&&(G==="*"||(G==null?void 0:G.toLocaleLowerCase())===((S=r.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const D=(N=(T=y==null?void 0:y.filter)===null||T===void 0?void 0:T.event)===null||N===void 0?void 0:N.toLocaleLowerCase();return D==="*"||D===((E=r==null?void 0:r.event)===null||E===void 0?void 0:E.toLocaleLowerCase())}else return y.type.toLocaleLowerCase()===o}).map(y=>{if(typeof p=="object"&&"ids"in p){const w=p.data,{schema:_,table:S,commit_timestamp:T,type:N,errors:E}=w;p=Object.assign(Object.assign({},{schema:_,table:S,commit_timestamp:T,eventType:N,new:{},old:{},errors:E}),this._getPayloadRecords(w))}y.callback(p,a)})}_isClosed(){return this.state===Xr.closed}_isJoined(){return this.state===Xr.joined}_isJoining(){return this.state===Xr.joining}_isLeaving(){return this.state===Xr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,a){const s=t.toLocaleLowerCase(),l={type:s,filter:r,callback:a};return this.bindings[s]?this.bindings[s].push(l):this.bindings[s]=[l],this}_off(t,r){const a=t.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(s=>{var l;return!(((l=s.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===a&&Yl.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const a in t)if(t[a]!==r[a])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(In.close,{},t)}_onError(t){this._on(In.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Xr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Pv(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Pv(t.columns,t.old_record)),r}}const dm=()=>{},b0={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},HT=[1e3,2e3,5e3,1e4],qT=1e4,$T=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class GT{constructor(t,r){var a;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Bm,this.transport=null,this.heartbeatIntervalMs=b0.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=dm,this.ref=0,this.reconnectTimer=null,this.vsn=Bv,this.logger=dm,this.conn=null,this.sendBuffer=[],this.serializer=new MT,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=s=>s?(...l)=>s(...l):(...l)=>fetch(...l),!(!((a=r==null?void 0:r.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Pm.websocket}`,this.httpEndpoint=kb(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=AT.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,a){this.logger(t,r,a)}connectionState(){switch(this.conn&&this.conn.readyState){case Zs.connecting:return Fi.Connecting;case Zs.open:return Fi.Open;case Zs.closing:return Fi.Closing;default:return Fi.Closed}}isConnected(){return this.connectionState()===Fi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const a=`realtime:${t}`,s=this.getChannels().find(l=>l.topic===a);if(s)return s;{const l=new Yl(`realtime:${t}`,r,this);return this.channels.push(l),l}}push(t){const{topic:r,event:a,payload:s,ref:l}=t,o=()=>{this.encode(t,u=>{var h;(h=this.conn)===null||h===void 0||h.send(u)})};this.log("push",`${r} ${a} (${l})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(DT,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},b0.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(a=>a.topic===t&&(a._isJoined()||a._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const d=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",d)}catch(x){this.log("error","error in heartbeat callback",x)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:a,event:s,payload:l,ref:o}=r,u=o?`(${o})`:"",h=l.status||"";this.log("receive",`${h} ${a} ${s} ${u}`.trim(),l),this.channels.filter(d=>d._isMember(a)).forEach(d=>d._trigger(s,l,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===Zs.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Zs.open||this.conn.readyState===Zs.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t);try{this.heartbeatCallback("error")}catch(r){this.log("error","error in heartbeat callback",r)}}_triggerChanError(){this.channels.forEach(t=>t._trigger(In.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const a=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${a}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const a=new Blob([$T],{type:"application/javascript"});r=URL.createObjectURL(a)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,a=!1;if(t)r=t,a=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),r=this.accessTokenValue}else r=this.accessTokenValue;a?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const l={access_token:r,version:CT};r&&s.updateJoinPayload(l),s.joinedOnce&&s._isJoined()&&s._push(In.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(a=>{try{a(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(a){this.log("error",`error triggering ${t} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new Eb(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},b0.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,a,s,l,o,u,h,d,x,g,p,y;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(a=t==null?void 0:t.timeout)!==null&&a!==void 0?a:Bm,this.heartbeatIntervalMs=(s=t==null?void 0:t.heartbeatIntervalMs)!==null&&s!==void 0?s:b0.HEARTBEAT_INTERVAL,this.worker=(l=t==null?void 0:t.worker)!==null&&l!==void 0?l:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(u=t==null?void 0:t.heartbeatCallback)!==null&&u!==void 0?u:dm,this.vsn=(h=t==null?void 0:t.vsn)!==null&&h!==void 0?h:Bv,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=t==null?void 0:t.reconnectAfterMs)!==null&&d!==void 0?d:(w=>HT[w-1]||qT),this.vsn){case RT:this.encode=(x=t==null?void 0:t.encode)!==null&&x!==void 0?x:((w,_)=>_(JSON.stringify(w))),this.decode=(g=t==null?void 0:t.decode)!==null&&g!==void 0?g:((w,_)=>_(JSON.parse(w)));break;case Sb:this.encode=(p=t==null?void 0:t.encode)!==null&&p!==void 0?p:this.serializer.encode.bind(this.serializer),this.decode=(y=t==null?void 0:t.decode)!==null&&y!==void 0?y:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var kc=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function VT(e,t,r){const a=new URL(t,e);if(r)for(const[s,l]of Object.entries(r))l!==void 0&&a.searchParams.set(s,l);return a.toString()}async function XT(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function WT(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:a,query:s,body:l,headers:o}){const u=VT(e.baseUrl,a,s),h=await XT(e.auth),d=await t(u,{method:r,headers:{...l?{"Content-Type":"application/json"}:{},...h,...o},body:l?JSON.stringify(l):void 0}),x=await d.text(),g=(d.headers.get("content-type")||"").includes("application/json"),p=g&&x?JSON.parse(x):x;if(!d.ok){const y=g?p:void 0,w=y==null?void 0:y.error;throw new kc((w==null?void 0:w.message)??`Request failed with status ${d.status}`,{status:d.status,icebergType:w==null?void 0:w.type,icebergCode:w==null?void 0:w.code,details:y})}return{status:d.status,headers:d.headers,data:p}}}}function w0(e){return e.join("")}var KT=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:w0(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${w0(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${w0(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${w0(e.namespace)}`}),!0}catch(t){if(t instanceof kc&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof kc&&r.status===409)return;throw r}}};function Fl(e){return e.join("")}var YT=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Fl(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Fl(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Fl(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Fl(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Fl(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Fl(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof kc&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof kc&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},JT=class{constructor(e){var a;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=WT({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(a=e.accessDelegation)==null?void 0:a.join(","),this.namespaceOps=new KT(this.client,t),this.tableOps=new YT(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},zf=class extends Error{constructor(e,t="storage",r,a){super(e),this.__isStorageError=!0,this.namespace=t,this.name=t==="vectors"?"StorageVectorsError":"StorageError",this.status=r,this.statusCode=a}};function Hf(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var S0=class extends zf{constructor(e,t,r,a="storage"){super(e,a,t,r),this.name=a==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Nb=class extends zf{constructor(e,t,r="storage"){super(e,r),this.name=r==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};const QT=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),ZT=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},zm=e=>{if(Array.isArray(e))return e.map(r=>zm(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,a])=>{const s=r.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[s]=zm(a)}),t},ek=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function Nc(e){"@babel/helpers - typeof";return Nc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nc(e)}function tk(e,t){if(Nc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Nc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rk(e){var t=tk(e,"string");return Nc(t)=="symbol"?t:t+""}function ak(e,t,r){return(t=rk(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function ot(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Hv(Object(r),!0).forEach(function(a){ak(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hv(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}const qv=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},nk=async(e,t,r,a)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const s=e,l=s.status||500;if(typeof s.json=="function")s.json().then(o=>{const u=(o==null?void 0:o.statusCode)||(o==null?void 0:o.code)||l+"";t(new S0(qv(o),l,u,a))}).catch(()=>{if(a==="vectors"){const o=l+"";t(new S0(s.statusText||`HTTP ${l} error`,l,o,a))}else{const o=l+"";t(new S0(s.statusText||`HTTP ${l} error`,l,o,a))}});else{const o=l+"";t(new S0(s.statusText||`HTTP ${l} error`,l,o,a))}}else t(new Nb(qv(e),e,a))},sk=(e,t,r,a)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||e==="HEAD"||!a?ot(ot({},s),r):(ZT(a)?(s.headers=ot({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(a)):s.body=a,t!=null&&t.duplex&&(s.duplex=t.duplex),ot(ot({},s),r))};async function ac(e,t,r,a,s,l,o){return new Promise((u,h)=>{e(r,sk(t,a,s,l)).then(d=>{if(!d.ok)throw d;if(a!=null&&a.noResolveJson)return d;if(o==="vectors"){const x=d.headers.get("content-type");if(d.headers.get("content-length")==="0"||d.status===204)return{};if(!x||!x.includes("application/json"))return{}}return d.json()}).then(d=>u(d)).catch(d=>nk(d,h,a,o))})}function jb(e="storage"){return{get:async(t,r,a,s)=>ac(t,"GET",r,a,s,void 0,e),post:async(t,r,a,s,l)=>ac(t,"POST",r,s,l,a,e),put:async(t,r,a,s,l)=>ac(t,"PUT",r,s,l,a,e),head:async(t,r,a,s)=>ac(t,"HEAD",r,ot(ot({},a),{},{noResolveJson:!0}),s,void 0,e),remove:async(t,r,a,s,l)=>ac(t,"DELETE",r,s,l,a,e)}}const ik=jb("storage"),{get:jc,post:Mn,put:Hm,head:lk,remove:ix}=ik,an=jb("vectors");var io=class{constructor(e,t={},r,a="storage"){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.fetch=QT(r),this.namespace=a}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=ot(ot({},this.headers),{},{[e]:t}),this}async handleOperation(e){var t=this;try{return{data:await e(),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Hf(r))return{data:null,error:r};throw r}}},ok=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Hf(t))return{data:null,error:t};throw t}}};let Ab;Ab=Symbol.toStringTag;var ck=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[Ab]="BlobDownloadBuilder",this.promise=null}asStream(){return new ok(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Hf(t))return{data:null,error:t};throw t}}};const uk={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},$v={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var fk=class extends io{constructor(e,t={},r,a){super(e,t,a,"storage"),this.bucketId=r}async uploadOrUpdate(e,t,r,a){var s=this;return s.handleOperation(async()=>{let l;const o=ot(ot({},$v),a);let u=ot(ot({},s.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const h=o.metadata;typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",o.cacheControl),h&&l.append("metadata",s.encodeMetadata(h)),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.has("cacheControl")||l.append("cacheControl",o.cacheControl),h&&!l.has("metadata")&&l.append("metadata",s.encodeMetadata(h))):(l=r,u["cache-control"]=`max-age=${o.cacheControl}`,u["content-type"]=o.contentType,h&&(u["x-metadata"]=s.toBase64(s.encodeMetadata(h))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!o.duplex&&(o.duplex="half")),a!=null&&a.headers&&(u=ot(ot({},u),a.headers));const d=s._removeEmptyFolders(t),x=s._getFinalPath(d),g=await(e=="PUT"?Hm:Mn)(s.fetch,`${s.url}/object/${x}`,l,ot({headers:u},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{path:d,id:g.Id,fullPath:g.Key}})}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,a){var s=this;const l=s._removeEmptyFolders(e),o=s._getFinalPath(l),u=new URL(s.url+`/object/upload/sign/${o}`);return u.searchParams.set("token",t),s.handleOperation(async()=>{let h;const d=ot({upsert:$v.upsert},a),x=ot(ot({},s.headers),{"x-upsert":String(d.upsert)});return typeof Blob<"u"&&r instanceof Blob?(h=new FormData,h.append("cacheControl",d.cacheControl),h.append("",r)):typeof FormData<"u"&&r instanceof FormData?(h=r,h.append("cacheControl",d.cacheControl)):(h=r,x["cache-control"]=`max-age=${d.cacheControl}`,x["content-type"]=d.contentType),{path:l,fullPath:(await Hm(s.fetch,u.toString(),h,{headers:x})).Key}})}async createSignedUploadUrl(e,t){var r=this;return r.handleOperation(async()=>{let a=r._getFinalPath(e);const s=ot({},r.headers);t!=null&&t.upsert&&(s["x-upsert"]="true");const l=await Mn(r.fetch,`${r.url}/object/upload/sign/${a}`,{},{headers:s}),o=new URL(r.url+l.url),u=o.searchParams.get("token");if(!u)throw new zf("No token returned by API");return{signedUrl:o.toString(),path:e,token:u}})}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var a=this;return a.handleOperation(async()=>await Mn(a.fetch,`${a.url}/object/move`,{bucketId:a.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:a.headers}))}async copy(e,t,r){var a=this;return a.handleOperation(async()=>({path:(await Mn(a.fetch,`${a.url}/object/copy`,{bucketId:a.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:a.headers})).Key}))}async createSignedUrl(e,t,r){var a=this;return a.handleOperation(async()=>{let s=a._getFinalPath(e),l=await Mn(a.fetch,`${a.url}/object/sign/${s}`,ot({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:a.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{signedUrl:encodeURI(`${a.url}${l.signedURL}${o}`)}})}async createSignedUrls(e,t,r){var a=this;return a.handleOperation(async()=>{const s=await Mn(a.fetch,`${a.url}/object/sign/${a.bucketId}`,{expiresIn:t,paths:e},{headers:a.headers}),l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s.map(o=>ot(ot({},o),{},{signedUrl:o.signedURL?encodeURI(`${a.url}${o.signedURL}${l}`):null}))})}download(e,t,r){const a=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),l=s?`?${s}`:"",o=this._getFinalPath(e),u=()=>jc(this.fetch,`${this.url}/${a}/${o}${l}`,{headers:this.headers,noResolveJson:!0},r);return new ck(u,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);return t.handleOperation(async()=>zm(await jc(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})))}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await lk(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(Hf(a)&&a instanceof Nb){const s=a.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:a}}throw a}}getPublicUrl(e,t){const r=this._getFinalPath(e),a=[],s=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";s!==""&&a.push(s);const l=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",o=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});o!==""&&a.push(o);let u=a.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${u}`)}}}async remove(e){var t=this;return t.handleOperation(async()=>await ix(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}))}async list(e,t,r){var a=this;return a.handleOperation(async()=>{const s=ot(ot(ot({},uk),t),{},{prefix:e||""});return await Mn(a.fetch,`${a.url}/object/list/${a.bucketId}`,s,{headers:a.headers},r)})}async listV2(e,t){var r=this;return r.handleOperation(async()=>{const a=ot({},e);return await Mn(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,a,{headers:r.headers},t)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const dk="2.97.0",Vc={"X-Client-Info":`storage-js/${dk}`};var hk=class extends io{constructor(e,t={},r,a){const s=new URL(e);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase."));const l=s.href.replace(/\/$/,""),o=ot(ot({},Vc),t);super(l,o,r,"storage")}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=t.listBucketOptionsToQueryString(e);return await jc(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers})})}async getBucket(e){var t=this;return t.handleOperation(async()=>await jc(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}))}async createBucket(e,t={public:!1}){var r=this;return r.handleOperation(async()=>await Mn(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async updateBucket(e,t){var r=this;return r.handleOperation(async()=>await Hm(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async emptyBucket(e){var t=this;return t.handleOperation(async()=>await Mn(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await ix(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},mk=class extends io{constructor(e,t={},r){const a=e.replace(/\/$/,""),s=ot(ot({},Vc),t);super(a,s,r,"storage")}async createBucket(e){var t=this;return t.handleOperation(async()=>await Mn(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}))}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const a=r.toString(),s=a?`${t.url}/bucket?${a}`:`${t.url}/bucket`;return await jc(t.fetch,s,{headers:t.headers})})}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await ix(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}from(e){var t=this;if(!ek(e))throw new zf("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new JT({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),a=this.shouldThrowOnError;return new Proxy(r,{get(s,l){const o=s[l];return typeof o!="function"?o:async(...u)=>{try{return{data:await o.apply(s,u),error:null}}catch(h){if(a)throw h;return{data:null,error:h}}}}})}},xk=class extends io{constructor(e,t={},r){const a=e.replace(/\/$/,""),s=ot(ot({},Vc),{},{"Content-Type":"application/json"},t);super(a,s,r,"vectors")}async createIndex(e){var t=this;return t.handleOperation(async()=>await an.post(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{})}async getIndex(e,t){var r=this;return r.handleOperation(async()=>await an.post(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}))}async listIndexes(e){var t=this;return t.handleOperation(async()=>await an.post(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}))}async deleteIndex(e,t){var r=this;return r.handleOperation(async()=>await an.post(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{})}},pk=class extends io{constructor(e,t={},r){const a=e.replace(/\/$/,""),s=ot(ot({},Vc),{},{"Content-Type":"application/json"},t);super(a,s,r,"vectors")}async putVectors(e){var t=this;if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await an.post(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{})}async getVectors(e){var t=this;return t.handleOperation(async()=>await an.post(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}))}async listVectors(e){var t=this;if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return t.handleOperation(async()=>await an.post(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}))}async queryVectors(e){var t=this;return t.handleOperation(async()=>await an.post(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}))}async deleteVectors(e){var t=this;if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await an.post(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{})}},gk=class extends io{constructor(e,t={},r){const a=e.replace(/\/$/,""),s=ot(ot({},Vc),{},{"Content-Type":"application/json"},t);super(a,s,r,"vectors")}async createBucket(e){var t=this;return t.handleOperation(async()=>await an.post(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}async getBucket(e){var t=this;return t.handleOperation(async()=>await an.post(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}))}async listBuckets(e={}){var t=this;return t.handleOperation(async()=>await an.post(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await an.post(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}},vk=class extends gk{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new yk(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},yk=class extends xk{constructor(e,t,r,a){super(e,t,a),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,ot(ot({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,ot(ot({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new _k(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},_k=class extends pk{constructor(e,t,r,a,s){super(e,t,s),this.vectorBucketName=r,this.indexName=a}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,ot(ot({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,ot(ot({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,ot(ot({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,ot(ot({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,ot(ot({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},bk=class extends hk{constructor(e,t={},r,a){super(e,t,r,a)}from(e){return new fk(this.url,this.headers,e,this.fetch)}get vectors(){return new vk(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new mk(this.url+"/iceberg",this.headers,this.fetch)}};const Ob="2.97.0",Xl=30*1e3,qm=3,hm=qm*Xl,wk="http://localhost:9999",Sk="supabase.auth.token",Ek={"X-Client-Info":`gotrue-js/${Ob}`},$m="X-Supabase-Api-Version",Cb={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Tk=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,kk=600*1e3;class Ac extends Error{constructor(t,r,a){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=a}}function Ze(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Nk extends Ac{constructor(t,r,a){super(t,r,a),this.name="AuthApiError",this.status=r,this.code=a}}function jk(e){return Ze(e)&&e.name==="AuthApiError"}class Mi extends Ac{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Ss extends Ac{constructor(t,r,a,s){super(t,a,s),this.name=r,this.status=a}}class en extends Ss{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function mm(e){return Ze(e)&&e.name==="AuthSessionMissingError"}class Ml extends Ss{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class E0 extends Ss{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class T0 extends Ss{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Ak(e){return Ze(e)&&e.name==="AuthImplicitGrantRedirectError"}class Gv extends Ss{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ok extends Ss{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Gm extends Ss{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function xm(e){return Ze(e)&&e.name==="AuthRetryableFetchError"}class Vv extends Ss{constructor(t,r,a){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=a}}class Vm extends Ss{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const wf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Xv=` 	
\r=`.split(""),Ck=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Xv.length;t+=1)e[Xv[t].charCodeAt(0)]=-2;for(let t=0;t<wf.length;t+=1)e[wf[t].charCodeAt(0)]=t;return e})();function Wv(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(wf[a]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(wf[a]),t.queuedBits-=6}}function Rb(e,t,r){const a=Ck[e];if(a>-1)for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Kv(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},a={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},l=o=>{Fk(o,a,r)};for(let o=0;o<e.length;o+=1)Rb(e.charCodeAt(o),s,l);return t.join("")}function Rk(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Dk(e,t){for(let r=0;r<e.length;r+=1){let a=e.charCodeAt(r);if(a>55295&&a<=56319){const s=(a-55296)*1024&65535;a=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}Rk(a,t)}}function Fk(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let a=1;a<6;a+=1)if((e>>7-a&1)===0){t.utf8seq=a;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Ql(e){const t=[],r={queue:0,queuedBits:0},a=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)Rb(e.charCodeAt(s),r,a);return new Uint8Array(t)}function Mk(e){const t=[];return Dk(e,r=>t.push(r)),new Uint8Array(t)}function Li(e){const t=[],r={queue:0,queuedBits:0},a=s=>{t.push(s)};return e.forEach(s=>Wv(s,r,a)),Wv(null,r,a),t.join("")}function Ik(e){return Math.round(Date.now()/1e3)+e}function Lk(){return Symbol("auth-callback")}const ia=()=>typeof window<"u"&&typeof document<"u",Ai={tested:!1,writable:!1},Db=()=>{if(!ia())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ai.tested)return Ai.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Ai.tested=!0,Ai.writable=!0}catch{Ai.tested=!0,Ai.writable=!1}return Ai.writable};function Bk(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,l)=>{t[l]=s})}catch{}return r.searchParams.forEach((a,s)=>{t[s]=a}),t}const Fb=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Pk=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Wl=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Oi=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},sa=async(e,t)=>{await e.removeItem(t)};class qf{constructor(){this.promise=new qf.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}qf.promiseConstructor=Promise;function k0(e){const t=e.split(".");if(t.length!==3)throw new Vm("Invalid JWT structure");for(let a=0;a<t.length;a++)if(!Tk.test(t[a]))throw new Vm("JWT not in base64url format");return{header:JSON.parse(Kv(t[0])),payload:JSON.parse(Kv(t[1])),signature:Ql(t[2]),raw:{header:t[0],payload:t[1]}}}async function Uk(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function zk(e,t){return new Promise((a,s)=>{(async()=>{for(let l=0;l<1/0;l++)try{const o=await e(l);if(!t(l,null,o)){a(o);return}}catch(o){if(!t(l,o)){s(o);return}}})()})}function Hk(e){return("0"+e.toString(16)).substr(-2)}function qk(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=r.length;let s="";for(let l=0;l<56;l++)s+=r.charAt(Math.floor(Math.random()*a));return s}return crypto.getRandomValues(t),Array.from(t,Hk).join("")}async function $k(e){const r=new TextEncoder().encode(e),a=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(a);return Array.from(s).map(l=>String.fromCharCode(l)).join("")}async function Gk(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await $k(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Il(e,t,r=!1){const a=qk();let s=a;r&&(s+="/PASSWORD_RECOVERY"),await Wl(e,`${t}-code-verifier`,s);const l=await Gk(a);return[l,a===l?"plain":"s256"]}const Vk=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Xk(e){const t=e.headers.get($m);if(!t||!t.match(Vk))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Wk(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function Kk(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Yk=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ll(e){if(!Yk.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function pm(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Jk(e,t){return new Proxy(e,{get:(r,a,s)=>{if(a==="__isInsecureUserWarningProxy")return!0;if(typeof a=="symbol"){const l=a.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,a,s)}return!t.value&&typeof a=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,a,s)}})}function Yv(e){return JSON.parse(JSON.stringify(e))}const Di=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Qk=[502,503,504];async function Jv(e){var t;if(!Pk(e))throw new Gm(Di(e),0);if(Qk.includes(e.status))throw new Gm(Di(e),e.status);let r;try{r=await e.json()}catch(l){throw new Mi(Di(l),l)}let a;const s=Xk(e);if(s&&s.getTime()>=Cb["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?a=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(a=r.error_code),a){if(a==="weak_password")throw new Vv(Di(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(a==="session_not_found")throw new en}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((l,o)=>l&&typeof o=="string",!0))throw new Vv(Di(r),e.status,r.weak_password.reasons);throw new Nk(Di(r),e.status||500,a)}const Zk=(e,t,r,a)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(a),Object.assign(Object.assign({},s),r))};async function ct(e,t,r,a){var s;const l=Object.assign({},a==null?void 0:a.headers);l[$m]||(l[$m]=Cb["2024-01-01"].name),a!=null&&a.jwt&&(l.Authorization=`Bearer ${a.jwt}`);const o=(s=a==null?void 0:a.query)!==null&&s!==void 0?s:{};a!=null&&a.redirectTo&&(o.redirect_to=a.redirectTo);const u=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",h=await e4(e,t,r+u,{headers:l,noResolveJson:a==null?void 0:a.noResolveJson},{},a==null?void 0:a.body);return a!=null&&a.xform?a==null?void 0:a.xform(h):{data:Object.assign({},h),error:null}}async function e4(e,t,r,a,s,l){const o=Zk(t,a,s,l);let u;try{u=await e(r,Object.assign({},o))}catch(h){throw console.error(h),new Gm(Di(h),0)}if(u.ok||await Jv(u),a!=null&&a.noResolveJson)return u;try{return await u.json()}catch(h){await Jv(h)}}function Fn(e){var t;let r=null;a4(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=Ik(e.expires_in)));const a=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:a},error:null}}function Qv(e){const t=Fn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0)&&(t.data.weak_password=e.weak_password),t}function ei(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function t4(e){return{data:e,error:null}}function r4(e){const{action_link:t,email_otp:r,hashed_token:a,redirect_to:s,verification_type:l}=e,o=Uf(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:t,email_otp:r,hashed_token:a,redirect_to:s,verification_type:l},h=Object.assign({},o);return{data:{properties:u,user:h},error:null}}function Zv(e){return e}function a4(e){return e.access_token&&e.refresh_token&&e.expires_in}const gm=["global","local","others"];class n4{constructor({url:t="",headers:r={},fetch:a}){this.url=t,this.headers=r,this.fetch=Fb(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=gm[0]){if(gm.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${gm.join(", ")}`);try{return await ct(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(a){if(Ze(a))return{data:null,error:a};throw a}}async inviteUserByEmail(t,r={}){try{return await ct(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:ei})}catch(a){if(Ze(a))return{data:{user:null},error:a};throw a}}async generateLink(t){try{const{options:r}=t,a=Uf(t,["options"]),s=Object.assign(Object.assign({},a),r);return"newEmail"in a&&(s.new_email=a==null?void 0:a.newEmail,delete s.newEmail),await ct(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:r4,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Ze(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await ct(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:ei})}catch(r){if(Ze(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,a,s,l,o,u,h;try{const d={nextPage:null,lastPage:0,total:0},x=await ct(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(l=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:""},xform:Zv});if(x.error)throw x.error;const g=await x.json(),p=(o=x.headers.get("x-total-count"))!==null&&o!==void 0?o:0,y=(h=(u=x.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&h!==void 0?h:[];return y.length>0&&(y.forEach(w=>{const _=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(w.split(";")[1].split("=")[1]);d[`${S}Page`]=_}),d.total=parseInt(p)),{data:Object.assign(Object.assign({},g),d),error:null}}catch(d){if(Ze(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){Ll(t);try{return await ct(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:ei})}catch(r){if(Ze(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Ll(t);try{return await ct(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:ei})}catch(a){if(Ze(a))return{data:{user:null},error:a};throw a}}async deleteUser(t,r=!1){Ll(t);try{return await ct(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:ei})}catch(a){if(Ze(a))return{data:{user:null},error:a};throw a}}async _listFactors(t){Ll(t.userId);try{const{data:r,error:a}=await ct(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:a}}catch(r){if(Ze(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Ll(t.userId),Ll(t.id);try{return{data:await ct(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Ze(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,a,s,l,o,u,h;try{const d={nextPage:null,lastPage:0,total:0},x=await ct(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(l=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:""},xform:Zv});if(x.error)throw x.error;const g=await x.json(),p=(o=x.headers.get("x-total-count"))!==null&&o!==void 0?o:0,y=(h=(u=x.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&h!==void 0?h:[];return y.length>0&&(y.forEach(w=>{const _=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(w.split(";")[1].split("=")[1]);d[`${S}Page`]=_}),d.total=parseInt(p)),{data:Object.assign(Object.assign({},g),d),error:null}}catch(d){if(Ze(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(t){try{return await ct(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ze(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await ct(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ze(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await ct(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(Ze(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(t){try{return await ct(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ze(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await ct(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ze(r))return{data:null,error:r};throw r}}}function ey(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Bl={debug:!!(globalThis&&Db()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Mb extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class ty extends Mb{}async function s4(e,t,r){Bl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const a=new globalThis.AbortController;t>0&&setTimeout(()=>{a.abort(),Bl.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve();try{return await globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async s=>{if(s){Bl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{Bl.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw Bl.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new ty(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Bl.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}})}catch(s){throw(s==null?void 0:s.name)==="AbortError"?new ty(`Acquiring an exclusive Navigator LockManager lock "${e}" timed out waiting ${t}ms`):s}}function i4(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Ib(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function l4(e){return parseInt(e,16)}function o4(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,a=>a.toString(16).padStart(2,"0")).join("")}function c4(e){var t;const{chainId:r,domain:a,expirationTime:s,issuedAt:l=new Date,nonce:o,notBefore:u,requestId:h,resources:d,scheme:x,uri:g,version:p}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!g)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(p!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${p}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const y=Ib(e.address),w=x?`${x}://${a}`:a,_=e.statement?`${e.statement}
`:"",S=`${w} wants you to sign in with your Ethereum account:
${y}

${_}`;let T=`URI: ${g}
Version: ${p}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${l.toISOString()}`;if(s&&(T+=`
Expiration Time: ${s.toISOString()}`),u&&(T+=`
Not Before: ${u.toISOString()}`),h&&(T+=`
Request ID: ${h}`),d){let N=`
Resources:`;for(const E of d){if(!E||typeof E!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${E}`);N+=`
- ${E}`}T+=N}return`${S}
${T}`}class zr extends Error{constructor({message:t,code:r,cause:a,name:s}){var l;super(t,{cause:a}),this.__isWebAuthnError=!0,this.name=(l=s??(a instanceof Error?a.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=r}}class Sf extends zr{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function u4({error:e,options:t}){var r,a,s;const{publicKey:l}=t;if(!l)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new zr({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=l.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new zr({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((a=l.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new zr({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((s=l.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new zr({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new zr({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new zr({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return l.pubKeyCredParams.filter(u=>u.type==="public-key").length===0?new zr({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new zr({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const o=window.location.hostname;if(Lb(o)){if(l.rp.id!==o)return new zr({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new zr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new zr({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new zr({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new zr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function f4({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new zr({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new zr({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const a=window.location.hostname;if(Lb(a)){if(r.rpId!==a)return new zr({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new zr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new zr({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new zr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class d4{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const h4=new d4;function m4(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:a}=e,s=Uf(e,["challenge","user","excludeCredentials"]),l=Ql(t).buffer,o=Object.assign(Object.assign({},r),{id:Ql(r.id).buffer}),u=Object.assign(Object.assign({},s),{challenge:l,user:o});if(a&&a.length>0){u.excludeCredentials=new Array(a.length);for(let h=0;h<a.length;h++){const d=a[h];u.excludeCredentials[h]=Object.assign(Object.assign({},d),{id:Ql(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return u}function x4(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,a=Uf(e,["challenge","allowCredentials"]),s=Ql(t).buffer,l=Object.assign(Object.assign({},a),{challenge:s});if(r&&r.length>0){l.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const u=r[o];l.allowCredentials[o]=Object.assign(Object.assign({},u),{id:Ql(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function p4(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:Li(new Uint8Array(e.response.attestationObject)),clientDataJSON:Li(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function g4(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,a=e.getClientExtensionResults(),s=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Li(new Uint8Array(s.authenticatorData)),clientDataJSON:Li(new Uint8Array(s.clientDataJSON)),signature:Li(new Uint8Array(s.signature)),userHandle:s.userHandle?Li(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Lb(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function ry(){var e,t;return!!(ia()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function v4(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Sf("Browser returned unexpected credential type",t)}:{data:null,error:new Sf("Empty credential response",t)}}catch(t){return{data:null,error:u4({error:t,options:e})}}}async function y4(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Sf("Browser returned unexpected credential type",t)}:{data:null,error:new Sf("Empty credential response",t)}}catch(t){return{data:null,error:f4({error:t,options:e})}}}const _4={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},b4={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Ef(...e){const t=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),r=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),a={};for(const s of e)if(s)for(const l in s){const o=s[l];if(o!==void 0)if(Array.isArray(o))a[l]=o;else if(r(o))a[l]=o;else if(t(o)){const u=a[l];t(u)?a[l]=Ef(u,o):a[l]=Ef(o)}else a[l]=o}return a}function w4(e,t){return Ef(_4,e,t||{})}function S4(e,t){return Ef(b4,e,t||{})}class E4{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:a,signal:s},l){var o;try{const{data:u,error:h}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!u)return{data:null,error:h};const d=s??h4.createNewAbortSignal();if(u.webauthn.type==="create"){const{user:x}=u.webauthn.credential_options.publicKey;if(!x.name){const g=a;if(g)x.name=`${x.id}:${g}`;else{const y=(await this.client.getUser()).data.user,w=((o=y==null?void 0:y.user_metadata)===null||o===void 0?void 0:o.name)||(y==null?void 0:y.email)||(y==null?void 0:y.id)||"User";x.name=`${x.id}:${w}`}}x.displayName||(x.displayName=x.name)}switch(u.webauthn.type){case"create":{const x=w4(u.webauthn.credential_options.publicKey,l==null?void 0:l.create),{data:g,error:p}=await v4({publicKey:x,signal:d});return g?{data:{factorId:t,challengeId:u.id,webauthn:{type:u.webauthn.type,credential_response:g}},error:null}:{data:null,error:p}}case"request":{const x=S4(u.webauthn.credential_options.publicKey,l==null?void 0:l.request),{data:g,error:p}=await y4(Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:x,signal:d}));return g?{data:{factorId:t,challengeId:u.id,webauthn:{type:u.webauthn.type,credential_response:g}},error:null}:{data:null,error:p}}}}catch(u){return Ze(u)?{data:null,error:u}:{data:null,error:new Mi("Unexpected error in challenge",u)}}}async _verify({challengeId:t,factorId:r,webauthn:a}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:a})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},l){if(!r)return{data:null,error:new Ac("rpId is required for WebAuthn authentication")};try{if(!ry())return{data:null,error:new Mi("Browser does not support WebAuthn",null)};const{data:o,error:u}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:a},signal:s},{request:l});if(!o)return{data:null,error:u};const{webauthn:h}=o;return this._verify({factorId:t,challengeId:o.challengeId,webauthn:{type:h.type,rpId:r,rpOrigins:a,credential_response:h.credential_response}})}catch(o){return Ze(o)?{data:null,error:o}:{data:null,error:new Mi("Unexpected error in authenticate",o)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},l){if(!r)return{data:null,error:new Ac("rpId is required for WebAuthn registration")};try{if(!ry())return{data:null,error:new Mi("Browser does not support WebAuthn",null)};const{data:o,error:u}=await this._enroll({friendlyName:t});if(!o)return await this.client.mfa.listFactors().then(x=>{var g;return(g=x.data)===null||g===void 0?void 0:g.all.find(p=>p.factor_type==="webauthn"&&p.friendly_name===t&&p.status!=="unverified")}).then(x=>x?this.client.mfa.unenroll({factorId:x==null?void 0:x.id}):void 0),{data:null,error:u};const{data:h,error:d}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:a},signal:s},{create:l});return h?this._verify({factorId:o.id,challengeId:h.challengeId,webauthn:{rpId:r,rpOrigins:a,type:h.webauthn.type,credential_response:h.webauthn.credential_response}}):{data:null,error:d}}catch(o){return Ze(o)?{data:null,error:o}:{data:null,error:new Mi("Unexpected error in register",o)}}}}i4();const T4={url:wk,storageKey:Sk,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ek,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4,skipAutoInitialize:!1};async function ay(e,t,r){return await r()}const Pl={};class Oc{get jwks(){var t,r;return(r=(t=Pl[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Pl[this.storageKey]=Object.assign(Object.assign({},Pl[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Pl[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Pl[this.storageKey]=Object.assign(Object.assign({},Pl[this.storageKey]),{cachedAt:t})}constructor(t){var r,a,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const l=Object.assign(Object.assign({},T4),t);if(this.storageKey=l.storageKey,this.instanceID=(r=Oc.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Oc.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.instanceID>0&&ia()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=l.persistSession,this.autoRefreshToken=l.autoRefreshToken,this.admin=new n4({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=Fb(l.fetch),this.lock=l.lock||ay,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,this.throwOnError=l.throwOnError,this.lockAcquireTimeout=l.lockAcquireTimeout,l.lock?this.lock=l.lock:this.persistSession&&ia()&&(!((a=globalThis==null?void 0:globalThis.navigator)===null||a===void 0)&&a.locks)?this.lock=s4:this.lock=ay,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new E4(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:Db()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ey(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=ey(this.memoryStorage)),ia()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o);try{await this._notifyAllSubscribers(o.data.event,o.data.session,!1)}catch(u){this._debug("#broadcastChannel","error",u)}})}l.skipAutoInitialize||this.initialize().catch(o=>{this._debug("#initialize()","error",o)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Ob}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},a="none";if(ia()&&(r=Bk(window.location.href),this._isImplicitGrantCallback(r)?a="implicit":await this._isPKCECallback(r)&&(a="pkce")),ia()&&this.detectSessionInUrl&&a!=="none"){const{data:s,error:l}=await this._getSessionFromURL(r,a);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),Ak(l)){const h=(t=l.details)===null||t===void 0?void 0:t.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:l}}return{error:l}}const{session:o,redirectType:u}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",u),await this._saveSession(o),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Ze(r)?this._returnResult({error:r}):this._returnResult({error:new Mi("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,a,s;try{const l=await ct(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:Fn}),{data:o,error:u}=l;if(u||!o)return this._returnResult({data:{user:null,session:null},error:u});const h=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(l){if(Ze(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(t){var r,a,s;try{let l;if("email"in t){const{email:x,password:g,options:p}=t;let y=null,w=null;this.flowType==="pkce"&&([y,w]=await Il(this.storage,this.storageKey)),l=await ct(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:x,password:g,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:y,code_challenge_method:w},xform:Fn})}else if("phone"in t){const{phone:x,password:g,options:p}=t;l=await ct(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:x,password:g,data:(a=p==null?void 0:p.data)!==null&&a!==void 0?a:{},channel:(s=p==null?void 0:p.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:Fn})}else throw new E0("You must provide either an email or phone number and a password");const{data:o,error:u}=l;if(u||!o)return await sa(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:u});const h=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(l){if(await sa(this.storage,`${this.storageKey}-code-verifier`),Ze(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(t){try{let r;if("email"in t){const{email:l,password:o,options:u}=t;r=await ct(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:o,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken}},xform:Qv})}else if("phone"in t){const{phone:l,password:o,options:u}=t;r=await ct(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:o,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken}},xform:Qv})}else throw new E0("You must provide either an email or phone number and a password");const{data:a,error:s}=r;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!a||!a.session||!a.user){const l=new Ml;return this._returnResult({data:{user:null,session:null},error:l})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:s})}catch(r){if(Ze(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,a,s,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(a=t.options)===null||a===void 0?void 0:a.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,a,s,l,o,u,h,d,x,g,p;let y,w;if("message"in t)y=t.message,w=t.signature;else{const{chain:_,wallet:S,statement:T,options:N}=t;let E;if(ia())if(typeof S=="object")E=S;else{const C=window;if("ethereum"in C&&typeof C.ethereum=="object"&&"request"in C.ethereum&&typeof C.ethereum.request=="function")E=C.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!(N!=null&&N.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=S}const D=new URL((r=N==null?void 0:N.url)!==null&&r!==void 0?r:window.location.href),G=await E.request({method:"eth_requestAccounts"}).then(C=>C).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!G||G.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const V=Ib(G[0]);let A=(a=N==null?void 0:N.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!A){const C=await E.request({method:"eth_chainId"});A=l4(C)}const M={domain:D.host,address:V,statement:T,uri:D.href,version:"1",chainId:A,nonce:(s=N==null?void 0:N.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(o=(l=N==null?void 0:N.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(u=N==null?void 0:N.signInWithEthereum)===null||u===void 0?void 0:u.expirationTime,notBefore:(h=N==null?void 0:N.signInWithEthereum)===null||h===void 0?void 0:h.notBefore,requestId:(d=N==null?void 0:N.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(x=N==null?void 0:N.signInWithEthereum)===null||x===void 0?void 0:x.resources};y=c4(M),w=await E.request({method:"personal_sign",params:[o4(y),V]})}try{const{data:_,error:S}=await ct(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:y,signature:w},!((g=t.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Fn});if(S)throw S;if(!_||!_.session||!_.user){const T=new Ml;return this._returnResult({data:{user:null,session:null},error:T})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:S})}catch(_){if(Ze(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signInWithSolana(t){var r,a,s,l,o,u,h,d,x,g,p,y;let w,_;if("message"in t)w=t.message,_=t.signature;else{const{chain:S,wallet:T,statement:N,options:E}=t;let D;if(ia())if(typeof T=="object")D=T;else{const V=window;if("solana"in V&&typeof V.solana=="object"&&("signIn"in V.solana&&typeof V.solana.signIn=="function"||"signMessage"in V.solana&&typeof V.solana.signMessage=="function"))D=V.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof T!="object"||!(E!=null&&E.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");D=T}const G=new URL((r=E==null?void 0:E.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in D&&D.signIn){const V=await D.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},E==null?void 0:E.signInWithSolana),{version:"1",domain:G.host,uri:G.href}),N?{statement:N}:null));let A;if(Array.isArray(V)&&V[0]&&typeof V[0]=="object")A=V[0];else if(V&&typeof V=="object"&&"signedMessage"in V&&"signature"in V)A=V;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in A&&"signature"in A&&(typeof A.signedMessage=="string"||A.signedMessage instanceof Uint8Array)&&A.signature instanceof Uint8Array)w=typeof A.signedMessage=="string"?A.signedMessage:new TextDecoder().decode(A.signedMessage),_=A.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in D)||typeof D.signMessage!="function"||!("publicKey"in D)||typeof D!="object"||!D.publicKey||!("toBase58"in D.publicKey)||typeof D.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${G.host} wants you to sign in with your Solana account:`,D.publicKey.toBase58(),...N?["",N,""]:[""],"Version: 1",`URI: ${G.href}`,`Issued At: ${(s=(a=E==null?void 0:E.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((l=E==null?void 0:E.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${E.signInWithSolana.notBefore}`]:[],...!((o=E==null?void 0:E.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${E.signInWithSolana.expirationTime}`]:[],...!((u=E==null?void 0:E.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${E.signInWithSolana.chainId}`]:[],...!((h=E==null?void 0:E.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${E.signInWithSolana.nonce}`]:[],...!((d=E==null?void 0:E.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${E.signInWithSolana.requestId}`]:[],...!((g=(x=E==null?void 0:E.signInWithSolana)===null||x===void 0?void 0:x.resources)===null||g===void 0)&&g.length?["Resources",...E.signInWithSolana.resources.map(A=>`- ${A}`)]:[]].join(`
`);const V=await D.signMessage(new TextEncoder().encode(w),"utf8");if(!V||!(V instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=V}}try{const{data:S,error:T}=await ct(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:Li(_)},!((p=t.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(y=t.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:Fn});if(T)throw T;if(!S||!S.session||!S.user){const N=new Ml;return this._returnResult({data:{user:null,session:null},error:N})}return S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),this._returnResult({data:Object.assign({},S),error:T})}catch(S){if(Ze(S))return this._returnResult({data:{user:null,session:null},error:S});throw S}}async _exchangeCodeForSession(t){const r=await Oi(this.storage,`${this.storageKey}-code-verifier`),[a,s]=(r??"").split("/");try{if(!a&&this.flowType==="pkce")throw new Ok;const{data:l,error:o}=await ct(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:a},xform:Fn});if(await sa(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!l||!l.session||!l.user){const u=new Ml;return this._returnResult({data:{user:null,session:null,redirectType:null},error:u})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:s??null}),error:o})}catch(l){if(await sa(this.storage,`${this.storageKey}-code-verifier`),Ze(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(t){try{const{options:r,provider:a,token:s,access_token:l,nonce:o}=t,u=await ct(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:s,access_token:l,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Fn}),{data:h,error:d}=u;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!h||!h.session||!h.user){const x=new Ml;return this._returnResult({data:{user:null,session:null},error:x})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:h,error:d})}catch(r){if(Ze(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,a,s,l,o;try{if("email"in t){const{email:u,options:h}=t;let d=null,x=null;this.flowType==="pkce"&&([d,x]=await Il(this.storage,this.storageKey));const{error:g}=await ct(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},create_user:(a=h==null?void 0:h.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:d,code_challenge_method:x},redirectTo:h==null?void 0:h.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:g})}if("phone"in t){const{phone:u,options:h}=t,{data:d,error:x}=await ct(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(s=h==null?void 0:h.data)!==null&&s!==void 0?s:{},create_user:(l=h==null?void 0:h.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},channel:(o=h==null?void 0:h.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:x})}throw new E0("You must provide either an email or phone number.")}catch(u){if(await sa(this.storage,`${this.storageKey}-code-verifier`),Ze(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async verifyOtp(t){var r,a;try{let s,l;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,l=(a=t.options)===null||a===void 0?void 0:a.captchaToken);const{data:o,error:u}=await ct(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:s,xform:Fn});if(u)throw u;if(!o)throw new Error("An error occurred on token verification.");const h=o.session,d=o.user;return h!=null&&h.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(s){if(Ze(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(t){var r,a,s,l,o;try{let u=null,h=null;this.flowType==="pkce"&&([u,h]=await Il(this.storage,this.storageKey));const d=await ct(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&a!==void 0?a:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:u,code_challenge_method:h}),headers:this.headers,xform:t4});return!((l=d.data)===null||l===void 0)&&l.url&&ia()&&!(!((o=t.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(u){if(await sa(this.storage,`${this.storageKey}-code-verifier`),Ze(u))return this._returnResult({data:null,error:u});throw u}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;if(a)throw a;if(!r)throw new en;const{error:s}=await ct(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(t){if(Ze(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:a,type:s,options:l}=t,{error:o}=await ct(this.fetch,"POST",r,{headers:this.headers,body:{email:a,type:s,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in t){const{phone:a,type:s,options:l}=t,{data:o,error:u}=await ct(this.fetch,"POST",r,{headers:this.headers,body:{phone:a,type:s,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:u})}throw new E0("You must provide either an email or phone number and a type")}catch(r){if(Ze(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await a,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=r();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Oi(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const a=t.expires_at?t.expires_at*1e3-Date.now()<hm:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",t.expires_at),!a){if(this.userStorage){const o=await Oi(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=pm()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};t.user=Jk(t.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:s,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await ct(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:ei}):await this._useSession(async r=>{var a,s,l;const{data:o,error:u}=r;if(u)throw u;return!(!((a=o.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new en}:await ct(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&l!==void 0?l:void 0,xform:ei})})}catch(r){if(Ze(r))return mm(r)&&(await this._removeSession(),await sa(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async a=>{const{data:s,error:l}=a;if(l)throw l;if(!s.session)throw new en;const o=s.session;let u=null,h=null;this.flowType==="pkce"&&t.email!=null&&([u,h]=await Il(this.storage,this.storageKey));const{data:d,error:x}=await ct(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:u,code_challenge_method:h}),jwt:o.access_token,xform:ei});if(x)throw x;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(a){if(await sa(this.storage,`${this.storageKey}-code-verifier`),Ze(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new en;const r=Date.now()/1e3;let a=r,s=!0,l=null;const{payload:o}=k0(t.access_token);if(o.exp&&(a=o.exp,s=a<=r),s){const{data:u,error:h}=await this._callRefreshToken(t.refresh_token);if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!u)return{data:{user:null,session:null},error:null};l=u}else{const{data:u,error:h}=await this._getUser(t.access_token);if(h)return this._returnResult({data:{user:null,session:null},error:h});l={access_token:t.access_token,refresh_token:t.refresh_token,user:u.user,token_type:"bearer",expires_in:a-r,expires_at:a},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(r){if(Ze(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var a;if(!t){const{data:o,error:u}=r;if(u)throw u;t=(a=o.session)!==null&&a!==void 0?a:void 0}if(!(t!=null&&t.refresh_token))throw new en;const{data:s,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Ze(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!ia())throw new T0("No browser detected.");if(t.error||t.error_description||t.error_code)throw new T0(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Gv("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new T0("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Gv("No code detected.");const{data:N,error:E}=await this._exchangeCodeForSession(t.code);if(E)throw E;const D=new URL(window.location.href);return D.searchParams.delete("code"),window.history.replaceState(window.history.state,"",D.toString()),{data:{session:N.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:s,access_token:l,refresh_token:o,expires_in:u,expires_at:h,token_type:d}=t;if(!l||!u||!o||!d)throw new T0("No session defined in URL");const x=Math.round(Date.now()/1e3),g=parseInt(u);let p=x+g;h&&(p=parseInt(h));const y=p-x;y*1e3<=Xl&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${y}s, should have been closer to ${g}s`);const w=p-g;x-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,p,x):x-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,p,x);const{data:_,error:S}=await this._getUser(l);if(S)throw S;const T={provider_token:a,provider_refresh_token:s,access_token:l,expires_in:g,expires_at:p,refresh_token:o,token_type:d,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:T,redirectType:t.type},error:null})}catch(a){if(Ze(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Oi(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var a;const{data:s,error:l}=r;if(l&&!mm(l))return this._returnResult({error:l});const o=(a=s.session)===null||a===void 0?void 0:a.access_token;if(o){const{error:u}=await this.admin.signOut(o,t);if(u&&!(jk(u)&&(u.status===404||u.status===401||u.status===403)||mm(u)))return this._returnResult({error:u})}return t!=="others"&&(await this._removeSession(),await sa(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=Lk(),a={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,a),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:a}}}async _emitInitialSession(t){return await this._useSession(async r=>{var a,s;try{const{data:{session:l},error:o}=r;if(o)throw o;await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,r={}){let a=null,s=null;this.flowType==="pkce"&&([a,s]=await Il(this.storage,this.storageKey,!0));try{return await ct(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:a,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(l){if(await sa(this.storage,`${this.storageKey}-code-verifier`),Ze(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var t;try{const{data:r,error:a}=await this.getUser();if(a)throw a;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Ze(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:a,error:s}=await this._useSession(async l=>{var o,u,h,d,x;const{data:g,error:p}=l;if(p)throw p;const y=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(u=t.options)===null||u===void 0?void 0:u.scopes,queryParams:(h=t.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await ct(this.fetch,"GET",y,{headers:this.headers,jwt:(x=(d=g.session)===null||d===void 0?void 0:d.access_token)!==null&&x!==void 0?x:void 0})});if(s)throw s;return ia()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(a==null?void 0:a.url),this._returnResult({data:{provider:t.provider,url:a==null?void 0:a.url},error:null})}catch(a){if(Ze(a))return this._returnResult({data:{provider:t.provider,url:null},error:a});throw a}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var a;try{const{error:s,data:{session:l}}=r;if(s)throw s;const{options:o,provider:u,token:h,access_token:d,nonce:x}=t,g=await ct(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=l==null?void 0:l.access_token)!==null&&a!==void 0?a:void 0,body:{provider:u,id_token:h,access_token:d,nonce:x,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Fn}),{data:p,error:y}=g;return y?this._returnResult({data:{user:null,session:null},error:y}):!p||!p.session||!p.user?this._returnResult({data:{user:null,session:null},error:new Ml}):(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("USER_UPDATED",p.session)),this._returnResult({data:p,error:y}))}catch(s){if(await sa(this.storage,`${this.storageKey}-code-verifier`),Ze(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var a,s;const{data:l,error:o}=r;if(o)throw o;return await ct(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(Ze(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const a=Date.now();return await zk(async s=>(s>0&&await Uk(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await ct(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Fn})),(s,l)=>{const o=200*Math.pow(2,s);return l&&xm(l)&&Date.now()+o-a<Xl})}catch(a){if(this._debug(r,"error",a),Ze(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const a=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",a),ia()&&!r.skipBrowserRedirect&&window.location.assign(a),{data:{provider:t,url:a},error:null}}async _recoverAndRefresh(){var t,r;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const s=await Oi(this.storage,this.storageKey);if(s&&this.userStorage){let o=await Oi(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await Wl(this.userStorage,this.storageKey+"-user",o)),s.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:pm()}else if(s&&!s.user&&!s.user){const o=await Oi(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(s.user=o.user,await sa(this.storage,this.storageKey+"-user"),await Wl(this.storage,this.storageKey,s)):s.user=pm()}if(this._debug(a,"session from storage",s),!this._isValidSession(s)){this._debug(a,"session is not valid"),s!==null&&await this._removeSession();return}const l=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<hm;if(this._debug(a,`session has${l?"":" not"} expired with margin of ${hm}s`),l){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),xm(o)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:u}=await this._getUser(s.access_token);!u&&(o!=null&&o.user)?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(a,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(a,"error",s),console.error(s);return}finally{this._debug(a,"end")}}async _callRefreshToken(t){var r,a;if(!t)throw new en;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new qf;const{data:l,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!l.session)throw new en;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const u={data:l.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(l){if(this._debug(s,"error",l),Ze(l)){const o={data:null,error:l};return xm(l)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(l),l}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,a=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:t,session:r});const l=[],o=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(t,r)}catch(h){l.push(h)}});if(await Promise.all(o),l.length>0){for(let u=0;u<l.length;u+=1)console.error(l[u]);throw l[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await sa(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),a=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&r.user&&await Wl(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const l=Yv(s);await Wl(this.storage,this.storageKey,l)}else{const s=Yv(r);await Wl(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await sa(this.storage,this.storageKey),await sa(this.storage,this.storageKey+"-code-verifier"),await sa(this.storage,this.storageKey+"-user"),this.userStorage&&await sa(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ia()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Xl);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:a}}=r;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((a.expires_at*1e3-t)/Xl);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Xl}ms, refresh threshold is ${qm} ticks`),s<=qm&&await this._callRefreshToken(a.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Mb)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ia()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(t){this._debug("#visibilityChangedCallback","error",t)}},window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,a){const s=[`provider=${encodeURIComponent(r)}`];if(a!=null&&a.redirectTo&&s.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a!=null&&a.scopes&&s.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[l,o]=await Il(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(u.toString())}if(a!=null&&a.queryParams){const l=new URLSearchParams(a.queryParams);s.push(l.toString())}return a!=null&&a.skipBrowserRedirect&&s.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var a;const{data:s,error:l}=r;return l?this._returnResult({data:null,error:l}):await ct(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(a=s==null?void 0:s.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(Ze(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var a,s;const{data:l,error:o}=r;if(o)return this._returnResult({data:null,error:o});const u=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:h,error:d}=await ct(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(a=l==null?void 0:l.session)===null||a===void 0?void 0:a.access_token});return d?this._returnResult({data:null,error:d}):(t.factorType==="totp"&&h.type==="totp"&&(!((s=h==null?void 0:h.totp)===null||s===void 0)&&s.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),this._returnResult({data:h,error:null}))})}catch(r){if(Ze(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var a;const{data:s,error:l}=r;if(l)return this._returnResult({data:null,error:l});const o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?p4(t.webauthn.credential_response):g4(t.webauthn.credential_response)})}:{code:t.code}),{data:u,error:h}=await ct(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:(a=s==null?void 0:s.session)===null||a===void 0?void 0:a.access_token});return h?this._returnResult({data:null,error:h}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),this._returnResult({data:u,error:h}))})}catch(r){if(Ze(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var a;const{data:s,error:l}=r;if(l)return this._returnResult({data:null,error:l});const o=await ct(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(a=s==null?void 0:s.session)===null||a===void 0?void 0:a.access_token});if(o.error)return o;const{data:u}=o;if(u.type!=="webauthn")return{data:u,error:null};switch(u.webauthn.type){case"create":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:m4(u.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:x4(u.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Ze(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:a}=await this._challenge({factorId:t.factorId});return a?this._returnResult({data:null,error:a}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:a}=await this.getUser();if(a)return{data:null,error:a};const s={all:[],phone:[],totp:[],webauthn:[]};for(const l of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])s.all.push(l),l.status==="verified"&&s[l.factor_type].push(l);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(t){var r,a,s,l;if(t)try{const{payload:y}=k0(t);let w=null;y.aal&&(w=y.aal);let _=w;const{data:{user:S},error:T}=await this.getUser(t);if(T)return this._returnResult({data:null,error:T});((a=(r=S==null?void 0:S.factors)===null||r===void 0?void 0:r.filter(D=>D.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(_="aal2");const E=y.amr||[];return{data:{currentLevel:w,nextLevel:_,currentAuthenticationMethods:E},error:null}}catch(y){if(Ze(y))return this._returnResult({data:null,error:y});throw y}const{data:{session:o},error:u}=await this.getSession();if(u)return this._returnResult({data:null,error:u});if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:h}=k0(o.access_token);let d=null;h.aal&&(d=h.aal);let x=d;((l=(s=o.user.factors)===null||s===void 0?void 0:s.filter(y=>y.status==="verified"))!==null&&l!==void 0?l:[]).length>0&&(x="aal2");const p=h.amr||[];return{data:{currentLevel:d,nextLevel:x,currentAuthenticationMethods:p},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:a},error:s}=r;return s?this._returnResult({data:null,error:s}):a?await ct(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:a.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new en})})}catch(r){if(Ze(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async a=>{const{data:{session:s},error:l}=a;if(l)return this._returnResult({data:null,error:l});if(!s)return this._returnResult({data:null,error:new en});const o=await ct(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:u=>({data:u,error:null})});return o.data&&o.data.redirect_url&&ia()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(a){if(Ze(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(t,r){try{return await this._useSession(async a=>{const{data:{session:s},error:l}=a;if(l)return this._returnResult({data:null,error:l});if(!s)return this._returnResult({data:null,error:new en});const o=await ct(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:u=>({data:u,error:null})});return o.data&&o.data.redirect_url&&ia()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(a){if(Ze(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;return a?this._returnResult({data:null,error:a}):r?await ct(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new en})})}catch(t){if(Ze(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:a},error:s}=r;return s?this._returnResult({data:null,error:s}):a?(await ct(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:a.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new en})})}catch(r){if(Ze(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let a=r.keys.find(u=>u.kid===t);if(a)return a;const s=Date.now();if(a=this.jwks.keys.find(u=>u.kid===t),a&&this.jwks_cached_at+kk>s)return a;const{data:l,error:o}=await ct(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=s,a=l.keys.find(u=>u.kid===t),!a)?null:a}async getClaims(t,r={}){try{let a=t;if(!a){const{data:y,error:w}=await this.getSession();if(w||!y.session)return this._returnResult({data:null,error:w});a=y.session.access_token}const{header:s,payload:l,signature:o,raw:{header:u,payload:h}}=k0(a);r!=null&&r.allowExpired||Wk(l.exp);const d=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!d){const{error:y}=await this.getUser(a);if(y)throw y;return{data:{claims:l,header:s,signature:o},error:null}}const x=Kk(s.alg),g=await crypto.subtle.importKey("jwk",d,x,!0,["verify"]);if(!await crypto.subtle.verify(x,g,o,Mk(`${u}.${h}`)))throw new Vm("Invalid JWT signature");return{data:{claims:l,header:s,signature:o},error:null}}catch(a){if(Ze(a))return this._returnResult({data:null,error:a});throw a}}}Oc.nextInstanceID={};const k4=Oc,N4="2.97.0";let fc="";typeof Deno<"u"?fc="deno":typeof document<"u"?fc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?fc="react-native":fc="node";const j4={"X-Client-Info":`supabase-js-${fc}/${N4}`},A4={headers:j4},O4={schema:"public"},C4={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},R4={};function Cc(e){"@babel/helpers - typeof";return Cc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cc(e)}function D4(e,t){if(Cc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Cc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function F4(e){var t=D4(e,"string");return Cc(t)=="symbol"?t:t+""}function M4(e,t,r){return(t=F4(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ny(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Tr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ny(Object(r),!0).forEach(function(a){M4(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ny(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}const I4=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),L4=()=>Headers,B4=(e,t,r)=>{const a=I4(r),s=L4();return async(l,o)=>{var u;const h=(u=await t())!==null&&u!==void 0?u:e;let d=new s(o==null?void 0:o.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${h}`),a(l,Tr(Tr({},o),{},{headers:d}))}};function P4(e){return e.endsWith("/")?e:e+"/"}function U4(e,t){var r,a;const{db:s,auth:l,realtime:o,global:u}=e,{db:h,auth:d,realtime:x,global:g}=t,p={db:Tr(Tr({},h),s),auth:Tr(Tr({},d),l),realtime:Tr(Tr({},x),o),storage:{},global:Tr(Tr(Tr({},g),u),{},{headers:Tr(Tr({},(r=g==null?void 0:g.headers)!==null&&r!==void 0?r:{}),(a=u==null?void 0:u.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return e.accessToken?p.accessToken=e.accessToken:delete p.accessToken,p}function z4(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(P4(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var H4=class extends k4{constructor(e){super(e)}},q4=class{constructor(e,t,r){var a,s;this.supabaseUrl=e,this.supabaseKey=t;const l=z4(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const o=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:O4,realtime:R4,auth:Tr(Tr({},C4),{},{storageKey:o}),global:A4},h=U4(r??{},u);if(this.storageKey=(a=h.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=h.global.headers)!==null&&s!==void 0?s:{},h.accessToken)this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(x,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}});else{var d;this.auth=this._initSupabaseAuthClient((d=h.auth)!==null&&d!==void 0?d:{},this.headers,h.global.fetch)}this.fetch=B4(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Tr({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(x=>this.realtime.setAuth(x)).catch(x=>console.warn("Failed to set initial Realtime auth token:",x)),this.rest=new jT(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch,timeout:h.db.timeout,urlLengthLimit:h.db.urlLengthLimit}),this.storage=new bk(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new _T(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:a}=await e.auth.getSession();return(t=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:s,storageKey:l,flowType:o,lock:u,debug:h,throwOnError:d},x,g){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new H4({url:this.authUrl.href,headers:Tr(Tr({},p),x),storageKey:l,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:s,flowType:o,lock:u,debug:h,throwOnError:d,fetch:g,hasCustomAuthorizationHeader:Object.keys(this.headers).some(y=>y.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new GT(this.realtimeUrl.href,Tr(Tr({},e),{},{params:Tr(Tr({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const $4=(e,t,r)=>new q4(e,t,r);function G4(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}G4()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const V4="https://zbvqycapnwrwetunwtqi.supabase.co",X4="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpidnF5Y2Fwbndyd2V0dW53dHFpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg4MzQzNDQsImV4cCI6MjA4NDQxMDM0NH0.X4bewSYGuWDlr0VXbRNojg0ARhOTwhd609dshHOM50U",Te=$4(V4,X4),Xe={getUserProfile:async e=>{const{data:t,error:r}=await Te.from("profiles").select("*").eq("id",e).single();return r||!t?null:{id:t.id,username:t.username||t.email,name:t.name,role:t.role,teamName:t.team_name,projectId:t.project_id,reportsTo:t.reports_to}},login:async(e,t)=>{const r=e?e.trim().toLowerCase():"",a=t?t.trim():"";return(r==="admin"||r==="admin@smartkpis.com")&&a==="admin"?(console.log("Logged in via Master Fallback"),{id:"master-admin-id",username:"admin",name:"System Administrator",role:"super_admin",projectId:void 0}):r==="power"&&a==="power"?{id:"power-admin-id",username:"power",name:"Power Administrator",role:"power_admin"}:null},getAllProjectManagers:async()=>{const{data:e}=await Te.from("profiles").select("*").eq("role","project_manager");return(e||[]).map(t=>({id:t.id,username:t.username||t.email,name:t.name,role:t.role,projectId:t.project_id,reportsTo:t.reports_to}))},getUsers:async e=>{let t=Te.from("profiles").select("*");e&&e!=="all"&&(t=t.eq("project_id",e));const{data:r,error:a}=await t;return a?(console.error("Error fetching users:",a),[]):(r||[]).map(s=>({id:s.id,username:s.username||s.email,name:s.name,role:s.role,teamName:s.team_name,projectId:s.project_id,reportsTo:s.reports_to}))},saveUser:async e=>{const t={id:e.id,name:e.name,role:e.role,project_id:e.projectId,team_name:e.teamName,reports_to:e.reportsTo,username:e.username,email:e.username.includes("@")?e.username:void 0},{error:r}=await Te.from("profiles").upsert(t);return r?{success:!1,error:r.message}:{success:!0}},deleteUser:async e=>{const{error:t}=await Te.from("profiles").delete().eq("id",e);return!t},getProjects:async()=>{const{data:e}=await Te.from("projects").select("*");return(e||[]).map(t=>({id:t.id,name:t.name,location:t.location,pmId:t.pm_id,createdAt:t.created_at}))},getProjectsByPM:async e=>{const{data:t}=await Te.from("projects").select("*").eq("pm_id",e);return(t||[]).map(r=>({id:r.id,name:r.name,location:r.location,pmId:r.pm_id,createdAt:r.created_at}))},assignProjectsToPM:async(e,t)=>{if(await Te.from("projects").update({pm_id:null}).eq("pm_id",e),t.length>0){const{error:r}=await Te.from("projects").update({pm_id:e}).in("id",t);if(r)return!1}return!0},createProject:async(e,t)=>{const{data:r,error:a}=await Te.from("projects").insert({name:e,location:t}).select().single();return a||!r?null:{id:r.id,name:r.name,location:r.location,pmId:r.pm_id,createdAt:r.created_at}},updateProject:async(e,t,r,a)=>{const s={name:t,location:r};a&&(s.pm_id=a);const{error:l}=await Te.from("projects").update(s).eq("id",e);return!l},deleteProject:async e=>{const{error:t}=await Te.from("projects").delete().eq("id",e);return!t},getPMDashboardSummary:async e=>{const t=await Xe.getProjectsByPM(e),r=[];for(const a of t){const{count:s}=await Te.from("profiles").select("*",{count:"exact",head:!0}).eq("project_id",a.id).eq("role","supervisor"),{count:l}=await Te.from("unlock_requests").select("*",{count:"exact",head:!0}).eq("project_id",a.id).eq("status","pending"),{count:o}=await Te.from("assets").select("*",{count:"exact",head:!0}).eq("project_id",a.id),{count:u}=await Te.from("maintenance_requests").select("*",{count:"exact",head:!0}).eq("project_id",a.id).eq("status","pending");r.push({projectId:a.id,siteName:a.name,location:a.location,supervisorCount:s||0,pendingRequestsCount:l||0,assetsMaintenanceCount:(o||0)+(u||0)})}return r},getOperators:async e=>{let t=Te.from("operators").select("*");e&&e!=="all"&&(t=t.eq("project_id",e));const{data:r}=await t;return(r||[]).map(a=>({id:a.id,name:a.name,phone:a.phone,supervisorId:a.supervisor_id,projectId:a.project_id}))},getOperatorsBySupervisor:async e=>{const{data:t}=await Te.from("operators").select("*").eq("supervisor_id",e);return(t||[]).map(r=>({id:r.id,name:r.name,phone:r.phone,supervisorId:r.supervisor_id,projectId:r.project_id}))},saveOperators:async e=>{const t=e.map(r=>({id:r.id.includes("op-")?void 0:r.id,name:r.name,phone:r.phone,supervisor_id:r.supervisorId,project_id:r.projectId}));await Te.from("operators").upsert(t)},updateOperatorsSupervisor:async(e,t)=>{await Te.from("operators").update({supervisor_id:t}).in("id",e)},deleteOperators:async e=>{await Te.from("operators").delete().in("id",e)},getLogs:async(e,t)=>{let r=Te.from("kpi_logs").select("*");e&&e!=="all"&&(r=r.eq("project_id",e)),t&&(r=r.eq("status",t));const{data:a}=await r;return(a||[]).map(s=>({id:s.id,operatorId:s.operator_id,supervisorId:s.supervisor_id,projectId:s.project_id,date:s.date,attitude:s.attitude,performance:s.performance,quality:s.quality,appearance:s.appearance,dailyVolume:s.daily_volume,status:s.status,timestamp:s.timestamp}))},getLogsByDateAndSupervisor:async(e,t)=>{const{data:r}=await Te.from("kpi_logs").select("*").eq("date",e).eq("supervisor_id",t);return(r||[]).map(a=>({id:a.id,operatorId:a.operator_id,supervisorId:a.supervisor_id,projectId:a.project_id,date:a.date,attitude:a.attitude,performance:a.performance,quality:a.quality,appearance:a.appearance,dailyVolume:a.daily_volume,status:a.status,timestamp:a.timestamp}))},getLogsByMonth:async(e,t,r)=>{const a=new Date(t,e,1).toISOString().split("T")[0],s=new Date(t,e+1,0).toISOString().split("T")[0],{data:l}=await Te.from("kpi_logs").select("*").eq("supervisor_id",r).gte("date",a).lte("date",s);return(l||[]).map(o=>({id:o.id,operatorId:o.operator_id,supervisorId:o.supervisor_id,projectId:o.project_id,date:o.date,attitude:o.attitude,performance:o.performance,quality:o.quality,appearance:o.appearance,dailyVolume:o.daily_volume,status:o.status,timestamp:o.timestamp}))},saveLogs:async e=>{const t=e.map(a=>({id:a.id,operator_id:a.operatorId,supervisor_id:a.supervisorId,project_id:a.projectId,date:a.date,attitude:a.attitude,performance:a.performance,quality:a.quality,appearance:a.appearance,status:"pending",timestamp:a.timestamp})),{error:r}=await Te.from("kpi_logs").upsert(t);return r?{success:!1,error:r.message}:{success:!0}},updateLogStatus:async(e,t)=>{const{error:r}=await Te.from("kpi_logs").update({status:t}).in("id",e);return!r},getTeamStats:async(e,t)=>{const{data:r}=await Te.from("team_stats").select("*").eq("supervisor_id",e).eq("date",t).single();return r?{id:r.id,supervisorId:r.supervisor_id,projectId:r.project_id,date:r.date,volume:r.volume}:null},saveTeamStats:async e=>{const t={supervisor_id:e.supervisorId,project_id:e.projectId,date:e.date,volume:e.volume},{error:r}=await Te.from("team_stats").upsert(t);return r?{success:!1,error:r.message}:{success:!0}},getUnlockRequests:async(e,t,r)=>{let a=Te.from("unlock_requests").select("*");e&&e!=="all"&&(a=a.eq("project_id",e)),t&&(a=a.eq("supervisor_id",t)),r&&(a=a.eq("status",r));const{data:s}=await a;return(s||[]).map(l=>({id:l.id,operatorId:l.operator_id,operatorName:l.operator_name,supervisorId:l.supervisor_id,supervisorName:l.supervisor_name,projectId:l.project_id,logId:l.log_id,date:l.date,status:l.status,reason:l.reason,createdAt:l.created_at}))},createUnlockRequest:async(e,t,r,a,s,l,o)=>{const u={operator_id:e,operator_name:t,supervisor_id:r,supervisor_name:a,project_id:s,log_id:o,date:new Date().toISOString().split("T")[0],reason:l,status:"pending"},{error:h}=await Te.from("unlock_requests").insert(u);return h?{success:!1,error:h.message}:{success:!0}},approveUnlockRequest:async(e,t,r,a)=>{a?await Te.from("kpi_logs").delete().eq("id",a):await Te.from("kpi_logs").delete().eq("operator_id",t).eq("date",r);const{error:s}=await Te.from("unlock_requests").update({status:"approved"}).eq("id",e);return!s},rejectUnlockRequest:async(e,t,r)=>{const{error:a}=await Te.from("unlock_requests").update({status:"rejected"}).eq("id",e);return a?{success:!1,error:a.message}:{success:!0}},getAssets:async e=>{let t=Te.from("assets").select("*");e&&e!=="all"&&(t=t.eq("project_id",e));const{data:r}=await t;return(r||[]).map(a=>({id:a.id,assetTag:a.asset_tag,name:a.name,type:a.type,status:a.status,serialNumber:a.serial_number,macAddress:a.mac_address,cpu:a.cpu,ram:a.ram,storage:a.storage,currentCounter:a.current_counter,purchaseDate:a.purchase_date,cost:a.cost,projectId:a.project_id,physicalLocation:a.location,assignedUser:a.assigned_user,department:a.department,lastMaintenanceDate:a.last_maintenance_date,imageUrl:a.image_url,lastAuditDate:a.last_audit_date,auditedBy:a.audited_by}))},getNextAssetTag:async()=>{const e=new Date().getFullYear().toString(),{data:t,error:r}=await Te.rpc("generate_next_asset_tag",{year_prefix:e});return r?(console.error("Error generating asset tag:",r),""):t},createAsset:async e=>{const t={asset_tag:e.assetTag,name:e.name,type:e.type,status:e.status,serial_number:e.serialNumber,project_id:e.projectId,location:e.physicalLocation,assigned_user:e.assignedUser,department:e.department,purchase_date:e.purchaseDate,cost:e.cost,last_maintenance_date:e.lastMaintenanceDate,cpu:e.cpu,ram:e.ram,storage:e.storage,current_counter:e.currentCounter},{error:r}=await Te.from("assets").insert(t);return r?{success:!1,error:r.message}:{success:!0}},registerAssetsBulk:async(e,t,r)=>{const a=new Date().getFullYear().toString(),{data:s,error:l}=await Te.rpc("register_assets_bulk",{assets_data:e,year_prefix:a,project_id_input:t,user_id_input:r});return l?(console.error("Bulk Registration Error:",l),{success:!1,error:l.message}):{success:!0,data:s}},updateAsset:async e=>{const t={asset_tag:e.assetTag,name:e.name,type:e.type,status:e.status,serial_number:e.serialNumber,project_id:e.projectId,location:e.physicalLocation,assigned_user:e.assignedUser,department:e.department,purchase_date:e.purchaseDate,cost:e.cost,last_maintenance_date:e.lastMaintenanceDate,cpu:e.cpu,ram:e.ram,storage:e.storage,current_counter:e.currentCounter},{error:r}=await Te.from("assets").update(t).eq("id",e.id);return r?{success:!1,error:r.message}:{success:!0}},bulkUpdateAssets:async(e,t)=>{try{const r={};t.status&&(r.status=t.status),t.projectId&&(r.project_id=t.projectId),t.lastAuditDate&&(r.last_audit_date=t.lastAuditDate),t.auditedBy&&(r.audited_by=t.auditedBy),t.assignedUser&&(r.assigned_user=t.assignedUser),t.physicalLocation&&(r.location=t.physicalLocation);const{error:a}=await Te.from("assets").update(r).in("id",e);return a?{success:!1,error:a.message}:{success:!0}}catch(r){return{success:!1,error:r.message}}},verifyAsset:async(e,t)=>{const{error:r}=await Te.from("assets").update({last_audit_date:new Date().toISOString(),audited_by:t}).eq("id",e);return r?{success:!1,error:r.message}:{success:!0}},deleteAssets:async e=>{try{await Te.from("maintenance_requests").delete().in("asset_id",e),await Te.from("tickets").delete().in("assetid",e);const{error:t}=await Te.from("assets").delete().in("id",e);return t?{success:!1,error:t.message}:{success:!0}}catch(t){return{success:!1,error:t.message}}},getMaintenanceRequests:async(e,t)=>{let r=Te.from("maintenance_requests").select("*, assets(name), profiles!supervisor_id(name)");e&&e!=="all"&&(r=r.eq("project_id",e)),t&&(r=r.eq("status",t));const{data:a}=await r;return(a||[]).map(s=>{var l,o;return{id:s.id,assetId:s.asset_id,supervisorId:s.supervisor_id,projectId:s.project_id,priority:s.priority,description:s.description,status:s.status,createdAt:s.created_at,assetName:((l=s.assets)==null?void 0:l.name)||"Unknown",supervisorName:((o=s.profiles)==null?void 0:o.name)||"Unknown"}})},createMaintenanceRequest:async e=>{const t={asset_id:e.assetId,supervisor_id:e.supervisorId,project_id:e.projectId,priority:e.priority,description:e.description,status:e.status},{error:r}=await Te.from("maintenance_requests").insert(t);return r?{success:!1,error:r.message}:{success:!0}},updateMaintenanceRequestStatus:async(e,t)=>{const{error:r}=await Te.from("maintenance_requests").update({status:t}).eq("id",e);return!r},getTickets:async e=>{let t=Te.from("tickets").select("*");e.role==="supervisor"?t=t.eq("created_by",e.id):e.role==="project_manager"&&(t=t.or(`created_by.eq.${e.id},pmid.eq.${e.id}`));const{data:r,error:a}=await t;if(a||!r)return console.error("Error fetching tickets:",a),[];const s=[...new Set(r.map(h=>h.assetid).filter(Boolean))],l=[...new Set(r.map(h=>h.created_by).filter(Boolean))];let o={},u={};if(s.length>0){const{data:h}=await Te.from("assets").select("id, name").in("id",s);h&&h.forEach(d=>{o[d.id]=d.name})}if(l.length>0){const{data:h}=await Te.from("profiles").select("id, name").in("id",l);h&&h.forEach(d=>{u[d.id]=d.name})}return r.map(h=>({id:h.id,title:h.title,category:h.category,assetId:h.assetid,assetName:o[h.assetid]||"Unknown",description:h.description,priority:h.priority,status:h.status,createdBy:h.created_by,creatorName:u[h.created_by]||"Unknown",pmId:h.pmid||h.pm_id,projectId:h.projectid,projectName:"Unknown",createdAt:h.createdat,solvedAt:h.solvedat,closedAt:h.closedat,cost:h.cost}))},createTicket:async e=>{let t="";if(e.projectId){const{data:l}=await Te.from("projects").select("pm_id").eq("id",e.projectId).single();l&&(t=l.pm_id)}const r={title:e.title,category:e.category,description:e.description,priority:e.priority,status:"open",created_by:e.createdBy};e.projectId&&(r.projectid=e.projectId),e.assetId&&(r.assetid=e.assetId),t&&(r.pmid=t);const{data:a,error:s}=await Te.from("tickets").insert(r).select().single();if(s)return{success:!1,error:s.message};try{await Te.functions.invoke("ticket-notification",{body:{record:{...a,pm_id:t||void 0}}})}catch(l){console.error("Failed to invoke edge function:",l)}return{success:!0}},updateTicketStatus:async(e,t,r)=>{const a={status:t};t==="solved"&&(a.solvedat=new Date().toISOString(),r!==void 0&&(a.cost=r)),t==="closed"&&(a.closedat=new Date().toISOString()),t==="open"&&(a.solvedat=null,a.closedat=null);const{data:s}=await Te.from("tickets").select("*").eq("id",e).single(),{error:l}=await Te.from("tickets").update(a).eq("id",e);if(!l&&s)try{await Te.functions.invoke("ticket-notification",{body:{record:s,action:"status_change",newStatus:t}})}catch(o){console.error("Failed to invoke edge function for status update:",o)}return!l},updateTicket:async(e,t)=>{const r={};t.title&&(r.title=t.title),t.category&&(r.category=t.category),t.priority&&(r.priority=t.priority),t.description&&(r.description=t.description),t.status&&(r.status=t.status),t.cost!==void 0&&(r.cost=t.cost);const{error:a}=await Te.from("tickets").update(r).eq("id",e);return!a},deleteTickets:async e=>{const{error:t}=await Te.from("tickets").delete().in("id",e);return!t}},W4=({onLogin:e})=>{const[t,r]=ne.useState(!1),[a,s]=ne.useState(""),[l,o]=ne.useState(""),[u,h]=ne.useState(!1),[d,x]=ne.useState(""),[g,p]=ne.useState(""),y=async w=>{w.preventDefault(),x(""),p(""),h(!0);try{const _=await Xe.login(a,l);if(_){e(_),h(!1);return}if(t){const S=a.split("@")[0],{error:T}=await Te.auth.signUp({email:a,password:l,options:{data:{full_name:S,role:"supervisor"}}});if(T)throw T;try{await Te.functions.invoke("new-user-notification",{body:{email:a,name:S}})}catch(N){console.error("Failed to send admin notification:",N)}p("   !       ."),r(!1)}else{const{data:S,error:T}=await Te.auth.signInWithPassword({email:a,password:l});if(T)throw T;if(S.user){const N=await Xe.getUserProfile(S.user.id);N?e(N):x("         .   .")}}}catch(_){console.error(_);const S=_.message||"";S.includes("Invalid login credentials")?a.toLowerCase()==="admin"?x("   (admin)  ."):x("      .    "):S.includes("Email not confirmed")?x("         ."):S.includes("Database error saving new user")?x("    .       (supabase_setup.sql)."):x(" : "+S)}finally{h(!1)}};return f.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#f0f3f6] p-4 font-sans",dir:"rtl",children:f.jsxs("div",{className:"bg-white p-8 md:p-12 rounded-2xl shadow-xl w-full max-w-md border border-gray-100",children:[f.jsxs("div",{className:"text-center mb-10",children:[f.jsx("div",{className:"inline-flex items-center justify-center w-14 h-14 bg-primary/10 rounded-2xl text-primary mb-4 shadow-sm",children:f.jsx("span",{className:"material-icons text-4xl",children:"bar_chart"})}),f.jsx("h2",{className:"text-3xl font-bold text-gray-800 tracking-tight",children:"Capture Flow"}),f.jsx("p",{className:"text-xs font-bold text-blue-600 mt-1 tracking-wide",children:"(Powered by Capture Doc)"}),f.jsx("p",{className:"text-gray-400 text-sm mt-6 font-medium",children:t?"  ":"  "})]}),d&&f.jsxs("div",{className:"bg-red-50 text-red-600 p-4 rounded-xl mb-6 text-sm flex items-start gap-3 border border-red-100 animate-pulse",children:[f.jsx("span",{className:"material-icons text-lg mt-0.5",children:"error_outline"}),f.jsx("span",{className:"font-bold",children:d})]}),g&&f.jsxs("div",{className:"bg-green-50 text-green-600 p-4 rounded-xl mb-6 text-sm flex items-start gap-3 border border-green-100",children:[f.jsx("span",{className:"material-icons text-lg mt-0.5",children:"check_circle"}),f.jsx("span",{className:"font-bold",children:g})]}),f.jsxs("form",{onSubmit:y,className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-2 uppercase tracking-wider",children:"  /  "}),f.jsxs("div",{className:"relative",children:[f.jsx("span",{className:"material-icons absolute top-3 right-3 text-gray-400",children:"person"}),f.jsx("input",{type:"text",required:!0,className:"w-full pl-4 pr-10 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-primary focus:bg-white outline-none transition-all text-left",dir:"ltr",placeholder:"admin",value:a,onChange:w=>s(w.target.value)})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-2 uppercase tracking-wider",children:" "}),f.jsxs("div",{className:"relative",children:[f.jsx("span",{className:"material-icons absolute top-3 right-3 text-gray-400",children:"lock"}),f.jsx("input",{type:"password",required:!0,className:"w-full pl-4 pr-10 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-primary focus:bg-white outline-none transition-all text-left",dir:"ltr",placeholder:"",value:l,onChange:w=>o(w.target.value)})]})]}),f.jsx("button",{type:"submit",disabled:u,className:"w-full bg-primary text-white py-3.5 rounded-xl font-bold hover:bg-primary-dark active:scale-[0.98] transition-all shadow-lg shadow-blue-500/30 flex justify-center items-center mt-8 text-lg",children:u?f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"material-icons animate-spin text-xl",children:"donut_large"}),f.jsx("span",{children:" ..."})]}):t?" ":" "})]}),f.jsx("div",{className:"mt-8 text-center pt-6 border-t border-gray-100",children:f.jsx("button",{onClick:()=>{r(!t),x(""),p("")},className:"text-sm text-primary font-bold hover:text-primary-dark transition-colors flex items-center justify-center gap-1 mx-auto",children:t?"    ":"     "})})]})})},lo=({message:e,type:t,onClose:r})=>{ne.useEffect(()=>{const l=setTimeout(r,3e3);return()=>clearTimeout(l)},[r]);const a={success:{bg:"bg-green-600",icon:"check_circle"},error:{bg:"bg-red-600",icon:"error"},info:{bg:"bg-blue-600",icon:"info"}},s=a[t]||a.info;return f.jsxs("div",{className:`fixed top-6 left-1/2 transform -translate-x-1/2 z-[70] flex items-center gap-3 px-6 py-3 rounded-lg shadow-xl text-white font-bold animate-bounce-in ${s.bg}`,children:[f.jsx("span",{className:"material-icons text-xl",children:s.icon}),f.jsx("span",{children:e}),f.jsx("button",{onClick:r,className:"ml-4 text-white/80 hover:text-white",children:f.jsx("span",{className:"material-icons text-sm",children:"close"})})]})},$f=({isOpen:e,title:t=" ",message:r,onConfirm:a,onCancel:s,confirmText:l=" ",cancelText:o="",isDangerous:u=!1})=>e?f.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/50 backdrop-blur-sm p-4 animate-fade-in",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-sm w-full p-6 transform scale-100 transition-transform",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[f.jsx("div",{className:`p-2 rounded-full ${u?"bg-red-100 text-red-600":"bg-blue-100 text-blue-600"}`,children:f.jsx("span",{className:"material-icons text-2xl",children:u?"warning":"help"})}),f.jsx("h3",{className:"text-lg font-bold text-gray-800",children:t})]}),f.jsx("p",{className:"text-gray-600 mb-6 text-sm leading-relaxed",children:r}),f.jsxs("div",{className:"flex gap-3",children:[f.jsx("button",{onClick:s,className:"flex-1 py-2.5 rounded-lg font-bold bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors",children:o}),f.jsx("button",{onClick:a,className:`flex-1 py-2.5 rounded-lg font-bold text-white transition-colors shadow-md ${u?"bg-red-600 hover:bg-red-700":"bg-primary hover:bg-primary-dark"}`,children:l})]})]})}):null,sy={id:"all",name:" ",location:" ",createdAt:new Date().toISOString()},K4=({activeTab:e,currentUser:t,onNavigate:r,onlineUsers:a})=>{const[s,l]=ne.useState([]),[o,u]=ne.useState(null),[h,d]=ne.useState(!1),[x,g]=ne.useState([]),[p,y]=ne.useState([]),[w,_]=ne.useState([]),[S,T]=ne.useState([]),[N,E]=ne.useState([]),[D,G]=ne.useState([]),[V,A]=ne.useState([]),[M,C]=ne.useState([]),[U,Z]=ne.useState([]),[q,le]=ne.useState([]),[ge,Se]=ne.useState([]),[te,ae]=ne.useState([]),[De,ie]=ne.useState([]),[Me,W]=ne.useState([]),[O,P]=ne.useState(null),[z,F]=ne.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{},isDangerous:!1}),Q=(Y,pe="success")=>{P({message:Y,type:pe})},re=(Y,pe,Ne=!1,Pe=" ")=>{F({isOpen:!0,message:Y,title:Pe,onConfirm:pe,isDangerous:Ne})},Ee=()=>{F(Y=>({...Y,isOpen:!1}))},ye=ne.useRef(new Set),[Oe,tt]=ne.useState(!1),[J,wt]=ne.useState(!1),[et,gt]=ne.useState({name:"",location:""}),[it,Ce]=ne.useState(!1),[Ae,Ge]=ne.useState({name:"",location:"",pmId:""}),[mt,Ue]=ne.useState(""),[Ve,Tt]=ne.useState(""),[Ke,Rt]=ne.useState(null),[zt,ua]=ne.useState(!1),[ir,or]=ne.useState(!1),[nt,Ht]=ne.useState(""),[Hr,It]=ne.useState(new Set),[Gt,qr]=ne.useState(!1),[Vt,Ns]=ne.useState({id:"",name:"",phone:"",supervisorId:""}),[Zn,es]=ne.useState(""),[qa,zn]=ne.useState("all"),[cn,fa]=ne.useState([]),[ea,Ea]=ne.useState(null),[st,_r]=ne.useState({name:"",teamName:"",username:"",password:"",role:"supervisor",reportsTo:"",targetProjectId:"",targetProjectIds:[]}),[tr,$a]=ne.useState(null),[Ca,K]=ne.useState(""),[Ie,ft]=ne.useState(new Set),[qt,gr]=ne.useState(!1),[j,H]=ne.useState(""),[I,L]=ne.useState(""),[B,X]=ne.useState(""),[ce,_e]=ne.useState(null),ue=ne.useRef(null),he=ne.useRef(null),me=ne.useRef(null),Fe=ne.useRef(null),Be=ne.useRef({}),qe=ne.useRef(o);ne.useEffect(()=>{qe.current=o},[o]);const Le=t.role==="super_admin"||t.role==="power_admin",$e=t.role==="it_specialist",Ye=t.role==="hr_admin",Ot=Le||$e||Ye;ne.useEffect(()=>{(async()=>{d(!0);const pe=await Xe.getAllProjectManagers();if(G(pe),Ot){const Ne=await Xe.getProjects();l(Ne),u(sy)}else if(t.role==="project_manager"){const Ne=await Xe.getPMDashboardSummary(t.id);g(Ne);const Pe=await Xe.getProjectsByPM(t.id);if(l(Pe),t.projectId){const Qe=Pe.find(xt=>xt.id===t.projectId);Qe&&u(Qe)}}else if(t.projectId){const Pe=(await Xe.getProjects()).find(Qe=>Qe.id===t.projectId);Pe&&u(Pe)}d(!1)})()},[t,Ot]),ne.useEffect(()=>{o?$r(o.id):(y([]),_([]),T([]),A([]),C([]),Z([]),le([]),Se([]),ae([]),ie([]))},[o,D]),ne.useEffect(()=>{if(!o)return;const Y=o.id,pe=Y==="all"?void 0:`project_id=eq.${Y}`,Ne=`admin-dashboard-${Y}-${Date.now()}`,Pe=Te.channel(Ne).on("postgres_changes",{event:"*",schema:"public",table:"unlock_requests",filter:pe},Qe=>{qe.current&&Lt(qe.current.id)}).on("postgres_changes",{event:"*",schema:"public",table:"maintenance_requests",filter:pe},Qe=>{qe.current&&Xt(qe.current.id)}).on("postgres_changes",{event:"*",schema:"public",table:"kpi_logs",filter:pe},Qe=>{qe.current&&(Hn(qe.current.id),Nn(qe.current.id))}).subscribe();return()=>{Te.removeChannel(Pe)}},[o==null?void 0:o.id]);const Lt=async Y=>{const pe=Y==="all"?void 0:Y,Pe=(await Xe.getUnlockRequests(pe,void 0,"pending")).filter(Qe=>!ye.current.has(Qe.id));ae(Pe)},Xt=async Y=>{const pe=Y==="all"?void 0:Y,Ne=await Xe.getMaintenanceRequests(pe,"pending");ie(Ne)},Ta=async()=>{const Y=await Xe.getTickets(t);W(Y.filter(pe=>pe.status==="open"))},Hn=async Y=>{const pe=Y==="all"?void 0:Y,Ne=await Xe.getLogs(pe);le(Ne)},Nn=async Y=>{const pe=Y==="all"?void 0:Y,Ne=await Xe.getLogs(pe,"pending");Se(Ne)},$r=async Y=>{d(!0);const pe=Y==="all"?void 0:Y,Ne=await Xe.getUsers(pe),Pe=await Xe.getOperators(pe),Qe=await Xe.getAssets(pe),xt=await Xe.getLogs(pe);await Lt(Y),await Xt(Y),await Ta(),await Nn(Y);let xr=Ne.filter(Gr=>Gr.role==="project_manager");const Dt=Ne.filter(Gr=>Gr.role==="supervisor"),Wt=Ne.filter(Gr=>Gr.role==="it_specialist"),ma=Ne.filter(Gr=>Gr.role==="hr_admin");if(Y!=="all"){const Gr=s.find(Kt=>Kt.id===Y)||((o==null?void 0:o.id)===Y?o:null);if(Gr&&Gr.pmId){const Kt=D.find(br=>br.id===Gr.pmId);Kt&&!xr.some(br=>br.id===Kt.id)&&xr.push(Kt)}}y(Dt),_(xr),T(Wt),E(ma),A([...Dt,...xr,...Wt,...ma]),C(Pe),Z(Qe),le(xt),d(!1),ft(new Set)};ne.useEffect(()=>((e==="reports"||e==="dashboard")&&q.length>0&&!h&&fi(),()=>{Object.values(Be.current).forEach(Y=>Y.destroy())}),[e,q,h,p]);const fi=()=>{const Y=Ne=>{Be.current[Ne]&&(Be.current[Ne].destroy(),delete Be.current[Ne])},pe=q.filter(Ne=>Ne.status==="approved"||!Ne.status);if(ue.current){Y("trend");const Ne=ue.current.getContext("2d"),Pe={};[...pe].sort((Dt,Wt)=>new Date(Dt.date).getTime()-new Date(Wt.date).getTime()).forEach(Dt=>{const Wt=Dt.date.substring(5);Pe[Wt]||(Pe[Wt]={sum:0,count:0});const ma=(Dt.attitude+Dt.performance+Dt.quality+Dt.appearance)/4;Pe[Wt].sum+=ma,Pe[Wt].count+=1});const xt=Object.keys(Pe),xr=xt.map(Dt=>(Pe[Dt].sum/Pe[Dt].count).toFixed(2));Be.current.trend=new Chart(Ne,{type:"line",data:{labels:xt,datasets:[{label:"  ",data:xr,borderColor:"#007aff",backgroundColor:Dt=>{const ma=Dt.chart.ctx.createLinearGradient(0,0,0,400);return ma.addColorStop(0,"rgba(0, 122, 255, 0.5)"),ma.addColorStop(1,"rgba(0, 122, 255, 0.0)"),ma},fill:!0,tension:.4,pointRadius:3,borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{min:0,max:10,grid:{borderDash:[4,4],color:"#f0f0f0"}},x:{grid:{display:!1}}}}})}if(he.current&&p.length>0){Y("team");const Ne=he.current.getContext("2d"),Pe=p.map(Qe=>{const xt=pe.filter(Dt=>Dt.supervisorId===Qe.id);if(xt.length===0)return{name:Qe.name,avg:0};const xr=xt.reduce((Dt,Wt)=>Dt+(Wt.attitude+Wt.performance+Wt.quality+Wt.appearance)/4,0);return{name:Qe.name,avg:xr/xt.length}}).sort((Qe,xt)=>xt.avg-Qe.avg);Be.current.team=new Chart(Ne,{type:"bar",data:{labels:Pe.map(Qe=>Qe.name),datasets:[{label:"  ",data:Pe.map(Qe=>Qe.avg.toFixed(2)),backgroundColor:"#3b82f6",borderRadius:6,barThickness:20}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,max:10,grid:{display:!1}},x:{grid:{display:!1}}}}})}if(me.current){Y("category");const Ne=me.current.getContext("2d"),Pe=pe.reduce((xt,xr)=>({attitude:xt.attitude+xr.attitude,performance:xt.performance+xr.performance,quality:xt.quality+xr.quality,appearance:xt.appearance+xr.appearance}),{attitude:0,performance:0,quality:0,appearance:0}),Qe=pe.length||1;Be.current.category=new Chart(Ne,{type:"radar",data:{labels:["","","",""],datasets:[{label:" ",data:[(Pe.attitude/Qe).toFixed(2),(Pe.performance/Qe).toFixed(2),(Pe.quality/Qe).toFixed(2),(Pe.appearance/Qe).toFixed(2)],backgroundColor:"rgba(139, 92, 246, 0.2)",borderColor:"#8b5cf6",pointBackgroundColor:"#8b5cf6",pointBorderColor:"#fff"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{r:{angleLines:{color:"#e5e7eb"},grid:{color:"#e5e7eb"},suggestedMin:0,suggestedMax:10,pointLabels:{font:{size:12,family:"Cairo"}}}}}})}if(Fe.current){Y("dist");const Ne=Fe.current.getContext("2d"),Pe={excellent:0,good:0,fair:0,poor:0};pe.forEach(Qe=>{const xt=(Qe.attitude+Qe.performance+Qe.quality+Qe.appearance)/4;xt>=9?Pe.excellent++:xt>=7?Pe.good++:xt>=5?Pe.fair++:Pe.poor++}),Be.current.dist=new Chart(Ne,{type:"doughnut",data:{labels:[" (9-10)"," (7-8.9)"," (5-6.9)"," (<5)"],datasets:[{data:[Pe.excellent,Pe.good,Pe.fair,Pe.poor],backgroundColor:["#10b981","#3b82f6","#f59e0b","#ef4444"],borderWidth:0,hoverOffset:4}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"70%",plugins:{legend:{position:"bottom",labels:{font:{family:"Cairo",size:10},boxWidth:10}}}}})}},da=()=>{const Y=q.filter(Kt=>Kt.status==="approved"||!Kt.status);if(Y.length===0)return{avg:0,total:0,active:0,trend:0};const Ne=Y.reduce((Kt,br)=>Kt+(br.attitude+br.performance+br.quality+br.appearance)/4,0)/Y.length,Qe=new Date().getMonth(),xt=Qe===0?11:Qe-1,xr=Y.filter(Kt=>new Date(Kt.date).getMonth()===Qe),Dt=Y.filter(Kt=>new Date(Kt.date).getMonth()===xt),Wt=xr.length?xr.reduce((Kt,br)=>Kt+(br.attitude+br.performance+br.quality+br.appearance)/4,0)/xr.length:0,ma=Dt.length?Dt.reduce((Kt,br)=>Kt+(br.attitude+br.performance+br.quality+br.appearance)/4,0)/Dt.length:0,Gr=ma===0?0:(Wt-ma)/ma*100;return{avg:Ne.toFixed(1),total:Y.length,active:new Set(Y.map(Kt=>Kt.operatorId)).size,trend:Gr.toFixed(1)}},tl=()=>{const Y=q.filter(Ne=>Ne.status==="approved"||!Ne.status),pe={};return Y.forEach(Ne=>{if(!pe[Ne.operatorId]){const Qe=M.find(xt=>xt.id===Ne.operatorId);pe[Ne.operatorId]={name:(Qe==null?void 0:Qe.name)||"Unknown",sum:0,count:0}}const Pe=(Ne.attitude+Ne.performance+Ne.quality+Ne.appearance)/4;pe[Ne.operatorId].sum+=Pe,pe[Ne.operatorId].count+=1}),Object.values(pe).map(Ne=>({name:Ne.name,avg:Ne.sum/Ne.count})).sort((Ne,Pe)=>Pe.avg-Ne.avg).slice(0,5)},ha=da();tl(),q.filter(Y=>{const pe=Y.status==="approved"||!Y.status,Ne=I?Y.date===I:!0,Pe=B?Y.supervisorId===B:!0;return pe&&Ne&&Pe}).sort((Y,pe)=>new Date(pe.date).getTime()-new Date(Y.date).getTime());const Ra=Y=>{const pe=s.find(Ne=>Ne.id===Y.projectId);pe&&(u(pe),r("dashboard"))},su=async Y=>{ce||re(`       ${Y.operatorName}       .`,async()=>{_e(Y.id),ye.current.add(Y.id),ae(Ne=>Ne.filter(Pe=>Pe.id!==Y.id)),await Xe.approveUnlockRequest(Y.id,Y.operatorId,Y.date,Y.logId)?(o&&Hn(o.id),Q("      ")):(ye.current.delete(Y.id),o&&Lt(o.id),Q("     ","error")),_e(null),Ee()},!0)},ad=async Y=>{ce||re("      ",async()=>{_e(Y.id),ye.current.add(Y.id),ae(Ne=>Ne.filter(Pe=>Pe.id!==Y.id));const pe=await Xe.rejectUnlockRequest(Y.id,Y.operatorId,Y.date);pe.success?Q("  ","info"):(ye.current.delete(Y.id),o&&Lt(o.id),Q(` : ${pe.error}`,"error")),_e(null),Ee()},!0)},ho=async Y=>{if(ce)return;_e(Y.id),await Xe.updateMaintenanceRequestStatus(Y.id,"in_progress")?(o&&Xt(o.id),Q("       ")):Q("    ","error"),_e(null)},iu=async Y=>{if(Y.preventDefault(),!et.name||!et.location)return;const pe=await Xe.createProject(et.name,et.location);pe?(l([...s,pe]),u(pe),wt(!1),gt({name:"",location:""}),Q("   ")):Q("    .","error")},rl=async Y=>{if(Y.preventDefault(),!o||!Ae.name)return;if(await Xe.updateProject(o.id,Ae.name,Ae.location,Ae.pmId)){const Ne={...o,...Ae};l(s.map(Pe=>Pe.id===o.id?Ne:Pe)),u(Ne),Ce(!1),Q("    ")}else Q("    ","error")},nd=async()=>{o&&re(` :    "${o.name}"    .   `,async()=>{if(await Xe.deleteProject(o.id)){const pe=s.filter(Ne=>Ne.id!==o.id);l(pe),u(pe.length>0?pe[0]:null),Ce(!1),Q("   ")}else Q("    .","error");Ee()},!0)},Da=()=>{o&&(Ge({name:o.name,location:o.location,pmId:o.pmId||""}),Ce(!0))},di=async Y=>{const pe=Y.projectId||((o==null?void 0:o.id)==="all"?"":o==null?void 0:o.id)||"",Ne=await Xe.getUsers("all");fa(Ne);let Pe=[];if(Y.role==="project_manager"&&Y.id&&(Pe=s.filter(Qe=>Qe.pmId===Y.id).map(Qe=>Qe.id)),Y.id)$a(Y),Ea(null),_r({name:Y.name||"",teamName:Y.teamName||"",username:Y.username,password:Y.password||"",role:Y.role,reportsTo:Y.reportsTo||"",targetProjectId:pe,targetProjectIds:Pe});else{$a(null),Ea(null);const Qe=st.role||"supervisor";_r({name:"",teamName:"",username:"",password:"",role:Qe,reportsTo:"",targetProjectId:pe,targetProjectIds:[]})}ua(!0)},al=()=>{ua(!1),$a(null),Ea(null),_r({name:"",teamName:"",username:"",password:"",role:"supervisor",reportsTo:"",targetProjectId:"",targetProjectIds:[]})},mo=Y=>{const pe=Y.target.value;if(!pe){Ea(null),_r(Pe=>({...Pe,name:"",username:""}));return}const Ne=cn.find(Pe=>Pe.id===pe);Ne&&(Ea(Ne.id),_r(Pe=>({...Pe,name:Ne.name||"",username:Ne.username||"",role:Ne.role})))},js=Y=>{_r(pe=>{const Ne=new Set(pe.targetProjectIds);return Ne.has(Y)?Ne.delete(Y):Ne.add(Y),{...pe,targetProjectIds:Array.from(Ne)}})},lu=async Y=>{if(Y.preventDefault(),!st.name||!st.username)return;if(Ot&&!st.targetProjectId&&st.role!=="it_specialist"&&st.role!=="project_manager"&&st.role!=="hr_admin"){Q("  .","error");return}if(st.role==="supervisor"&&!st.teamName){Q("    .","error");return}let pe=st.role;t.role==="project_manager"?pe!=="supervisor"&&pe!=="it_specialist"&&(pe="supervisor"):Ot||(pe="supervisor");let Ne=st.targetProjectId;if(pe==="project_manager")Ne=st.targetProjectIds.length>0?st.targetProjectIds[0]:"";else if(pe==="it_specialist"||pe==="hr_admin")Ne="";else if(!Ne&&o&&o.id!=="all"&&(Ne=o.id),!Ne){Q(" :    .","error");return}let Pe=ea;!Pe&&tr&&(Pe=tr.id),Pe||(Pe=`u-${Date.now()}`);const Qe={id:Pe,...st,role:pe,projectId:Ne||void 0,teamName:pe==="supervisor"?st.teamName:void 0,reportsTo:pe==="supervisor"?st.reportsTo:void 0},xt=await Xe.saveUser(Qe);if(xt.success){if(pe==="project_manager"){await Xe.assignProjectsToPM(Qe.id,st.targetProjectIds);const Wt=await Xe.getProjects();l(Wt)}al(),$r(o?o.id:"all");const Dt={supervisor:"",project_manager:" ",it_specialist:" IT",hr_admin:"  ",power_admin:" "}[pe]||"";Q(tr?"    ":`  ${Dt} `)}else Q("  : "+xt.error,"error")},ou=async Y=>{o&&re("      ",async()=>{await Xe.deleteUser(Y),tr&&tr.id===Y&&al(),$r(o.id),Q("  ","info"),Ee()},!0)},As=async()=>{if(!o||!nt)return;if(await Xe.updateProject(o.id,o.name,o.location,nt)){const pe={...o,pmId:nt};l(s.map(Ne=>Ne.id===o.id?pe:Ne)),u(pe),or(!1),$r(o.id),Q("    ")}else Q("  ","error")},sd=async Y=>{Y.preventDefault(),!(!Vt.name||!o)&&(await Xe.saveOperators([{id:Vt.id,name:Vt.name,phone:Vt.phone,supervisorId:Vt.supervisorId,projectId:o.id}]),qr(!1),$r(o.id),Q("   "))},cu=async()=>{!j||Ie.size===0||!o||(await Xe.updateOperatorsSupervisor(Array.from(Ie),j),gr(!1),H(""),$r(o.id),Q(`  ${Ie.size}  `))},uu=async()=>{Ie.size===0||!o||re(`     ${Ie.size} `,async()=>{await Xe.deleteOperators(Array.from(Ie)),$r(o.id),ft(new Set),Q("   ","info"),Ee()},!0)},xo=Y=>{ft(Ie.size===Y.length&&Y.length>0?new Set:new Set(Y.map(pe=>pe.id)))},id=Y=>{const pe=new Set(Ie);pe.has(Y)?pe.delete(Y):pe.add(Y),ft(pe)},fu=()=>{if(e==="sites"&&t.role==="project_manager")return f.jsx("div",{className:"mb-8 flex justify-between items-center bg-white p-5 rounded-xl shadow-sm border border-gray-100",children:f.jsxs("div",{children:[f.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"  "}),f.jsxs("p",{className:"text-gray-500 text-sm mt-1",children:[" ",t.name,"  ",x.length,"   ."]})]})});if(!o)return null;const Y=te.filter(xt=>xt.status==="pending").length,pe=De.length,Ne=Me.length,Pe=Y+pe+Ne,Qe=ge.length;return f.jsxs("div",{className:"mb-8 flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-white p-5 rounded-xl shadow-sm border border-gray-100 relative",children:[f.jsxs("div",{className:"flex items-center gap-4 w-full md:w-auto",children:[t.role==="project_manager"&&f.jsx("button",{onClick:()=>{u(null),r("sites")},className:"p-2 rounded-full bg-gray-100 hover:bg-gray-200 text-gray-600 transition-colors",title:" ",children:f.jsx("span",{className:"material-icons",children:"arrow_forward"})}),f.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[f.jsx("span",{className:"material-icons text-gray-400",children:"domain"}),f.jsx("span",{className:"font-bold text-gray-800 text-lg",children:o.name}),f.jsx("span",{className:"bg-gray-100 text-gray-500 text-xs px-2 py-1 rounded-full",children:o.location})]}),f.jsxs("div",{className:"relative flex gap-2",children:[Qe>0&&f.jsxs("button",{onClick:()=>r("approvals"),className:"p-2 rounded-full bg-orange-50 text-orange-600 hover:bg-orange-100 relative",children:[f.jsx("span",{className:"material-icons text-2xl",children:"fact_check"}),f.jsx("span",{className:"absolute top-1 right-1 w-5 h-5 bg-orange-500 text-white text-xs font-bold rounded-full flex items-center justify-center border-2 border-white animate-pulse",children:Qe})]}),f.jsxs("button",{onClick:()=>{o&&(Lt(o.id),Xt(o.id),Ta()),tt(!0)},className:`relative p-2 rounded-full transition-colors ${Oe?"bg-blue-50 text-primary":"text-gray-400 hover:text-primary hover:bg-gray-50"}`,children:[f.jsx("span",{className:"material-icons text-2xl",children:"notifications"}),Pe>0&&f.jsx("span",{className:"absolute top-1 right-1 w-5 h-5 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center border-2 border-white animate-bounce",children:Pe})]}),f.jsx("button",{onClick:()=>$r(o.id),className:"p-2 rounded-full text-gray-400 hover:text-primary hover:bg-gray-50 transition-colors",children:f.jsx("span",{className:"material-icons text-2xl",children:"refresh"})})]})]}),Ot&&f.jsxs("div",{className:"flex items-center gap-2 w-full md:w-auto mt-4 md:mt-0",children:[f.jsxs("div",{className:"relative flex-1 md:w-64",children:[f.jsxs("select",{className:"w-full pl-10 pr-4 py-2 bg-gray-50 border border-gray-200 rounded-lg cursor-pointer focus:ring-2 focus:ring-primary outline-none text-sm font-bold text-gray-700",value:o.id,onChange:xt=>{if(xt.target.value==="all")u(sy);else{const xr=s.find(Dt=>Dt.id===xt.target.value);xr&&u(xr)}},children:[f.jsx("option",{value:"all",children:" "}),s.map(xt=>f.jsx("option",{value:xt.id,children:xt.name},xt.id))]}),f.jsx("span",{className:"material-icons absolute left-3 top-2.5 text-gray-400 pointer-events-none",children:"expand_more"})]}),o.id!=="all"&&f.jsx("button",{onClick:Da,className:"p-2 bg-gray-50 text-gray-600 rounded-lg hover:bg-gray-200 border border-gray-200",children:f.jsx("span",{className:"material-icons",children:"settings"})}),f.jsx("button",{onClick:()=>wt(!0),className:"p-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100",children:f.jsx("span",{className:"material-icons",children:"add"})})]})]})},nl=()=>{const Y=te.filter(pe=>pe.status==="pending");return f.jsxs(f.Fragment,{children:[Oe&&f.jsx("div",{className:"fixed inset-0 bg-black/30 z-40 backdrop-blur-sm",onClick:()=>tt(!1)}),f.jsx("div",{className:`fixed inset-y-0 right-0 w-80 sm:w-96 bg-white shadow-2xl z-50 transform transition-transform duration-300 ${Oe?"translate-x-0":"translate-x-full"}`,children:f.jsxs("div",{className:"h-full flex flex-col",children:[f.jsxs("div",{className:"p-4 border-b bg-gray-50 flex justify-between items-center",children:[f.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[f.jsx("span",{className:"material-icons text-primary",children:"notifications_active"})," "]}),f.jsx("button",{onClick:()=>tt(!1),className:"text-gray-400 hover:text-red-500",children:f.jsx("span",{className:"material-icons",children:"close"})})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[De.length>0&&f.jsxs("div",{className:"mb-6",children:[f.jsxs("h4",{className:"text-xs font-bold text-gray-500 uppercase mb-2",children:["  (",De.length,")"]}),f.jsx("div",{className:"space-y-3",children:De.map(pe=>f.jsxs("div",{className:"bg-white border-l-4 border-l-red-500 border rounded-r-lg p-3 shadow-sm",children:[f.jsxs("div",{className:"flex justify-between items-start mb-2",children:[f.jsxs("div",{className:"font-bold text-gray-800 flex items-center gap-2",children:[f.jsx("span",{className:"material-icons text-red-500 text-sm",children:"build"}),pe.assetName]}),f.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded font-bold uppercase ${pe.priority==="critical"?"bg-red-600 text-white":pe.priority==="high"?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-600"}`,children:pe.priority})]}),f.jsxs("p",{className:"text-xs text-gray-600 mb-2 italic bg-gray-50 p-2 rounded",children:['"',pe.description,'"']}),f.jsxs("div",{className:"flex justify-between items-center mt-2",children:[f.jsxs("div",{className:"text-[10px] text-gray-400",children:[": ",pe.supervisorName]}),f.jsx("button",{onClick:()=>ho(pe),disabled:ce===pe.id,className:"text-xs bg-blue-50 text-blue-600 px-3 py-1 rounded hover:bg-blue-100 font-bold",children:""})]})]},pe.id))})]}),Y.length>0&&f.jsxs("div",{children:[f.jsxs("h4",{className:"text-xs font-bold text-gray-500 uppercase mb-2",children:["   (",Y.length,")"]}),f.jsx("div",{className:"space-y-3",children:Y.map(pe=>f.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:[f.jsxs("div",{className:"flex justify-between mb-2",children:[f.jsx("div",{className:"font-bold",children:pe.operatorName}),f.jsx("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:pe.date})]}),f.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:[": ",pe.supervisorName]}),f.jsxs("div",{className:"bg-gray-50 p-2 rounded text-xs text-gray-600 italic mb-3",children:['"',pe.reason,'"']}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>su(pe),disabled:ce===pe.id,className:"flex-1 bg-green-500 text-white py-1.5 rounded text-xs font-bold hover:bg-green-600",children:""}),f.jsx("button",{onClick:()=>ad(pe),disabled:ce===pe.id,className:"flex-1 border text-gray-600 py-1.5 rounded text-xs font-bold hover:bg-gray-50",children:""})]})]},pe.id))})]}),Me.length>0&&f.jsxs("div",{className:"mb-6",children:[f.jsxs("h4",{className:"text-xs font-bold text-gray-500 uppercase mb-2",children:["   (",Me.length,")"]}),f.jsx("div",{className:"space-y-3",children:Me.map(pe=>f.jsxs("div",{className:"bg-white border-l-4 border-l-blue-500 border rounded-r-lg p-3 shadow-sm",children:[f.jsxs("div",{className:"flex justify-between items-start mb-2",children:[f.jsxs("div",{className:"font-bold text-gray-800 flex items-center gap-2",children:[f.jsx("span",{className:"material-icons text-blue-500 text-sm",children:"support_agent"}),pe.title]}),f.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded font-bold uppercase ${pe.priority==="critical"?"bg-red-600 text-white":pe.priority==="high"?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-600"}`,children:pe.priority})]}),f.jsxs("p",{className:"text-xs text-gray-600 mb-2 italic bg-gray-50 p-2 rounded",children:['"',pe.description,'"']}),f.jsxs("div",{className:"flex justify-between items-center mt-2",children:[f.jsxs("div",{className:"text-[10px] text-gray-400",children:[": ",pe.creatorName]}),f.jsx("button",{onClick:()=>{tt(!1),r("tickets")},className:"text-xs bg-blue-50 text-blue-600 px-3 py-1 rounded hover:bg-blue-100 font-bold",children:""})]})]},pe.id))})]}),Y.length===0&&De.length===0&&Me.length===0&&f.jsxs("div",{className:"text-center text-gray-400 mt-10",children:[f.jsx("span",{className:"material-icons text-4xl mb-2 opacity-20",children:"notifications_off"}),f.jsx("p",{children:"   "})]})]})]})})]})},jn=()=>{p.filter(pe=>!pe.reportsTo);const Y=w.map(pe=>{const Ne=p.filter(Pe=>Pe.reportsTo===pe.id);return{...pe,children:Ne}});return f.jsx("div",{className:"space-y-12 pb-12",children:Y.map(pe=>f.jsxs("div",{className:"flex flex-col items-center animate-fade-in-up",children:[f.jsxs("div",{className:"mb-8 relative",children:[f.jsxs("div",{className:"bg-purple-600 text-white p-4 rounded-xl shadow-lg w-64 text-center z-10 relative",children:[f.jsx("div",{className:"font-bold text-lg",children:pe.name}),f.jsx("div",{className:"text-xs opacity-75 uppercase tracking-wider",children:"Project Manager"})]}),pe.children.length>0&&f.jsx("div",{className:"absolute top-full left-1/2 w-0.5 h-8 bg-gray-300 -translate-x-1/2"})]}),pe.children.length>0&&f.jsxs("div",{className:"flex flex-wrap justify-center gap-8 relative",children:[pe.children.length>1&&f.jsx("div",{className:"absolute -top-8 left-0 right-0 h-0.5 bg-gray-300 mx-auto",style:{width:"calc(100% - 16rem)"}}),pe.children.map((Ne,Pe)=>{const Qe=M.filter(xt=>xt.supervisorId===Ne.id);return f.jsxs("div",{className:"flex flex-col items-center relative",children:[f.jsx("div",{className:"absolute -top-8 w-0.5 h-8 bg-gray-300"}),f.jsxs("div",{className:"bg-white border-t-4 border-blue-500 p-4 rounded-lg shadow-sm w-60 mb-4 text-center",children:[f.jsx("div",{className:"font-bold text-gray-800",children:Ne.name}),f.jsx("div",{className:"text-xs text-gray-500 uppercase",children:Ne.teamName||"Team Lead"}),f.jsxs("div",{className:"mt-2 text-xs bg-blue-50 text-blue-600 px-2 py-1 rounded inline-block",children:[Qe.length," Members"]})]}),Qe.length>0&&f.jsx("div",{className:"w-56 bg-gray-50 rounded-lg border border-gray-100 p-2 space-y-1 max-h-48 overflow-y-auto custom-scrollbar",children:Qe.map(xt=>f.jsxs("div",{className:"text-xs text-gray-600 flex items-center gap-2 bg-white p-1.5 rounded border border-gray-100",children:[f.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-gray-300"}),f.jsx("span",{className:"truncate",children:xt.name})]},xt.id))})]},Ne.id)})]})]},pe.id))})};return f.jsxs(f.Fragment,{children:[O&&f.jsx(lo,{message:O.message,type:O.type,onClose:()=>P(null)}),f.jsx($f,{isOpen:z.isOpen,title:z.title,message:z.message,onConfirm:z.onConfirm,onCancel:Ee,isDangerous:z.isDangerous}),J&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6",children:[f.jsx("h3",{className:"text-xl font-bold mb-4",children:" "}),f.jsxs("form",{onSubmit:iu,className:"space-y-4",children:[f.jsx("input",{type:"text",className:"w-full p-3 bg-gray-50 border rounded-lg",required:!0,value:et.name,onChange:Y=>gt({...et,name:Y.target.value}),placeholder:" "}),f.jsx("input",{type:"text",className:"w-full p-3 bg-gray-50 border rounded-lg",required:!0,value:et.location,onChange:Y=>gt({...et,location:Y.target.value}),placeholder:""}),f.jsx("button",{type:"submit",className:"w-full bg-primary text-white py-3 rounded-lg font-bold",children:""})]}),f.jsx("button",{onClick:()=>wt(!1),className:"mt-4 text-gray-400 text-sm w-full text-center",children:""})]})}),it&&o&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6",children:[f.jsx("h3",{className:"text-xl font-bold mb-4",children:" "}),f.jsxs("form",{onSubmit:rl,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:" "}),f.jsx("input",{type:"text",className:"w-full p-3 bg-gray-50 border rounded-lg",required:!0,value:Ae.name,onChange:Y=>Ge({...Ae,name:Y.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:""}),f.jsx("input",{type:"text",className:"w-full p-3 bg-gray-50 border rounded-lg",required:!0,value:Ae.location,onChange:Y=>Ge({...Ae,location:Y.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"  (Project Manager)"}),f.jsxs("select",{className:"w-full p-3 bg-gray-50 border rounded-lg",value:Ae.pmId,onChange:Y=>Ge({...Ae,pmId:Y.target.value}),children:[f.jsx("option",{value:"",children:"--   --"}),D.map(Y=>f.jsx("option",{value:Y.id,children:Y.name},Y.id))]})]}),f.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white py-3 rounded-lg font-bold",children:""}),f.jsx("button",{type:"button",onClick:nd,className:"w-full bg-red-50 text-red-600 py-3 rounded-lg font-bold",children:" "})]}),f.jsx("button",{onClick:()=>Ce(!1),className:"mt-4 text-gray-400 text-sm w-full text-center",children:""})]})}),ir&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-sm p-6 animate-fade-in-up",children:[f.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[f.jsx("span",{className:"material-icons text-blue-600",children:"manage_accounts"}),"  "]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-2",children:"   "}),f.jsxs("select",{className:"w-full p-3 bg-gray-50 border rounded-lg",value:nt,onChange:Y=>Ht(Y.target.value),children:[f.jsx("option",{value:"",children:"--  --"}),D.map(Y=>f.jsx("option",{value:Y.id,children:Y.name},Y.id))]})]}),f.jsx("button",{onClick:As,disabled:!nt,className:"w-full bg-primary text-white py-3 rounded-lg font-bold disabled:bg-gray-300",children:" "}),f.jsx("button",{onClick:()=>{or(!1),_r({...st,role:"project_manager"}),di({})},className:"w-full bg-white border border-gray-300 text-gray-700 py-2 rounded-lg font-bold hover:bg-gray-50",children:"  "}),f.jsx("button",{onClick:()=>or(!1),className:"mt-4 text-gray-400 text-sm w-full text-center",children:""})]})]})}),zt&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6 animate-fade-in-up overflow-y-auto max-h-[90vh]",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6 border-b pb-2",children:[f.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[f.jsx("span",{className:"material-icons text-primary",children:tr?"edit":"person_add"}),tr?" ":" "]}),f.jsx("button",{onClick:al,className:"text-gray-400 hover:text-red-500",children:f.jsx("span",{className:"material-icons",children:"close"})})]}),f.jsxs("form",{onSubmit:lu,className:"space-y-4",children:[!tr&&f.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-100 mb-4",children:[f.jsxs("label",{className:"block text-xs font-bold text-blue-800 mb-2 flex items-center gap-1",children:[f.jsx("span",{className:"material-icons text-sm",children:"search"}),"    (Link to Existing User)"]}),f.jsxs("select",{className:"w-full p-2 border rounded text-sm bg-white focus:ring-2 focus:ring-blue-400 outline-none",onChange:mo,defaultValue:"",children:[f.jsx("option",{value:"",children:"--    --"}),cn.filter(Y=>!Y.projectId||Y.projectId==="null").concat(cn.filter(Y=>Y.projectId)).map(Y=>f.jsxs("option",{value:Y.id,children:[Y.username," (",Y.name,") ",Y.projectId?"- Assigned":"- New"]},Y.id))]}),f.jsx("p",{className:"text-[10px] text-blue-600 mt-1",children:"       ."})]}),Ot&&f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:""}),st.role==="project_manager"?f.jsxs("div",{className:"border rounded-lg p-2 max-h-40 overflow-y-auto bg-gray-50",children:[f.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"     (  )"}),s.map(Y=>f.jsxs("div",{className:"flex items-center gap-2 mb-2 last:mb-0",children:[f.jsx("input",{type:"checkbox",id:`proj-${Y.id}`,className:"w-4 h-4 rounded text-primary",checked:st.targetProjectIds.includes(Y.id),onChange:()=>js(Y.id),disabled:!!(tr!=null&&tr.id)&&(o==null?void 0:o.id)!=="all"}),f.jsxs("label",{htmlFor:`proj-${Y.id}`,className:"text-sm text-gray-700 cursor-pointer select-none",children:[Y.name," ",Y.pmId&&Y.pmId!==(tr==null?void 0:tr.id)?f.jsx("span",{className:"text-xs text-orange-500",children:"(  )"}):""]})]},Y.id))]}):f.jsxs("select",{className:"w-full p-3 bg-gray-50 border rounded-lg outline-none focus:ring-2 focus:ring-primary disabled:bg-gray-200 disabled:text-gray-500",value:st.targetProjectId,onChange:Y=>_r({...st,targetProjectId:Y.target.value}),required:(o==null?void 0:o.id)==="all"&&st.role!=="it_specialist"&&st.role!=="hr_admin",disabled:!!(tr!=null&&tr.id)&&(o==null?void 0:o.id)!=="all"||st.role==="it_specialist"||st.role==="hr_admin",children:[f.jsx("option",{value:"",children:st.role==="it_specialist"||st.role==="hr_admin"?"  (Global)":"--   --"}),s.map(Y=>f.jsx("option",{value:Y.id,children:Y.name},Y.id))]})]}),(Ot||t.role==="project_manager")&&f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:" "}),f.jsxs("select",{className:"w-full p-3 bg-gray-50 border rounded-lg outline-none focus:ring-2 focus:ring-primary",value:st.role,onChange:Y=>_r({...st,role:Y.target.value}),children:[f.jsx("option",{value:"supervisor",children:" "}),Le&&f.jsx("option",{value:"project_manager",children:" "}),f.jsx("option",{value:"it_specialist",children:"  "}),(Le||t.role==="hr_admin")&&f.jsx("option",{value:"hr_admin",children:"  "})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:" "}),f.jsx("input",{type:"text",className:"w-full p-3 bg-gray-50 border rounded-lg outline-none focus:ring-2 focus:ring-primary",value:st.name,onChange:Y=>_r({...st,name:Y.target.value}),required:!0})]}),st.role==="supervisor"&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"  ( )"}),f.jsx("input",{type:"text",className:"w-full p-3 bg-gray-50 border rounded-lg outline-none focus:ring-2 focus:ring-primary",value:st.teamName,onChange:Y=>_r({...st,teamName:Y.target.value}),required:!0,placeholder:":   -  "})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"  (Reports To)"}),f.jsxs("select",{className:"w-full p-3 bg-gray-50 border rounded-lg outline-none focus:ring-2 focus:ring-primary",value:st.reportsTo||"",onChange:Y=>_r({...st,reportsTo:Y.target.value}),children:[f.jsx("option",{value:"",children:"--    --"}),D.filter(Y=>!st.targetProjectId||Y.projectId===st.targetProjectId).map(Y=>f.jsx("option",{value:Y.id,children:Y.name},Y.id))]}),st.targetProjectId&&D.filter(Y=>Y.projectId===st.targetProjectId).length===0&&f.jsx("p",{className:"text-[10px] text-orange-600 mt-1",children:"      .     ."})]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"  / "}),f.jsx("input",{type:"text",className:"w-full p-3 bg-gray-50 border rounded-lg outline-none focus:ring-2 focus:ring-primary disabled:bg-gray-200 disabled:text-gray-500",value:st.username,onChange:Y=>_r({...st,username:Y.target.value}),required:!0,disabled:!!ea})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:" "}),f.jsx("input",{type:"password",className:"w-full p-3 bg-gray-50 border rounded-lg outline-none focus:ring-2 focus:ring-primary disabled:bg-gray-200",value:ea?"********":st.password,onChange:Y=>!ea&&_r({...st,password:Y.target.value}),required:!tr&&!ea,disabled:!!ea,placeholder:tr||ea?ea?"  ":"  ":""})]})]}),f.jsx("button",{type:"submit",className:"w-full bg-primary text-white py-3 rounded-lg font-bold shadow-lg shadow-blue-500/20 hover:bg-primary-dark transition-colors mt-4",children:tr?" ":" /  "})]})]})}),Gt&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-sm p-6 animate-fade-in-up",children:[f.jsxs("h3",{className:"font-bold text-lg mb-4 flex items-center gap-2",children:[f.jsx("span",{className:"material-icons text-primary",children:"badge"}),Vt.id.startsWith("op-")&&!Vt.name?" ":" "]}),f.jsxs("form",{onSubmit:sd,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:""}),f.jsx("input",{className:"w-full p-2 border rounded bg-gray-50",value:Vt.name,onChange:Y=>Ns({...Vt,name:Y.target.value}),required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:" "}),f.jsx("input",{className:"w-full p-2 border rounded bg-gray-50",value:Vt.phone,onChange:Y=>Ns({...Vt,phone:Y.target.value})})]}),f.jsxs("div",{className:"flex gap-2 mt-4",children:[f.jsx("button",{type:"submit",className:"flex-1 bg-primary text-white py-2 rounded font-bold",children:""}),f.jsx("button",{type:"button",onClick:()=>qr(!1),className:"flex-1 bg-gray-100 text-gray-600 py-2 rounded font-bold",children:""})]})]})]})}),qt&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-sm p-6",children:[f.jsxs("h3",{className:"font-bold mb-4",children:[" ",Ie.size," "]}),f.jsxs("select",{className:"w-full p-3 bg-gray-50 border rounded-lg mb-4",value:j,onChange:Y=>H(Y.target.value),children:[f.jsx("option",{value:"",children:"--   --"}),p.filter(Y=>Y.role==="supervisor").map(Y=>f.jsx("option",{value:Y.id,children:Y.name},Y.id))]}),f.jsx("button",{onClick:cu,disabled:!j,className:"w-full bg-primary text-white py-3 rounded-lg font-bold disabled:bg-gray-300",children:""}),f.jsx("button",{onClick:()=>gr(!1),className:"mt-4 text-gray-400 text-sm w-full text-center",children:""})]})}),nl(),h&&!o&&e!=="sites"?f.jsx("div",{className:"flex justify-center p-10",children:f.jsx("span",{className:"material-icons animate-spin text-4xl text-primary",children:"donut_large"})}):e==="sites"?f.jsxs(f.Fragment,{children:[fu(),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 animate-fade-in-up",children:x.map(Y=>f.jsxs("div",{onClick:()=>Ra(Y),className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-lg transition-all cursor-pointer group",children:[f.jsxs("div",{className:"flex justify-between items-start mb-4",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-xl font-bold text-gray-800 group-hover:text-primary transition-colors",children:Y.siteName}),f.jsxs("div",{className:"flex items-center gap-1 text-gray-500 text-sm mt-1",children:[f.jsx("span",{className:"material-icons text-sm",children:"location_on"}),Y.location]})]}),f.jsx("div",{className:"p-2 bg-gray-50 rounded-full group-hover:bg-blue-50 transition-colors",children:f.jsx("span",{className:"material-icons text-gray-400 group-hover:text-primary",children:"arrow_forward"})})]}),f.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-6",children:[f.jsxs("div",{className:"text-center p-2 rounded bg-blue-50 border border-blue-100",children:[f.jsx("span",{className:"material-icons text-blue-500 text-xl mb-1",children:"groups"}),f.jsx("div",{className:"font-bold text-gray-800 text-lg",children:Y.supervisorCount}),f.jsx("div",{className:"text-[10px] text-gray-500",children:"Supervisors"})]}),f.jsxs("div",{className:"text-center p-2 rounded bg-orange-50 border border-orange-100 relative",children:[f.jsx("span",{className:"material-icons text-orange-500 text-xl mb-1",children:"lock_open"}),Y.pendingRequestsCount>0&&f.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full animate-ping"}),f.jsx("div",{className:"font-bold text-gray-800 text-lg",children:Y.pendingRequestsCount}),f.jsx("div",{className:"text-[10px] text-gray-500",children:"Requests"})]}),f.jsxs("div",{className:"text-center p-2 rounded bg-purple-50 border border-purple-100",children:[f.jsx("span",{className:"material-icons text-purple-500 text-xl mb-1",children:"build"}),f.jsx("div",{className:"font-bold text-gray-800 text-lg",children:Y.assetsMaintenanceCount}),f.jsx("div",{className:"text-[10px] text-gray-500",children:"Assets"})]})]})]},Y.projectId))})]}):o?f.jsxs(f.Fragment,{children:[fu(),(e==="dashboard"||e==="reports")&&f.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[f.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:[f.jsxs("div",{className:"flex justify-between items-start mb-2",children:[f.jsx("div",{className:"p-2 rounded-lg bg-blue-50 text-blue-600",children:f.jsx("span",{className:"material-icons",children:"analytics"})}),f.jsxs("span",{className:`text-xs font-bold px-2 py-1 rounded-full flex items-center ${Number(ha.trend)>=0?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[Number(ha.trend)>=0?"":""," ",Math.abs(Number(ha.trend)),"%"]})]}),f.jsx("h3",{className:"text-3xl font-bold text-gray-800 mb-1",children:ha.avg}),f.jsx("p",{className:"text-gray-400 text-xs font-bold",children:" "})]}),f.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:[f.jsx("div",{className:"flex justify-between items-start mb-2",children:f.jsx("div",{className:"p-2 rounded-lg bg-purple-50 text-purple-600",children:f.jsx("span",{className:"material-icons",children:"assignment_turned_in"})})}),f.jsx("h3",{className:"text-3xl font-bold text-gray-800 mb-1",children:ha.total}),f.jsx("p",{className:"text-gray-400 text-xs font-bold",children:"  (Approved)"})]})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[f.jsxs("div",{className:"lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[f.jsx("div",{className:"flex justify-between items-center mb-6",children:f.jsx("h3",{className:"font-bold text-gray-800 text-lg",children:"  "})}),f.jsx("div",{className:"h-72 w-full",children:f.jsx("canvas",{ref:ue})})]}),f.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex flex-col items-center justify-center",children:[f.jsx("h3",{className:"font-bold text-gray-800 text-lg w-full text-right mb-4",children:" "}),f.jsxs("div",{className:"h-56 w-full relative",children:[f.jsx("canvas",{ref:Fe}),f.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center pointer-events-none",children:[f.jsx("span",{className:"text-3xl font-bold text-gray-800",children:ha.avg}),f.jsx("span",{className:"text-xs text-gray-400",children:"Avg Score"})]})]})]})]})]}),e==="structure"&&f.jsxs("div",{className:"animate-fade-in-up",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[f.jsx("span",{className:"material-icons text-purple-600",children:"account_tree"}),"  "]}),f.jsx("div",{className:"text-sm text-gray-500 bg-white px-3 py-1 rounded shadow-sm",children:o.name})]}),f.jsx("div",{className:"overflow-x-auto pb-4",children:f.jsx("div",{className:"min-w-[800px] flex justify-center",children:jn()})})]}),e==="teams"&&f.jsx("div",{className:"grid grid-cols-1 gap-6 animate-fade-in-up",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[f.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6 gap-4",children:[f.jsxs("div",{children:[f.jsx("h2",{className:"text-lg font-bold text-gray-800",children:"  (User Management)"}),f.jsx("p",{className:"text-xs text-gray-500",children:"    ."})]}),f.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full md:w-auto",children:[f.jsxs("div",{className:"relative",children:[f.jsxs("select",{className:"pl-8 pr-4 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm font-bold text-gray-700 outline-none focus:ring-2 focus:ring-primary appearance-none",value:qa,onChange:Y=>zn(Y.target.value),children:[f.jsx("option",{value:"all",children:" "}),f.jsx("option",{value:"project_manager",children:" "}),f.jsx("option",{value:"supervisor",children:""}),f.jsx("option",{value:"it_specialist",children:" IT"}),f.jsx("option",{value:"hr_admin",children:"  "})]}),f.jsx("span",{className:"material-icons absolute left-2 top-2 text-gray-400 text-sm pointer-events-none",children:"filter_list"})]}),f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:"text",placeholder:" ...",className:"pl-8 pr-4 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm font-bold outline-none focus:ring-2 focus:ring-primary w-full sm:w-48",value:Zn,onChange:Y=>es(Y.target.value)}),f.jsx("span",{className:"material-icons absolute left-2 top-2 text-gray-400 text-sm",children:"search"})]}),f.jsxs("button",{onClick:()=>{_r({...st,role:"supervisor"}),di({})},className:"bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-bold flex items-center justify-center gap-2 shadow-sm whitespace-nowrap",children:[f.jsx("span",{className:"material-icons text-sm",children:"add"}),"  "]})]})]}),f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full text-right text-sm",children:[f.jsx("thead",{className:"bg-gray-50 text-gray-500 font-bold uppercase rounded-lg",children:f.jsxs("tr",{children:[f.jsx("th",{className:"p-4 rounded-r-lg",children:""}),f.jsx("th",{className:"p-4",children:""}),f.jsx("th",{className:"p-4",children:" / "}),o.id==="all"&&f.jsx("th",{className:"p-4",children:""}),f.jsx("th",{className:"p-4 text-center rounded-l-lg",children:""})]})}),f.jsx("tbody",{className:"divide-y divide-gray-100",children:p.concat(w).concat(S).concat(N).filter(Y=>{const Ne=(Y.name||"").toLowerCase().includes(Zn.toLowerCase()),Pe=qa==="all"||Y.role===qa;return Ne&&Pe}).sort((Y,pe)=>Y.role.localeCompare(pe.role)).map(Y=>{var pe,Ne;return f.jsxs("tr",{className:"hover:bg-gray-50",children:[f.jsxs("td",{className:"p-4 font-bold text-gray-800 flex items-center gap-2",children:[f.jsx("div",{className:"relative",children:f.jsx("div",{className:`h-3 w-3 rounded-full ${a.has(Y.id)?"bg-green-500 animate-pulse":"bg-gray-300"}`})}),Y.name||f.jsx("span",{className:"text-gray-400 italic",children:"Unknown"})]}),f.jsx("td",{className:"p-4",children:f.jsx("span",{className:`px-2 py-1 rounded text-xs ${Y.role==="project_manager"?"bg-purple-100 text-purple-700":Y.role==="it_specialist"?"bg-cyan-100 text-cyan-700":Y.role==="hr_admin"?"bg-orange-100 text-orange-700":"bg-blue-100 text-blue-700"}`,children:Y.role==="project_manager"?" ":Y.role==="it_specialist"?" IT":Y.role==="hr_admin"?"  ":""})}),f.jsx("td",{className:"p-4 text-gray-600",children:Y.role==="supervisor"?f.jsxs("div",{className:"flex flex-col",children:[f.jsx("span",{className:"font-bold",children:Y.teamName}),Y.reportsTo&&f.jsxs("span",{className:"text-xs text-gray-400",children:[" : ",((pe=D.find(Pe=>Pe.id===Y.reportsTo))==null?void 0:pe.name)||" "]})]}):f.jsx("span",{className:"text-gray-400",children:"-"})}),o.id==="all"&&f.jsx("td",{className:"p-4 text-gray-600",children:((Ne=s.find(Pe=>Pe.id===Y.projectId))==null?void 0:Ne.name)||"  (Global)"}),f.jsxs("td",{className:"p-4 flex justify-center gap-2",children:[f.jsx("button",{onClick:()=>di(Y),className:"p-2 rounded text-orange-500 bg-orange-50 hover:bg-orange-100",title:"",children:f.jsx("span",{className:"material-icons text-sm",children:"edit"})}),f.jsx("button",{onClick:()=>ou(Y.id),className:"p-2 rounded text-red-500 bg-red-50 hover:bg-red-100",title:"",children:f.jsx("span",{className:"material-icons text-sm",children:"delete"})})]})]},Y.id)})})]})})]})}),(e==="operators"||e==="upload")&&f.jsx("div",{className:"space-y-6 animate-fade-in-up",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[f.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6 gap-4",children:[f.jsxs("h2",{className:"text-lg font-bold text-gray-800",children:["  (",M.length,")"]}),f.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[f.jsx("input",{type:"text",placeholder:" ...",className:"flex-1 border p-2 rounded-lg bg-gray-50 outline-none focus:ring-1 focus:ring-primary",value:Ca,onChange:Y=>K(Y.target.value)}),Ie.size>0&&o.id!=="all"&&f.jsx("button",{onClick:uu,className:"px-4 bg-red-50 text-red-600 rounded-lg font-bold text-sm",children:""})]})]}),f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full text-right text-sm",children:[f.jsx("thead",{className:"bg-gray-50 text-gray-500 font-bold uppercase rounded-lg",children:f.jsxs("tr",{children:[f.jsx("th",{className:"p-4 w-10 text-center",children:f.jsx("input",{type:"checkbox",disabled:o.id==="all",className:"w-4 h-4 rounded text-primary",onChange:()=>xo(M.filter(Y=>Y.name.includes(Ca)))})}),f.jsx("th",{className:"p-4",children:""}),f.jsx("th",{className:"p-4",children:""}),f.jsx("th",{className:"p-4",children:""})]})}),f.jsx("tbody",{className:"divide-y divide-gray-100",children:M.filter(Y=>Y.name.includes(Ca)).map(Y=>{var pe;return f.jsxs("tr",{className:`hover:bg-gray-50 ${Ie.has(Y.id)?"bg-blue-50":""}`,children:[f.jsx("td",{className:"p-4 text-center",children:f.jsx("input",{type:"checkbox",disabled:o.id==="all",className:"w-4 h-4 rounded text-primary",checked:Ie.has(Y.id),onChange:()=>id(Y.id)})}),f.jsx("td",{className:"p-4 font-bold text-gray-800",children:Y.name}),f.jsx("td",{className:"p-4 text-gray-600",children:(pe=p.find(Ne=>Ne.id===Y.supervisorId))==null?void 0:pe.name}),f.jsx("td",{className:"p-4 font-mono text-gray-500",children:Y.phone})]},Y.id)})})]})})]})})]}):f.jsxs("div",{className:"flex flex-col items-center justify-center h-96 bg-white rounded-xl shadow-sm border p-8 text-center",children:[f.jsx("span",{className:"material-icons text-5xl text-gray-300 mb-4",children:"domain_disabled"}),f.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"  "}),Ot&&f.jsx("button",{onClick:()=>wt(!0),className:"mt-4 bg-primary text-white px-6 py-2 rounded-lg font-bold",children:" "})]})]})},N0=({label:e,value:t,onChange:r,icon:a,colorClass:s})=>f.jsxs("div",{className:"bg-gray-50/50 p-5 rounded-lg border border-gray-100 hover:border-gray-200 transition-colors",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:`p-1.5 rounded bg-white shadow-sm ${s}`,children:f.jsx("span",{className:"material-icons text-lg block",children:a})}),f.jsx("span",{className:"font-bold text-gray-700",children:e})]}),f.jsx("span",{className:`text-xl font-bold ${s}`,children:t})]}),f.jsxs("div",{className:"relative h-8 flex items-center",children:[f.jsx("input",{type:"range",min:"1",max:"10",value:t,onChange:l=>r(Number(l.target.value)),className:"w-full z-10 relative",style:{direction:"ltr"}}),f.jsx("div",{className:"absolute top-1/2 left-0 w-full flex justify-between px-1 pointer-events-none transform -translate-y-1/2",children:[...Array(10)].map((l,o)=>f.jsx("div",{className:`w-0.5 h-1.5 rounded-full ${o+1<=t?"bg-current opacity-50":"bg-gray-300"}`},o))})]})]}),Y4=({user:e,activeTab:t})=>{var Ce;const[r,a]=ne.useState([]),[s,l]=ne.useState([]),[o,u]=ne.useState([]),[h,d]=ne.useState([]),[x,g]=ne.useState([]),[p,y]=ne.useState(new Set),[w,_]=ne.useState(!1),[S,T]=ne.useState(new Date),[N,E]=ne.useState({attitude:5,performance:5,quality:5,appearance:5}),[D,G]=ne.useState(""),[V,A]=ne.useState(""),[M,C]=ne.useState(""),[U,Z]=ne.useState(null),q=(Ae,Ge)=>{Z({message:Ae,type:Ge})},[le,ge]=ne.useState(!1),[Se,te]=ne.useState(""),[ae,De]=ne.useState(""),[ie,Me]=ne.useState(!1),[W,O]=ne.useState({title:"",category:"hardware",assetId:"",description:"",priority:"medium"}),[P,z]=ne.useState(""),[F,Q]=ne.useState(e.projectId||localStorage.getItem("current_project_id")||void 0),re=ne.useCallback(async()=>{let Ae=e.projectId||localStorage.getItem("current_project_id");if(Ae)Q(Ae);else try{const{data:Tt}=await Te.from("users").select("project_id").eq("id",e.id).maybeSingle();Tt&&Tt.project_id&&(Ae=Tt.project_id,Q(Ae),localStorage.setItem("current_project_id",Ae))}catch(Tt){console.error("Error resolving project ID:",Tt)}const Ge=await Xe.getOperatorsBySupervisor(e.id),mt=new Date().toISOString().split("T")[0],Ue=await Xe.getLogsByDateAndSupervisor(e.id,mt),Ve=await Xe.getTeamStats(e.id,mt);if(Ve&&G(Ve.volume),Ae){const Tt=await Xe.getUnlockRequests(Ae,e.id);d(Tt.filter(Rt=>Rt.date===mt));const Ke=await Xe.getAssets(Ae);g(Ke)}a(Ge),l(Ue),_(!1)},[e.id,e.projectId]);ne.useEffect(()=>{_(!0),re()},[re]),ne.useEffect(()=>{const Ae=`sup-logs-${e.id}-${Date.now()}`,Ge=`sup-reqs-${e.id}-${Date.now()}`,mt=Te.channel(Ae).on("postgres_changes",{event:"UPDATE",schema:"public",table:"kpi_logs",filter:`supervisor_id=eq.${e.id}`},()=>{re()}).subscribe(),Ue=Te.channel(Ge).on("postgres_changes",{event:"UPDATE",schema:"public",table:"unlock_requests",filter:`supervisor_id=eq.${e.id}`},Ve=>{Ve.new.status==="approved"?(q(`    : ${Ve.new.operator_name}`,"success"),re()):Ve.new.status==="rejected"&&(q(`   : ${Ve.new.operator_name}`,"error"),re())}).subscribe();return()=>{Te.removeChannel(Ue),Te.removeChannel(mt)}},[e.id,re]),ne.useEffect(()=>{(async()=>{if(t==="dashboard"){const Ge=await Xe.getLogsByMonth(S.getMonth(),S.getFullYear(),e.id);u(Ge)}})()},[S,e.id,t,s]);const Ee=Ae=>{const Ge=new Set(p);if(Ge.has(Ae)?Ge.delete(Ae):Ge.add(Ae),y(Ge),C(""),De(""),ge(!1),Ge.size===1){const mt=Array.from(Ge)[0],Ue=s.find(Ve=>Ve.operatorId===mt);E(Ue?{attitude:Ue.attitude,performance:Ue.performance,quality:Ue.quality,appearance:Ue.appearance}:{attitude:5,performance:5,quality:5,appearance:5})}else Ge.size>1&&p.size===1&&E({attitude:5,performance:5,quality:5,appearance:5});Ge.size>0&&window.innerWidth<1024&&setTimeout(()=>{var mt;(mt=document.getElementById("kpi-form"))==null||mt.scrollIntoView({behavior:"smooth"})},100)},ye=()=>{p.size===r.length?y(new Set):(y(new Set(r.map(Ae=>Ae.id))),E({attitude:5,performance:5,quality:5,appearance:5}),C(""),De(""),ge(!1))},Oe=async()=>{if(p.size===0)return;const Ae=Array.from(p).filter(Ke=>!s.some(Rt=>Rt.operatorId===Ke));if(Ae.length===0){C("      .");return}C(" ...");const Ge=Date.now(),mt=new Date().toISOString().split("T")[0],Ue=[],Ve=F||e.projectId||"";Ae.forEach(Ke=>{Ue.push({id:`${Ke}-${mt}`,operatorId:Ke,supervisorId:e.id,projectId:Ve,date:mt,timestamp:Ge,...N})});const Tt=await Xe.saveLogs(Ue);Tt.success?(l(Ke=>[...Ke,...Ue.map(Rt=>({...Rt,status:"pending"}))]),C("   ( )!"),p.size>1&&setTimeout(()=>y(new Set),1500),setTimeout(()=>C(""),3e3)):C(` : ${Tt.error}`)},tt=async()=>{if(D===""||!F)return;A("saving");const Ae=new Date().toISOString().split("T")[0],Ge=await Xe.saveTeamStats({supervisorId:e.id,projectId:F,date:Ae,volume:Number(D)});Ge.success?(A("saved"),setTimeout(()=>A(""),2e3)):(q("Error saving volume: "+Ge.error,"error"),A("error"))},J=async()=>{if(p.size!==1||!Se.trim()||!F)return;const Ae=Array.from(p)[0],Ge=r.find(Ue=>Ue.id===Ae),mt=s.find(Ue=>Ue.operatorId===Ae);if(Ge){De("sending");try{const{success:Ue,error:Ve}=await Xe.createUnlockRequest(Ge.id,Ge.name,e.id,e.name,F,Se,mt==null?void 0:mt.id);Ue?(De("sent"),C("   ."),re(),ge(!1),te(""),q("   ","success")):(De("error"),q(`: ${Ve}`,"error"))}catch(Ue){De("error"),q(`Error: ${Ue.message}`,"error")}}},wt=async Ae=>{if(Ae.preventDefault(),!F)return;z("sending");const Ge=await Xe.createTicket({...W,createdBy:e.id,projectId:F});Ge.success?(z("success"),q("    ","success"),setTimeout(()=>{Me(!1),O({title:"",category:"hardware",assetId:"",description:"",priority:"medium"}),z("")},1500)):(q(`Error: ${Ge.error}`,"error"),z(""))},et=Ae=>{T(new Date(S.getFullYear(),S.getMonth()+Ae,1))},gt=()=>{const Ae=S.getFullYear(),Ge=S.getMonth(),mt=new Date(Ae,Ge,1),Ve=new Date(Ae,Ge+1,0).getDate(),Tt=mt.getDay(),Ke=["","","","","","","","","","","",""],Rt=[];for(let zt=0;zt<Tt;zt++)Rt.push(f.jsx("div",{className:"h-24 bg-gray-50/50 border border-gray-100/50"},`empty-${zt}`));for(let zt=1;zt<=Ve;zt++){const ua=`${Ae}-${String(Ge+1).padStart(2,"0")}-${String(zt).padStart(2,"0")}`,ir=o.filter(It=>It.date===ua),or=ir.length,nt=r.length,Ht=new Date().toISOString().split("T")[0]===ua,Hr=or>0?(ir.reduce((It,Gt)=>It+(Gt.attitude+Gt.performance+Gt.quality+Gt.appearance)/4,0)/or).toFixed(1):"-";Rt.push(f.jsxs("div",{className:`h-24 border border-gray-100 p-2 flex flex-col justify-between transition-colors ${Ht?"bg-blue-50 ring-1 ring-blue-200":"bg-white"}`,children:[f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{className:`text-sm font-bold ${Ht?"text-blue-600":"text-gray-700"}`,children:zt}),or>0&&f.jsxs("span",{className:"text-xs font-bold text-gray-400",children:[Hr," "]})]}),or>0?f.jsxs("div",{className:`text-xs rounded px-1.5 py-1 flex items-center justify-between ${or>=nt?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:[f.jsxs("span",{className:"font-bold",children:[or,"/",nt]}),f.jsx("span",{className:"material-icons text-sm",children:or>=nt?"check_circle":"hourglass_bottom"})]}):f.jsx("div",{className:"h-6"})]},zt))}return f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[f.jsxs("div",{className:"p-4 bg-gray-50 border-b flex justify-between items-center",children:[f.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[f.jsx("span",{className:"material-icons text-primary",children:"calendar_month"}),"  "]}),f.jsxs("div",{className:"flex gap-2 text-sm font-bold text-gray-600",children:[f.jsx("button",{onClick:()=>et(-1),className:"hover:text-primary",children:""}),f.jsxs("span",{children:[Ke[Ge]," ",Ae]}),f.jsx("button",{onClick:()=>et(1),className:"hover:text-primary",children:""})]})]}),f.jsxs("div",{className:"grid grid-cols-7 text-center bg-gray-100 text-xs font-bold text-gray-500 py-2 border-b",children:[f.jsx("div",{children:""}),f.jsx("div",{children:""}),f.jsx("div",{children:""}),f.jsx("div",{children:""}),f.jsx("div",{children:""}),f.jsx("div",{children:""}),f.jsx("div",{children:""})]}),f.jsx("div",{className:"grid grid-cols-7 bg-gray-50",children:Rt})]})};if(w)return f.jsx("div",{className:"flex h-96 items-center justify-center text-primary",children:f.jsx("span",{className:"material-icons animate-spin text-4xl",children:"donut_large"})});const it=r.length-s.length;return f.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[U&&f.jsx(lo,{message:U.message,type:U.type,onClose:()=>Z(null)}),it>0&&r.length>0&&f.jsxs("div",{className:"bg-amber-50 border-r-4 border-amber-500 p-4 rounded-lg shadow-sm flex items-center gap-4 animate-pulse",children:[f.jsx("div",{className:"bg-amber-100 p-2 rounded-full text-amber-600",children:f.jsx("span",{className:"material-icons",children:"priority_high"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-bold text-amber-800 text-lg",children:":   "}),f.jsxs("p",{className:"text-amber-700 text-sm",children:[" ",f.jsx("span",{className:"font-bold text-amber-900",children:it}),"     .   ."]})]}),f.jsx("button",{onClick:()=>Me(!0),className:"mr-auto bg-white/50 border border-amber-200 text-amber-800 px-4 py-1 rounded-lg text-sm font-bold hover:bg-white",children:"  "})]}),t==="kpi"?f.jsxs("div",{className:"relative animate-fade-in-up",children:[f.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-6",children:f.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[f.jsxs("div",{children:[f.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[f.jsx("span",{className:"material-icons text-blue-600",children:"inventory_2"}),"   (Team Volume)"]}),f.jsx("p",{className:"text-gray-400 text-sm",children:"      ."})]}),f.jsxs("div",{className:"flex items-center gap-2 w-full md:w-auto",children:[f.jsx("input",{type:"number",min:"0",placeholder:"0",className:"flex-1 md:w-48 p-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary outline-none font-bold text-center text-lg",value:D,onChange:Ae=>G(Number(Ae.target.value))}),f.jsx("button",{onClick:tt,disabled:V==="saving",className:`px-6 py-3 rounded-lg font-bold text-white transition-all ${V==="saved"?"bg-green-500 hover:bg-green-600":"bg-primary hover:bg-primary-dark"}`,children:V==="saving"?f.jsx("span",{className:"material-icons animate-spin",children:"sync"}):V==="saved"?f.jsx("span",{className:"material-icons",children:"check"}):""})]})]})}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 h-auto lg:h-[calc(100vh-200px)]",children:[f.jsxs("div",{className:"lg:col-span-4 bg-white rounded-xl shadow-sm flex flex-col overflow-hidden border border-gray-100 h-96 lg:h-auto",children:[f.jsxs("div",{className:"p-4 border-b bg-gray-50 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("h2",{className:"font-bold text-gray-700",children:" "}),it>0&&f.jsxs("span",{className:"text-xs font-bold text-amber-600 bg-amber-50 px-2 py-0.5 rounded-full border border-amber-200",children:[": ",it]}),f.jsx("button",{onClick:re,className:"p-1 rounded hover:bg-gray-100 text-gray-400",children:f.jsx("span",{className:"material-icons text-sm",children:"refresh"})})]}),f.jsx("button",{onClick:ye,className:"text-xs font-bold text-primary hover:bg-blue-50 px-2 py-1 rounded",children:p.size===r.length?" ":" "})]}),f.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:r.map(Ae=>{const Ge=s.find(Tt=>Tt.operatorId===Ae.id),mt=!!Ge,Ue=p.has(Ae.id);let Ve=f.jsx("span",{className:"material-icons text-green-500 text-sm",children:"check_circle"});return mt&&(Ge.status==="pending"?Ve=f.jsx("span",{className:"material-icons text-yellow-500 text-sm",children:"hourglass_empty"}):Ge.status==="rejected"&&(Ve=f.jsx("span",{className:"material-icons text-red-500 text-sm",children:"cancel"}))),f.jsxs("button",{onClick:()=>Ee(Ae.id),className:`w-full flex items-center justify-between p-3 rounded-lg border transition-all ${Ue?"bg-blue-50 border-primary shadow-sm":"border-transparent hover:bg-gray-50"}`,children:[f.jsxs("div",{className:"flex items-center gap-3 w-full",children:[f.jsx("div",{className:`w-5 h-5 rounded border flex items-center justify-center ${Ue?"bg-primary border-primary":"border-gray-300 bg-white"}`,children:Ue&&f.jsx("span",{className:"material-icons text-white text-sm",children:"check"})}),f.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold ${Ue?"bg-primary text-white":"bg-gray-200 text-gray-600"}`,children:Ae.name.charAt(0)}),f.jsx("div",{className:"text-right flex-1",children:f.jsx("p",{className:`text-sm font-bold ${Ue?"text-primary":"text-gray-800"}`,children:Ae.name})})]}),mt&&Ve]},Ae.id)})})]}),f.jsx("div",{id:"kpi-form",className:"lg:col-span-8 bg-white rounded-xl shadow-sm border border-gray-100 p-6 flex flex-col relative overflow-hidden min-h-[400px]",children:p.size>0?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex justify-between items-center mb-6 border-b pb-4",children:[f.jsxs("div",{children:[f.jsx("h2",{className:"text-xl font-bold text-gray-800",children:p.size===1?(Ce=r.find(Ae=>Ae.id===Array.from(p)[0]))==null?void 0:Ce.name:`  (${p.size})`}),f.jsx("p",{className:"text-gray-400 text-xs mt-1",children:new Date().toLocaleDateString("ar-EG",{weekday:"long",day:"numeric",month:"long"})})]}),M&&f.jsx("span",{className:`font-bold px-3 py-1 rounded text-sm ${M.includes("")||M.includes("")?"bg-red-50 text-red-600":"bg-green-50 text-green-600"}`,children:M})]}),(()=>{var mt,Ue;let Ae=!1,Ge=null;if(p.size===1){const Ve=Array.from(p)[0];s.find(Ke=>Ke.operatorId===Ve)&&(Ae=!0,Ge=h.find(Ke=>Ke.operatorId===Ve&&Ke.status==="pending"))}else if(p.size>1){const Ve=Array.from(p).filter(Tt=>s.some(Ke=>Ke.operatorId===Tt)).length;Ve>0&&Ve===p.size&&(Ae=!0)}return Ae?f.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center p-6 bg-gray-50 rounded-lg border border-dashed border-gray-200",children:[p.size===1&&((mt=s.find(Ve=>Ve.operatorId===Array.from(p)[0]))==null?void 0:mt.status)==="pending"?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"bg-yellow-100 p-4 rounded-full mb-4",children:f.jsx("span",{className:"material-icons text-4xl text-yellow-600",children:"hourglass_top"})}),f.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:" "}),f.jsx("p",{className:"text-gray-500 mb-6 text-sm",children:"      ."})]}):p.size===1&&((Ue=s.find(Ve=>Ve.operatorId===Array.from(p)[0]))==null?void 0:Ue.status)==="rejected"?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"bg-red-100 p-4 rounded-full mb-4",children:f.jsx("span",{className:"material-icons text-4xl text-red-600",children:"error"})}),f.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"  "}),f.jsx("p",{className:"text-gray-500 mb-6 text-sm",children:"     ."})]}):f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"bg-green-100 p-4 rounded-full mb-4",children:f.jsx("span",{className:"material-icons text-4xl text-green-600",children:"verified"})}),f.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"  "}),f.jsx("p",{className:"text-gray-500 mb-6 text-sm",children:"     ."})]}),p.size===1&&(Ge?f.jsxs("div",{className:"bg-yellow-50 text-yellow-700 px-4 py-2 rounded-lg flex items-center gap-2 text-sm font-bold",children:[f.jsx("span",{className:"material-icons",children:"hourglass_empty"}),"   ..."]}):f.jsxs("button",{onClick:()=>ge(!0),className:"bg-white border border-gray-300 text-gray-700 px-6 py-2 rounded-lg font-bold hover:bg-gray-100 flex items-center gap-2",children:[f.jsx("span",{className:"material-icons",children:"lock_open"}),"  "]}))]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"space-y-4 mb-8 flex-1 overflow-y-auto",children:[f.jsx(N0,{label:" (Attitude)",icon:"sentiment_satisfied_alt",value:N.attitude,onChange:Ve=>E({...N,attitude:Ve}),colorClass:"text-blue-600"}),f.jsx(N0,{label:" (Performance)",icon:"speed",value:N.performance,onChange:Ve=>E({...N,performance:Ve}),colorClass:"text-indigo-600"}),f.jsx(N0,{label:" (Quality)",icon:"verified",value:N.quality,onChange:Ve=>E({...N,quality:Ve}),colorClass:"text-purple-600"}),f.jsx(N0,{label:" (Appearance)",icon:"accessibility_new",value:N.appearance,onChange:Ve=>E({...N,appearance:Ve}),colorClass:"text-pink-600"})]}),f.jsx("button",{onClick:Oe,className:"w-full bg-primary text-white py-4 rounded-lg font-bold text-lg hover:bg-primary-dark shadow-lg shadow-blue-500/20",children:p.size>1?"  ":" "})]})})()]}):f.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-gray-300",children:[f.jsx("span",{className:"material-icons text-8xl mb-4",children:"checklist_rtl"}),f.jsx("p",{className:"text-xl",children:"  "}),f.jsxs("button",{onClick:()=>Me(!0),className:"mt-8 text-primary font-bold hover:underline flex items-center gap-1",children:[f.jsx("span",{className:"material-icons text-sm",children:"support_agent"}),"     "]})]})})]})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[f.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-gray-400 text-xs font-bold uppercase mb-1",children:" "}),f.jsx("h3",{className:"text-4xl font-bold text-gray-800",children:r.length})]}),f.jsx("div",{className:"h-12 w-12 rounded-full bg-blue-50 flex items-center justify-center text-blue-600",children:f.jsx("span",{className:"material-icons",children:"groups"})})]}),f.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex items-center justify-between relative overflow-hidden",children:[f.jsxs("div",{className:"z-10",children:[f.jsx("p",{className:"text-gray-400 text-xs font-bold uppercase mb-1",children:" "}),f.jsxs("h3",{className:"text-4xl font-bold text-gray-800",children:[s.length," ",f.jsxs("span",{className:"text-xl text-gray-400",children:["/ ",r.length]})]})]}),f.jsxs("div",{className:"relative h-16 w-16",children:[f.jsxs("svg",{className:"h-full w-full transform -rotate-90",viewBox:"0 0 36 36",children:[f.jsx("path",{className:"text-gray-100",d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:`${s.length===r.length&&r.length>0?"text-green-500":"text-primary"}`,strokeDasharray:`${r.length>0?s.length/r.length*100:0}, 100`,d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"currentColor",strokeWidth:"4"})]}),f.jsxs("div",{className:"absolute inset-0 flex items-center justify-center text-xs font-bold text-gray-600",children:[r.length>0?Math.round(s.length/r.length*100):0,"%"]})]})]}),f.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex items-center justify-between group cursor-pointer hover:border-primary transition-colors",onClick:()=>Me(!0),children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-gray-400 text-xs font-bold uppercase mb-1",children:" "}),f.jsx("h3",{className:"text-lg font-bold text-primary group-hover:scale-105 transition-transform",children:"  "})]}),f.jsx("div",{className:"h-12 w-12 rounded-full bg-orange-50 flex items-center justify-center text-orange-600 group-hover:bg-orange-600 group-hover:text-white transition-colors",children:f.jsx("span",{className:"material-icons",children:"confirmation_number"})})]})]}),gt(),f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[f.jsxs("div",{className:"p-5 border-b border-gray-100 bg-white flex justify-between items-center",children:[f.jsx("h2",{className:"text-lg font-bold text-gray-800",children:"  "}),f.jsx("span",{className:"text-xs font-mono bg-gray-100 px-2 py-1 rounded text-gray-500",children:new Date().toISOString().split("T")[0]}),f.jsx("button",{onClick:re,className:"p-2 rounded-full hover:bg-gray-100 text-gray-400",title:" ",children:f.jsx("span",{className:"material-icons",children:"refresh"})})]}),f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full text-right",children:[f.jsx("thead",{className:"bg-gray-50 text-gray-500 text-xs font-bold uppercase",children:f.jsxs("tr",{children:[f.jsx("th",{className:"p-4",children:""}),f.jsx("th",{className:"p-4",children:""}),f.jsx("th",{className:"p-4",children:""}),f.jsx("th",{className:"p-4",children:""})]})}),f.jsx("tbody",{className:"divide-y divide-gray-50",children:r.map(Ae=>{const Ge=s.find(Tt=>Tt.operatorId===Ae.id),mt=!!Ge,Ue=Ge?((Ge.attitude+Ge.performance+Ge.quality+Ge.appearance)/4).toFixed(1):"-";let Ve=f.jsx("span",{className:"inline-flex items-center gap-1 bg-gray-100 text-gray-400 px-2 py-1 rounded text-xs font-bold",children:""});return mt&&(Ge.status==="pending"?Ve=f.jsxs("span",{className:"inline-flex items-center gap-1 bg-yellow-100 text-yellow-700 px-2 py-1 rounded text-xs font-bold",children:[f.jsx("span",{className:"material-icons text-sm",children:"hourglass_empty"})," "]}):Ge.status==="rejected"?Ve=f.jsxs("span",{className:"inline-flex items-center gap-1 bg-red-100 text-red-700 px-2 py-1 rounded text-xs font-bold",children:[f.jsx("span",{className:"material-icons text-sm",children:"cancel"})," "]}):Ve=f.jsxs("span",{className:"inline-flex items-center gap-1 bg-green-100 text-green-700 px-2 py-1 rounded text-xs font-bold",children:[f.jsx("span",{className:"material-icons text-sm",children:"check"})," "]})),f.jsxs("tr",{className:"hover:bg-gray-50",children:[f.jsx("td",{className:"p-4 font-bold text-gray-800",children:Ae.name}),f.jsx("td",{className:"p-4 text-gray-500 font-mono text-xs",children:Ae.phone}),f.jsx("td",{className:"p-4 font-bold text-primary",children:Ue}),f.jsx("td",{className:"p-4",children:Ve})]},Ae.id)})})]})})]})]}),ie&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md p-6 animate-fade-in-up",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6 border-b pb-2",children:[f.jsxs("h3",{className:"font-bold text-lg text-gray-800 flex items-center gap-2",children:[f.jsx("span",{className:"material-icons text-primary",children:"confirmation_number"}),"   "]}),f.jsx("button",{onClick:()=>Me(!1),className:"text-gray-400 hover:text-red-500",children:f.jsx("span",{className:"material-icons",children:"close"})})]}),P==="success"?f.jsxs("div",{className:"text-center py-8",children:[f.jsx("span",{className:"material-icons text-6xl text-green-500 mb-4 animate-bounce",children:"check_circle"}),f.jsx("h4",{className:"text-xl font-bold text-gray-800",children:"  !"}),f.jsx("p",{className:"text-gray-500 mt-2",children:"    ."})]}):f.jsxs("form",{onSubmit:wt,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1 uppercase tracking-wider",children:" "}),f.jsx("input",{required:!0,className:"w-full p-3 bg-gray-50 border rounded-lg focus:ring-2 focus:ring-primary outline-none",placeholder:":    ",value:W.title,onChange:Ae=>O({...W,title:Ae.target.value})})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:""}),f.jsxs("select",{className:"w-full p-3 bg-gray-50 border rounded-lg",value:W.category,onChange:Ae=>O({...W,category:Ae.target.value}),children:[f.jsx("option",{value:"hardware",children:" (Hardware)"}),f.jsx("option",{value:"software",children:" (Software)"}),f.jsx("option",{value:"tools",children:"  (Tools)"}),f.jsx("option",{value:"network",children:" (Network)"}),f.jsx("option",{value:"other",children:""})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:""}),f.jsxs("select",{className:"w-full p-3 bg-gray-50 border rounded-lg",value:W.priority,onChange:Ae=>O({...W,priority:Ae.target.value}),children:[f.jsx("option",{value:"low",children:""}),f.jsx("option",{value:"medium",children:""}),f.jsx("option",{value:"high",children:""}),f.jsx("option",{value:"critical",children:" "})]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"  ()"}),f.jsxs("select",{className:"w-full p-3 bg-gray-50 border rounded-lg",value:W.assetId,onChange:Ae=>O({...W,assetId:Ae.target.value}),children:[f.jsx("option",{value:"",children:"--     --"}),x.map(Ae=>f.jsxs("option",{value:Ae.id,children:[Ae.name," (",Ae.assetTag||Ae.serialNumber,")"]},Ae.id))]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:""}),f.jsx("textarea",{required:!0,className:"w-full p-3 bg-gray-50 border rounded-lg h-24",placeholder:"   ...",value:W.description,onChange:Ae=>O({...W,description:Ae.target.value})})]}),f.jsxs("button",{type:"submit",disabled:P==="sending",className:"w-full bg-primary text-white py-3.5 rounded-xl font-bold hover:bg-primary-dark transition-all shadow-lg flex justify-center items-center gap-2",children:[P==="sending"?f.jsx("span",{className:"material-icons animate-spin",children:"sync"}):f.jsx("span",{className:"material-icons",children:"send"}),"   "]})]})]})}),le&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-sm p-6",children:[f.jsx("h3",{className:"font-bold mb-4",children:" "}),f.jsx("textarea",{className:"w-full border rounded-lg p-3 text-sm",rows:3,value:Se,onChange:Ae=>te(Ae.target.value),placeholder:"  ..."}),f.jsx("button",{onClick:J,disabled:!Se.trim(),className:"w-full mt-4 bg-primary text-white py-2 rounded-lg font-bold disabled:bg-gray-300",children:" "}),f.jsx("button",{onClick:()=>ge(!1),className:"w-full mt-2 text-gray-400 text-sm",children:""})]})})]})};var j0={},nc={},A0={},iy;function on(){if(iy)return A0;iy=1,Object.defineProperty(A0,"__esModule",{value:!0});function e(r,a){if(!(r instanceof a))throw new TypeError("Cannot call a class as a function")}var t=function r(a,s){e(this,r),this.data=a,this.text=s.text||a,this.options=s};return A0.default=t,A0}var ly;function J4(){if(ly)return nc;ly=1,Object.defineProperty(nc,"__esModule",{value:!0}),nc.CODE39=void 0;var e=(function(){function _(S,T){for(var N=0;N<T.length;N++){var E=T[N];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(S,E.key,E)}}return function(S,T,N){return T&&_(S.prototype,T),N&&_(S,N),S}})(),t=on(),r=a(t);function a(_){return _&&_.__esModule?_:{default:_}}function s(_,S){if(!(_ instanceof S))throw new TypeError("Cannot call a class as a function")}function l(_,S){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:_}function o(_,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);_.prototype=Object.create(S&&S.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(_,S):_.__proto__=S)}var u=(function(_){o(S,_);function S(T,N){return s(this,S),T=T.toUpperCase(),N.mod43&&(T+=p(w(T))),l(this,(S.__proto__||Object.getPrototypeOf(S)).call(this,T,N))}return e(S,[{key:"encode",value:function(){for(var N=x("*"),E=0;E<this.data.length;E++)N+=x(this.data[E])+"0";return N+=x("*"),{data:N,text:this.text}}},{key:"valid",value:function(){return this.data.search(/^[0-9A-Z\-\.\ \$\/\+\%]+$/)!==-1}}]),S})(r.default),h=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","*"],d=[20957,29783,23639,30485,20951,29813,23669,20855,29789,23645,29975,23831,30533,22295,30149,24005,21623,29981,23837,22301,30023,23879,30545,22343,30161,24017,21959,30065,23921,22385,29015,18263,29141,17879,29045,18293,17783,29021,18269,17477,17489,17681,20753,35770];function x(_){return g(y(_))}function g(_){return d[_].toString(2)}function p(_){return h[_]}function y(_){return h.indexOf(_)}function w(_){for(var S=0,T=0;T<_.length;T++)S+=y(_[T]);return S=S%43,S}return nc.CODE39=u,nc}var Rn={},O0={},C0={},Er={},oy;function Xc(){if(oy)return Er;oy=1,Object.defineProperty(Er,"__esModule",{value:!0});var e;function t(h,d,x){return d in h?Object.defineProperty(h,d,{value:x,enumerable:!0,configurable:!0,writable:!0}):h[d]=x,h}var r=Er.SET_A=0,a=Er.SET_B=1,s=Er.SET_C=2;Er.SHIFT=98;var l=Er.START_A=103,o=Er.START_B=104,u=Er.START_C=105;return Er.MODULO=103,Er.STOP=106,Er.FNC1=207,Er.SET_BY_CODE=(e={},t(e,l,r),t(e,o,a),t(e,u,s),e),Er.SWAP={101:r,100:a,99:s},Er.A_START_CHAR="",Er.B_START_CHAR="",Er.C_START_CHAR="",Er.A_CHARS="[\0-_-]",Er.B_CHARS="[ --]",Er.C_CHARS="(*[0-9]{2}*)",Er.BARS=[11011001100,11001101100,11001100110,10010011e3,10010001100,10001001100,10011001e3,10011000100,10001100100,11001001e3,11001000100,11000100100,10110011100,10011011100,10011001110,10111001100,10011101100,10011100110,11001110010,11001011100,11001001110,11011100100,11001110100,11101101110,11101001100,11100101100,11100100110,11101100100,11100110100,11100110010,11011011e3,11011000110,11000110110,10100011e3,10001011e3,10001000110,10110001e3,10001101e3,10001100010,11010001e3,11000101e3,11000100010,10110111e3,10110001110,10001101110,10111011e3,10111000110,10001110110,11101110110,11010001110,11000101110,11011101e3,11011100010,11011101110,11101011e3,11101000110,11100010110,11101101e3,11101100010,11100011010,11101111010,11001000010,11110001010,1010011e4,10100001100,1001011e4,10010000110,10000101100,10000100110,1011001e4,10110000100,1001101e4,10011000010,10000110100,10000110010,11000010010,1100101e4,11110111010,11000010100,10001111010,10100111100,10010111100,10010011110,10111100100,10011110100,10011110010,11110100100,11110010100,11110010010,11011011110,11011110110,11110110110,10101111e3,10100011110,10001011110,10111101e3,10111100010,11110101e3,11110100010,10111011110,10111101110,11101011110,11110101110,11010000100,1101001e4,11010011100,1100011101011],Er}var cy;function Gf(){if(cy)return C0;cy=1,Object.defineProperty(C0,"__esModule",{value:!0});var e=(function(){function d(x,g){for(var p=0;p<g.length;p++){var y=g[p];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(x,y.key,y)}}return function(x,g,p){return g&&d(x.prototype,g),p&&d(x,p),x}})(),t=on(),r=s(t),a=Xc();function s(d){return d&&d.__esModule?d:{default:d}}function l(d,x){if(!(d instanceof x))throw new TypeError("Cannot call a class as a function")}function o(d,x){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:d}function u(d,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);d.prototype=Object.create(x&&x.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(d,x):d.__proto__=x)}var h=(function(d){u(x,d);function x(g,p){l(this,x);var y=o(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,g.substring(1),p));return y.bytes=g.split("").map(function(w){return w.charCodeAt(0)}),y}return e(x,[{key:"valid",value:function(){return/^[\x00-\x7F\xC8-\xD3]+$/.test(this.data)}},{key:"encode",value:function(){var p=this.bytes,y=p.shift()-105,w=a.SET_BY_CODE[y];if(w===void 0)throw new RangeError("The encoding does not start with a start character.");this.shouldEncodeAsEan128()===!0&&p.unshift(a.FNC1);var _=x.next(p,1,w);return{text:this.text===this.data?this.text.replace(/[^\x20-\x7E]/g,""):this.text,data:x.getBar(y)+_.result+x.getBar((_.checksum+y)%a.MODULO)+x.getBar(a.STOP)}}},{key:"shouldEncodeAsEan128",value:function(){var p=this.options.ean128||!1;return typeof p=="string"&&(p=p.toLowerCase()==="true"),p}}],[{key:"getBar",value:function(p){return a.BARS[p]?a.BARS[p].toString():""}},{key:"correctIndex",value:function(p,y){if(y===a.SET_A){var w=p.shift();return w<32?w+64:w-32}else return y===a.SET_B?p.shift()-32:(p.shift()-48)*10+p.shift()-48}},{key:"next",value:function(p,y,w){if(!p.length)return{result:"",checksum:0};var _=void 0,S=void 0;if(p[0]>=200){S=p.shift()-105;var T=a.SWAP[S];T!==void 0?_=x.next(p,y+1,T):((w===a.SET_A||w===a.SET_B)&&S===a.SHIFT&&(p[0]=w===a.SET_A?p[0]>95?p[0]-96:p[0]:p[0]<32?p[0]+96:p[0]),_=x.next(p,y+1,w))}else S=x.correctIndex(p,w),_=x.next(p,y+1,w);var N=x.getBar(S),E=S*y;return{result:N+_.result,checksum:E+_.checksum}}}]),x})(r.default);return C0.default=h,C0}var R0={},uy;function Q4(){if(uy)return R0;uy=1,Object.defineProperty(R0,"__esModule",{value:!0});var e=Xc(),t=function(u){return u.match(new RegExp("^"+e.A_CHARS+"*"))[0].length},r=function(u){return u.match(new RegExp("^"+e.B_CHARS+"*"))[0].length},a=function(u){return u.match(new RegExp("^"+e.C_CHARS+"*"))[0]};function s(o,u){var h=u?e.A_CHARS:e.B_CHARS,d=o.match(new RegExp("^("+h+"+?)(([0-9]{2}){2,})([^0-9]|$)"));if(d)return d[1]+""+l(o.substring(d[1].length));var x=o.match(new RegExp("^"+h+"+"))[0];return x.length===o.length?o:x+String.fromCharCode(u?205:206)+s(o.substring(x.length),!u)}function l(o){var u=a(o),h=u.length;if(h===o.length)return o;o=o.substring(h);var d=t(o)>=r(o);return u+String.fromCharCode(d?206:205)+s(o,d)}return R0.default=function(o){var u=void 0,h=a(o).length;if(h>=2)u=e.C_START_CHAR+l(o);else{var d=t(o)>r(o);u=(d?e.A_START_CHAR:e.B_START_CHAR)+s(o,d)}return u.replace(/[\xCD\xCE]([^])[\xCD\xCE]/,function(x,g){return""+g})},R0}var fy;function Z4(){if(fy)return O0;fy=1,Object.defineProperty(O0,"__esModule",{value:!0});var e=Gf(),t=s(e),r=Q4(),a=s(r);function s(d){return d&&d.__esModule?d:{default:d}}function l(d,x){if(!(d instanceof x))throw new TypeError("Cannot call a class as a function")}function o(d,x){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:d}function u(d,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);d.prototype=Object.create(x&&x.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(d,x):d.__proto__=x)}var h=(function(d){u(x,d);function x(g,p){if(l(this,x),/^[\x00-\x7F\xC8-\xD3]+$/.test(g))var y=o(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,(0,a.default)(g),p));else var y=o(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,g,p));return o(y)}return x})(t.default);return O0.default=h,O0}var D0={},dy;function eN(){if(dy)return D0;dy=1,Object.defineProperty(D0,"__esModule",{value:!0});var e=(function(){function d(x,g){for(var p=0;p<g.length;p++){var y=g[p];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(x,y.key,y)}}return function(x,g,p){return g&&d(x.prototype,g),p&&d(x,p),x}})(),t=Gf(),r=s(t),a=Xc();function s(d){return d&&d.__esModule?d:{default:d}}function l(d,x){if(!(d instanceof x))throw new TypeError("Cannot call a class as a function")}function o(d,x){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:d}function u(d,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);d.prototype=Object.create(x&&x.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(d,x):d.__proto__=x)}var h=(function(d){u(x,d);function x(g,p){return l(this,x),o(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,a.A_START_CHAR+g,p))}return e(x,[{key:"valid",value:function(){return new RegExp("^"+a.A_CHARS+"+$").test(this.data)}}]),x})(r.default);return D0.default=h,D0}var F0={},hy;function tN(){if(hy)return F0;hy=1,Object.defineProperty(F0,"__esModule",{value:!0});var e=(function(){function d(x,g){for(var p=0;p<g.length;p++){var y=g[p];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(x,y.key,y)}}return function(x,g,p){return g&&d(x.prototype,g),p&&d(x,p),x}})(),t=Gf(),r=s(t),a=Xc();function s(d){return d&&d.__esModule?d:{default:d}}function l(d,x){if(!(d instanceof x))throw new TypeError("Cannot call a class as a function")}function o(d,x){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:d}function u(d,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);d.prototype=Object.create(x&&x.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(d,x):d.__proto__=x)}var h=(function(d){u(x,d);function x(g,p){return l(this,x),o(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,a.B_START_CHAR+g,p))}return e(x,[{key:"valid",value:function(){return new RegExp("^"+a.B_CHARS+"+$").test(this.data)}}]),x})(r.default);return F0.default=h,F0}var M0={},my;function rN(){if(my)return M0;my=1,Object.defineProperty(M0,"__esModule",{value:!0});var e=(function(){function d(x,g){for(var p=0;p<g.length;p++){var y=g[p];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(x,y.key,y)}}return function(x,g,p){return g&&d(x.prototype,g),p&&d(x,p),x}})(),t=Gf(),r=s(t),a=Xc();function s(d){return d&&d.__esModule?d:{default:d}}function l(d,x){if(!(d instanceof x))throw new TypeError("Cannot call a class as a function")}function o(d,x){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:d}function u(d,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);d.prototype=Object.create(x&&x.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(d,x):d.__proto__=x)}var h=(function(d){u(x,d);function x(g,p){return l(this,x),o(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,a.C_START_CHAR+g,p))}return e(x,[{key:"valid",value:function(){return new RegExp("^"+a.C_CHARS+"+$").test(this.data)}}]),x})(r.default);return M0.default=h,M0}var xy;function aN(){if(xy)return Rn;xy=1,Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.CODE128C=Rn.CODE128B=Rn.CODE128A=Rn.CODE128=void 0;var e=Z4(),t=h(e),r=eN(),a=h(r),s=tN(),l=h(s),o=rN(),u=h(o);function h(d){return d&&d.__esModule?d:{default:d}}return Rn.CODE128=t.default,Rn.CODE128A=a.default,Rn.CODE128B=l.default,Rn.CODE128C=u.default,Rn}var Na={},I0={},ps={},py;function Wc(){return py||(py=1,Object.defineProperty(ps,"__esModule",{value:!0}),ps.SIDE_BIN="101",ps.MIDDLE_BIN="01010",ps.BINARIES={L:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],G:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"],R:["1110010","1100110","1101100","1000010","1011100","1001110","1010000","1000100","1001000","1110100"],O:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],E:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"]},ps.EAN2_STRUCTURE=["LL","LG","GL","GG"],ps.EAN5_STRUCTURE=["GGLLL","GLGLL","GLLGL","GLLLG","LGGLL","LLGGL","LLLGG","LGLGL","LGLLG","LLGLG"],ps.EAN13_STRUCTURE=["LLLLLL","LLGLGG","LLGGLG","LLGGGL","LGLLGG","LGGLLG","LGGGLL","LGLGLG","LGLGGL","LGGLGL"]),ps}var L0={},B0={},gy;function Kc(){if(gy)return B0;gy=1,Object.defineProperty(B0,"__esModule",{value:!0});var e=Wc(),t=function(a,s,l){var o=a.split("").map(function(h,d){return e.BINARIES[s[d]]}).map(function(h,d){return h?h[a[d]]:""});if(l){var u=a.length-1;o=o.map(function(h,d){return d<u?h+l:h})}return o.join("")};return B0.default=t,B0}var vy;function Bb(){if(vy)return L0;vy=1,Object.defineProperty(L0,"__esModule",{value:!0});var e=(function(){function g(p,y){for(var w=0;w<y.length;w++){var _=y[w];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(p,_.key,_)}}return function(p,y,w){return y&&g(p.prototype,y),w&&g(p,w),p}})(),t=Wc(),r=Kc(),a=o(r),s=on(),l=o(s);function o(g){return g&&g.__esModule?g:{default:g}}function u(g,p){if(!(g instanceof p))throw new TypeError("Cannot call a class as a function")}function h(g,p){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:g}function d(g,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);g.prototype=Object.create(p&&p.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(g,p):g.__proto__=p)}var x=(function(g){d(p,g);function p(y,w){u(this,p);var _=h(this,(p.__proto__||Object.getPrototypeOf(p)).call(this,y,w));return _.fontSize=!w.flat&&w.fontSize>w.width*10?w.width*10:w.fontSize,_.guardHeight=w.height+_.fontSize/2+w.textMargin,_}return e(p,[{key:"encode",value:function(){return this.options.flat?this.encodeFlat():this.encodeGuarded()}},{key:"leftText",value:function(w,_){return this.text.substr(w,_)}},{key:"leftEncode",value:function(w,_){return(0,a.default)(w,_)}},{key:"rightText",value:function(w,_){return this.text.substr(w,_)}},{key:"rightEncode",value:function(w,_){return(0,a.default)(w,_)}},{key:"encodeGuarded",value:function(){var w={fontSize:this.fontSize},_={height:this.guardHeight};return[{data:t.SIDE_BIN,options:_},{data:this.leftEncode(),text:this.leftText(),options:w},{data:t.MIDDLE_BIN,options:_},{data:this.rightEncode(),text:this.rightText(),options:w},{data:t.SIDE_BIN,options:_}]}},{key:"encodeFlat",value:function(){var w=[t.SIDE_BIN,this.leftEncode(),t.MIDDLE_BIN,this.rightEncode(),t.SIDE_BIN];return{data:w.join(""),text:this.text}}}]),p})(l.default);return L0.default=x,L0}var yy;function nN(){if(yy)return I0;yy=1,Object.defineProperty(I0,"__esModule",{value:!0});var e=(function(){function g(p,y){for(var w=0;w<y.length;w++){var _=y[w];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(p,_.key,_)}}return function(p,y,w){return y&&g(p.prototype,y),w&&g(p,w),p}})(),t=function g(p,y,w){p===null&&(p=Function.prototype);var _=Object.getOwnPropertyDescriptor(p,y);if(_===void 0){var S=Object.getPrototypeOf(p);return S===null?void 0:g(S,y,w)}else{if("value"in _)return _.value;var T=_.get;return T===void 0?void 0:T.call(w)}},r=Wc(),a=Bb(),s=l(a);function l(g){return g&&g.__esModule?g:{default:g}}function o(g,p){if(!(g instanceof p))throw new TypeError("Cannot call a class as a function")}function u(g,p){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:g}function h(g,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);g.prototype=Object.create(p&&p.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(g,p):g.__proto__=p)}var d=function(p){var y=p.substr(0,12).split("").map(function(w){return+w}).reduce(function(w,_,S){return S%2?w+_*3:w+_},0);return(10-y%10)%10},x=(function(g){h(p,g);function p(y,w){o(this,p),y.search(/^[0-9]{12}$/)!==-1&&(y+=d(y));var _=u(this,(p.__proto__||Object.getPrototypeOf(p)).call(this,y,w));return _.lastChar=w.lastChar,_}return e(p,[{key:"valid",value:function(){return this.data.search(/^[0-9]{13}$/)!==-1&&+this.data[12]===d(this.data)}},{key:"leftText",value:function(){return t(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"leftText",this).call(this,1,6)}},{key:"leftEncode",value:function(){var w=this.data.substr(1,6),_=r.EAN13_STRUCTURE[this.data[0]];return t(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"leftEncode",this).call(this,w,_)}},{key:"rightText",value:function(){return t(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"rightText",this).call(this,7,6)}},{key:"rightEncode",value:function(){var w=this.data.substr(7,6);return t(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"rightEncode",this).call(this,w,"RRRRRR")}},{key:"encodeGuarded",value:function(){var w=t(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"encodeGuarded",this).call(this);return this.options.displayValue&&(w.unshift({data:"000000000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),this.options.lastChar&&(w.push({data:"00"}),w.push({data:"00000",text:this.options.lastChar,options:{fontSize:this.fontSize}}))),w}}]),p})(s.default);return I0.default=x,I0}var P0={},_y;function sN(){if(_y)return P0;_y=1,Object.defineProperty(P0,"__esModule",{value:!0});var e=(function(){function x(g,p){for(var y=0;y<p.length;y++){var w=p[y];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(g,w.key,w)}}return function(g,p,y){return p&&x(g.prototype,p),y&&x(g,y),g}})(),t=function x(g,p,y){g===null&&(g=Function.prototype);var w=Object.getOwnPropertyDescriptor(g,p);if(w===void 0){var _=Object.getPrototypeOf(g);return _===null?void 0:x(_,p,y)}else{if("value"in w)return w.value;var S=w.get;return S===void 0?void 0:S.call(y)}},r=Bb(),a=s(r);function s(x){return x&&x.__esModule?x:{default:x}}function l(x,g){if(!(x instanceof g))throw new TypeError("Cannot call a class as a function")}function o(x,g){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:x}function u(x,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);x.prototype=Object.create(g&&g.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(x,g):x.__proto__=g)}var h=function(g){var p=g.substr(0,7).split("").map(function(y){return+y}).reduce(function(y,w,_){return _%2?y+w:y+w*3},0);return(10-p%10)%10},d=(function(x){u(g,x);function g(p,y){return l(this,g),p.search(/^[0-9]{7}$/)!==-1&&(p+=h(p)),o(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,p,y))}return e(g,[{key:"valid",value:function(){return this.data.search(/^[0-9]{8}$/)!==-1&&+this.data[7]===h(this.data)}},{key:"leftText",value:function(){return t(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"leftText",this).call(this,0,4)}},{key:"leftEncode",value:function(){var y=this.data.substr(0,4);return t(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"leftEncode",this).call(this,y,"LLLL")}},{key:"rightText",value:function(){return t(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"rightText",this).call(this,4,4)}},{key:"rightEncode",value:function(){var y=this.data.substr(4,4);return t(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"rightEncode",this).call(this,y,"RRRR")}}]),g})(a.default);return P0.default=d,P0}var U0={},by;function iN(){if(by)return U0;by=1,Object.defineProperty(U0,"__esModule",{value:!0});var e=(function(){function p(y,w){for(var _=0;_<w.length;_++){var S=w[_];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(y,S.key,S)}}return function(y,w,_){return w&&p(y.prototype,w),_&&p(y,_),y}})(),t=Wc(),r=Kc(),a=o(r),s=on(),l=o(s);function o(p){return p&&p.__esModule?p:{default:p}}function u(p,y){if(!(p instanceof y))throw new TypeError("Cannot call a class as a function")}function h(p,y){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:p}function d(p,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);p.prototype=Object.create(y&&y.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(p,y):p.__proto__=y)}var x=function(y){var w=y.split("").map(function(_){return+_}).reduce(function(_,S,T){return T%2?_+S*9:_+S*3},0);return w%10},g=(function(p){d(y,p);function y(w,_){return u(this,y),h(this,(y.__proto__||Object.getPrototypeOf(y)).call(this,w,_))}return e(y,[{key:"valid",value:function(){return this.data.search(/^[0-9]{5}$/)!==-1}},{key:"encode",value:function(){var _=t.EAN5_STRUCTURE[x(this.data)];return{data:"1011"+(0,a.default)(this.data,_,"01"),text:this.text}}}]),y})(l.default);return U0.default=g,U0}var z0={},wy;function lN(){if(wy)return z0;wy=1,Object.defineProperty(z0,"__esModule",{value:!0});var e=(function(){function g(p,y){for(var w=0;w<y.length;w++){var _=y[w];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(p,_.key,_)}}return function(p,y,w){return y&&g(p.prototype,y),w&&g(p,w),p}})(),t=Wc(),r=Kc(),a=o(r),s=on(),l=o(s);function o(g){return g&&g.__esModule?g:{default:g}}function u(g,p){if(!(g instanceof p))throw new TypeError("Cannot call a class as a function")}function h(g,p){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:g}function d(g,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);g.prototype=Object.create(p&&p.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(g,p):g.__proto__=p)}var x=(function(g){d(p,g);function p(y,w){return u(this,p),h(this,(p.__proto__||Object.getPrototypeOf(p)).call(this,y,w))}return e(p,[{key:"valid",value:function(){return this.data.search(/^[0-9]{2}$/)!==-1}},{key:"encode",value:function(){var w=t.EAN2_STRUCTURE[parseInt(this.data)%4];return{data:"1011"+(0,a.default)(this.data,w,"01"),text:this.text}}}]),p})(l.default);return z0.default=x,z0}var sc={},Sy;function Pb(){if(Sy)return sc;Sy=1,Object.defineProperty(sc,"__esModule",{value:!0});var e=(function(){function g(p,y){for(var w=0;w<y.length;w++){var _=y[w];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(p,_.key,_)}}return function(p,y,w){return y&&g(p.prototype,y),w&&g(p,w),p}})();sc.checksum=x;var t=Kc(),r=l(t),a=on(),s=l(a);function l(g){return g&&g.__esModule?g:{default:g}}function o(g,p){if(!(g instanceof p))throw new TypeError("Cannot call a class as a function")}function u(g,p){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:g}function h(g,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);g.prototype=Object.create(p&&p.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(g,p):g.__proto__=p)}var d=(function(g){h(p,g);function p(y,w){o(this,p),y.search(/^[0-9]{11}$/)!==-1&&(y+=x(y));var _=u(this,(p.__proto__||Object.getPrototypeOf(p)).call(this,y,w));return _.displayValue=w.displayValue,w.fontSize>w.width*10?_.fontSize=w.width*10:_.fontSize=w.fontSize,_.guardHeight=w.height+_.fontSize/2+w.textMargin,_}return e(p,[{key:"valid",value:function(){return this.data.search(/^[0-9]{12}$/)!==-1&&this.data[11]==x(this.data)}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var w="";return w+="101",w+=(0,r.default)(this.data.substr(0,6),"LLLLLL"),w+="01010",w+=(0,r.default)(this.data.substr(6,6),"RRRRRR"),w+="101",{data:w,text:this.text}}},{key:"guardedEncoding",value:function(){var w=[];return this.displayValue&&w.push({data:"00000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),w.push({data:"101"+(0,r.default)(this.data[0],"L"),options:{height:this.guardHeight}}),w.push({data:(0,r.default)(this.data.substr(1,5),"LLLLL"),text:this.text.substr(1,5),options:{fontSize:this.fontSize}}),w.push({data:"01010",options:{height:this.guardHeight}}),w.push({data:(0,r.default)(this.data.substr(6,5),"RRRRR"),text:this.text.substr(6,5),options:{fontSize:this.fontSize}}),w.push({data:(0,r.default)(this.data[11],"R")+"101",options:{height:this.guardHeight}}),this.displayValue&&w.push({data:"00000000",text:this.text.substr(11,1),options:{textAlign:"right",fontSize:this.fontSize}}),w}}]),p})(s.default);function x(g){var p=0,y;for(y=1;y<11;y+=2)p+=parseInt(g[y]);for(y=0;y<11;y+=2)p+=parseInt(g[y])*3;return(10-p%10)%10}return sc.default=d,sc}var H0={},Ey;function oN(){if(Ey)return H0;Ey=1,Object.defineProperty(H0,"__esModule",{value:!0});var e=(function(){function w(_,S){for(var T=0;T<S.length;T++){var N=S[T];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(_,N.key,N)}}return function(_,S,T){return S&&w(_.prototype,S),T&&w(_,T),_}})(),t=Kc(),r=o(t),a=on(),s=o(a),l=Pb();function o(w){return w&&w.__esModule?w:{default:w}}function u(w,_){if(!(w instanceof _))throw new TypeError("Cannot call a class as a function")}function h(w,_){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:w}function d(w,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);w.prototype=Object.create(_&&_.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(w,_):w.__proto__=_)}var x=["XX00000XXX","XX10000XXX","XX20000XXX","XXX00000XX","XXXX00000X","XXXXX00005","XXXXX00006","XXXXX00007","XXXXX00008","XXXXX00009"],g=[["EEEOOO","OOOEEE"],["EEOEOO","OOEOEE"],["EEOOEO","OOEEOE"],["EEOOOE","OOEEEO"],["EOEEOO","OEOOEE"],["EOOEEO","OEEOOE"],["EOOOEE","OEEEOO"],["EOEOEO","OEOEOE"],["EOEOOE","OEOEEO"],["EOOEOE","OEEOEO"]],p=(function(w){d(_,w);function _(S,T){u(this,_);var N=h(this,(_.__proto__||Object.getPrototypeOf(_)).call(this,S,T));if(N.isValid=!1,S.search(/^[0-9]{6}$/)!==-1)N.middleDigits=S,N.upcA=y(S,"0"),N.text=T.text||""+N.upcA[0]+S+N.upcA[N.upcA.length-1],N.isValid=!0;else if(S.search(/^[01][0-9]{7}$/)!==-1)if(N.middleDigits=S.substring(1,S.length-1),N.upcA=y(N.middleDigits,S[0]),N.upcA[N.upcA.length-1]===S[S.length-1])N.isValid=!0;else return h(N);else return h(N);return N.displayValue=T.displayValue,T.fontSize>T.width*10?N.fontSize=T.width*10:N.fontSize=T.fontSize,N.guardHeight=T.height+N.fontSize/2+T.textMargin,N}return e(_,[{key:"valid",value:function(){return this.isValid}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var T="";return T+="101",T+=this.encodeMiddleDigits(),T+="010101",{data:T,text:this.text}}},{key:"guardedEncoding",value:function(){var T=[];return this.displayValue&&T.push({data:"00000000",text:this.text[0],options:{textAlign:"left",fontSize:this.fontSize}}),T.push({data:"101",options:{height:this.guardHeight}}),T.push({data:this.encodeMiddleDigits(),text:this.text.substring(1,7),options:{fontSize:this.fontSize}}),T.push({data:"010101",options:{height:this.guardHeight}}),this.displayValue&&T.push({data:"00000000",text:this.text[7],options:{textAlign:"right",fontSize:this.fontSize}}),T}},{key:"encodeMiddleDigits",value:function(){var T=this.upcA[0],N=this.upcA[this.upcA.length-1],E=g[parseInt(N)][parseInt(T)];return(0,r.default)(this.middleDigits,E)}}]),_})(s.default);function y(w,_){for(var S=parseInt(w[w.length-1]),T=x[S],N="",E=0,D=0;D<T.length;D++){var G=T[D];G==="X"?N+=w[E++]:N+=G}return N=""+_+N,""+N+(0,l.checksum)(N)}return H0.default=p,H0}var Ty;function cN(){if(Ty)return Na;Ty=1,Object.defineProperty(Na,"__esModule",{value:!0}),Na.UPCE=Na.UPC=Na.EAN2=Na.EAN5=Na.EAN8=Na.EAN13=void 0;var e=nN(),t=p(e),r=sN(),a=p(r),s=iN(),l=p(s),o=lN(),u=p(o),h=Pb(),d=p(h),x=oN(),g=p(x);function p(y){return y&&y.__esModule?y:{default:y}}return Na.EAN13=t.default,Na.EAN8=a.default,Na.EAN5=l.default,Na.EAN2=u.default,Na.UPC=d.default,Na.UPCE=g.default,Na}var Ci={},q0={},Ul={},ky;function uN(){return ky||(ky=1,Object.defineProperty(Ul,"__esModule",{value:!0}),Ul.START_BIN="1010",Ul.END_BIN="11101",Ul.BINARIES=["00110","10001","01001","11000","00101","10100","01100","00011","10010","01010"]),Ul}var Ny;function Ub(){if(Ny)return q0;Ny=1,Object.defineProperty(q0,"__esModule",{value:!0});var e=(function(){function d(x,g){for(var p=0;p<g.length;p++){var y=g[p];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(x,y.key,y)}}return function(x,g,p){return g&&d(x.prototype,g),p&&d(x,p),x}})(),t=uN(),r=on(),a=s(r);function s(d){return d&&d.__esModule?d:{default:d}}function l(d,x){if(!(d instanceof x))throw new TypeError("Cannot call a class as a function")}function o(d,x){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:d}function u(d,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);d.prototype=Object.create(x&&x.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(d,x):d.__proto__=x)}var h=(function(d){u(x,d);function x(){return l(this,x),o(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return e(x,[{key:"valid",value:function(){return this.data.search(/^([0-9]{2})+$/)!==-1}},{key:"encode",value:function(){var p=this,y=this.data.match(/.{2}/g).map(function(w){return p.encodePair(w)}).join("");return{data:t.START_BIN+y+t.END_BIN,text:this.text}}},{key:"encodePair",value:function(p){var y=t.BINARIES[p[1]];return t.BINARIES[p[0]].split("").map(function(w,_){return(w==="1"?"111":"1")+(y[_]==="1"?"000":"0")}).join("")}}]),x})(a.default);return q0.default=h,q0}var $0={},jy;function fN(){if(jy)return $0;jy=1,Object.defineProperty($0,"__esModule",{value:!0});var e=(function(){function d(x,g){for(var p=0;p<g.length;p++){var y=g[p];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(x,y.key,y)}}return function(x,g,p){return g&&d(x.prototype,g),p&&d(x,p),x}})(),t=Ub(),r=a(t);function a(d){return d&&d.__esModule?d:{default:d}}function s(d,x){if(!(d instanceof x))throw new TypeError("Cannot call a class as a function")}function l(d,x){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:d}function o(d,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);d.prototype=Object.create(x&&x.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(d,x):d.__proto__=x)}var u=function(x){var g=x.substr(0,13).split("").map(function(p){return parseInt(p,10)}).reduce(function(p,y,w){return p+y*(3-w%2*2)},0);return Math.ceil(g/10)*10-g},h=(function(d){o(x,d);function x(g,p){return s(this,x),g.search(/^[0-9]{13}$/)!==-1&&(g+=u(g)),l(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,g,p))}return e(x,[{key:"valid",value:function(){return this.data.search(/^[0-9]{14}$/)!==-1&&+this.data[13]===u(this.data)}}]),x})(r.default);return $0.default=h,$0}var Ay;function dN(){if(Ay)return Ci;Ay=1,Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.ITF14=Ci.ITF=void 0;var e=Ub(),t=s(e),r=fN(),a=s(r);function s(l){return l&&l.__esModule?l:{default:l}}return Ci.ITF=t.default,Ci.ITF14=a.default,Ci}var Qa={},G0={},Oy;function Yc(){if(Oy)return G0;Oy=1,Object.defineProperty(G0,"__esModule",{value:!0});var e=(function(){function d(x,g){for(var p=0;p<g.length;p++){var y=g[p];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(x,y.key,y)}}return function(x,g,p){return g&&d(x.prototype,g),p&&d(x,p),x}})(),t=on(),r=a(t);function a(d){return d&&d.__esModule?d:{default:d}}function s(d,x){if(!(d instanceof x))throw new TypeError("Cannot call a class as a function")}function l(d,x){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:d}function o(d,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);d.prototype=Object.create(x&&x.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(d,x):d.__proto__=x)}var u=(function(d){o(x,d);function x(g,p){return s(this,x),l(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,g,p))}return e(x,[{key:"encode",value:function(){for(var p="110",y=0;y<this.data.length;y++){var w=parseInt(this.data[y]),_=w.toString(2);_=h(_,4-_.length);for(var S=0;S<_.length;S++)p+=_[S]=="0"?"100":"110"}return p+="1001",{data:p,text:this.text}}},{key:"valid",value:function(){return this.data.search(/^[0-9]+$/)!==-1}}]),x})(r.default);function h(d,x){for(var g=0;g<x;g++)d="0"+d;return d}return G0.default=u,G0}var V0={},ic={},Cy;function Vf(){if(Cy)return ic;Cy=1,Object.defineProperty(ic,"__esModule",{value:!0}),ic.mod10=e,ic.mod11=t;function e(r){for(var a=0,s=0;s<r.length;s++){var l=parseInt(r[s]);(s+r.length)%2===0?a+=l:a+=l*2%10+Math.floor(l*2/10)}return(10-a%10)%10}function t(r){for(var a=0,s=[2,3,4,5,6,7],l=0;l<r.length;l++){var o=parseInt(r[r.length-1-l]);a+=s[l%s.length]*o}return(11-a%11)%11}return ic}var Ry;function hN(){if(Ry)return V0;Ry=1,Object.defineProperty(V0,"__esModule",{value:!0});var e=Yc(),t=a(e),r=Vf();function a(h){return h&&h.__esModule?h:{default:h}}function s(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")}function l(h,d){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:h}function o(h,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);h.prototype=Object.create(d&&d.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(h,d):h.__proto__=d)}var u=(function(h){o(d,h);function d(x,g){return s(this,d),l(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,x+(0,r.mod10)(x),g))}return d})(t.default);return V0.default=u,V0}var X0={},Dy;function mN(){if(Dy)return X0;Dy=1,Object.defineProperty(X0,"__esModule",{value:!0});var e=Yc(),t=a(e),r=Vf();function a(h){return h&&h.__esModule?h:{default:h}}function s(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")}function l(h,d){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:h}function o(h,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);h.prototype=Object.create(d&&d.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(h,d):h.__proto__=d)}var u=(function(h){o(d,h);function d(x,g){return s(this,d),l(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,x+(0,r.mod11)(x),g))}return d})(t.default);return X0.default=u,X0}var W0={},Fy;function xN(){if(Fy)return W0;Fy=1,Object.defineProperty(W0,"__esModule",{value:!0});var e=Yc(),t=a(e),r=Vf();function a(h){return h&&h.__esModule?h:{default:h}}function s(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")}function l(h,d){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:h}function o(h,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);h.prototype=Object.create(d&&d.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(h,d):h.__proto__=d)}var u=(function(h){o(d,h);function d(x,g){return s(this,d),x+=(0,r.mod10)(x),x+=(0,r.mod10)(x),l(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,x,g))}return d})(t.default);return W0.default=u,W0}var K0={},My;function pN(){if(My)return K0;My=1,Object.defineProperty(K0,"__esModule",{value:!0});var e=Yc(),t=a(e),r=Vf();function a(h){return h&&h.__esModule?h:{default:h}}function s(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")}function l(h,d){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:h}function o(h,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);h.prototype=Object.create(d&&d.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(h,d):h.__proto__=d)}var u=(function(h){o(d,h);function d(x,g){return s(this,d),x+=(0,r.mod11)(x),x+=(0,r.mod10)(x),l(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,x,g))}return d})(t.default);return K0.default=u,K0}var Iy;function gN(){if(Iy)return Qa;Iy=1,Object.defineProperty(Qa,"__esModule",{value:!0}),Qa.MSI1110=Qa.MSI1010=Qa.MSI11=Qa.MSI10=Qa.MSI=void 0;var e=Yc(),t=x(e),r=hN(),a=x(r),s=mN(),l=x(s),o=xN(),u=x(o),h=pN(),d=x(h);function x(g){return g&&g.__esModule?g:{default:g}}return Qa.MSI=t.default,Qa.MSI10=a.default,Qa.MSI11=l.default,Qa.MSI1010=u.default,Qa.MSI1110=d.default,Qa}var lc={},Ly;function vN(){if(Ly)return lc;Ly=1,Object.defineProperty(lc,"__esModule",{value:!0}),lc.pharmacode=void 0;var e=(function(){function h(d,x){for(var g=0;g<x.length;g++){var p=x[g];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(d,p.key,p)}}return function(d,x,g){return x&&h(d.prototype,x),g&&h(d,g),d}})(),t=on(),r=a(t);function a(h){return h&&h.__esModule?h:{default:h}}function s(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")}function l(h,d){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:h}function o(h,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);h.prototype=Object.create(d&&d.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(h,d):h.__proto__=d)}var u=(function(h){o(d,h);function d(x,g){s(this,d);var p=l(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,x,g));return p.number=parseInt(x,10),p}return e(d,[{key:"encode",value:function(){for(var g=this.number,p="";!isNaN(g)&&g!=0;)g%2===0?(p="11100"+p,g=(g-2)/2):(p="100"+p,g=(g-1)/2);return p=p.slice(0,-2),{data:p,text:this.text}}},{key:"valid",value:function(){return this.number>=3&&this.number<=131070}}]),d})(r.default);return lc.pharmacode=u,lc}var oc={},By;function yN(){if(By)return oc;By=1,Object.defineProperty(oc,"__esModule",{value:!0}),oc.codabar=void 0;var e=(function(){function h(d,x){for(var g=0;g<x.length;g++){var p=x[g];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(d,p.key,p)}}return function(d,x,g){return x&&h(d.prototype,x),g&&h(d,g),d}})(),t=on(),r=a(t);function a(h){return h&&h.__esModule?h:{default:h}}function s(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")}function l(h,d){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:h}function o(h,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);h.prototype=Object.create(d&&d.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(h,d):h.__proto__=d)}var u=(function(h){o(d,h);function d(x,g){s(this,d),x.search(/^[0-9\-\$\:\.\+\/]+$/)===0&&(x="A"+x+"A");var p=l(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,x.toUpperCase(),g));return p.text=p.options.text||p.text.replace(/[A-D]/g,""),p}return e(d,[{key:"valid",value:function(){return this.data.search(/^[A-D][0-9\-\$\:\.\+\/]+[A-D]$/)!==-1}},{key:"encode",value:function(){for(var g=[],p=this.getEncodings(),y=0;y<this.data.length;y++)g.push(p[this.data.charAt(y)]),y!==this.data.length-1&&g.push("0");return{text:this.text,data:g.join("")}}},{key:"getEncodings",value:function(){return{0:"101010011",1:"101011001",2:"101001011",3:"110010101",4:"101101001",5:"110101001",6:"100101011",7:"100101101",8:"100110101",9:"110100101","-":"101001101",$:"101100101",":":"1101011011","/":"1101101011",".":"1101101101","+":"1011011011",A:"1011001001",B:"1001001011",C:"1010010011",D:"1010011001"}}}]),d})(r.default);return oc.codabar=u,oc}var Ri={},Y0={},zl={},Py;function _N(){return Py||(Py=1,Object.defineProperty(zl,"__esModule",{value:!0}),zl.SYMBOLS=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","($)","(%)","(/)","(+)",""],zl.BINARIES=["100010100","101001000","101000100","101000010","100101000","100100100","100100010","101010000","100010010","100001010","110101000","110100100","110100010","110010100","110010010","110001010","101101000","101100100","101100010","100110100","100011010","101011000","101001100","101000110","100101100","100010110","110110100","110110010","110101100","110100110","110010110","110011010","101101100","101100110","100110110","100111010","100101110","111010100","111010010","111001010","101101110","101110110","110101110","100100110","111011010","111010110","100110010","101011110"],zl.MULTI_SYMBOLS={"\0":["(%)","U"],"":["($)","A"],"":["($)","B"],"":["($)","C"],"":["($)","D"],"":["($)","E"],"":["($)","F"],"\x07":["($)","G"],"\b":["($)","H"],"	":["($)","I"],"\n":["($)","J"],"\v":["($)","K"],"\f":["($)","L"],"\r":["($)","M"],"":["($)","N"],"":["($)","O"],"":["($)","P"],"":["($)","Q"],"":["($)","R"],"":["($)","S"],"":["($)","T"],"":["($)","U"],"":["($)","V"],"":["($)","W"],"":["($)","X"],"":["($)","Y"],"":["($)","Z"],"\x1B":["(%)","A"],"":["(%)","B"],"":["(%)","C"],"":["(%)","D"],"":["(%)","E"],"!":["(/)","A"],'"':["(/)","B"],"#":["(/)","C"],"&":["(/)","F"],"'":["(/)","G"],"(":["(/)","H"],")":["(/)","I"],"*":["(/)","J"],",":["(/)","L"],":":["(/)","Z"],";":["(%)","F"],"<":["(%)","G"],"=":["(%)","H"],">":["(%)","I"],"?":["(%)","J"],"@":["(%)","V"],"[":["(%)","K"],"\\":["(%)","L"],"]":["(%)","M"],"^":["(%)","N"],_:["(%)","O"],"`":["(%)","W"],a:["(+)","A"],b:["(+)","B"],c:["(+)","C"],d:["(+)","D"],e:["(+)","E"],f:["(+)","F"],g:["(+)","G"],h:["(+)","H"],i:["(+)","I"],j:["(+)","J"],k:["(+)","K"],l:["(+)","L"],m:["(+)","M"],n:["(+)","N"],o:["(+)","O"],p:["(+)","P"],q:["(+)","Q"],r:["(+)","R"],s:["(+)","S"],t:["(+)","T"],u:["(+)","U"],v:["(+)","V"],w:["(+)","W"],x:["(+)","X"],y:["(+)","Y"],z:["(+)","Z"],"{":["(%)","P"],"|":["(%)","Q"],"}":["(%)","R"],"~":["(%)","S"],"":["(%)","T"]}),zl}var Uy;function zb(){if(Uy)return Y0;Uy=1,Object.defineProperty(Y0,"__esModule",{value:!0});var e=(function(){function d(x,g){for(var p=0;p<g.length;p++){var y=g[p];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(x,y.key,y)}}return function(x,g,p){return g&&d(x.prototype,g),p&&d(x,p),x}})(),t=_N(),r=on(),a=s(r);function s(d){return d&&d.__esModule?d:{default:d}}function l(d,x){if(!(d instanceof x))throw new TypeError("Cannot call a class as a function")}function o(d,x){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:d}function u(d,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);d.prototype=Object.create(x&&x.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(d,x):d.__proto__=x)}var h=(function(d){u(x,d);function x(g,p){return l(this,x),o(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,g,p))}return e(x,[{key:"valid",value:function(){return/^[0-9A-Z\-. $/+%]+$/.test(this.data)}},{key:"encode",value:function(){var p=this.data.split("").flatMap(function(S){return t.MULTI_SYMBOLS[S]||S}),y=p.map(function(S){return x.getEncoding(S)}).join(""),w=x.checksum(p,20),_=x.checksum(p.concat(w),15);return{text:this.text,data:x.getEncoding("")+y+x.getEncoding(w)+x.getEncoding(_)+x.getEncoding("")+"1"}}}],[{key:"getEncoding",value:function(p){return t.BINARIES[x.symbolValue(p)]}},{key:"getSymbol",value:function(p){return t.SYMBOLS[p]}},{key:"symbolValue",value:function(p){return t.SYMBOLS.indexOf(p)}},{key:"checksum",value:function(p,y){var w=p.slice().reverse().reduce(function(_,S,T){var N=T%y+1;return _+x.symbolValue(S)*N},0);return x.getSymbol(w%47)}}]),x})(a.default);return Y0.default=h,Y0}var J0={},zy;function bN(){if(zy)return J0;zy=1,Object.defineProperty(J0,"__esModule",{value:!0});var e=(function(){function h(d,x){for(var g=0;g<x.length;g++){var p=x[g];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(d,p.key,p)}}return function(d,x,g){return x&&h(d.prototype,x),g&&h(d,g),d}})(),t=zb(),r=a(t);function a(h){return h&&h.__esModule?h:{default:h}}function s(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")}function l(h,d){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:h}function o(h,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);h.prototype=Object.create(d&&d.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(h,d):h.__proto__=d)}var u=(function(h){o(d,h);function d(x,g){return s(this,d),l(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,x,g))}return e(d,[{key:"valid",value:function(){return/^[\x00-\x7f]+$/.test(this.data)}}]),d})(r.default);return J0.default=u,J0}var Hy;function wN(){if(Hy)return Ri;Hy=1,Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.CODE93FullASCII=Ri.CODE93=void 0;var e=zb(),t=s(e),r=bN(),a=s(r);function s(l){return l&&l.__esModule?l:{default:l}}return Ri.CODE93=t.default,Ri.CODE93FullASCII=a.default,Ri}var cc={},qy;function SN(){if(qy)return cc;qy=1,Object.defineProperty(cc,"__esModule",{value:!0}),cc.GenericBarcode=void 0;var e=(function(){function h(d,x){for(var g=0;g<x.length;g++){var p=x[g];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(d,p.key,p)}}return function(d,x,g){return x&&h(d.prototype,x),g&&h(d,g),d}})(),t=on(),r=a(t);function a(h){return h&&h.__esModule?h:{default:h}}function s(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")}function l(h,d){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:h}function o(h,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);h.prototype=Object.create(d&&d.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(h,d):h.__proto__=d)}var u=(function(h){o(d,h);function d(x,g){return s(this,d),l(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,x,g))}return e(d,[{key:"encode",value:function(){return{data:"10101010101010101010101010101010101010101",text:this.text}}},{key:"valid",value:function(){return!0}}]),d})(r.default);return cc.GenericBarcode=u,cc}var $y;function EN(){if($y)return j0;$y=1,Object.defineProperty(j0,"__esModule",{value:!0});var e=J4(),t=aN(),r=cN(),a=dN(),s=gN(),l=vN(),o=yN(),u=wN(),h=SN();return j0.default={CODE39:e.CODE39,CODE128:t.CODE128,CODE128A:t.CODE128A,CODE128B:t.CODE128B,CODE128C:t.CODE128C,EAN13:r.EAN13,EAN8:r.EAN8,EAN5:r.EAN5,EAN2:r.EAN2,UPC:r.UPC,UPCE:r.UPCE,ITF14:a.ITF14,ITF:a.ITF,MSI:s.MSI,MSI10:s.MSI10,MSI11:s.MSI11,MSI1010:s.MSI1010,MSI1110:s.MSI1110,pharmacode:l.pharmacode,codabar:o.codabar,CODE93:u.CODE93,CODE93FullASCII:u.CODE93FullASCII,GenericBarcode:h.GenericBarcode},j0}var Q0={},Gy;function Xf(){if(Gy)return Q0;Gy=1,Object.defineProperty(Q0,"__esModule",{value:!0});var e=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(t[s]=a[s])}return t};return Q0.default=function(t,r){return e({},t,r)},Q0}var Z0={},Vy;function TN(){if(Vy)return Z0;Vy=1,Object.defineProperty(Z0,"__esModule",{value:!0}),Z0.default=e;function e(t){var r=[];function a(s){if(Array.isArray(s))for(var l=0;l<s.length;l++)a(s[l]);else s.text=s.text||"",s.data=s.data||"",r.push(s)}return a(t),r}return Z0}var ef={},Xy;function kN(){if(Xy)return ef;Xy=1,Object.defineProperty(ef,"__esModule",{value:!0}),ef.default=e;function e(t){return t.marginTop=t.marginTop||t.margin,t.marginBottom=t.marginBottom||t.margin,t.marginRight=t.marginRight||t.margin,t.marginLeft=t.marginLeft||t.margin,t}return ef}var tf={},rf={},af={},Wy;function Hb(){if(Wy)return af;Wy=1,Object.defineProperty(af,"__esModule",{value:!0}),af.default=e;function e(t){var r=["width","height","textMargin","fontSize","margin","marginTop","marginBottom","marginLeft","marginRight"];for(var a in r)r.hasOwnProperty(a)&&(a=r[a],typeof t[a]=="string"&&(t[a]=parseInt(t[a],10)));return typeof t.displayValue=="string"&&(t.displayValue=t.displayValue!="false"),t}return af}var nf={},Ky;function qb(){if(Ky)return nf;Ky=1,Object.defineProperty(nf,"__esModule",{value:!0});var e={width:2,height:100,format:"auto",displayValue:!0,fontOptions:"",font:"monospace",text:void 0,textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",lineColor:"#000000",margin:10,marginTop:void 0,marginBottom:void 0,marginLeft:void 0,marginRight:void 0,valid:function(){}};return nf.default=e,nf}var Yy;function NN(){if(Yy)return rf;Yy=1,Object.defineProperty(rf,"__esModule",{value:!0});var e=Hb(),t=s(e),r=qb(),a=s(r);function s(o){return o&&o.__esModule?o:{default:o}}function l(o){var u={};for(var h in a.default)a.default.hasOwnProperty(h)&&(o.hasAttribute("jsbarcode-"+h.toLowerCase())&&(u[h]=o.getAttribute("jsbarcode-"+h.toLowerCase())),o.hasAttribute("data-"+h.toLowerCase())&&(u[h]=o.getAttribute("data-"+h.toLowerCase())));return u.value=o.getAttribute("jsbarcode-value")||o.getAttribute("data-value"),u=(0,t.default)(u),u}return rf.default=l,rf}var sf={},lf={},Za={},Jy;function $b(){if(Jy)return Za;Jy=1,Object.defineProperty(Za,"__esModule",{value:!0}),Za.getTotalWidthOfEncodings=Za.calculateEncodingAttributes=Za.getBarcodePadding=Za.getEncodingHeight=Za.getMaximumHeightOfEncodings=void 0;var e=Xf(),t=r(e);function r(d){return d&&d.__esModule?d:{default:d}}function a(d,x){return x.height+(x.displayValue&&d.text.length>0?x.fontSize+x.textMargin:0)+x.marginTop+x.marginBottom}function s(d,x,g){if(g.displayValue&&x<d){if(g.textAlign=="center")return Math.floor((d-x)/2);if(g.textAlign=="left")return 0;if(g.textAlign=="right")return Math.floor(d-x)}return 0}function l(d,x,g){for(var p=0;p<d.length;p++){var y=d[p],w=(0,t.default)(x,y.options),_;w.displayValue?_=h(y.text,w,g):_=0;var S=y.data.length*w.width;y.width=Math.ceil(Math.max(_,S)),y.height=a(y,w),y.barcodePadding=s(_,S,w)}}function o(d){for(var x=0,g=0;g<d.length;g++)x+=d[g].width;return x}function u(d){for(var x=0,g=0;g<d.length;g++)d[g].height>x&&(x=d[g].height);return x}function h(d,x,g){var p;if(g)p=g;else if(typeof document<"u")p=document.createElement("canvas").getContext("2d");else return 0;p.font=x.fontOptions+" "+x.fontSize+"px "+x.font;var y=p.measureText(d);if(!y)return 0;var w=y.width;return w}return Za.getMaximumHeightOfEncodings=u,Za.getEncodingHeight=a,Za.getBarcodePadding=s,Za.calculateEncodingAttributes=l,Za.getTotalWidthOfEncodings=o,Za}var Qy;function jN(){if(Qy)return lf;Qy=1,Object.defineProperty(lf,"__esModule",{value:!0});var e=(function(){function u(h,d){for(var x=0;x<d.length;x++){var g=d[x];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(h,g.key,g)}}return function(h,d,x){return d&&u(h.prototype,d),x&&u(h,x),h}})(),t=Xf(),r=s(t),a=$b();function s(u){return u&&u.__esModule?u:{default:u}}function l(u,h){if(!(u instanceof h))throw new TypeError("Cannot call a class as a function")}var o=(function(){function u(h,d,x){l(this,u),this.canvas=h,this.encodings=d,this.options=x}return e(u,[{key:"render",value:function(){if(!this.canvas.getContext)throw new Error("The browser does not support canvas.");this.prepareCanvas();for(var d=0;d<this.encodings.length;d++){var x=(0,r.default)(this.options,this.encodings[d].options);this.drawCanvasBarcode(x,this.encodings[d]),this.drawCanvasText(x,this.encodings[d]),this.moveCanvasDrawing(this.encodings[d])}this.restoreCanvas()}},{key:"prepareCanvas",value:function(){var d=this.canvas.getContext("2d");d.save(),(0,a.calculateEncodingAttributes)(this.encodings,this.options,d);var x=(0,a.getTotalWidthOfEncodings)(this.encodings),g=(0,a.getMaximumHeightOfEncodings)(this.encodings);this.canvas.width=x+this.options.marginLeft+this.options.marginRight,this.canvas.height=g,d.clearRect(0,0,this.canvas.width,this.canvas.height),this.options.background&&(d.fillStyle=this.options.background,d.fillRect(0,0,this.canvas.width,this.canvas.height)),d.translate(this.options.marginLeft,0)}},{key:"drawCanvasBarcode",value:function(d,x){var g=this.canvas.getContext("2d"),p=x.data,y;d.textPosition=="top"?y=d.marginTop+d.fontSize+d.textMargin:y=d.marginTop,g.fillStyle=d.lineColor;for(var w=0;w<p.length;w++){var _=w*d.width+x.barcodePadding;p[w]==="1"?g.fillRect(_,y,d.width,d.height):p[w]&&g.fillRect(_,y,d.width,d.height*p[w])}}},{key:"drawCanvasText",value:function(d,x){var g=this.canvas.getContext("2d"),p=d.fontOptions+" "+d.fontSize+"px "+d.font;if(d.displayValue){var y,w;d.textPosition=="top"?w=d.marginTop+d.fontSize-d.textMargin:w=d.height+d.textMargin+d.marginTop+d.fontSize,g.font=p,d.textAlign=="left"||x.barcodePadding>0?(y=0,g.textAlign="left"):d.textAlign=="right"?(y=x.width-1,g.textAlign="right"):(y=x.width/2,g.textAlign="center"),g.fillText(x.text,y,w)}}},{key:"moveCanvasDrawing",value:function(d){var x=this.canvas.getContext("2d");x.translate(d.width,0)}},{key:"restoreCanvas",value:function(){var d=this.canvas.getContext("2d");d.restore()}}]),u})();return lf.default=o,lf}var of={},Zy;function AN(){if(Zy)return of;Zy=1,Object.defineProperty(of,"__esModule",{value:!0});var e=(function(){function h(d,x){for(var g=0;g<x.length;g++){var p=x[g];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(d,p.key,p)}}return function(d,x,g){return x&&h(d.prototype,x),g&&h(d,g),d}})(),t=Xf(),r=s(t),a=$b();function s(h){return h&&h.__esModule?h:{default:h}}function l(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")}var o="http://www.w3.org/2000/svg",u=(function(){function h(d,x,g){l(this,h),this.svg=d,this.encodings=x,this.options=g,this.document=g.xmlDocument||document}return e(h,[{key:"render",value:function(){var x=this.options.marginLeft;this.prepareSVG();for(var g=0;g<this.encodings.length;g++){var p=this.encodings[g],y=(0,r.default)(this.options,p.options),w=this.createGroup(x,y.marginTop,this.svg);this.setGroupOptions(w,y),this.drawSvgBarcode(w,y,p),this.drawSVGText(w,y,p),x+=p.width}}},{key:"prepareSVG",value:function(){for(;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);(0,a.calculateEncodingAttributes)(this.encodings,this.options);var x=(0,a.getTotalWidthOfEncodings)(this.encodings),g=(0,a.getMaximumHeightOfEncodings)(this.encodings),p=x+this.options.marginLeft+this.options.marginRight;this.setSvgAttributes(p,g),this.options.background&&this.drawRect(0,0,p,g,this.svg).setAttribute("fill",this.options.background)}},{key:"drawSvgBarcode",value:function(x,g,p){var y=p.data,w;g.textPosition=="top"?w=g.fontSize+g.textMargin:w=0;for(var _=0,S=0,T=0;T<y.length;T++)S=T*g.width+p.barcodePadding,y[T]==="1"?_++:_>0&&(this.drawRect(S-g.width*_,w,g.width*_,g.height,x),_=0);_>0&&this.drawRect(S-g.width*(_-1),w,g.width*_,g.height,x)}},{key:"drawSVGText",value:function(x,g,p){var y=this.document.createElementNS(o,"text");if(g.displayValue){var w,_;y.setAttribute("font-family",g.font),y.setAttribute("font-size",g.fontSize),g.fontOptions.includes("bold")&&y.setAttribute("font-weight","bold"),g.fontOptions.includes("italic")&&y.setAttribute("font-style","italic"),g.textPosition=="top"?_=g.fontSize-g.textMargin:_=g.height+g.textMargin+g.fontSize,g.textAlign=="left"||p.barcodePadding>0?(w=0,y.setAttribute("text-anchor","start")):g.textAlign=="right"?(w=p.width-1,y.setAttribute("text-anchor","end")):(w=p.width/2,y.setAttribute("text-anchor","middle")),y.setAttribute("x",w),y.setAttribute("y",_),y.appendChild(this.document.createTextNode(p.text)),x.appendChild(y)}}},{key:"setSvgAttributes",value:function(x,g){var p=this.svg;p.setAttribute("width",x+"px"),p.setAttribute("height",g+"px"),p.setAttribute("x","0px"),p.setAttribute("y","0px"),p.setAttribute("viewBox","0 0 "+x+" "+g),p.setAttribute("xmlns",o),p.setAttribute("version","1.1")}},{key:"createGroup",value:function(x,g,p){var y=this.document.createElementNS(o,"g");return y.setAttribute("transform","translate("+x+", "+g+")"),p.appendChild(y),y}},{key:"setGroupOptions",value:function(x,g){x.setAttribute("fill",g.lineColor)}},{key:"drawRect",value:function(x,g,p,y,w){var _=this.document.createElementNS(o,"rect");return _.setAttribute("x",x),_.setAttribute("y",g),_.setAttribute("width",p),_.setAttribute("height",y),w.appendChild(_),_}}]),h})();return of.default=u,of}var cf={},e_;function ON(){if(e_)return cf;e_=1,Object.defineProperty(cf,"__esModule",{value:!0});var e=(function(){function a(s,l){for(var o=0;o<l.length;o++){var u=l[o];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(s,u.key,u)}}return function(s,l,o){return l&&a(s.prototype,l),o&&a(s,o),s}})();function t(a,s){if(!(a instanceof s))throw new TypeError("Cannot call a class as a function")}var r=(function(){function a(s,l,o){t(this,a),this.object=s,this.encodings=l,this.options=o}return e(a,[{key:"render",value:function(){this.object.encodings=this.encodings}}]),a})();return cf.default=r,cf}var t_;function CN(){if(t_)return sf;t_=1,Object.defineProperty(sf,"__esModule",{value:!0});var e=jN(),t=o(e),r=AN(),a=o(r),s=ON(),l=o(s);function o(u){return u&&u.__esModule?u:{default:u}}return sf.default={CanvasRenderer:t.default,SVGRenderer:a.default,ObjectRenderer:l.default},sf}var Hl={},r_;function Gb(){if(r_)return Hl;r_=1,Object.defineProperty(Hl,"__esModule",{value:!0});function e(o,u){if(!(o instanceof u))throw new TypeError("Cannot call a class as a function")}function t(o,u){if(!o)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u&&(typeof u=="object"||typeof u=="function")?u:o}function r(o,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof u);o.prototype=Object.create(u&&u.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(o,u):o.__proto__=u)}var a=(function(o){r(u,o);function u(h,d){e(this,u);var x=t(this,(u.__proto__||Object.getPrototypeOf(u)).call(this));return x.name="InvalidInputException",x.symbology=h,x.input=d,x.message='"'+x.input+'" is not a valid input for '+x.symbology,x}return u})(Error),s=(function(o){r(u,o);function u(){e(this,u);var h=t(this,(u.__proto__||Object.getPrototypeOf(u)).call(this));return h.name="InvalidElementException",h.message="Not supported type to render on",h}return u})(Error),l=(function(o){r(u,o);function u(){e(this,u);var h=t(this,(u.__proto__||Object.getPrototypeOf(u)).call(this));return h.name="NoElementException",h.message="No element to render on.",h}return u})(Error);return Hl.InvalidInputException=a,Hl.InvalidElementException=s,Hl.NoElementException=l,Hl}var a_;function RN(){if(a_)return tf;a_=1,Object.defineProperty(tf,"__esModule",{value:!0});var e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},t=NN(),r=o(t),a=CN(),s=o(a),l=Gb();function o(x){return x&&x.__esModule?x:{default:x}}function u(x){if(typeof x=="string")return h(x);if(Array.isArray(x)){for(var g=[],p=0;p<x.length;p++)g.push(u(x[p]));return g}else{if(typeof HTMLCanvasElement<"u"&&x instanceof HTMLImageElement)return d(x);if(x&&x.nodeName&&x.nodeName.toLowerCase()==="svg"||typeof SVGElement<"u"&&x instanceof SVGElement)return{element:x,options:(0,r.default)(x),renderer:s.default.SVGRenderer};if(typeof HTMLCanvasElement<"u"&&x instanceof HTMLCanvasElement)return{element:x,options:(0,r.default)(x),renderer:s.default.CanvasRenderer};if(x&&x.getContext)return{element:x,renderer:s.default.CanvasRenderer};if(x&&(typeof x>"u"?"undefined":e(x))==="object"&&!x.nodeName)return{element:x,renderer:s.default.ObjectRenderer};throw new l.InvalidElementException}}function h(x){var g=document.querySelectorAll(x);if(g.length!==0){for(var p=[],y=0;y<g.length;y++)p.push(u(g[y]));return p}}function d(x){var g=document.createElement("canvas");return{element:g,options:(0,r.default)(x),renderer:s.default.CanvasRenderer,afterRender:function(){x.setAttribute("src",g.toDataURL())}}}return tf.default=u,tf}var uf={},n_;function DN(){if(n_)return uf;n_=1,Object.defineProperty(uf,"__esModule",{value:!0});var e=(function(){function a(s,l){for(var o=0;o<l.length;o++){var u=l[o];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(s,u.key,u)}}return function(s,l,o){return l&&a(s.prototype,l),o&&a(s,o),s}})();function t(a,s){if(!(a instanceof s))throw new TypeError("Cannot call a class as a function")}var r=(function(){function a(s){t(this,a),this.api=s}return e(a,[{key:"handleCatch",value:function(l){if(l.name==="InvalidInputException")if(this.api._options.valid!==this.api._defaults.valid)this.api._options.valid(!1);else throw l.message;else throw l;this.api.render=function(){}}},{key:"wrapBarcodeCall",value:function(l){try{var o=l.apply(void 0,arguments);return this.api._options.valid(!0),o}catch(u){return this.handleCatch(u),this.api}}}]),a})();return uf.default=r,uf}var vm,s_;function FN(){if(s_)return vm;s_=1;var e=EN(),t=T(e),r=Xf(),a=T(r),s=TN(),l=T(s),o=kN(),u=T(o),h=RN(),d=T(h),x=Hb(),g=T(x),p=DN(),y=T(p),w=Gb(),_=qb(),S=T(_);function T(C){return C&&C.__esModule?C:{default:C}}var N=function(){},E=function(U,Z,q){var le=new N;if(typeof U>"u")throw Error("No element to render on was provided.");return le._renderProperties=(0,d.default)(U),le._encodings=[],le._options=S.default,le._errorHandler=new y.default(le),typeof Z<"u"&&(q=q||{},q.format||(q.format=A()),le.options(q)[q.format](Z,q).render()),le};E.getModule=function(C){return t.default[C]};for(var D in t.default)t.default.hasOwnProperty(D)&&G(t.default,D);function G(C,U){N.prototype[U]=N.prototype[U.toUpperCase()]=N.prototype[U.toLowerCase()]=function(Z,q){var le=this;return le._errorHandler.wrapBarcodeCall(function(){q.text=typeof q.text>"u"?void 0:""+q.text;var ge=(0,a.default)(le._options,q);ge=(0,g.default)(ge);var Se=C[U],te=V(Z,Se,ge);return le._encodings.push(te),le})}}function V(C,U,Z){C=""+C;var q=new U(C,Z);if(!q.valid())throw new w.InvalidInputException(q.constructor.name,C);var le=q.encode();le=(0,l.default)(le);for(var ge=0;ge<le.length;ge++)le[ge].options=(0,a.default)(Z,le[ge].options);return le}function A(){return t.default.CODE128?"CODE128":Object.keys(t.default)[0]}N.prototype.options=function(C){return this._options=(0,a.default)(this._options,C),this},N.prototype.blank=function(C){var U=new Array(C+1).join("0");return this._encodings.push({data:U}),this},N.prototype.init=function(){if(this._renderProperties){Array.isArray(this._renderProperties)||(this._renderProperties=[this._renderProperties]);var C;for(var U in this._renderProperties){C=this._renderProperties[U];var Z=(0,a.default)(this._options,C.options);Z.format=="auto"&&(Z.format=A()),this._errorHandler.wrapBarcodeCall(function(){var q=Z.value,le=t.default[Z.format.toUpperCase()],ge=V(q,le,Z);M(C,ge,Z)})}}},N.prototype.render=function(){if(!this._renderProperties)throw new w.NoElementException;if(Array.isArray(this._renderProperties))for(var C=0;C<this._renderProperties.length;C++)M(this._renderProperties[C],this._encodings,this._options);else M(this._renderProperties,this._encodings,this._options);return this},N.prototype._defaults=S.default;function M(C,U,Z){U=(0,l.default)(U);for(var q=0;q<U.length;q++)U[q].options=(0,a.default)(Z,U[q].options),(0,u.default)(U[q].options);(0,u.default)(Z);var le=C.renderer,ge=new le(C.element,U,Z);ge.render(),C.afterRender&&C.afterRender()}return typeof window<"u"&&(window.JsBarcode=E),typeof jQuery<"u"&&(jQuery.fn.JsBarcode=function(C,U){var Z=[];return jQuery(this).each(function(){Z.push(this)}),E(Z,C,U)}),vm=E,vm}var ym={exports:{}},_m,i_;function MN(){if(i_)return _m;i_=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return _m=e,_m}var bm,l_;function IN(){if(l_)return bm;l_=1;var e=MN();function t(){}function r(){}return r.resetWarningCache=t,bm=function(){function a(o,u,h,d,x,g){if(g!==e){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}a.isRequired=a;function s(){return a}var l={array:a,bigint:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:s,element:a,elementType:a,instanceOf:s,node:a,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:r,resetWarningCache:t};return l.PropTypes=l,l},bm}var o_;function LN(){return o_||(o_=1,ym.exports=IN()()),ym.exports}var wm,c_;function BN(){if(c_)return wm;c_=1;function e(S){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?e=function(N){return typeof N}:e=function(N){return N&&typeof Symbol=="function"&&N.constructor===Symbol&&N!==Symbol.prototype?"symbol":typeof N},e(S)}var t=s(Pf()),r=s(FN()),a=s(LN());function s(S){return S&&S.__esModule?S:{default:S}}function l(S,T){if(!(S instanceof T))throw new TypeError("Cannot call a class as a function")}function o(S,T){for(var N=0;N<T.length;N++){var E=T[N];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(S,E.key,E)}}function u(S,T,N){return T&&o(S.prototype,T),S}function h(S,T){return T&&(e(T)==="object"||typeof T=="function")?T:x(S)}function d(S){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(N){return N.__proto__||Object.getPrototypeOf(N)},d(S)}function x(S){if(S===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S}function g(S,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function");S.prototype=Object.create(T&&T.prototype,{constructor:{value:S,writable:!0,configurable:!0}}),T&&p(S,T)}function p(S,T){return p=Object.setPrototypeOf||function(E,D){return E.__proto__=D,E},p(S,T)}var y,w=t.default.version.split(/[.-]/);w[0]==="0"&&(w[1]==="13"||w[1]==="12")?y=function(T){return T.getDOMNode()}:y=function(T){return T};var _=(function(S){g(T,S);function T(N){var E;return l(this,T),E=h(this,d(T).call(this,N)),E.renderElementRef=t.default.createRef(),E.update=E.update.bind(x(E)),E}return u(T,[{key:"shouldComponentUpdate",value:function(E){var D=this;return Object.keys(T.propTypes).some(function(G){return D.props[G]!==E[G]})}},{key:"componentDidMount",value:function(){this.update()}},{key:"componentDidUpdate",value:function(){this.update()}},{key:"update",value:function(){var E=y(this.renderElementRef.current);try{new r.default(E,this.props.value,Object.assign({text:this.props.text||this.props.value},this.props))}catch(D){window.console.error(D)}}},{key:"render",value:function(){var E=this.props,D=E.id,G=E.className;if(this.props.renderer==="svg")return t.default.createElement("svg",{ref:this.renderElementRef,id:D,className:G});if(this.props.renderer==="canvas")return t.default.createElement("canvas",{ref:this.renderElementRef,id:D,className:G});if(this.props.renderer==="img")return t.default.createElement("img",{ref:this.renderElementRef,id:D,className:G})}}]),T})(t.default.Component);return _.propTypes={value:a.default.string.isRequired,text:a.default.string,renderer:a.default.string,format:a.default.string,width:a.default.number,height:a.default.number,displayValue:a.default.bool,fontOptions:a.default.string,font:a.default.string,textAlign:a.default.string,textPosition:a.default.string,textMargin:a.default.number,fontSize:a.default.number,background:a.default.string,lineColor:a.default.string,margin:a.default.number,marginTop:a.default.number,marginBottom:a.default.number,marginLeft:a.default.number,marginRight:a.default.number,id:a.default.string,className:a.default.string,ean128:a.default.bool},_.defaultProps={format:"CODE128",renderer:"svg",width:2,height:100,displayValue:!0,fontOptions:"",font:"monospace",textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",lineColor:"#000000",margin:10,className:"",ean128:!1},wm=_,wm}var PN=BN();const UN=nx(PN),u_=({value:e,className:t="",onCopy:r})=>{const[a,s]=ne.useState(!1),l=o=>{o.stopPropagation(),e&&(navigator.clipboard.writeText(e),s(!0),r&&r(),setTimeout(()=>s(!1),2e3))};return e?f.jsxs("div",{onClick:l,className:`relative group cursor-pointer transition-all duration-200 hover:scale-105 active:scale-95 bg-white rounded p-1 border border-transparent hover:border-blue-100 hover:shadow-sm ${t}`,title:"Click to copy Asset Tag",children:[f.jsx("div",{className:`transition-opacity duration-200 ${a?"opacity-30 blur-[1px]":"opacity-100"}`,children:f.jsx(UN,{value:e,format:"CODE128",width:1,height:30,displayValue:!0,font:"monospace",textAlign:"center",textPosition:"bottom",fontSize:10,background:"transparent",margin:0})}),f.jsx("div",{className:`absolute inset-0 flex items-center justify-center transition-all duration-200 ${a?"opacity-100 scale-100":"opacity-0 scale-75 pointer-events-none"}`,children:f.jsxs("div",{className:"bg-green-500 text-white text-[10px] font-bold px-2 py-1 rounded-full shadow-md flex items-center gap-1",children:[f.jsx("span",{className:"material-icons text-[12px]",children:"check"})," Copied"]})}),f.jsx("div",{className:"absolute -top-6 left-1/2 transform -translate-x-1/2 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",children:f.jsx("div",{className:"bg-gray-800 text-white text-[10px] px-2 py-1 rounded shadow-lg whitespace-nowrap",children:"Copy Tag"})})]}):null},f_=["Scanner","Server","PC","Workstation","Laptop","Printer","Monitor","Other"],d_=[{value:"operational",label:"Operational ()"},{value:"in_storage",label:"In Storage ()"},{value:"faulty",label:"Faulty ()"},{value:"maintenance",label:"Maintenance ()"},{value:"retired",label:"Retired ()"}],zN=({user:e})=>{const[t,r]=ne.useState([]),[a,s]=ne.useState(!1),[l,o]=ne.useState(e.projectId),[u,h]=ne.useState([]),[d,x]=ne.useState(""),[g,p]=ne.useState(new Set),[y,w]=ne.useState(!1),[_,S]=ne.useState(null),[T,N]=ne.useState({priority:"medium",description:""}),[E,D]=ne.useState(""),[G,V]=ne.useState(!1),[A,M]=ne.useState(!1),[C,U]=ne.useState(!1),[Z,q]=ne.useState(!1),[le,ge]=ne.useState(1),[Se,te]=ne.useState(""),[ae,De]=ne.useState(1),[ie,Me]=ne.useState([]),[W,O]=ne.useState(""),[P,z]=ne.useState({type:"Laptop",status:"in_storage",purchaseDate:new Date().toISOString().split("T")[0],cost:0,targetProjectId:"",cpu:"",ram:"",storage:""}),[F,Q]=ne.useState([]),[re,Ee]=ne.useState(""),[ye,Oe]=ne.useState(0),[tt,J]=ne.useState([]),[wt,et]=ne.useState(null),[gt,it]=ne.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{},isDangerous:!1}),Ce=(K,Ie="success")=>{et({message:K,type:Ie})},Ae=(K,Ie,ft=!1)=>{it({isOpen:!0,message:K,title:"",onConfirm:Ie,isDangerous:ft})},Ge=()=>{it(K=>({...K,isOpen:!1}))},mt={assetTag:"",name:"",type:"Scanner",status:"in_storage",serialNumber:"",macAddress:"",cpu:"",ram:"",storage:"",purchaseDate:"",cost:0,assignedUser:"",department:"",physicalLocation:"",lastMaintenanceDate:"",projectId:"",currentCounter:0},[Ue,Ve]=ne.useState(mt),Tt=e.role==="project_manager"||e.role==="super_admin"||e.role==="power_admin"||e.role==="it_specialist"||e.role==="hr_admin",Ke=e.role==="it_specialist"||e.role==="hr_admin",Rt=e.role==="super_admin"||e.role==="power_admin";ne.useEffect(()=>{if(!l&&!Ke&&!Rt){const K=localStorage.getItem("current_project_id");K&&o(K)}},[]),ne.useEffect(()=>{(l||Ke||Rt)&&zt()},[l]),ne.useEffect(()=>{Tt&&(async()=>{let Ie=[];Rt||Ke?Ie=await Xe.getProjects():e.role==="project_manager"&&(Ie=await Xe.getProjectsByPM(e.id)),h(Ie),l||(Ke||Rt?o("all"):Ie.length>0&&o(Ie[0].id))})()},[e.role,e.id,Tt,Ke,Rt]),ne.useEffect(()=>{if(Z&&le===2){const K=Array.from(new Set(t.map(Ie=>Ie.name))).sort();Me(K),Xe.getNextAssetTag().then(Ie=>O(Ie))}},[Z,le,t]);const zt=async()=>{const K=(Ke||Rt)&&(!l||l==="all")?"all":l;if(!K)return;s(!0);const Ie=await Xe.getAssets(K);r(Ie),s(!1),p(new Set)},ua=K=>{switch(K.toLowerCase()){case"laptop":return"laptop";case"pc":return"computer";case"server":return"dns";case"scanner":return"document_scanner";case"workstation":return"desktop_windows";case"printer":return"print";default:return"devices_other"}},ir=K=>{S(K),N({priority:"medium",description:""}),D(""),w(!0)},or=async K=>{if(K.preventDefault(),!_||!_.projectId)return;D("sending");const Ie={assetId:_.id,supervisorId:e.id,projectId:_.projectId,priority:T.priority,description:T.description,status:"pending",createdAt:new Date().toISOString()},ft=await Xe.createMaintenanceRequest(Ie);ft.success?(D("success"),(Ie.priority==="high"||Ie.priority==="critical")&&zt(),setTimeout(()=>{w(!1),S(null)},1500)):(D("error"),Ce(`Error: ${ft.error}`,"error"))},nt=async()=>{const K=new Date().toISOString().split("T")[0];Ve({...mt,lastMaintenanceDate:K,purchaseDate:K,projectId:l==="all"?"":l}),M(!1),V(!0),U(!0);const Ie=await Xe.getNextAssetTag();Ve(ft=>({...ft,assetTag:Ie})),U(!1)},Ht=K=>{Ve({...K}),M(!0),V(!0)},Hr=async K=>{if(K.preventDefault(),!Ue.name||!Ue.projectId||!Ue.assetTag){Ce("   :   (Tag) .","error");return}D("sending");let Ie;A&&Ue.id?Ie=await Xe.updateAsset(Ue):Ie=await Xe.createAsset(Ue),Ie.success?(D("success"),zt(),V(!1),Ce("   ")):(Ce(`: ${Ie.error}`,"error"),D(""))},It=async()=>{const K=await Xe.createProject(" (Storage)","Main Storage");K?(h(Ie=>[...Ie,K]),z(Ie=>({...Ie,targetProjectId:K.id})),Ce("     (Storage)")):Ce("  ","error")},Gt=()=>{if(!l){Ce("    .","error");return}ge(1),z({type:"Laptop",status:"in_storage",purchaseDate:new Date().toISOString().split("T")[0],cost:0,targetProjectId:l==="all"?"":l,cpu:"",ram:"",storage:""}),Q([{id:Date.now(),model:"",serialNumber:"",isDuplicate:!1,predictedTag:""}]),J([]),D(""),q(!0),te(""),De(1),Oe(0)},qr=(K,Ie)=>{if(!Ie)return K;const ft=Ie.split("-");if(ft.length<2)return K;const qt=ft[0];let gr=parseInt(ft[1],10);return isNaN(gr)?K:K.map((j,H)=>{const L=(gr+H).toString().padStart(5,"0");return{...j,predictedTag:`${qt}-${L}`}})},Vt=()=>{const K=F.filter(j=>j.model.trim()!==""||j.serialNumber.trim()!=="");Oe(K.length);const Ie=[],ft=Date.now();for(let j=0;j<ae;j++)Ie.push({id:ft+j,model:Se||"",serialNumber:"",isDuplicate:!1,predictedTag:""});const qt=[...K,...Ie],gr=qr(qt,W);Q(gr)},Ns=()=>{const K={id:Date.now(),model:Se||"",serialNumber:"",isDuplicate:!1,predictedTag:""},Ie=[...F,K];Q(qr(Ie,W)),Oe(Ie.length-1)},Zn=K=>{const Ie=F.filter(ft=>ft.id!==K);Q(qr(Ie,W))},es=(K,Ie,ft)=>{Q(qt=>qt.map(gr=>{if(gr.id!==K)return gr;const j={...gr,[Ie]:ft};if(Ie==="serialNumber"){const H=ft.trim().toLowerCase(),I=t.some(B=>B.serialNumber.toLowerCase()===H&&H!==""),L=qt.some(B=>B.id!==K&&B.serialNumber.toLowerCase()===H&&H!=="");j.isDuplicate=I||L}return j}))},qa=()=>{if(!re.trim())return;const Ie=re.trim().split(`
`).map((qt,gr)=>{var B,X,ce;const j=qt.split("	"),H=((B=j[0])==null?void 0:B.trim())||"",I=((X=j[1])==null?void 0:X.trim())||(j.length===1?(ce=j[0])==null?void 0:ce.trim():"")||"",L=t.some(_e=>_e.serialNumber.toLowerCase()===I.toLowerCase()&&I!=="");return{id:Date.now()+gr,model:j.length>1?H:"",serialNumber:I,isDuplicate:L,predictedTag:""}}),ft=[...F,...Ie];Q(qr(ft,W)),Ee("")},zn=async()=>{const K=l==="all"?P.targetProjectId:l;if(!K){Ce("  .","error");return}if(F.some(qt=>qt.isDuplicate)){Ce("    ( ).  .","error");return}D("sending");const Ie=F.map(qt=>({name:qt.model||P.type+" "+(qt.serialNumber||"No Serial"),type:P.type,serialNumber:qt.serialNumber,status:P.status,purchaseDate:P.purchaseDate,cost:P.cost,projectId:K,cpu:P.cpu,ram:P.ram,storage:P.storage})),ft=await Xe.registerAssetsBulk(Ie,K,e.id);ft.success&&ft.data?(J(ft.data),ge(4),D("success"),zt(),Ce(`  ${ft.data.length}  `)):(D("error"),Ce(" : "+ft.error,"error"))},cn=()=>{const K=window.open("","","width=800,height=600");if(!K)return;const Ie=tt.map(ft=>`
        <div class="label">
            <div class="header">
                <span class="org">Capture Flow</span>
                <span class="cat">${ft.type}</span>
            </div>
            <div class="barcode-box">
               <div class="tag">${ft.asset_tag}</div>
            </div>
            <div class="details">
                <div class="model">${ft.name}</div>
                <div class="sn">S/N: ${ft.serial_number}</div>
            </div>
        </div>
      `).join("");K.document.write(`
        <html>
          <head>
            <title>Print Asset Labels</title>
            <style>
              @media print {
                @page { size: auto; margin: 0; }
                body { margin: 0.5cm; }
              }
              body { font-family: monospace; display: flex; flex-wrap: wrap; gap: 10px; }
              .label {
                width: 3.5in; 
                height: 1.5in;
                border: 2px solid #000;
                border-radius: 8px;
                padding: 10px;
                box-sizing: border-box;
                display: flex;
                flex-direction: column;
                justify-content: space-between;
                page-break-inside: avoid;
                margin-bottom: 10px;
              }
              .header { display: flex; justify-content: space-between; font-size: 12px; font-weight: bold; border-bottom: 1px solid #000; padding-bottom: 4px; }
              .barcode-box { text-align: center; margin: 10px 0; }
              .tag { font-size: 28px; font-weight: 900; letter-spacing: 2px; }
              .details { font-size: 12px; }
              .model { font-weight: bold; font-size: 14px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
            </style>
          </head>
          <body>
            ${Ie}
            <script>
                window.print();
            <\/script>
          </body>
        </html>
      `),K.document.close()},fa=K=>{const Ie=new Set(g);Ie.has(K)?Ie.delete(K):Ie.add(K),p(Ie)},ea=K=>{g.size===K.length&&K.length>0?p(new Set):p(new Set(K.map(Ie=>Ie.id)))},Ea=async()=>{g.size!==0&&Ae(`  ${g.size}      .`,async()=>{const K=await Xe.bulkUpdateAssets(Array.from(g),{lastAuditDate:new Date().toISOString(),auditedBy:e.id});K.success?(Ce("   "),zt(),p(new Set)):Ce(`: ${K.error}`,"error"),Ge()})},st=async()=>{g.size!==0&&Ae(`     ${g.size}       .`,async()=>{const K=await Xe.deleteAssets(Array.from(g));K.success?(Ce("   "),zt(),p(new Set)):Ce(`: ${K.error}`,"error"),Ge()},!0)},_r=async K=>{if(g.size===0)return;const Ie=await Xe.bulkUpdateAssets(Array.from(g),{status:K});Ie.success?(Ce(`    ${K}`),zt(),p(new Set)):Ce(`: ${Ie.error}`,"error")},tr=async K=>{const Ie=await Xe.verifyAsset(K.id,e.id);Ie.success?(Ce("   "),r(ft=>ft.map(qt=>qt.id===K.id?{...qt,lastAuditDate:new Date().toISOString()}:qt))):Ce(`: ${Ie.error}`,"error")},$a=()=>{if(g.size===0)return;const K=t.filter(L=>g.has(L.id)),qt=[["Asset Tag","Asset Name","Category","Serial Number","Location"].join(","),...K.map(L=>{const B=X=>{const ce=X||"";return ce.includes(",")?`"${ce}"`:ce};return[B(L.assetTag),B(L.name),B(L.type),B(L.serialNumber),B(L.physicalLocation)].join(",")})].join(`
`),gr="\uFEFF",j=new Blob([gr+qt],{type:"text/csv;charset=utf-8;"}),H=document.createElement("a"),I=URL.createObjectURL(j);H.setAttribute("href",I),H.setAttribute("download",`assets_labels_export_${new Date().toISOString().split("T")[0]}.csv`),H.style.visibility="hidden",document.body.appendChild(H),H.click(),document.body.removeChild(H),Ce("   ")},Ca=t.filter(K=>(K.name||"").toLowerCase().includes(d.toLowerCase())||(K.serialNumber||"").toLowerCase().includes(d.toLowerCase())||K.assetTag&&K.assetTag.toLowerCase().includes(d.toLowerCase()));return a?f.jsx("div",{className:"flex h-96 items-center justify-center text-primary",children:f.jsx("span",{className:"material-icons animate-spin text-4xl",children:"donut_large"})}):f.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[wt&&f.jsx(lo,{message:wt.message,type:wt.type,onClose:()=>et(null)}),f.jsx($f,{isOpen:gt.isOpen,title:gt.title,message:gt.message,onConfirm:gt.onConfirm,onCancel:Ge,isDangerous:gt.isDangerous}),f.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex flex-col gap-4",children:[f.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[f.jsxs("div",{children:[f.jsx("h2",{className:"text-lg font-bold text-gray-800",children:Ke?"   (IT Audit)":" "}),f.jsx("p",{className:"text-gray-500 text-sm",children:Ke?"    ":"   "})]}),Tt&&u.length>0&&f.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 p-2 rounded-lg border border-gray-200",children:[f.jsx("span",{className:"material-icons text-gray-400",children:"domain"}),f.jsxs("select",{className:"bg-transparent font-bold text-gray-700 outline-none text-sm min-w-[150px]",value:l||"all",onChange:K=>o(K.target.value),children:[(Ke||Rt)&&f.jsx("option",{value:"all",children:"  (Global)"}),u.map(K=>f.jsx("option",{value:K.id,children:K.name},K.id))]})]})]}),f.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between border-t pt-4",children:[f.jsxs("div",{className:"relative w-full md:w-96",children:[f.jsx("span",{className:"material-icons absolute right-3 top-2.5 text-gray-400",children:"search"}),f.jsx("input",{type:"text",placeholder:"  (Tag)   ...",className:"w-full pl-4 pr-10 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary outline-none",value:d,onChange:K=>x(K.target.value)})]}),f.jsx("div",{className:"flex gap-2 w-full md:w-auto",children:Tt&&f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:Gt,disabled:!l,className:"bg-emerald-600 text-white px-4 py-2 rounded-lg font-bold shadow-sm hover:bg-emerald-700 flex items-center gap-2 disabled:bg-gray-300",children:[f.jsx("span",{className:"material-icons text-sm",children:"playlist_add"}),"   (Wizard)"]}),f.jsxs("button",{onClick:nt,disabled:l==="all"&&!Ke,className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-bold shadow-sm hover:bg-blue-700 flex items-center gap-2 disabled:bg-gray-300",children:[f.jsx("span",{className:"material-icons text-sm",children:"add_circle"})," "]})]})})]}),g.size>0&&f.jsxs("div",{className:"bg-blue-50 border border-blue-100 p-3 rounded-lg flex items-center justify-between animate-fade-in-up flex-wrap gap-2",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsxs("span",{className:"font-bold text-blue-800 text-sm",children:["  ",g.size," "]})}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("button",{onClick:$a,className:"bg-purple-600 text-white px-3 py-1.5 rounded text-xs font-bold hover:bg-purple-700 flex items-center gap-1",children:[f.jsx("span",{className:"material-icons text-sm",children:"file_download"}),"   (CSV)"]}),Ke&&f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:Ea,className:"bg-green-600 text-white px-3 py-1.5 rounded text-xs font-bold hover:bg-green-700 flex items-center gap-1",children:[f.jsx("span",{className:"material-icons text-sm",children:"fact_check"}),"   (Verify)"]}),f.jsxs("button",{onClick:st,className:"bg-red-600 text-white px-3 py-1.5 rounded text-xs font-bold hover:bg-red-700 flex items-center gap-1",children:[f.jsx("span",{className:"material-icons text-sm",children:"delete"})," "]})]}),f.jsxs("div",{className:"relative group",children:[f.jsxs("button",{className:"bg-white border border-gray-300 text-gray-700 px-3 py-1.5 rounded text-xs font-bold hover:bg-gray-50 flex items-center gap-1",children:[f.jsx("span",{className:"material-icons text-sm",children:"edit_note"}),"  "]}),f.jsx("div",{className:"absolute left-0 mt-1 w-40 bg-white border border-gray-200 shadow-xl rounded-lg hidden group-hover:block z-20",children:["operational","in_storage","faulty","maintenance","retired"].map(K=>f.jsx("button",{onClick:()=>_r(K),className:"block w-full text-right px-4 py-2 hover:bg-gray-50 text-xs font-bold capitalize",children:K},K))})]})]})]})]}),!l&&!Ke&&!Rt&&f.jsxs("div",{className:"flex flex-col items-center justify-center h-96 bg-white rounded-xl shadow-sm border p-8 text-center",children:[f.jsx("span",{className:"material-icons text-5xl text-gray-300 mb-4",children:"domain_disabled"}),f.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"   "})]}),(l||Ke||Rt)&&Ca.length===0?f.jsxs("div",{className:"text-center py-20 bg-gray-50 rounded-xl border-2 border-dashed border-gray-200",children:[f.jsx("span",{className:"material-icons text-5xl text-gray-300 mb-4",children:"inventory_2"}),f.jsx("p",{className:"text-gray-500 font-bold",children:"    "})]}):(l||Ke||Rt)&&(Ke?f.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full text-right text-sm",children:[f.jsx("thead",{className:"bg-gray-50 text-gray-500 font-bold uppercase",children:f.jsxs("tr",{children:[f.jsx("th",{className:"p-4 w-10 text-center",children:f.jsx("input",{type:"checkbox",onChange:()=>ea(Ca),checked:g.size===Ca.length&&Ca.length>0,className:"w-4 h-4 rounded text-primary"})}),f.jsx("th",{className:"p-4",children:"Tag / Name"}),f.jsx("th",{className:"p-4",children:" / S.N"}),f.jsx("th",{className:"p-4",children:""}),f.jsx("th",{className:"p-4 text-center",children:""}),f.jsx("th",{className:"p-4 text-center",children:" "}),f.jsx("th",{className:"p-4 text-center",children:""})]})}),f.jsx("tbody",{className:"divide-y divide-gray-100",children:Ca.map(K=>{var qt;const Ie=K.lastAuditDate&&new Date(K.lastAuditDate)>new Date(Date.now()-6048e5),ft=((qt=u.find(gr=>gr.id===K.projectId))==null?void 0:qt.name)||"Unknown";return f.jsxs("tr",{className:`hover:bg-gray-50 ${g.has(K.id)?"bg-blue-50":""}`,children:[f.jsx("td",{className:"p-4 text-center",children:f.jsx("input",{type:"checkbox",checked:g.has(K.id),onChange:()=>fa(K.id),className:"w-4 h-4 rounded text-primary"})}),f.jsxs("td",{className:"py-2 px-4",children:[f.jsx("div",{className:"font-bold text-gray-800 mb-1",children:K.name}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("span",{className:"material-icons text-gray-400 bg-gray-100 p-1 rounded text-lg",children:ua(K.type)}),K.assetTag?f.jsx(u_,{value:K.assetTag}):f.jsx("span",{className:"text-xs text-red-300 font-mono italic",children:"NO TAG"})]})]}),f.jsxs("td",{className:"p-4",children:[f.jsx("div",{className:"text-gray-700 font-bold text-xs",children:K.type}),f.jsx("div",{className:"text-xs text-gray-500 font-mono",children:K.serialNumber}),(K.cpu||K.ram||K.storage)&&f.jsxs("div",{className:"text-[10px] text-gray-400 mt-1 flex gap-1",children:[K.cpu&&f.jsx("span",{children:K.cpu}),K.ram&&f.jsxs("span",{children:["/ ",K.ram]}),K.storage&&f.jsxs("span",{children:["/ ",K.storage]})]})]}),f.jsx("td",{className:"p-4 text-gray-600",children:f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("span",{className:"material-icons text-xs text-gray-400",children:"place"}),ft]})}),f.jsx("td",{className:"p-4 text-center",children:f.jsx("span",{className:`px-2 py-1 rounded text-[10px] font-bold uppercase ${K.status==="operational"||K.status==="in_use"?"bg-green-100 text-green-700":K.status==="in_storage"?"bg-blue-100 text-blue-700":K.status==="faulty"?"bg-red-100 text-red-700":K.status==="retired"?"bg-gray-200 text-gray-600":"bg-orange-100 text-orange-700"}`,children:K.status.replace("_"," ")})}),f.jsx("td",{className:"p-4 text-center",children:K.lastAuditDate?f.jsx("div",{className:`text-xs ${Ie?"text-green-600":"text-orange-500"}`,children:new Date(K.lastAuditDate).toLocaleDateString()}):f.jsx("span",{className:"text-xs text-red-400 italic",children:"Never"})}),f.jsxs("td",{className:"p-4 flex justify-center gap-2",children:[f.jsx("button",{onClick:()=>tr(K),className:"p-1.5 rounded bg-green-50 text-green-600 hover:bg-green-100",title:"Verify",children:f.jsx("span",{className:"material-icons text-sm",children:"fact_check"})}),f.jsx("button",{onClick:()=>Ht(K),className:"p-1.5 rounded bg-blue-50 text-blue-600 hover:bg-blue-100",title:"Edit",children:f.jsx("span",{className:"material-icons text-sm",children:"edit"})})]})]},K.id)})})]})})}):f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:Ca.map(K=>{const Ie=K.status==="faulty"||K.status==="maintenance";return f.jsxs("div",{className:`bg-white rounded-xl shadow-sm border overflow-hidden transition-all hover:shadow-md relative group ${Ie?"border-red-100":"border-gray-100"}`,children:[Tt&&f.jsx("button",{onClick:()=>Ht(K),className:"absolute top-3 left-3 p-1.5 rounded-full bg-white text-gray-400 hover:text-blue-600 hover:bg-blue-50 border border-gray-200 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:f.jsx("span",{className:"material-icons text-sm",children:"edit"})}),f.jsx("div",{className:`h-1.5 w-full ${K.status==="operational"||K.status==="in_use"?"bg-green-500":K.status==="in_storage"?"bg-blue-500":K.status==="faulty"?"bg-red-500":K.status==="retired"?"bg-gray-400":"bg-orange-500"}`}),f.jsxs("div",{className:"p-5",children:[f.jsxs("div",{className:"flex justify-between items-start mb-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center text-xl ${Ie?"bg-red-50 text-red-600":"bg-green-50 text-green-600"}`,children:f.jsx("span",{className:"material-icons",children:"precision_manufacturing"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-bold text-gray-800 text-lg leading-tight",children:K.name}),f.jsx("p",{className:"text-xs text-gray-500 font-mono mt-0.5",children:K.assetTag||"NO TAG"})]})]}),f.jsx("span",{className:`px-2 py-1 rounded text-[10px] font-bold uppercase ${Ie?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:K.status.replace("_"," ")})]}),f.jsxs("div",{className:"space-y-3 mb-6",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-400",children:""}),f.jsx("span",{className:"font-bold text-gray-700",children:K.type})]}),K.assignedUser&&f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-400",children:""}),f.jsx("span",{className:"font-bold text-gray-700",children:K.assignedUser})]})]}),f.jsxs("button",{onClick:()=>ir(K),className:"w-full py-2.5 rounded-lg border border-gray-200 text-gray-600 font-bold text-sm hover:bg-gray-50 hover:text-primary transition-colors flex items-center justify-center gap-2",children:[f.jsx("span",{className:"material-icons text-sm",children:"build"})," "]})]})]},K.id)})})),y&&_&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6 animate-fade-in-up",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6 border-b pb-2",children:[f.jsxs("h3",{className:"font-bold text-lg text-gray-800 flex items-center gap-2",children:[f.jsx("span",{className:"material-icons text-orange-600",children:"build_circle"}),"  "]}),f.jsx("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-red-500",children:f.jsx("span",{className:"material-icons",children:"close"})})]}),E==="success"?f.jsxs("div",{className:"text-center py-10",children:[f.jsx("span",{className:"material-icons text-5xl text-green-500 mb-4 animate-bounce",children:"check_circle"}),f.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"   "})]}):f.jsxs("form",{onSubmit:or,className:"space-y-4",children:[f.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-100",children:[f.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-1",children:""}),f.jsxs("div",{className:"font-bold text-gray-800 flex justify-between",children:[f.jsx("span",{children:_.name}),f.jsx("span",{className:"font-mono text-xs bg-white px-1 rounded border",children:_.assetTag})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:""}),f.jsx("div",{className:"grid grid-cols-4 gap-2",children:["low","medium","high","critical"].map(K=>f.jsx("button",{type:"button",onClick:()=>N({...T,priority:K}),className:`py-2 rounded text-xs font-bold border transition-colors capitalize ${T.priority===K?K==="critical"?"bg-red-600 text-white border-red-600":"bg-primary text-white border-primary":"bg-white text-gray-600 border-gray-200 hover:bg-gray-50"}`,children:K==="critical"?"":K==="high"?"":K==="medium"?"":""},K))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:" "}),f.jsx("textarea",{required:!0,className:"w-full p-3 bg-gray-50 border rounded-lg focus:ring-2 focus:ring-primary outline-none min-h-[100px]",placeholder:"     ...",value:T.description,onChange:K=>N({...T,description:K.target.value})})]}),f.jsxs("button",{type:"submit",disabled:E==="sending",className:"w-full bg-primary text-white py-3 rounded-lg font-bold shadow-lg shadow-blue-500/20 hover:bg-primary-dark transition-colors flex items-center justify-center gap-2",children:[E==="sending"&&f.jsx("span",{className:"material-icons animate-spin text-sm",children:"sync"}),"  "]})]})]})}),Z&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-6xl h-[90vh] flex flex-col animate-fade-in-up",children:[f.jsxs("div",{className:"flex justify-between items-center px-6 py-4 border-b",children:[f.jsxs("div",{children:[f.jsxs("h3",{className:"font-bold text-lg text-gray-800 flex items-center gap-2",children:[f.jsx("span",{className:"material-icons text-emerald-600",children:"playlist_add"}),"    (Bulk Wizard)"]}),f.jsxs("p",{className:"text-xs text-gray-500",children:[" ",le,"  4"]})]}),f.jsx("button",{onClick:()=>q(!1),className:"text-gray-400 hover:text-red-500",children:f.jsx("span",{className:"material-icons",children:"close"})})]}),f.jsx("div",{className:"w-full bg-gray-100 h-2",children:f.jsx("div",{className:"bg-emerald-500 h-2 transition-all duration-300",style:{width:`${le/4*100}%`}})}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-gray-50/50",children:[le===1&&f.jsxs("div",{className:"max-w-2xl mx-auto bg-white p-8 rounded-xl shadow-sm border border-gray-100",children:[f.jsxs("h4",{className:"font-bold text-gray-800 mb-6 border-b pb-2 flex items-center gap-2",children:[f.jsx("span",{className:"material-icons text-blue-500",children:"settings"}),"  (Common Attributes)"]}),f.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[l==="all"&&f.jsxs("div",{className:"col-span-2 bg-blue-50 p-3 rounded-lg border border-blue-100",children:[f.jsx("label",{className:"block text-xs font-bold text-blue-800 mb-2",children:"  (Target Project) *"}),f.jsxs("select",{className:"w-full p-3 bg-white border rounded-lg outline-none focus:ring-2 focus:ring-primary font-bold text-gray-700",value:P.targetProjectId,onChange:K=>{K.target.value==="NEW_STORAGE"?It():z({...P,targetProjectId:K.target.value})},children:[f.jsx("option",{value:"",children:"--     --"}),u.map(K=>f.jsx("option",{value:K.id,children:K.name},K.id)),Ke&&!u.some(K=>K.name.includes("Storage")||K.name.includes(""))&&f.jsx("option",{value:"NEW_STORAGE",className:"bg-blue-100 text-blue-800 font-bold",children:"    (Storage)"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-2",children:"  *"}),f.jsx("select",{className:"w-full p-3 bg-gray-50 border rounded-lg outline-none focus:ring-2 focus:ring-primary",value:P.type,onChange:K=>z({...P,type:K.target.value}),children:f_.map(K=>f.jsx("option",{value:K,children:K},K))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-2",children:" "}),f.jsx("select",{className:"w-full p-3 bg-gray-50 border rounded-lg outline-none focus:ring-2 focus:ring-primary",value:P.status,onChange:K=>z({...P,status:K.target.value}),children:d_.map(K=>f.jsx("option",{value:K.value,children:K.label},K.value))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-2",children:"CPU"}),f.jsx("input",{className:"w-full p-3 bg-gray-50 border rounded-lg outline-none focus:ring-2 focus:ring-primary",value:P.cpu,onChange:K=>z({...P,cpu:K.target.value}),placeholder:"i5-1135G7"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-2",children:"RAM"}),f.jsx("input",{className:"w-full p-3 bg-gray-50 border rounded-lg outline-none focus:ring-2 focus:ring-primary",value:P.ram,onChange:K=>z({...P,ram:K.target.value}),placeholder:"16GB"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-2",children:"Storage"}),f.jsx("input",{className:"w-full p-3 bg-gray-50 border rounded-lg outline-none focus:ring-2 focus:ring-primary",value:P.storage,onChange:K=>z({...P,storage:K.target.value}),placeholder:"512GB SSD"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-2",children:" "}),f.jsx("input",{type:"date",className:"w-full p-3 bg-gray-50 border rounded-lg outline-none focus:ring-2 focus:ring-primary",value:P.purchaseDate,onChange:K=>z({...P,purchaseDate:K.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-2",children:" ( )"}),f.jsx("input",{type:"number",className:"w-full p-3 bg-gray-50 border rounded-lg outline-none focus:ring-2 focus:ring-primary",value:P.cost,onChange:K=>z({...P,cost:parseFloat(K.target.value)}),placeholder:"0.00"})]})]})]}),le===2&&f.jsxs("div",{className:"flex flex-col h-full gap-6",children:[f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"bg-white border border-gray-200 p-5 rounded-xl shadow-sm",children:[f.jsxs("h5",{className:"font-bold text-gray-800 mb-4 flex items-center gap-2",children:[f.jsx("span",{className:"material-icons text-blue-500",children:"auto_fix_high"}),"  (Quick Generator)"]}),f.jsxs("div",{className:"grid grid-cols-12 gap-3",children:[f.jsxs("div",{className:"col-span-6",children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Model Name (Autocomplete)"}),f.jsx("input",{list:"model-suggestions",className:"w-full p-2 bg-gray-50 border border-gray-200 rounded-lg outline-none focus:ring-2 focus:ring-primary",value:Se,onChange:K=>te(K.target.value),placeholder:"e.g. Dell Latitude 5420"}),f.jsx("datalist",{id:"model-suggestions",children:ie.map((K,Ie)=>f.jsx("option",{value:K},Ie))})]}),f.jsxs("div",{className:"col-span-3",children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"QTY"}),f.jsx("input",{type:"number",min:"1",max:"100",className:"w-full p-2 bg-gray-50 border border-gray-200 rounded-lg outline-none focus:ring-2 focus:ring-primary text-center font-bold",value:ae,onChange:K=>De(Number(K.target.value))})]}),f.jsx("div",{className:"col-span-3 flex items-end",children:f.jsxs("button",{onClick:Vt,className:"w-full bg-blue-600 text-white py-2 rounded-lg font-bold hover:bg-blue-700 transition-colors flex justify-center items-center gap-1 shadow-sm",children:[f.jsx("span",{className:"material-icons text-sm",children:"add_circle"})," Generate"]})})]})]}),f.jsxs("div",{className:"bg-gray-50 border border-gray-200 p-5 rounded-xl flex flex-col justify-center",children:[f.jsx("div",{className:"text-xs text-gray-500 font-bold mb-2 uppercase",children:"Bulk Actions"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("button",{onClick:()=>Ee(""),className:"flex-1 bg-white border border-gray-300 text-gray-700 py-2 rounded-lg font-bold hover:bg-gray-100 flex items-center justify-center gap-2 text-xs",children:[f.jsx("span",{className:"material-icons text-sm",children:"content_paste"})," Paste Excel"]}),f.jsxs("button",{onClick:()=>Q([]),className:"flex-1 bg-white border border-red-200 text-red-600 py-2 rounded-lg font-bold hover:bg-red-50 flex items-center justify-center gap-2 text-xs",children:[f.jsx("span",{className:"material-icons text-sm",children:"clear_all"})," Clear All"]})]}),re!==void 0&&f.jsx("textarea",{className:"mt-2 w-full p-2 border rounded text-xs h-12 bg-white font-mono focus:ring-2 focus:ring-primary outline-none resize-none",placeholder:"Paste (Model [Tab] Serial)...",value:re,onChange:K=>Ee(K.target.value),onBlur:qa})]})]}),f.jsxs("div",{className:"flex-1 bg-white border rounded-xl shadow-sm overflow-hidden flex flex-col",children:[f.jsx("div",{className:"overflow-y-auto flex-1",children:f.jsxs("table",{className:"w-full text-left text-sm whitespace-nowrap",children:[f.jsx("thead",{className:"bg-gray-100 text-gray-600 font-bold sticky top-0 z-10 shadow-sm",children:f.jsxs("tr",{children:[f.jsx("th",{className:"p-3 w-12 text-center",children:"#"}),f.jsx("th",{className:"p-3 w-40",children:"Asset Tag (Est.)"}),f.jsx("th",{className:"p-3 w-1/3",children:"Model Name"}),f.jsx("th",{className:"p-3 w-1/3",children:"Serial Number"}),f.jsx("th",{className:"p-3 w-16 text-center",children:"Action"})]})}),f.jsxs("tbody",{className:"divide-y",children:[F.map((K,Ie)=>f.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${K.isDuplicate?"bg-red-50":""}`,children:[f.jsx("td",{className:"p-3 text-center text-gray-400 font-mono text-xs",children:Ie+1}),f.jsx("td",{className:"p-3 font-mono text-xs font-bold text-blue-600 bg-blue-50/30",children:K.predictedTag||"-"}),f.jsx("td",{className:"p-3",children:f.jsx("input",{className:"w-full bg-transparent border-b border-gray-200 focus:border-primary outline-none focus:bg-white px-2 py-1 transition-colors",value:K.model,onChange:ft=>es(K.id,"model",ft.target.value),placeholder:"Model Name"})}),f.jsx("td",{className:"p-3 relative",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx("input",{autoFocus:Ie===ye,className:`w-full bg-transparent border-b outline-none px-2 py-1 font-mono transition-colors ${K.isDuplicate?"border-red-300 bg-red-50/50":"border-gray-200 focus:border-primary focus:bg-white"}`,value:K.serialNumber,onChange:ft=>es(K.id,"serialNumber",ft.target.value),placeholder:"SCAN S/N (Optional)..."}),K.isDuplicate&&f.jsx("div",{className:"absolute right-4 top-3 flex items-center text-red-600 text-xs font-bold animate-pulse",title:"Duplicate Serial Number",children:f.jsx("span",{className:"material-icons text-sm mr-1",children:"warning"})})]})}),f.jsx("td",{className:"p-3 text-center",children:f.jsx("button",{onClick:()=>Zn(K.id),className:"text-gray-400 hover:text-red-600 transition-colors p-1 rounded-full hover:bg-red-50",children:f.jsx("span",{className:"material-icons text-sm",children:"delete"})})})]},K.id)),F.length===0&&f.jsx("tr",{children:f.jsx("td",{colSpan:5,className:"p-10 text-center text-gray-400 italic",children:f.jsxs("div",{className:"flex flex-col items-center",children:[f.jsx("span",{className:"material-icons text-4xl mb-2 text-gray-300",children:"playlist_add"}),f.jsx("span",{children:"Use the generator above to add rows."})]})})})]})]})}),f.jsx("div",{className:"p-3 border-t bg-gray-50 flex justify-center",children:f.jsxs("button",{onClick:Ns,className:"w-full max-w-md py-2 border-2 border-dashed border-gray-300 rounded-lg text-gray-500 font-bold hover:border-primary hover:text-primary transition-colors flex items-center justify-center gap-2 hover:bg-white",children:[f.jsx("span",{className:"material-icons",children:"add"})," Add Single Row"]})})]})]}),le===3&&f.jsxs("div",{className:"max-w-2xl mx-auto text-center py-8",children:[f.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-blue-50 rounded-full text-blue-600 mb-6",children:f.jsx("span",{className:"material-icons text-5xl",children:"fact_check"})}),f.jsx("h4",{className:"text-3xl font-bold text-gray-800 mb-2",children:" "}),f.jsxs("p",{className:"text-gray-500 mb-8 text-lg",children:["    ",f.jsx("span",{className:"font-bold text-blue-600 border-b-2 border-blue-200",children:F.length}),"  ."]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6 text-right grid grid-cols-2 gap-6 mb-10",children:[f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-400 text-xs font-bold uppercase",children:" "})," ",f.jsx("div",{className:"font-bold text-lg text-gray-800",children:P.type})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-400 text-xs font-bold uppercase",children:""})," ",f.jsx("div",{className:"font-bold text-lg text-gray-800",children:[P.cpu,P.ram,P.storage].filter(Boolean).join(" / ")||"-"})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-400 text-xs font-bold uppercase",children:"  "})," ",f.jsx("div",{className:"font-bold text-lg text-gray-800 font-mono",children:(P.cost*F.length).toLocaleString()})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-400 text-xs font-bold uppercase",children:""})," ",f.jsx("div",{className:"font-bold text-lg text-gray-800",children:P.status})]})]}),f.jsxs("div",{className:"flex justify-center gap-4",children:[f.jsx("button",{onClick:()=>ge(2),disabled:E==="sending",className:"bg-gray-100 text-gray-600 px-8 py-4 rounded-xl font-bold text-lg hover:bg-gray-200 transition-colors",children:""}),f.jsxs("button",{onClick:zn,disabled:E==="sending",className:"bg-emerald-600 text-white px-10 py-4 rounded-xl font-bold text-lg hover:bg-emerald-700 shadow-lg shadow-emerald-200 flex items-center gap-3 transition-all hover:scale-105 active:scale-95",children:[E==="sending"?f.jsx("span",{className:"material-icons animate-spin",children:"sync"}):f.jsx("span",{className:"material-icons",children:"save"}),"  "]})]})]}),le===4&&f.jsxs("div",{className:"flex flex-col h-full",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-green-100 rounded-full text-green-600 mb-4 animate-bounce",children:f.jsx("span",{className:"material-icons text-5xl",children:"check_circle"})}),f.jsx("h4",{className:"text-3xl font-bold text-gray-800",children:"  !"}),f.jsx("p",{className:"text-gray-500 mt-2",children:"    (Barcodes)     ."})]}),f.jsxs("div",{className:"flex justify-center gap-4 mb-8",children:[f.jsxs("button",{onClick:cn,className:"bg-gray-800 text-white px-8 py-4 rounded-xl font-bold shadow-lg hover:bg-gray-900 flex items-center gap-3 transition-all hover:-translate-y-1",children:[f.jsx("span",{className:"material-icons",children:"print"}),"   (2x4)"]}),f.jsx("button",{onClick:()=>q(!1),className:"bg-gray-100 text-gray-600 px-8 py-4 rounded-xl font-bold hover:bg-gray-200 transition-colors",children:""})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto bg-white border rounded-xl p-6 shadow-inner bg-gray-50/30",children:[f.jsx("h5",{className:"font-bold text-gray-500 mb-4 text-center text-sm uppercase tracking-widest",children:"  "}),f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4",children:tt.map((K,Ie)=>f.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3 flex flex-col items-center shadow-sm hover:shadow-md transition-shadow",children:[f.jsx("div",{className:"text-[10px] font-bold text-gray-500 mb-2 truncate w-full text-center",title:K.name,children:K.name}),f.jsx(u_,{value:K.asset_tag}),f.jsx("div",{className:"text-[10px] text-gray-400 font-mono mt-2",children:K.serial_number})]},Ie))})]})]})]}),le<3&&f.jsxs("div",{className:"p-4 border-t bg-white flex justify-between items-center",children:[le>1?f.jsx("button",{onClick:()=>ge(K=>K-1),className:"text-gray-500 font-bold hover:bg-gray-100 px-6 py-2 rounded-lg transition-colors",children:""}):f.jsx("div",{}),f.jsxs("button",{onClick:()=>{if(le===1){if(l==="all"&&!P.targetProjectId){Ce("   .","error");return}if(!P.type){Ce("Type is required","error");return}ge(2)}else if(le===2){if(F.length===0){Ce("     .","error");return}if(F.some(K=>K.isDuplicate)){Ce("    .  .","error");return}ge(3)}},className:"bg-primary text-white px-8 py-3 rounded-lg font-bold hover:bg-primary-dark flex items-center gap-2 shadow-lg shadow-blue-500/30 transition-all",children:[" ",f.jsx("span",{className:"material-icons text-sm",children:"arrow_back"})]})]})]})}),G&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl p-6 animate-fade-in-up max-h-[90vh] overflow-y-auto",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6 border-b pb-2 sticky top-0 bg-white z-10",children:[f.jsxs("h3",{className:"font-bold text-lg text-gray-800 flex items-center gap-2",children:[f.jsx("span",{className:"material-icons text-blue-600",children:"inventory"}),A?" /  ":"  "]}),f.jsx("button",{onClick:()=>V(!1),className:"text-gray-400 hover:text-red-500",children:f.jsx("span",{className:"material-icons",children:"close"})})]}),f.jsxs("form",{onSubmit:Hr,className:"space-y-6",children:[f.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-100",children:[f.jsx("h4",{className:"text-sm font-bold text-blue-800 mb-3 border-b border-blue-200 pb-1",children:"  (Basic Info)"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Asset Tag (Barcode) *"}),f.jsxs("div",{className:"relative",children:[f.jsx("input",{className:"w-full p-2 border rounded-lg bg-gray-100 text-gray-500 cursor-not-allowed font-mono font-bold",value:Ue.assetTag,readOnly:!0,placeholder:C?"Generating...":"e.g. CD2026-00001"}),C&&f.jsx("span",{className:"absolute right-3 top-2.5 material-icons animate-spin text-sm text-blue-500",children:"sync"})]}),f.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:"    "})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"  *"}),f.jsx("input",{className:"w-full p-2 bg-white border rounded-lg",value:Ue.name,onChange:K=>Ve({...Ue,name:K.target.value}),required:!0,placeholder:"e.g. Dell Latitude 5420"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:" "}),f.jsx("select",{className:"w-full p-2 bg-white border rounded-lg",value:Ue.type,onChange:K=>Ve({...Ue,type:K.target.value}),children:f_.map(K=>f.jsx("option",{value:K,children:K},K))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:""}),f.jsx("select",{className:"w-full p-2 bg-white border rounded-lg",value:Ue.status,onChange:K=>Ve({...Ue,status:K.target.value}),children:d_.map(K=>f.jsx("option",{value:K.value,children:K.label},K.value))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Serial Number"}),f.jsx("input",{className:"w-full p-2 bg-white border rounded-lg",value:Ue.serialNumber,onChange:K=>Ve({...Ue,serialNumber:K.target.value}),placeholder:"S/N"})]})]})]}),f.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-100",children:[f.jsx("h4",{className:"text-sm font-bold text-blue-800 mb-3 border-b border-blue-200 pb-1",children:"  (Technical Specs)"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"CPU"}),f.jsx("input",{className:"w-full p-2 bg-white border rounded-lg",value:Ue.cpu||"",onChange:K=>Ve({...Ue,cpu:K.target.value}),placeholder:"e.g. i7-1185G7"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"RAM"}),f.jsx("input",{className:"w-full p-2 bg-white border rounded-lg",value:Ue.ram||"",onChange:K=>Ve({...Ue,ram:K.target.value}),placeholder:"e.g. 16GB"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Storage"}),f.jsx("input",{className:"w-full p-2 bg-white border rounded-lg",value:Ue.storage||"",onChange:K=>Ve({...Ue,storage:K.target.value}),placeholder:"e.g. 512GB SSD"})]})]})]}),f.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-100",children:[f.jsx("h4",{className:"text-sm font-bold text-blue-800 mb-3 border-b border-blue-200 pb-1",children:"   (Location & Finance)"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"md:col-span-2",children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:" (Project)"}),f.jsxs("select",{className:"w-full p-2 bg-white border rounded-lg font-bold text-gray-700",value:Ue.projectId,onChange:K=>Ve({...Ue,projectId:K.target.value}),disabled:!Ke&&!Rt,children:[f.jsx("option",{value:"",children:"--   --"}),u.map(K=>f.jsx("option",{value:K.id,children:K.name},K.id))]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"  (Location)"}),f.jsx("input",{className:"w-full p-2 bg-white border rounded-lg",value:Ue.physicalLocation||"",onChange:K=>Ve({...Ue,physicalLocation:K.target.value}),placeholder:"e.g. Room 101"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:" "}),f.jsx("input",{className:"w-full p-2 bg-white border rounded-lg",value:Ue.assignedUser||"",onChange:K=>Ve({...Ue,assignedUser:K.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:""}),f.jsx("input",{className:"w-full p-2 bg-white border rounded-lg",value:Ue.department||"",onChange:K=>Ve({...Ue,department:K.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:" "}),f.jsx("input",{type:"date",className:"w-full p-2 bg-white border rounded-lg",value:Ue.purchaseDate||"",onChange:K=>Ve({...Ue,purchaseDate:K.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:""}),f.jsx("input",{type:"number",className:"w-full p-2 bg-white border rounded-lg",value:Ue.cost||0,onChange:K=>Ve({...Ue,cost:parseFloat(K.target.value)})})]})]})]}),Ue.type==="Scanner"&&f.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-100",children:[f.jsx("h4",{className:"text-sm font-bold text-blue-800 mb-3 border-b border-blue-200 pb-1",children:"   (Scanner)"}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"   (Current Counter)"}),f.jsx("input",{type:"number",className:"w-full p-2 bg-white border rounded-lg focus:ring-2 focus:ring-blue-400 outline-none",value:Ue.currentCounter||0,onChange:K=>Ve({...Ue,currentCounter:parseInt(K.target.value)})})]})]}),f.jsxs("div",{className:"flex gap-4 pt-4 border-t",children:[f.jsx("button",{type:"button",onClick:()=>V(!1),className:"flex-1 bg-gray-100 text-gray-600 py-3 rounded-lg font-bold hover:bg-gray-200 transition-colors",children:""}),f.jsxs("button",{type:"submit",disabled:E==="sending",className:"flex-1 bg-blue-600 text-white py-3 rounded-lg font-bold hover:bg-blue-700 shadow-lg shadow-blue-200 transition-colors flex justify-center items-center gap-2",children:[E==="sending"?f.jsx("span",{className:"material-icons animate-spin text-sm",children:"sync"}):f.jsx("span",{className:"material-icons text-sm",children:"save"}),A?" ":" "]})]})]})]})})]})},HN=({user:e})=>{const[t,r]=ne.useState([]),[a,s]=ne.useState([]),[l,o]=ne.useState([]),[u,h]=ne.useState(!1),[d,x]=ne.useState(!1),[g,p]=ne.useState({isOpen:!1,ticketId:"",cost:""}),[y,w]=ne.useState([]),[_,S]=ne.useState({isOpen:!1,ticket:null}),[T,N]=ne.useState(null),[E,D]=ne.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{},isDangerous:!1}),G=(F,Q="success")=>{N({message:F,type:Q})},V=(F,Q,re=!1)=>{D({isOpen:!0,message:F,title:" ",onConfirm:Q,isDangerous:re})},A=()=>{D(F=>({...F,isOpen:!1}))},[M,C]=ne.useState({title:"",category:"hardware",projectId:"",assetId:"",description:"",priority:"medium"}),[U,Z]=ne.useState({avgTime:"0h",total:0,open:0}),q=["super_admin","power_admin"].includes(e.role),le=async()=>{h(!0);const F=await Xe.getTickets(e);if(r(F),e.role==="supervisor"&&e.projectId){const Q=await Xe.getAssets(e.projectId);s(Q)}else if(e.role==="project_manager"){const Q=await Xe.getProjectsByPM(e.id);o(Q.map(re=>({id:re.id,name:re.name})))}h(!1)};ne.useEffect(()=>{le();const F=Te.channel(`tickets-${e.id}`).on("postgres_changes",{event:"*",schema:"public",table:"tickets"},()=>{le()}).subscribe();return()=>{Te.removeChannel(F)}},[e]),ne.useEffect(()=>{if((q||e.role==="it_specialist"||e.role==="hr_admin")&&t.length>0){const F=t.filter(ye=>ye.status==="solved"||ye.status==="closed");let Q=0,re=0;F.forEach(ye=>{ye.solvedAt&&ye.createdAt&&(Q+=new Date(ye.solvedAt).getTime()-new Date(ye.createdAt).getTime(),re++)});const Ee=re>0?(Q/re/(1e3*60*60)).toFixed(1):"0";Z({avgTime:`${Ee} hrs`,total:t.length,open:t.filter(ye=>ye.status==="open").length})}},[t,q,e.role]);const ge=async F=>{F.preventDefault();const Q=e.role==="project_manager"?M.projectId:e.projectId;if(!Q){G("Error: You are not assigned to a project or did not select one.","error");return}const re=await Xe.createTicket({...M,createdBy:e.id,projectId:Q});re.success?(x(!1),C({...M,title:"",category:"hardware",assetId:"",description:"",priority:"medium"}),G("   "),le()):G(`Error: ${re.error}`,"error")},Se=async(F,Q)=>{if(Q==="solved"){p({isOpen:!0,ticketId:F,cost:""});return}V(`    ${Q==="in_progress"?" ":Q==="open"?"":""}`,async()=>{await Xe.updateTicketStatus(F,Q)?(le(),G("  ")):G("Failed to update status","error"),A()})},te=async F=>{F.preventDefault(),await Xe.updateTicketStatus(g.ticketId,"solved",Number(g.cost)||0)?(le(),G("     ")):G("Failed to update ticket","error"),p({isOpen:!1,ticketId:"",cost:""})},ae=F=>{w(Q=>Q.includes(F)?Q.filter(re=>re!==F):[...Q,F])},De=()=>{y.length!==0&&V(`     ${y.length}   `,async()=>{await Xe.deleteTickets(y)?(G("   "),w([]),le()):G("   ","error"),A()},!0)},ie=()=>{y.length!==0&&V(`      ${y.length} `,async()=>{let F=!0;for(const Q of y)await Xe.updateTicketStatus(Q,"open")||(F=!1);F?(G("    "),w([]),le()):G("    ","error"),A()})},Me=async F=>{if(F.preventDefault(),!_.ticket)return;await Xe.updateTicket(_.ticket.id,{title:_.ticket.title,category:_.ticket.category,priority:_.ticket.priority,cost:_.ticket.cost})?(G("   "),S({isOpen:!1,ticket:null}),le()):G("  ","error")},W=F=>{switch(F){case"open":return"bg-red-100 text-red-700";case"in_progress":return"bg-blue-100 text-blue-700";case"solved":return"bg-green-100 text-green-700";case"closed":return"bg-gray-100 text-gray-600";default:return"bg-gray-50"}},O=F=>{switch(F){case"open":return"";case"in_progress":return" ";case"solved":return" ";case"closed":return"";default:return F}},P=()=>{const F=t.filter(re=>re.status!=="closed"),Q=t.filter(re=>re.status==="solved");return f.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[f.jsxs("div",{className:"flex justify-between items-center bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[f.jsxs("div",{children:[f.jsx("h2",{className:"text-xl font-bold text-gray-800",children:" "}),f.jsx("p",{className:"text-gray-500 text-sm",children:"   "})]}),f.jsxs("button",{onClick:()=>x(!0),className:"bg-primary text-white px-4 py-2 rounded-lg font-bold flex items-center gap-2 hover:bg-primary-dark",children:[f.jsx("span",{className:"material-icons",children:"add"}),"  "]})]}),Q.length>0&&f.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-6",children:[f.jsxs("h3",{className:"font-bold text-green-800 flex items-center gap-2 mb-4",children:[f.jsx("span",{className:"material-icons",children:"fact_check"}),"    ( )"]}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Q.map(re=>f.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-green-100 flex justify-between items-center",children:[f.jsxs("div",{children:[f.jsx("div",{className:"font-bold text-gray-800",children:re.title}),f.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["     ",re.solvedAt?new Date(re.solvedAt).toLocaleDateString():""]})]}),f.jsx("button",{onClick:()=>Se(re.id,"closed"),className:"bg-green-600 text-white px-3 py-1.5 rounded text-sm font-bold hover:bg-green-700",children:" "})]},re.id))})]}),f.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[F.map(re=>f.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-gray-100 flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-bold ${W(re.status)}`,children:O(re.status)}),f.jsx("span",{className:"font-bold text-gray-800 text-lg",children:re.title})]}),f.jsx("p",{className:"text-gray-600 text-sm mb-2",children:re.description}),f.jsxs("div",{className:"flex gap-4 text-xs text-gray-400",children:[f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx("span",{className:"material-icons text-xs",children:"category"})," ",re.category]}),f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx("span",{className:"material-icons text-xs",children:"inventory_2"})," ",re.assetName||" "]}),f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx("span",{className:"material-icons text-xs",children:"calendar_today"})," ",new Date(re.createdAt).toLocaleDateString()]})]})]}),re.status==="in_progress"&&f.jsx("div",{className:"bg-blue-50 text-blue-600 px-3 py-1 rounded text-xs font-bold animate-pulse",children:"  ..."})]},re.id)),F.length===0&&f.jsx("div",{className:"text-center py-10 text-gray-400 bg-white rounded-xl border border-dashed",children:"   "})]})]})},z=()=>{const F=t.filter(re=>re.status==="open"),Q=t.filter(re=>re.status==="in_progress");return f.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[f.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[f.jsxs("div",{children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"   "}),f.jsx("p",{className:"text-sm text-gray-500",children:"    "})]}),(q||e.role==="it_specialist"||e.role==="hr_admin")&&f.jsxs("div",{className:"flex items-center gap-2 bg-blue-50 px-3 py-1.5 rounded-lg border border-blue-100",children:[f.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500 animate-pulse"}),f.jsx("span",{className:"text-xs font-bold text-blue-700",children:"  "})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[f.jsx("div",{className:"text-gray-500 text-xs font-bold uppercase",children:" "}),f.jsx("div",{className:"text-3xl font-bold text-gray-800 mt-1",children:U.total})]}),f.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[f.jsx("div",{className:"text-gray-500 text-xs font-bold uppercase",children:"  "}),f.jsx("div",{className:"text-3xl font-bold text-blue-600 mt-1",children:U.avgTime})]}),f.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[f.jsx("div",{className:"text-gray-500 text-xs font-bold uppercase",children:" "}),f.jsx("div",{className:"text-3xl font-bold text-red-600 mt-1",children:U.open})]})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl border border-gray-200",children:[f.jsxs("h3",{className:"font-bold text-gray-700 mb-4 flex items-center gap-2 border-b pb-2",children:[f.jsx("span",{className:"w-3 h-3 rounded-full bg-red-500"}),"  (",F.length,")"]}),f.jsxs("div",{className:"space-y-3",children:[F.map(re=>f.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-100 group hover:border-red-200 transition-all",children:[f.jsxs("div",{className:"flex justify-between items-start mb-2",children:[f.jsx("span",{className:"font-bold text-gray-800",children:re.title}),f.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded font-bold uppercase ${re.priority==="critical"?"bg-red-600 text-white":"bg-gray-100 text-gray-600"}`,children:re.priority})]}),f.jsx("p",{className:"text-xs text-gray-600 mb-3 line-clamp-2",children:re.description}),f.jsxs("div",{className:"flex justify-between items-center mt-2 pt-2 border-t border-gray-50",children:[f.jsxs("div",{className:"text-[10px] text-gray-400 flex items-center gap-1",children:[f.jsx("span",{className:"material-icons text-[12px]",children:"person"}),re.creatorName]}),(e.role==="it_specialist"||e.role==="hr_admin")&&f.jsx("button",{onClick:()=>Se(re.id,"in_progress"),className:"bg-blue-600 text-white px-3 py-1 rounded text-xs font-bold hover:bg-blue-700 shadow-sm",children:" "})]})]},re.id)),F.length===0&&f.jsx("p",{className:"text-center text-gray-400 text-xs py-10 italic",children:"     "})]})]}),f.jsxs("div",{className:"bg-blue-50/50 p-4 rounded-xl border border-blue-100",children:[f.jsxs("h3",{className:"font-bold text-blue-800 mb-4 flex items-center gap-2 border-b border-blue-100 pb-2",children:[f.jsx("span",{className:"w-3 h-3 rounded-full bg-blue-500 animate-pulse"}),"  (",Q.length,")"]}),f.jsxs("div",{className:"space-y-3",children:[Q.map(re=>f.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-blue-100 hover:border-blue-300 transition-all",children:[f.jsxs("div",{className:"flex justify-between items-start mb-2",children:[f.jsx("span",{className:"font-bold text-gray-800",children:re.title}),f.jsx("span",{className:"text-[10px] bg-blue-100 text-blue-700 px-2 py-0.5 rounded font-bold",children:"In Progress"})]}),f.jsxs("div",{className:"text-xs text-gray-500 mb-3 flex items-center gap-1",children:[f.jsx("span",{className:"material-icons text-[12px] text-blue-400",children:"inventory_2"}),re.assetName||"  "]}),f.jsxs("div",{className:"flex justify-between items-center mt-2 pt-2 border-t border-gray-50",children:[f.jsx("div",{className:"text-[10px] text-gray-400",children:new Date(re.createdAt).toLocaleDateString()}),(e.role==="it_specialist"||e.role==="hr_admin")&&f.jsxs("button",{onClick:()=>Se(re.id,"solved"),className:"bg-green-600 text-white px-4 py-1.5 rounded text-xs font-bold hover:bg-green-700 flex items-center gap-1 shadow-sm",children:[f.jsx("span",{className:"material-icons text-sm",children:"check_circle"})," "]})]})]},re.id)),Q.length===0&&f.jsx("p",{className:"text-center text-blue-300 text-xs py-10 italic",children:"    "})]})]})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden mt-8",children:[f.jsxs("div",{className:"p-4 bg-gray-50 border-b flex justify-between items-center",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"material-icons text-gray-500",children:"list_alt"}),f.jsx("span",{className:"font-bold text-gray-700",children:"  "})]}),q&&y.length>0&&f.jsxs("div",{className:"flex gap-2 animate-fade-in",children:[f.jsxs("button",{onClick:ie,className:"bg-blue-600 text-white px-3 py-1.5 rounded text-xs font-bold hover:bg-blue-700 flex items-center gap-1",children:[f.jsx("span",{className:"material-icons text-sm",children:"refresh"}),"   (",y.length,")"]}),f.jsxs("button",{onClick:De,className:"bg-red-600 text-white px-3 py-1.5 rounded text-xs font-bold hover:bg-red-700 flex items-center gap-1",children:[f.jsx("span",{className:"material-icons text-sm",children:"delete"}),"   (",y.length,")"]})]})]}),f.jsxs("div",{className:"overflow-x-auto",children:[f.jsxs("table",{className:"w-full text-right text-sm",children:[f.jsx("thead",{className:"bg-gray-50 text-gray-500 font-bold uppercase border-b",children:f.jsxs("tr",{children:[q&&f.jsx("th",{className:"p-3 w-10",children:f.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-primary focus:ring-primary",checked:y.length===t.length&&t.length>0,onChange:re=>w(re.target.checked?t.map(Ee=>Ee.id):[])})}),f.jsx("th",{className:"p-4",children:""}),f.jsx("th",{className:"p-4",children:""}),f.jsx("th",{className:"p-4 text-center",children:""}),f.jsx("th",{className:"p-4 text-center",children:""}),f.jsx("th",{className:"p-4",children:""}),f.jsx("th",{className:"p-4",children:""}),f.jsx("th",{className:"p-4",children:""})]})}),f.jsx("tbody",{className:"divide-y divide-gray-100",children:t.map(re=>f.jsxs("tr",{className:`hover:bg-blue-50/30 transition-colors ${y.includes(re.id)?"bg-blue-50/50":""}`,children:[q&&f.jsx("td",{className:"p-3 text-center",children:f.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-primary focus:ring-primary",checked:y.includes(re.id),onChange:()=>ae(re.id)})}),f.jsx("td",{className:"p-4 font-bold text-gray-800",children:re.title}),f.jsx("td",{className:"p-4 text-gray-600",children:re.projectName}),f.jsx("td",{className:"p-4 text-center",children:f.jsx("span",{className:`px-2 py-1 rounded-full text-[10px] font-bold ${W(re.status)}`,children:O(re.status)})}),f.jsx("td",{className:"p-4 text-center",children:f.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase",children:re.priority})}),f.jsx("td",{className:"p-4 font-mono font-bold text-red-600",children:re.cost!==null&&re.cost!==void 0?`$${re.cost}`:"-"}),f.jsx("td",{className:"p-4 font-mono text-xs text-gray-400",children:new Date(re.createdAt).toLocaleDateString()}),f.jsx("td",{className:"p-4",children:q?f.jsx("button",{onClick:()=>S({isOpen:!0,ticket:re}),className:"p-1.5 text-blue-500 hover:bg-blue-50 rounded-lg transition-colors",title:"",children:f.jsx("span",{className:"material-icons text-sm",children:"edit"})}):f.jsx("button",{onClick:()=>G(`: ${re.description}`,"info"),className:"p-1.5 text-gray-400 hover:bg-gray-100 rounded-lg",children:f.jsx("span",{className:"material-icons text-sm",children:"visibility"})})})]},re.id))})]}),t.length===0&&f.jsx("div",{className:"py-20 text-center text-gray-400 italic",children:"    "})]})]})]})};return f.jsxs("div",{className:"max-w-6xl mx-auto",children:[T&&f.jsx(lo,{message:T.message,type:T.type,onClose:()=>N(null)}),f.jsx($f,{isOpen:E.isOpen,title:E.title,message:E.message,onConfirm:E.onConfirm,onCancel:A,isDangerous:E.isDangerous}),(e.role==="supervisor"||e.role==="project_manager")&&P(),(e.role==="it_specialist"||e.role==="hr_admin"||q)&&z(),d&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md p-6 animate-fade-in-up",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6 border-b pb-2",children:[f.jsx("h3",{className:"font-bold text-lg text-gray-800",children:"  "}),f.jsx("button",{onClick:()=>x(!1),className:"text-gray-400 hover:text-red-500",children:f.jsx("span",{className:"material-icons",children:"close"})})]}),f.jsxs("form",{onSubmit:ge,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:" "}),f.jsx("input",{className:"w-full p-3 bg-gray-50 border rounded-lg outline-none focus:ring-2 focus:ring-primary",value:M.title,onChange:F=>C({...M,title:F.target.value}),required:!0,placeholder:":   "})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:""}),f.jsxs("select",{className:"w-full p-3 bg-gray-50 border rounded-lg",value:M.category,onChange:F=>C({...M,category:F.target.value}),children:[f.jsx("option",{value:"hardware",children:" (Hardware)"}),f.jsx("option",{value:"software",children:" (Software)"}),f.jsx("option",{value:"tools",children:"  (Tools)"}),f.jsx("option",{value:"network",children:" (Network)"}),f.jsx("option",{value:"facility",children:" (Facility)"}),f.jsx("option",{value:"other",children:""})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:""}),f.jsxs("select",{className:"w-full p-3 bg-gray-50 border rounded-lg",value:M.priority,onChange:F=>C({...M,priority:F.target.value}),children:[f.jsx("option",{value:"low",children:""}),f.jsx("option",{value:"medium",children:""}),f.jsx("option",{value:"high",children:""}),f.jsx("option",{value:"critical",children:""})]})]})]}),e.role==="project_manager"&&f.jsxs("div",{children:[f.jsxs("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:["  ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsxs("select",{className:"w-full p-3 bg-gray-50 border rounded-lg",value:M.projectId,onChange:async F=>{const Q=F.target.value;if(C({...M,projectId:Q,assetId:""}),Q){const re=await Xe.getAssets(Q);s(re)}else s([])},required:!0,children:[f.jsx("option",{value:"",children:"--   --"}),l.map(F=>f.jsx("option",{value:F.id,children:F.name},F.id))]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"  ()"}),f.jsxs("select",{className:"w-full p-3 bg-gray-50 border rounded-lg",value:M.assetId,onChange:F=>C({...M,assetId:F.target.value}),children:[f.jsx("option",{value:"",children:"--  --"}),a.map(F=>f.jsxs("option",{value:F.id,children:[F.name," (",F.serialNumber,")"]},F.id))]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:""}),f.jsx("textarea",{className:"w-full p-3 bg-gray-50 border rounded-lg h-24",value:M.description,onChange:F=>C({...M,description:F.target.value}),required:!0,placeholder:"  ..."})]}),f.jsx("button",{type:"submit",className:"w-full bg-primary text-white py-3 rounded-lg font-bold hover:bg-primary-dark transition-colors",children:" "})]})]})}),g.isOpen&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-sm p-6 animate-fade-in-up",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6 border-b pb-2",children:[f.jsx("h3",{className:"font-bold text-lg text-gray-800",children:"  "}),f.jsx("button",{onClick:()=>p({isOpen:!1,ticketId:"",cost:""}),className:"text-gray-400 hover:text-red-500",children:f.jsx("span",{className:"material-icons",children:"close"})})]}),f.jsxs("form",{onSubmit:te,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"   (   )"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-gray-400 font-bold",children:"$"}),f.jsx("input",{type:"number",min:"0",step:"0.01",className:"w-full p-3 bg-gray-50 border rounded-lg outline-none focus:ring-2 focus:ring-primary font-mono text-left",value:g.cost,onChange:F=>p({...g,cost:F.target.value}),placeholder:"0.00"})]})]}),f.jsxs("button",{type:"submit",className:"w-full bg-green-600 text-white py-3 rounded-lg font-bold hover:bg-green-700 transition-colors flex justify-center items-center gap-2",children:[f.jsx("span",{className:"material-icons",children:"check_circle"}),"  "]})]})]})}),_.isOpen&&_.ticket&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md p-6 animate-fade-in-up",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6 border-b pb-2",children:[f.jsx("h3",{className:"font-bold text-lg text-gray-800",children:"  "}),f.jsx("button",{onClick:()=>S({isOpen:!1,ticket:null}),className:"text-gray-400 hover:text-red-500",children:f.jsx("span",{className:"material-icons",children:"close"})})]}),f.jsxs("form",{onSubmit:Me,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:" "}),f.jsx("input",{className:"w-full p-3 bg-gray-50 border rounded-lg outline-none focus:ring-2 focus:ring-primary",value:_.ticket.title,onChange:F=>S({..._,ticket:{..._.ticket,title:F.target.value}}),required:!0})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:""}),f.jsxs("select",{className:"w-full p-3 bg-gray-50 border rounded-lg",value:_.ticket.category,onChange:F=>S({..._,ticket:{..._.ticket,category:F.target.value}}),children:[f.jsx("option",{value:"hardware",children:" (Hardware)"}),f.jsx("option",{value:"software",children:" (Software)"}),f.jsx("option",{value:"tools",children:"  (Tools)"}),f.jsx("option",{value:"network",children:" (Network)"}),f.jsx("option",{value:"facility",children:" (Facility)"}),f.jsx("option",{value:"other",children:""})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:""}),f.jsxs("select",{className:"w-full p-3 bg-gray-50 border rounded-lg",value:_.ticket.priority,onChange:F=>S({..._,ticket:{..._.ticket,priority:F.target.value}}),children:[f.jsx("option",{value:"low",children:""}),f.jsx("option",{value:"medium",children:""}),f.jsx("option",{value:"high",children:""}),f.jsx("option",{value:"critical",children:""})]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:" ($)"}),f.jsx("input",{type:"number",min:"0",step:"0.01",className:"w-full p-3 bg-gray-50 border rounded-lg outline-none",value:_.ticket.cost??"",onChange:F=>S({..._,ticket:{..._.ticket,cost:F.target.value?Number(F.target.value):void 0}})})]}),f.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white py-3 rounded-lg font-bold hover:bg-blue-700 transition-colors",children:" "})]})]})})]})},qN=({user:e})=>{const[t,r]=ne.useState(null),[a,s]=ne.useState(!1),[l,o]=ne.useState([]),[u,h]=ne.useState((e==null?void 0:e.projectId)||""),[d,x]=ne.useState(""),[g,p]=ne.useState([]),[y,w]=ne.useState(!1),[_,S]=ne.useState([]),[T,N]=ne.useState(!1);ne.useEffect(()=>{e!=null&&e.projectId&&h(e.projectId)},[e]);const E=async()=>{if(d.trim()){w(!0);try{const{data:C,error:U}=await Te.from("projects").select("id, name, location").ilike("name",`%${d}%`).limit(5);U?console.error("Error searching projects:",U):p(C||[])}catch(C){console.error("Exception searching projects:",C)}finally{w(!1)}}},D=C=>{h(C.id),x(C.name),p([]),G(C.id)},G=async(C=u)=>{if(C)try{const{data:U,error:Z}=await Te.from("unlock_requests").select("*").eq("project_id",C).order("created_at",{ascending:!1}).limit(50);Z?(console.error("Error fetching raw requests:",Z),o([])):o(U||[])}catch(U){console.error("Exception fetching raw requests:",U)}},V=async()=>{s(!0),await G(u);const U={timestamp:new Date().toISOString(),tables:{},rls:{status:"Skipped",message:""},hrAdmins:{status:"Skipped",message:"",users:[]}},Z=[{name:"profiles",checkCols:["id","username","role","project_id","email"]},{name:"projects",checkCols:["id","name","location"]},{name:"operators",checkCols:["id","name","supervisor_id","project_id"]},{name:"kpi_logs",checkCols:["id","project_id","operator_id","attitude"]},{name:"unlock_requests",checkCols:["id","logId","project_id","operator_id","status"]},{name:"assets",checkCols:["id","name","status","project_id","asset_tag","mac_address","cpu","ram","storage","purchase_date","cost","assigned_user","department","location"]}];for(const q of Z){const le={connected:!1,error:null,columns:{}},{error:ge}=await Te.from(q.name).select("*").limit(1);if(ge)le.error=ge.message,le.connected=!1;else{le.connected=!0;for(const Se of q.checkCols){const{error:te}=await Te.from(q.name).select(Se).limit(1);te?le.columns[Se]={exists:!1,error:te.message}:le.columns[Se]={exists:!0}}}U.tables[q.name]=le}try{const{data:q,error:le}=await Te.from("profiles").select("*").eq("role","hr_admin");le?U.hrAdmins={status:"Error",message:le.message,users:[]}:U.hrAdmins={status:"Success",message:`Found ${(q==null?void 0:q.length)||0} HR admins`,users:q||[]}}catch(q){U.hrAdmins={status:"Exception",message:q.message,users:[]}}if(e&&u)try{const q=`hc-${Date.now()}`,{data:le}=await Te.from("operators").select("id").eq("project_id",u).limit(1),ge=le&&le[0]?le[0].id:null;if(ge){const Se={id:q,operator_id:ge,supervisor_id:e.id,project_id:u,date:new Date().toISOString().split("T")[0],status:"pending",reason:"Health Check Probe",logId:null},{error:te}=await Te.from("unlock_requests").insert([Se]);if(te)U.rls={status:"Failed",message:te.message};else{const{error:ae}=await Te.from("unlock_requests").delete().eq("id",q);ae?U.rls={status:"Warning",message:"Insert OK, Delete Failed: "+ae.message}:U.rls={status:"Success",message:"Insert and Delete successful"}}}else U.rls={status:"Skipped",message:"No valid operator found in this project to test FK constraints."}}catch(q){U.rls={status:"Error",message:q.message}}else U.rls={status:"Skipped",message:"No Target Project ID defined."};r(U),s(!1)},A=async()=>{N(!0);const C=[],U=q=>{C.push(`[${new Date().toLocaleTimeString()}] ${q}`),S([...C])},Z=q=>new Promise(le=>setTimeout(le,q));try{if(S([]),U(" Starting Approval Logic Diagnostic..."),!u)throw new Error("No Target Project ID selected. Please select a project above.");U(" Finding a valid operator in target project...");const{data:q,error:le}=await Te.from("operators").select("*").eq("project_id",u).limit(1);if(le||!q||q.length===0)throw new Error("No operators found in this project to test with.");const ge=q[0];U(` Found Operator: ${ge.name} (${ge.id})`);const Se=new Date().toISOString().split("T")[0],te=`debug-log-${Date.now()}`,ae=`debug-req-1-${Date.now()}`,De=`debug-req-2-${Date.now()}`;await Z(500),U(" Creating test KPI Log (Simulating Locked State)...");const{error:ie}=await Te.from("kpi_logs").insert([{id:te,project_id:u,operator_id:ge.id,supervisor_id:e==null?void 0:e.id,date:Se,attitude:5,performance:5,quality:5,appearance:5,timestamp:Date.now()}]);if(ie)throw new Error(`Failed to insert test log: ${ie.message}`);U(" Test Log created."),await Z(500),U(" Creating DUPLICATE Unlock Requests (Simulating Ghost/Race Condition)...");const Me={operator_id:ge.id,operator_name:ge.name,supervisor_id:e==null?void 0:e.id,supervisor_name:(e==null?void 0:e.name)||"Debugger",project_id:u,date:Se,reason:"Debug Diagnostic Test",status:"pending"},{error:W}=await Te.from("unlock_requests").insert([{...Me,id:ae}]),{error:O}=await Te.from("unlock_requests").insert([{...Me,id:De}]);if(W||O)throw new Error("Failed to insert test requests.");U(` Created Request A (${ae}) and Request B (${De}) - Both PENDING.`),await Z(1e3),U(" Executing StorageService.approveUnlockRequest(Request A)...");const P=await Xe.approveUnlockRequest(ae,ge.id,Se,te);U(P?" Service returned TRUE (Success).":" Service returned FALSE (Failed)."),await Z(500),U(" Verifying Database State...");const{data:z}=await Te.from("kpi_logs").select("id").eq("id",te).maybeSingle();U(z?" FAILURE: KPI Log still exists!":" KPI Log was successfully DELETED (Unlock worked).");const{data:F}=await Te.from("unlock_requests").select("id, status").in("id",[ae,De]);if(F){let Q=0;F.forEach(re=>{const Ee=re.id===ae?"Request A (Target)":"Request B (Ghost)";re.status==="approved"?(U(` ${Ee}: Status is APPROVED.`),Q++):U(` ${Ee}: Status is '${re.status}' (Expected APPROVED).`)}),U(Q===2?" SUCCESS: Bulk Update Policy worked! Both requests approved.":" WARNING: Bulk Update did NOT catch all duplicates.")}await Z(1e3),U(" Cleaning up test records..."),await Te.from("unlock_requests").delete().in("id",[ae,De]),await Te.from("kpi_logs").delete().eq("id",te),U(" Diagnostic Complete.")}catch(q){U(` CRITICAL ERROR: ${q.message}`),console.error(q)}finally{N(!1)}};ne.useEffect(()=>{V()},[e]);const M=()=>{navigator.clipboard.writeText(JSON.stringify(t,null,2)),alert("Debug info copied!")};return f.jsxs("div",{className:"p-8 max-w-6xl mx-auto space-y-8 ltr",style:{direction:"ltr"},children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("h1",{className:"text-3xl font-bold text-gray-800 flex items-center gap-3",children:[f.jsx("span",{className:"material-icons text-4xl text-primary",children:"monitor_heart"}),"System Health Check"]}),f.jsxs("div",{className:"flex gap-3",children:[f.jsxs("button",{onClick:()=>V(),className:"bg-blue-600 text-white px-4 py-2 rounded shadow hover:bg-blue-700 flex items-center gap-2",children:[f.jsx("span",{className:`material-icons ${a?"animate-spin":""}`,children:"refresh"}),"Run Diagnostics"]}),f.jsxs("button",{onClick:M,className:"bg-gray-800 text-white px-4 py-2 rounded shadow hover:bg-gray-900 flex items-center gap-2",children:[f.jsx("span",{className:"material-icons",children:"content_copy"}),"Copy Report"]})]})]}),f.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-100 text-sm text-blue-800",children:[f.jsx("strong",{className:"block mb-1",children:"Tip:"}),'If you see "column does not exist" errors, use the Supabase SQL Editor to reload the schema cache: ',f.jsx("code",{className:"bg-white px-1 rounded",children:"NOTIFY pgrst, 'reload schema';"})]}),f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[f.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[f.jsx("span",{className:"material-icons text-gray-500",children:"search"}),"Target Project Scope"]}),f.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[f.jsxs("div",{className:"flex-1 relative",children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Find Project By Name"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"text",value:d,onChange:C=>x(C.target.value),placeholder:"Type project name...",className:"flex-1 border p-2 rounded font-mono text-sm",onKeyDown:C=>C.key==="Enter"&&E()}),f.jsx("button",{onClick:E,className:"bg-gray-100 px-3 py-2 rounded hover:bg-gray-200 min-w-[80px]",disabled:y,children:y?"...":"Search"})]}),g.length>0&&f.jsx("div",{className:"absolute top-full left-0 right-0 bg-white shadow-xl border border-gray-200 rounded mt-1 z-10 max-h-48 overflow-y-auto",children:g.map(C=>f.jsxs("div",{onClick:()=>D(C),className:"p-2 hover:bg-blue-50 cursor-pointer border-b last:border-0",children:[f.jsx("div",{className:"font-bold text-sm text-gray-800",children:C.name}),f.jsxs("div",{className:"text-xs text-gray-500",children:[C.location," (ID: ",C.id,")"]})]},C.id))})]}),f.jsxs("div",{className:"flex-1",children:[f.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Target Project ID (Manual)"}),f.jsx("input",{type:"text",value:u,onChange:C=>h(C.target.value),onKeyDown:C=>C.key==="Enter"&&G(u),placeholder:"UUID (Enter to fetch)...",className:"w-full border p-2 rounded font-mono text-sm bg-gray-50"})]})]})]}),f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[f.jsxs("div",{className:"flex justify-between items-center mb-4",children:[f.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[f.jsx("span",{className:"material-icons text-purple-600",children:"bug_report"}),"Unlock Process Debugger"]}),f.jsxs("button",{onClick:A,disabled:T||!u,className:`px-4 py-2 rounded shadow font-bold flex items-center gap-2 ${T||!u?"bg-gray-300 cursor-not-allowed text-gray-500":"bg-purple-600 text-white hover:bg-purple-700"}`,children:[T?f.jsx("span",{className:"material-icons animate-spin",children:"sync"}):f.jsx("span",{className:"material-icons",children:"play_arrow"}),"Run Full Approval Test"]})]}),f.jsx("p",{className:"text-sm text-gray-500 mb-4",children:'This tool simulates creating two duplicate "pending" requests and approving one of them. It verifies if the system correctly "Bulk Approves" all duplicates and deletes the log.'}),f.jsxs("div",{className:"bg-gray-900 text-green-400 p-4 rounded font-mono text-sm h-64 overflow-y-auto border border-gray-700 shadow-inner",children:[_.length===0?f.jsx("span",{className:"text-gray-500 opacity-50 select-none",children:"Ready to start diagnostics... waiting for input."}):_.map((C,U)=>f.jsx("div",{className:"border-b border-gray-800 pb-1 mb-1 last:border-0",children:C},U)),T&&f.jsx("div",{className:"animate-pulse mt-2",children:"_ Processing..."})]})]}),f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[f.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[f.jsx("span",{className:"material-icons text-gray-500",children:"badge"}),"Session Context"]}),f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[f.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:[f.jsx("span",{className:"text-xs text-gray-500 block uppercase",children:"User ID"}),f.jsx("span",{className:"font-mono font-bold",children:(e==null?void 0:e.id)||"Guest"})]}),f.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:[f.jsx("span",{className:"text-xs text-gray-500 block uppercase",children:"Role"}),f.jsx("span",{className:"font-bold text-blue-600",children:(e==null?void 0:e.role)||"-"})]}),f.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:[f.jsx("span",{className:"text-xs text-gray-500 block uppercase",children:"Target Project ID"}),f.jsx("span",{className:"font-mono text-sm",children:u||"None Selected"})]}),(t==null?void 0:t.hrAdmins)&&f.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:[f.jsx("span",{className:"text-xs text-gray-500 block uppercase",children:"HR Admin Check"}),f.jsxs("span",{className:`font-bold ${t.hrAdmins.status==="Success"?"text-green-600":"text-red-600"}`,children:[t.hrAdmins.status,": ",t.hrAdmins.message]}),t.hrAdmins.users.length>0&&f.jsx("div",{className:"mt-2 text-[10px] font-mono text-gray-600 bg-white p-2 border rounded max-h-32 overflow-y-auto",children:t.hrAdmins.users.map(C=>f.jsxs("div",{className:"border-b last:border-0 pb-1 mb-1",children:[C.email," | ",C.role," | ID: ",C.id.slice(0,8)]},C.id))})]}),f.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:[f.jsx("span",{className:"text-xs text-gray-500 block uppercase",children:"RLS Test"}),f.jsx("span",{className:`font-bold ${(t==null?void 0:t.rls.status)==="Success"?"text-green-600":(t==null?void 0:t.rls.status)==="Failed"?"text-red-600":"text-gray-600"}`,children:(t==null?void 0:t.rls.status)||"Pending"})]})]}),(t==null?void 0:t.rls.message)&&f.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["RLS Message: ",t.rls.message]})]}),f.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:t&&Object.keys(t.tables).map(C=>{const U=t.tables[C];return f.jsxs("div",{className:`bg-white rounded-lg shadow-sm border-l-4 ${U.connected?"border-green-500":"border-red-500"} overflow-hidden`,children:[f.jsxs("div",{className:"p-4 border-b bg-gray-50 flex justify-between items-center",children:[f.jsx("h3",{className:"font-bold text-lg font-mono",children:C}),U.connected?f.jsx("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded font-bold",children:"CONNECTED"}):f.jsx("span",{className:"bg-red-100 text-red-800 text-xs px-2 py-1 rounded font-bold",children:"ERROR"})]}),f.jsxs("div",{className:"p-4",children:[U.error&&f.jsx("div",{className:"text-red-600 text-sm mb-4 bg-red-50 p-2 rounded",children:U.error}),f.jsx("div",{className:"space-y-2",children:Object.keys(U.columns).map(Z=>{const q=U.columns[Z];return f.jsxs("div",{className:"flex justify-between items-center text-sm border-b border-gray-100 pb-1 last:border-0",children:[f.jsx("span",{className:"font-mono text-gray-600",children:Z}),q.exists?f.jsxs("span",{className:"text-green-600 flex items-center gap-1",children:[f.jsx("span",{className:"material-icons text-sm",children:"check"})," Found"]}):f.jsxs("span",{className:"text-red-600 flex items-center gap-1 font-bold",children:[f.jsx("span",{className:"material-icons text-sm",children:"warning"})," Missing"]}),q.error&&f.jsx("span",{className:"block text-xs text-red-400 w-full mt-1",children:q.error})]},Z)})})]})]},C)})}),u&&f.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden mt-8",children:[f.jsxs("div",{className:"p-4 bg-gray-50 border-b flex justify-between items-center",children:[f.jsxs("h3",{className:"font-bold text-lg text-gray-800 flex items-center gap-2",children:[f.jsx("span",{className:"material-icons text-gray-500",children:"dataset"}),"Raw Unlock Requests (Project: ",u,")"]}),f.jsxs("span",{className:"text-xs bg-gray-200 px-2 py-1 rounded text-gray-700 font-mono",children:["Count: ",l.length]})]}),f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full text-left text-xs font-mono",children:[f.jsx("thead",{className:"bg-gray-100 border-b",children:f.jsxs("tr",{children:[f.jsx("th",{className:"p-3",children:"ID"}),f.jsx("th",{className:"p-3",children:"Operator"}),f.jsx("th",{className:"p-3",children:"Supervisor"}),f.jsx("th",{className:"p-3",children:"Status"}),f.jsx("th",{className:"p-3",children:"Reason"}),f.jsx("th",{className:"p-3",children:"Project ID"}),f.jsx("th",{className:"p-3",children:"Created At"})]})}),f.jsx("tbody",{className:"divide-y",children:l.length>0?l.map(C=>f.jsxs("tr",{className:"hover:bg-gray-50",children:[f.jsxs("td",{className:"p-3 text-gray-500",children:[C.id.slice(0,8),"..."]}),f.jsx("td",{className:"p-3 font-bold text-gray-700",children:C.operator_name||"N/A"}),f.jsx("td",{className:"p-3",children:C.supervisor_name||"N/A"}),f.jsx("td",{className:"p-3",children:f.jsx("span",{className:`px-2 py-0.5 rounded ${C.status==="pending"?"bg-yellow-100 text-yellow-800":C.status==="approved"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:C.status})}),f.jsx("td",{className:"p-3 truncate max-w-[200px]",title:C.reason,children:C.reason}),f.jsx("td",{className:"p-3 text-gray-400",children:C.project_id}),f.jsx("td",{className:"p-3",children:new Date(C.created_at||C.date).toLocaleString()})]},C.id)):f.jsx("tr",{children:f.jsx("td",{colSpan:7,className:"p-6 text-center text-gray-400 italic",children:'No records found in "unlock_requests" for this project ID.'})})})]})})]}),!t&&f.jsx("div",{className:"text-center py-10 text-gray-400",children:"Loading diagnostics..."})]})},$N=()=>{const[e,t]=ne.useState(!1),[r,a]=ne.useState([]),[s,l]=ne.useState(null),o=async()=>{t(!0),l(null),a([]),console.log("Debugger: Fetching all unlock_requests...");try{const{data:h,error:d}=await Te.from("unlock_requests").select("*");d?l(d):a(h||[])}catch(h){l({message:"Unexpected exception",details:h})}finally{t(!1)}},u=async()=>{t(!0),l(null),a([]);const h="2d605c62-a0e5-4722-927e-bd98d7a8d2c2";console.log(`Debugger: Testing filter for project_id=${h}`);try{const{data:d,error:x}=await Te.from("unlock_requests").select("*").eq("project_id",h);x?l(x):a(d||[])}catch(d){l({message:"Unexpected exception",details:d})}finally{t(!1)}};return ne.useEffect(()=>{o()},[]),f.jsxs("div",{className:"p-8 max-w-6xl mx-auto space-y-6 ltr",style:{direction:"ltr"},children:[f.jsxs("h1",{className:"text-3xl font-bold text-gray-800 flex items-center gap-2",children:[f.jsx("span",{className:"material-icons text-red-600",children:"pest_control"}),"Database Debugger"]}),f.jsxs("div",{className:"flex gap-4 flex-wrap",children:[f.jsx("button",{onClick:o,className:"bg-gray-800 text-white px-4 py-2 rounded hover:bg-gray-900 transition-colors",children:"Fetch All (*)"}),f.jsx("button",{onClick:u,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition-colors",children:"Test Filter by Project ID"})]}),e&&f.jsxs("div",{className:"flex items-center gap-2 text-xl text-gray-500",children:[f.jsx("span",{className:"material-icons animate-spin",children:"donut_large"}),"Loading from Supabase..."]}),s&&f.jsxs("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded shadow-sm",children:[f.jsxs("p",{className:"font-bold text-lg flex items-center gap-2",children:[f.jsx("span",{className:"material-icons",children:"error"})," Error Occurred"]}),f.jsxs("div",{className:"mt-2 space-y-1 font-mono text-sm",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Message:"})," ",s.message]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Code:"})," ",s.code||"N/A"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Details:"})," ",s.details||JSON.stringify(s)]})]})]}),!e&&!s&&r.length===0&&f.jsxs("div",{className:"bg-yellow-50 border-l-4 border-yellow-500 p-4 text-yellow-800 rounded",children:[f.jsxs("h3",{className:"font-bold text-lg mb-2 flex items-center gap-2",children:[f.jsx("span",{className:"material-icons",children:"lightbulb"})," Diagnosis: No Records Found"]}),f.jsx("p",{children:"The query returned 0 rows successfully."}),f.jsxs("div",{className:"mt-4 bg-white p-3 rounded border border-yellow-200",children:[f.jsx("p",{className:"font-bold text-yellow-900 mb-2",children:"Checklist:"}),f.jsxs("ul",{className:"list-disc pl-5 space-y-1 text-sm",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"RLS (Row Level Security):"})," If error is null but records are 0, policies might be hiding data."]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Empty Table:"})," Ensure `unlock_requests` actually has data in the Supabase dashboard."]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Auth Context:"})," Are you logged in? Does the user have `SELECT` permissions?"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Filter:"})," If using the filter button, does ID ",f.jsx("code",{children:"2d605c62..."})," exist?"]})]})]})]}),r.length>0&&f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"bg-green-50 border border-green-200 p-4 rounded text-green-800 flex items-center gap-2",children:[f.jsx("span",{className:"material-icons",children:"check_circle"}),f.jsx("strong",{children:"Success!"})," Found ",r.length," records."]}),f.jsxs("div",{className:"bg-gray-100 p-4 rounded border border-gray-300 font-mono text-sm overflow-x-auto",children:[f.jsx("h4",{className:"font-bold text-gray-700 border-b border-gray-300 pb-2 mb-2",children:"Schema Detection (Keys of first record):"}),f.jsxs("div",{className:"break-all text-blue-600 font-bold",children:["[",Object.keys(r[0]).join(", "),"]"]})]}),f.jsx("div",{className:"overflow-x-auto bg-white shadow rounded-lg",children:f.jsxs("table",{className:"w-full text-left text-sm font-mono",children:[f.jsx("thead",{className:"bg-gray-800 text-white",children:f.jsx("tr",{children:Object.keys(r[0]).map(h=>f.jsx("th",{className:"p-3 border-b border-gray-700 whitespace-nowrap",children:h},h))})}),f.jsx("tbody",{className:"divide-y",children:r.map((h,d)=>f.jsx("tr",{className:"hover:bg-gray-50",children:Object.values(h).map((x,g)=>f.jsx("td",{className:"p-3 border-r whitespace-nowrap max-w-xs truncate",title:String(x),children:typeof x=="object"&&x!==null?JSON.stringify(x):String(x)},g))},d))})]})})]})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Tf={};Tf.version="0.18.5";var Vb=1252,GN=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],lx={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ox=function(e){GN.indexOf(e)!=-1&&(Vb=lx[0]=e)};function VN(){ox(1252)}var Ln=function(e){ox(e)};function cx(){Ln(1200),VN()}function h_(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function XN(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function Xb(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var dc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?XN(e.slice(2)):t==254&&r==255?Xb(e.slice(2)):t==65279?e.slice(1):e},ff=function(t){return String.fromCharCode(t)},m_=function(t){return String.fromCharCode(t)},Rc,ti="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Dc(e){for(var t="",r=0,a=0,s=0,l=0,o=0,u=0,h=0,d=0;d<e.length;)r=e.charCodeAt(d++),l=r>>2,a=e.charCodeAt(d++),o=(r&3)<<4|a>>4,s=e.charCodeAt(d++),u=(a&15)<<2|s>>6,h=s&63,isNaN(a)?u=h=64:isNaN(s)&&(h=64),t+=ti.charAt(l)+ti.charAt(o)+ti.charAt(u)+ti.charAt(h);return t}function ln(e){var t="",r=0,a=0,s=0,l=0,o=0,u=0,h=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)l=ti.indexOf(e.charAt(d++)),o=ti.indexOf(e.charAt(d++)),r=l<<2|o>>4,t+=String.fromCharCode(r),u=ti.indexOf(e.charAt(d++)),a=(o&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(a)),h=ti.indexOf(e.charAt(d++)),s=(u&3)<<6|h,h!==64&&(t+=String.fromCharCode(s));return t}var St=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Es=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function ni(e){return St?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function x_(e){return St?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var nn=function(t){return St?Es(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Wf(e){if(typeof ArrayBuffer>"u")return nn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function oi(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function WN(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function ux(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ux(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Qr=St?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Es(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function KN(e){for(var t=[],r=0,a=e.length+250,s=ni(e.length+255),l=0;l<e.length;++l){var o=e.charCodeAt(l);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var u=e.charCodeAt(++l)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|u>>6&15|(o&3)<<4,s[r++]=128|u&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>a&&(t.push(s.slice(0,r)),r=0,s=ni(65535),a=65530)}return t.push(s.slice(0,r)),Qr(t)}var Oa=/\u0000/g,hc=/[\u0001-\u0006]/g;function Zl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Bn(e,t){var r=""+e;return r.length>=t?r:kr("0",t-r.length)+r}function fx(e,t){var r=""+e;return r.length>=t?r:kr(" ",t-r.length)+r}function kf(e,t){var r=""+e;return r.length>=t?r:r+kr(" ",t-r.length)}function YN(e,t){var r=""+Math.round(e);return r.length>=t?r:kr("0",t-r.length)+r}function JN(e,t){var r=""+e;return r.length>=t?r:kr("0",t-r.length)+r}var p_=Math.pow(2,32);function ql(e,t){if(e>p_||e<-p_)return YN(e,t);var r=Math.round(e);return JN(r,t)}function Nf(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var g_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Sm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function QN(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ut={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},v_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},ZN={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function jf(e,t,r){for(var a=e<0?-1:1,s=e*a,l=0,o=1,u=0,h=1,d=0,x=0,g=Math.floor(s);d<t&&(g=Math.floor(s),u=g*o+l,x=g*d+h,!(s-g<5e-8));)s=1/(s-g),l=o,o=u,h=d,d=x;if(x>t&&(d>t?(x=h,u=l):(x=d,u=o)),!r)return[0,a*u,x];var p=Math.floor(a*u/x);return[p,a*u-p*x,x]}function Bi(e,t,r){if(e>2958465||e<0)return null;var a=e|0,s=Math.floor(86400*(e-a)),l=0,o=[],u={D:a,T:s,u:86400*(e-a)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(a+=1462),u.u>.9999&&(u.u=0,++s==86400&&(u.T=s=0,++a,++u.D)),a===60)o=r?[1317,10,29]:[1900,2,29],l=3;else if(a===0)o=r?[1317,8,29]:[1900,1,0],l=6;else{a>60&&--a;var h=new Date(1900,0,1);h.setDate(h.getDate()+a-1),o=[h.getFullYear(),h.getMonth()+1,h.getDate()],l=h.getDay(),a<60&&(l=(l+6)%7),r&&(l=sj(h,o))}return u.y=o[0],u.m=o[1],u.d=o[2],u.S=s%60,s=Math.floor(s/60),u.M=s%60,s=Math.floor(s/60),u.H=s,u.q=l,u}var Wb=new Date(1899,11,31,0,0,0),ej=Wb.getTime(),tj=new Date(1900,2,1,0,0,0);function Kb(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=tj&&(r+=1440*60*1e3),(r-(ej+(e.getTimezoneOffset()-Wb.getTimezoneOffset())*6e4))/(1440*60*1e3)}function dx(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function rj(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function aj(e){var t=e<0?12:11,r=dx(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function nj(e){var t=dx(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Fc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=aj(e):t===10?r=e.toFixed(10).substr(0,12):r=nj(e),dx(rj(r.toUpperCase()))}function qi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Fc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Tn(14,Kb(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function sj(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function ij(e,t,r,a){var s="",l=0,o=0,u=r.y,h,d=0;switch(e){case 98:u=r.y+543;case 121:switch(t.length){case 1:case 2:h=u%100,d=2;break;default:h=u%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:h=r.m,d=t.length;break;case 3:return Sm[r.m-1][1];case 5:return Sm[r.m-1][0];default:return Sm[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:h=r.d,d=t.length;break;case 3:return g_[r.q][0];default:return g_[r.q][1]}break;case 104:switch(t.length){case 1:case 2:h=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:h=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:h=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Bn(r.S,t.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,l=Math.round(o*(r.S+r.u)),l>=60*o&&(l=0),t==="s"?l===0?"0":""+l/o:(s=Bn(l,2+a),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:h=u,d=1;break}var x=d>0?Bn(h,d):"";return x}function ri(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var Yb=/%/g;function lj(e,t,r){var a=t.replace(Yb,""),s=t.length-a.length;return ys(e,a,r*Math.pow(10,2*s))+kr("%",s)}function oj(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return ys(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function Jb(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Jb(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%s;if(l<0&&(l+=s),r=(t/Math.pow(10,l)).toPrecision(a+1+(s+l)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+l):r+="E+"+(o-l);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,x){return h+d+x.substr(0,(s+l)%s)+"."+x.substr(l)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Qb=/# (\?+)( ?)\/( ?)(\d+)/;function cj(e,t,r){var a=parseInt(e[4],10),s=Math.round(t*a),l=Math.floor(s/a),o=s-l*a,u=a;return r+(l===0?"":""+l)+" "+(o===0?kr(" ",e[1].length+1+e[4].length):fx(o,e[1].length)+e[2]+"/"+e[3]+Bn(u,e[4].length))}function uj(e,t,r){return r+(t===0?"":""+t)+kr(" ",e[1].length+2+e[4].length)}var Zb=/^#*0*\.([0#]+)/,ew=/\).*[0#]/,tw=/\(###\) ###\\?-####/;function ja(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function y_(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function __(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function fj(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function dj(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function yn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ew)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?yn("n",a,r):"("+yn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return oj(e,t,r);if(t.indexOf("%")!==-1)return lj(e,t,r);if(t.indexOf("E")!==-1)return Jb(t,r);if(t.charCodeAt(0)===36)return"$"+yn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,l,o,u,h=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+ql(h,t.length);if(t.match(/^[#?]+$/))return s=ql(r,0),s==="0"&&(s=""),s.length>t.length?s:ja(t.substr(0,t.length-s.length))+s;if(l=t.match(Qb))return cj(l,h,d);if(t.match(/^#+0+$/))return d+ql(h,t.length-t.indexOf("0"));if(l=t.match(Zb))return s=y_(r,l[1].length).replace(/^([^\.]+)$/,"$1."+ja(l[1])).replace(/\.$/,"."+ja(l[1])).replace(/\.(\d*)$/,function(w,_){return"."+_+kr("0",ja(l[1]).length-_.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return d+y_(h,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return d+ri(ql(h,0));if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+yn(e,t,-r):ri(""+(Math.floor(r)+fj(r,l[1].length)))+"."+Bn(__(r,l[1].length),l[1].length);if(l=t.match(/^#,#*,#0/))return yn(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Zl(yn(e,t.replace(/[\\-]/g,""),r)),o=0,Zl(Zl(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<s.length?s.charAt(o++):w==="0"?"0":""}));if(t.match(tw))return s=yn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var x="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),u=jf(h,Math.pow(10,o)-1,!1),s=""+d,x=ys("n",l[1],u[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),s+=x+l[2]+"/"+l[3],x=kf(u[2],o),x.length<l[4].length&&(x=ja(l[4].substr(l[4].length-x.length))+x),s+=x,s;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),u=jf(h,Math.pow(10,o)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?fx(u[1],o)+l[2]+"/"+l[3]+kf(u[2],o):kr(" ",2*o+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return s=ql(r,0),t.length<=s.length?s:ja(t.substr(0,t.length-s.length))+s;if(l=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var g=t.indexOf(".")-o,p=t.length-s.length-g;return ja(t.substr(0,g)+s+t.substr(t.length-p))}if(l=t.match(/^00,000\.([#0]*0)$/))return o=__(r,l[1].length),r<0?"-"+yn(e,t,-r):ri(dj(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?Bn(0,3-w.length):"")+w})+"."+Bn(o,l[1].length);switch(t){case"###,##0.00":return yn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var y=ri(ql(h,0));return y!=="0"?d+y:"";case"###,###.00":return yn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return yn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function hj(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return ys(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function mj(e,t,r){var a=t.replace(Yb,""),s=t.length-a.length;return ys(e,a,r*Math.pow(10,2*s))+kr("%",s)}function rw(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+rw(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%s;if(l<0&&(l+=s),r=(t/Math.pow(10,l)).toPrecision(a+1+(s+l)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+l):r+="E+"+(o-l),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,x){return h+d+x.substr(0,(s+l)%s)+"."+x.substr(l)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Wn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ew)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Wn("n",a,r):"("+Wn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return hj(e,t,r);if(t.indexOf("%")!==-1)return mj(e,t,r);if(t.indexOf("E")!==-1)return rw(t,r);if(t.charCodeAt(0)===36)return"$"+Wn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,l,o,u,h=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Bn(h,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:ja(t.substr(0,t.length-s.length))+s;if(l=t.match(Qb))return uj(l,h,d);if(t.match(/^#+0+$/))return d+Bn(h,t.length-t.indexOf("0"));if(l=t.match(Zb))return s=(""+r).replace(/^([^\.]+)$/,"$1."+ja(l[1])).replace(/\.$/,"."+ja(l[1])),s=s.replace(/\.(\d*)$/,function(w,_){return"."+_+kr("0",ja(l[1]).length-_.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return d+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return d+ri(""+h);if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Wn(e,t,-r):ri(""+r)+"."+kr("0",l[1].length);if(l=t.match(/^#,#*,#0/))return Wn(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Zl(Wn(e,t.replace(/[\\-]/g,""),r)),o=0,Zl(Zl(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<s.length?s.charAt(o++):w==="0"?"0":""}));if(t.match(tw))return s=Wn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var x="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),u=jf(h,Math.pow(10,o)-1,!1),s=""+d,x=ys("n",l[1],u[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),s+=x+l[2]+"/"+l[3],x=kf(u[2],o),x.length<l[4].length&&(x=ja(l[4].substr(l[4].length-x.length))+x),s+=x,s;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),u=jf(h,Math.pow(10,o)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?fx(u[1],o)+l[2]+"/"+l[3]+kf(u[2],o):kr(" ",2*o+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:ja(t.substr(0,t.length-s.length))+s;if(l=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var g=t.indexOf(".")-o,p=t.length-s.length-g;return ja(t.substr(0,g)+s+t.substr(t.length-p))}if(l=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Wn(e,t,-r):ri(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?Bn(0,3-w.length):"")+w})+"."+Bn(0,l[1].length);switch(t){case"###,###":case"##,###":case"#,###":var y=ri(""+h);return y!=="0"?d+y:"";default:if(t.match(/\.[0#?]*$/))return Wn(e,t.slice(0,t.lastIndexOf(".")),r)+ja(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ys(e,t,r){return(r|0)===r?Wn(e,t,r):yn(e,t,r)}function xj(e){for(var t=[],r=!1,a=0,s=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(s,a-s),s=a+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var aw=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function oo(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":Nf(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(aw))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function pj(e,t,r,a){for(var s=[],l="",o=0,u="",h="t",d,x,g,p="H";o<e.length;)switch(u=e.charAt(o)){case"G":if(!Nf(e,o))throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(l="";(g=e.charCodeAt(++o))!==34&&o<e.length;)l+=String.fromCharCode(g);s[s.length]={t:"t",v:l},++o;break;case"\\":var y=e.charAt(++o),w=y==="("||y===")"?y:"t";s[s.length]={t:w,v:y},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(d==null&&(d=Bi(t,r,e.charAt(o+1)==="2"),d==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},h=u,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=Bi(t,r),d==null))return"";for(l=u;++o<e.length&&e.charAt(o).toLowerCase()===u;)l+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=p),s[s.length]={t:u,v:l},h=u;break;case"A":case"a":case"":var _={t:u,v:u};if(d==null&&(d=Bi(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(_.v=d.H>=12?"P":"A"),_.t="T",p="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(_.v=d.H>=12?"PM":"AM"),_.t="T",o+=5,p="h"):e.substr(o,5).toUpperCase()==="/"?(d!=null&&(_.v=d.H>=12?"":""),_.t="T",o+=5,p="h"):(_.t="t",++o),d==null&&_.t==="T")return"";s[s.length]=_,h=u;break;case"[":for(l=u;e.charAt(o++)!=="]"&&o<e.length;)l+=e.charAt(o);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(aw)){if(d==null&&(d=Bi(t,r),d==null))return"";s[s.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",oo(e)||(s[s.length]={t:"t",v:l}));break;case".":if(d!=null){for(l=u;++o<e.length&&(u=e.charAt(o))==="0";)l+=u;s[s.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++o<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(o))>-1;)l+=u;s[s.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++o)===u;)l+=u;s[s.length]={t:u,v:l},h=u;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:a===1?"t":u,v:u},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)l+=e.charAt(o);s[s.length]={t:"D",v:l};break;case" ":s[s.length]={t:u,v:u},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"t",v:u},++o;break}var S=0,T=0,N;for(o=s.length-1,h="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=p,h="h",S<1&&(S=1);break;case"s":(N=s[o].v.match(/\.0+$/))&&(T=Math.max(T,N[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":h=s[o].t;break;case"m":h==="s"&&(s[o].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&s[o].v.match(/[Hh]/)&&(S=1),S<2&&s[o].v.match(/[Mm]/)&&(S=2),S<3&&s[o].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var E="",D;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=ij(s[o].t.charCodeAt(0),s[o].v,d,T),s[o].t="t";break;case"n":case"?":for(D=o+1;s[D]!=null&&((u=s[D].t)==="?"||u==="D"||(u===" "||u==="t")&&s[D+1]!=null&&(s[D+1].t==="?"||s[D+1].t==="t"&&s[D+1].v==="/")||s[o].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(s[D].v==="/"||s[D].v===" "&&s[D+1]!=null&&s[D+1].t=="?"));)s[o].v+=s[D].v,s[D]={v:"",t:";"},++D;E+=s[o].v,o=D-1;break;case"G":s[o].t="t",s[o].v=qi(t,r);break}var G="",V,A;if(E.length>0){E.charCodeAt(0)==40?(V=t<0&&E.charCodeAt(0)===45?-t:t,A=ys("n",E,V)):(V=t<0&&a>1?-t:t,A=ys("n",E,V),V<0&&s[0]&&s[0].t=="t"&&(A=A.substr(1),s[0].v="-"+s[0].v)),D=A.length-1;var M=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){M=o;break}var C=s.length;if(M===s.length&&A.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(D>=s[o].v.length-1?(D-=s[o].v.length,s[o].v=A.substr(D+1,s[o].v.length)):D<0?s[o].v="":(s[o].v=A.substr(0,D+1),D=-1),s[o].t="t",C=o);D>=0&&C<s.length&&(s[C].v=A.substr(0,D+1)+s[C].v)}else if(M!==s.length&&A.indexOf("E")===-1){for(D=A.indexOf(".")-1,o=M;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(x=s[o].v.indexOf(".")>-1&&o===M?s[o].v.indexOf(".")-1:s[o].v.length-1,G=s[o].v.substr(x+1);x>=0;--x)D>=0&&(s[o].v.charAt(x)==="0"||s[o].v.charAt(x)==="#")&&(G=A.charAt(D--)+G);s[o].v=G,s[o].t="t",C=o}for(D>=0&&C<s.length&&(s[C].v=A.substr(0,D+1)+s[C].v),D=A.indexOf(".")+1,o=M;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==M)){for(x=s[o].v.indexOf(".")>-1&&o===M?s[o].v.indexOf(".")+1:0,G=s[o].v.substr(0,x);x<s[o].v.length;++x)D<A.length&&(G+=A.charAt(D++));s[o].v=G,s[o].t="t",C=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(V=a>1&&t<0&&o>0&&s[o-1].v==="-"?-t:t,s[o].v=ys(s[o].t,s[o].v,V),s[o].t="t");var U="";for(o=0;o!==s.length;++o)s[o]!=null&&(U+=s[o].v);return U}var b_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function w_(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function gj(e,t){var r=xj(e),a=r.length,s=r[a-1].indexOf("@");if(a<4&&s>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var l=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,l];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(b_),u=r[1].match(b_);return w_(t,o)?[a,r[0]]:w_(t,u)?[a,r[1]]:[a,r[o!=null&&u!=null?2:1]]}return[a,l]}function Tn(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:ut)[e],a==null&&(a=r.table&&r.table[v_[e]]||ut[v_[e]]),a==null&&(a=ZN[e]||"General");break}if(Nf(a,0))return qi(t,r);t instanceof Date&&(t=Kb(t,r.date1904));var s=gj(a,t);if(Nf(s[1]))return qi(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return pj(s[1],t,r,s[0])}function _s(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ut[r]==null){t<0&&(t=r);continue}if(ut[r]==e){t=r;break}}t<0&&(t=391)}return ut[t]=e,t}function Kf(e){for(var t=0;t!=392;++t)e[t]!==void 0&&_s(e[t],t)}function co(){ut=QN()}var vj={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},nw=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function yj(e){var t=typeof e=="number"?ut[e]:e;return t=t.replace(nw,"(\\d+)"),new RegExp("^"+t+"$")}function _j(e,t,r){var a=-1,s=-1,l=-1,o=-1,u=-1,h=-1;(t.match(nw)||[]).forEach(function(g,p){var y=parseInt(r[p+1],10);switch(g.toLowerCase().charAt(0)){case"y":a=y;break;case"d":l=y;break;case"h":o=y;break;case"s":h=y;break;case"m":o>=0?u=y:s=y;break}}),h>=0&&u==-1&&s>=0&&(u=s,s=-1);var d=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var x=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return o==-1&&u==-1&&h==-1?d:a==-1&&s==-1&&l==-1?x:d+"T"+x}var bj=(function(){var e={};e.version="1.2.0";function t(){for(var A=0,M=new Array(256),C=0;C!=256;++C)A=C,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,M[C]=A;return typeof Int32Array<"u"?new Int32Array(M):M}var r=t();function a(A){var M=0,C=0,U=0,Z=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(U=0;U!=256;++U)Z[U]=A[U];for(U=0;U!=256;++U)for(C=A[U],M=256+U;M<4096;M+=256)C=Z[M]=C>>>8^A[C&255];var q=[];for(U=1;U!=16;++U)q[U-1]=typeof Int32Array<"u"?Z.subarray(U*256,U*256+256):Z.slice(U*256,U*256+256);return q}var s=a(r),l=s[0],o=s[1],u=s[2],h=s[3],d=s[4],x=s[5],g=s[6],p=s[7],y=s[8],w=s[9],_=s[10],S=s[11],T=s[12],N=s[13],E=s[14];function D(A,M){for(var C=M^-1,U=0,Z=A.length;U<Z;)C=C>>>8^r[(C^A.charCodeAt(U++))&255];return~C}function G(A,M){for(var C=M^-1,U=A.length-15,Z=0;Z<U;)C=E[A[Z++]^C&255]^N[A[Z++]^C>>8&255]^T[A[Z++]^C>>16&255]^S[A[Z++]^C>>>24]^_[A[Z++]]^w[A[Z++]]^y[A[Z++]]^p[A[Z++]]^g[A[Z++]]^x[A[Z++]]^d[A[Z++]]^h[A[Z++]]^u[A[Z++]]^o[A[Z++]]^l[A[Z++]]^r[A[Z++]];for(U+=15;Z<U;)C=C>>>8^r[(C^A[Z++])&255];return~C}function V(A,M){for(var C=M^-1,U=0,Z=A.length,q=0,le=0;U<Z;)q=A.charCodeAt(U++),q<128?C=C>>>8^r[(C^q)&255]:q<2048?(C=C>>>8^r[(C^(192|q>>6&31))&255],C=C>>>8^r[(C^(128|q&63))&255]):q>=55296&&q<57344?(q=(q&1023)+64,le=A.charCodeAt(U++)&1023,C=C>>>8^r[(C^(240|q>>8&7))&255],C=C>>>8^r[(C^(128|q>>2&63))&255],C=C>>>8^r[(C^(128|le>>6&15|(q&3)<<4))&255],C=C>>>8^r[(C^(128|le&63))&255]):(C=C>>>8^r[(C^(224|q>>12&15))&255],C=C>>>8^r[(C^(128|q>>6&63))&255],C=C>>>8^r[(C^(128|q&63))&255]);return~C}return e.table=r,e.bstr=D,e.buf=G,e.str=V,e})(),at=(function(){var t={};t.version="1.2.1";function r(j,H){for(var I=j.split("/"),L=H.split("/"),B=0,X=0,ce=Math.min(I.length,L.length);B<ce;++B){if(X=I[B].length-L[B].length)return X;if(I[B]!=L[B])return I[B]<L[B]?-1:1}return I.length-L.length}function a(j){if(j.charAt(j.length-1)=="/")return j.slice(0,-1).indexOf("/")===-1?j:a(j.slice(0,-1));var H=j.lastIndexOf("/");return H===-1?j:j.slice(0,H+1)}function s(j){if(j.charAt(j.length-1)=="/")return s(j.slice(0,-1));var H=j.lastIndexOf("/");return H===-1?j:j.slice(H+1)}function l(j,H){typeof H=="string"&&(H=new Date(H));var I=H.getHours();I=I<<6|H.getMinutes(),I=I<<5|H.getSeconds()>>>1,j.write_shift(2,I);var L=H.getFullYear()-1980;L=L<<4|H.getMonth()+1,L=L<<5|H.getDate(),j.write_shift(2,L)}function o(j){var H=j.read_shift(2)&65535,I=j.read_shift(2)&65535,L=new Date,B=I&31;I>>>=5;var X=I&15;I>>>=4,L.setMilliseconds(0),L.setFullYear(I+1980),L.setMonth(X-1),L.setDate(B);var ce=H&31;H>>>=5;var _e=H&63;return H>>>=6,L.setHours(H),L.setMinutes(_e),L.setSeconds(ce<<1),L}function u(j){oa(j,0);for(var H={},I=0;j.l<=j.length-4;){var L=j.read_shift(2),B=j.read_shift(2),X=j.l+B,ce={};switch(L){case 21589:I=j.read_shift(1),I&1&&(ce.mtime=j.read_shift(4)),B>5&&(I&2&&(ce.atime=j.read_shift(4)),I&4&&(ce.ctime=j.read_shift(4))),ce.mtime&&(ce.mt=new Date(ce.mtime*1e3));break}j.l=X,H[L]=ce}return H}var h;function d(){return h||(h={})}function x(j,H){if(j[0]==80&&j[1]==75)return qa(j,H);if((j[0]|32)==109&&(j[1]|32)==105)return $a(j,H);if(j.length<512)throw new Error("CFB file size "+j.length+" < 512");var I=3,L=512,B=0,X=0,ce=0,_e=0,ue=0,he=[],me=j.slice(0,512);oa(me,0);var Fe=g(me);switch(I=Fe[0],I){case 3:L=512;break;case 4:L=4096;break;case 0:if(Fe[1]==0)return qa(j,H);default:throw new Error("Major Version: Expected 3 or 4 saw "+I)}L!==512&&(me=j.slice(0,L),oa(me,28));var Be=j.slice(0,L);p(me,I);var qe=me.read_shift(4,"i");if(I===3&&qe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+qe);me.l+=4,ce=me.read_shift(4,"i"),me.l+=4,me.chk("00100000","Mini Stream Cutoff Size: "),_e=me.read_shift(4,"i"),B=me.read_shift(4,"i"),ue=me.read_shift(4,"i"),X=me.read_shift(4,"i");for(var Le=-1,$e=0;$e<109&&(Le=me.read_shift(4,"i"),!(Le<0));++$e)he[$e]=Le;var Ye=y(j,L);S(ue,X,Ye,L,he);var Ot=N(Ye,ce,he,L);Ot[ce].name="!Directory",B>0&&_e!==le&&(Ot[_e].name="!MiniFAT"),Ot[he[0]].name="!FAT",Ot.fat_addrs=he,Ot.ssz=L;var Lt={},Xt=[],Ta=[],Hn=[];E(ce,Ot,Ye,Xt,B,Lt,Ta,_e),w(Ta,Hn,Xt),Xt.shift();var Nn={FileIndex:Ta,FullPaths:Hn};return H&&H.raw&&(Nn.raw={header:Be,sectors:Ye}),Nn}function g(j){if(j[j.l]==80&&j[j.l+1]==75)return[0,0];j.chk(ge,"Header Signature: "),j.l+=16;var H=j.read_shift(2,"u");return[j.read_shift(2,"u"),H]}function p(j,H){var I=9;switch(j.l+=2,I=j.read_shift(2)){case 9:if(H!=3)throw new Error("Sector Shift: Expected 9 saw "+I);break;case 12:if(H!=4)throw new Error("Sector Shift: Expected 12 saw "+I);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+I)}j.chk("0600","Mini Sector Shift: "),j.chk("000000000000","Reserved: ")}function y(j,H){for(var I=Math.ceil(j.length/H)-1,L=[],B=1;B<I;++B)L[B-1]=j.slice(B*H,(B+1)*H);return L[I-1]=j.slice(I*H),L}function w(j,H,I){for(var L=0,B=0,X=0,ce=0,_e=0,ue=I.length,he=[],me=[];L<ue;++L)he[L]=me[L]=L,H[L]=I[L];for(;_e<me.length;++_e)L=me[_e],B=j[L].L,X=j[L].R,ce=j[L].C,he[L]===L&&(B!==-1&&he[B]!==B&&(he[L]=he[B]),X!==-1&&he[X]!==X&&(he[L]=he[X])),ce!==-1&&(he[ce]=L),B!==-1&&L!=he[L]&&(he[B]=he[L],me.lastIndexOf(B)<_e&&me.push(B)),X!==-1&&L!=he[L]&&(he[X]=he[L],me.lastIndexOf(X)<_e&&me.push(X));for(L=1;L<ue;++L)he[L]===L&&(X!==-1&&he[X]!==X?he[L]=he[X]:B!==-1&&he[B]!==B&&(he[L]=he[B]));for(L=1;L<ue;++L)if(j[L].type!==0){if(_e=L,_e!=he[_e])do _e=he[_e],H[L]=H[_e]+"/"+H[L];while(_e!==0&&he[_e]!==-1&&_e!=he[_e]);he[L]=-1}for(H[0]+="/",L=1;L<ue;++L)j[L].type!==2&&(H[L]+="/")}function _(j,H,I){for(var L=j.start,B=j.size,X=[],ce=L;I&&B>0&&ce>=0;)X.push(H.slice(ce*q,ce*q+q)),B-=q,ce=Ii(I,ce*4);return X.length===0?be(0):Qr(X).slice(0,j.size)}function S(j,H,I,L,B){var X=le;if(j===le){if(H!==0)throw new Error("DIFAT chain shorter than expected")}else if(j!==-1){var ce=I[j],_e=(L>>>2)-1;if(!ce)return;for(var ue=0;ue<_e&&(X=Ii(ce,ue*4))!==le;++ue)B.push(X);S(Ii(ce,L-4),H-1,I,L,B)}}function T(j,H,I,L,B){var X=[],ce=[];B||(B=[]);var _e=L-1,ue=0,he=0;for(ue=H;ue>=0;){B[ue]=!0,X[X.length]=ue,ce.push(j[ue]);var me=I[Math.floor(ue*4/L)];if(he=ue*4&_e,L<4+he)throw new Error("FAT boundary crossed: "+ue+" 4 "+L);if(!j[me])break;ue=Ii(j[me],he)}return{nodes:X,data:F_([ce])}}function N(j,H,I,L){var B=j.length,X=[],ce=[],_e=[],ue=[],he=L-1,me=0,Fe=0,Be=0,qe=0;for(me=0;me<B;++me)if(_e=[],Be=me+H,Be>=B&&(Be-=B),!ce[Be]){ue=[];var Le=[];for(Fe=Be;Fe>=0;){Le[Fe]=!0,ce[Fe]=!0,_e[_e.length]=Fe,ue.push(j[Fe]);var $e=I[Math.floor(Fe*4/L)];if(qe=Fe*4&he,L<4+qe)throw new Error("FAT boundary crossed: "+Fe+" 4 "+L);if(!j[$e]||(Fe=Ii(j[$e],qe),Le[Fe]))break}X[Be]={nodes:_e,data:F_([ue])}}return X}function E(j,H,I,L,B,X,ce,_e){for(var ue=0,he=L.length?2:0,me=H[j].data,Fe=0,Be=0,qe;Fe<me.length;Fe+=128){var Le=me.slice(Fe,Fe+128);oa(Le,64),Be=Le.read_shift(2),qe=yx(Le,0,Be-he),L.push(qe);var $e={name:qe,type:Le.read_shift(1),color:Le.read_shift(1),L:Le.read_shift(4,"i"),R:Le.read_shift(4,"i"),C:Le.read_shift(4,"i"),clsid:Le.read_shift(16),state:Le.read_shift(4,"i"),start:0,size:0},Ye=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);Ye!==0&&($e.ct=D(Le,Le.l-8));var Ot=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);Ot!==0&&($e.mt=D(Le,Le.l-8)),$e.start=Le.read_shift(4,"i"),$e.size=Le.read_shift(4,"i"),$e.size<0&&$e.start<0&&($e.size=$e.type=0,$e.start=le,$e.name=""),$e.type===5?(ue=$e.start,B>0&&ue!==le&&(H[ue].name="!StreamData")):$e.size>=4096?($e.storage="fat",H[$e.start]===void 0&&(H[$e.start]=T(I,$e.start,H.fat_addrs,H.ssz)),H[$e.start].name=$e.name,$e.content=H[$e.start].data.slice(0,$e.size)):($e.storage="minifat",$e.size<0?$e.size=0:ue!==le&&$e.start!==le&&H[ue]&&($e.content=_($e,H[ue].data,(H[_e]||{}).data))),$e.content&&oa($e.content,0),X[qe]=$e,ce.push($e)}}function D(j,H){return new Date((rn(j,H+4)/1e7*Math.pow(2,32)+rn(j,H)/1e7-11644473600)*1e3)}function G(j,H){return d(),x(h.readFileSync(j),H)}function V(j,H){var I=H&&H.type;switch(I||St&&Buffer.isBuffer(j)&&(I="buffer"),I||"base64"){case"file":return G(j,H);case"base64":return x(nn(ln(j)),H);case"binary":return x(nn(j),H)}return x(j,H)}function A(j,H){var I=H||{},L=I.root||"Root Entry";if(j.FullPaths||(j.FullPaths=[]),j.FileIndex||(j.FileIndex=[]),j.FullPaths.length!==j.FileIndex.length)throw new Error("inconsistent CFB structure");j.FullPaths.length===0&&(j.FullPaths[0]=L+"/",j.FileIndex[0]={name:L,type:5}),I.CLSID&&(j.FileIndex[0].clsid=I.CLSID),M(j)}function M(j){var H="Sh33tJ5";if(!at.find(j,"/"+H)){var I=be(4);I[0]=55,I[1]=I[3]=50,I[2]=54,j.FileIndex.push({name:H,type:2,content:I,size:4,L:69,R:69,C:69}),j.FullPaths.push(j.FullPaths[0]+H),C(j)}}function C(j,H){A(j);for(var I=!1,L=!1,B=j.FullPaths.length-1;B>=0;--B){var X=j.FileIndex[B];switch(X.type){case 0:L?I=!0:(j.FileIndex.pop(),j.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(X.R*X.L*X.C)&&(I=!0),X.R>-1&&X.L>-1&&X.R==X.L&&(I=!0);break;default:I=!0;break}}if(!(!I&&!H)){var ce=new Date(1987,1,19),_e=0,ue=Object.create?Object.create(null):{},he=[];for(B=0;B<j.FullPaths.length;++B)ue[j.FullPaths[B]]=!0,j.FileIndex[B].type!==0&&he.push([j.FullPaths[B],j.FileIndex[B]]);for(B=0;B<he.length;++B){var me=a(he[B][0]);L=ue[me],L||(he.push([me,{name:s(me).replace("/",""),type:1,clsid:te,ct:ce,mt:ce,content:null}]),ue[me]=!0)}for(he.sort(function(qe,Le){return r(qe[0],Le[0])}),j.FullPaths=[],j.FileIndex=[],B=0;B<he.length;++B)j.FullPaths[B]=he[B][0],j.FileIndex[B]=he[B][1];for(B=0;B<he.length;++B){var Fe=j.FileIndex[B],Be=j.FullPaths[B];if(Fe.name=s(Be).replace("/",""),Fe.L=Fe.R=Fe.C=-(Fe.color=1),Fe.size=Fe.content?Fe.content.length:0,Fe.start=0,Fe.clsid=Fe.clsid||te,B===0)Fe.C=he.length>1?1:-1,Fe.size=0,Fe.type=5;else if(Be.slice(-1)=="/"){for(_e=B+1;_e<he.length&&a(j.FullPaths[_e])!=Be;++_e);for(Fe.C=_e>=he.length?-1:_e,_e=B+1;_e<he.length&&a(j.FullPaths[_e])!=a(Be);++_e);Fe.R=_e>=he.length?-1:_e,Fe.type=1}else a(j.FullPaths[B+1]||"")==a(Be)&&(Fe.R=B+1),Fe.type=2}}}function U(j,H){var I=H||{};if(I.fileType=="mad")return Ca(j,I);switch(C(j),I.fileType){case"zip":return cn(j,I)}var L=(function(qe){for(var Le=0,$e=0,Ye=0;Ye<qe.FileIndex.length;++Ye){var Ot=qe.FileIndex[Ye];if(Ot.content){var Lt=Ot.content.length;Lt>0&&(Lt<4096?Le+=Lt+63>>6:$e+=Lt+511>>9)}}for(var Xt=qe.FullPaths.length+3>>2,Ta=Le+7>>3,Hn=Le+127>>7,Nn=Ta+$e+Xt+Hn,$r=Nn+127>>7,fi=$r<=109?0:Math.ceil(($r-109)/127);Nn+$r+fi+127>>7>$r;)fi=++$r<=109?0:Math.ceil(($r-109)/127);var da=[1,fi,$r,Hn,Xt,$e,Le,0];return qe.FileIndex[0].size=Le<<6,da[7]=(qe.FileIndex[0].start=da[0]+da[1]+da[2]+da[3]+da[4]+da[5])+(da[6]+7>>3),da})(j),B=be(L[7]<<9),X=0,ce=0;{for(X=0;X<8;++X)B.write_shift(1,Se[X]);for(X=0;X<8;++X)B.write_shift(2,0);for(B.write_shift(2,62),B.write_shift(2,3),B.write_shift(2,65534),B.write_shift(2,9),B.write_shift(2,6),X=0;X<3;++X)B.write_shift(2,0);for(B.write_shift(4,0),B.write_shift(4,L[2]),B.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),B.write_shift(4,0),B.write_shift(4,4096),B.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:le),B.write_shift(4,L[3]),B.write_shift(-4,L[1]?L[0]-1:le),B.write_shift(4,L[1]),X=0;X<109;++X)B.write_shift(-4,X<L[2]?L[1]+X:-1)}if(L[1])for(ce=0;ce<L[1];++ce){for(;X<236+ce*127;++X)B.write_shift(-4,X<L[2]?L[1]+X:-1);B.write_shift(-4,ce===L[1]-1?le:ce+1)}var _e=function(qe){for(ce+=qe;X<ce-1;++X)B.write_shift(-4,X+1);qe&&(++X,B.write_shift(-4,le))};for(ce=X=0,ce+=L[1];X<ce;++X)B.write_shift(-4,ae.DIFSECT);for(ce+=L[2];X<ce;++X)B.write_shift(-4,ae.FATSECT);_e(L[3]),_e(L[4]);for(var ue=0,he=0,me=j.FileIndex[0];ue<j.FileIndex.length;++ue)me=j.FileIndex[ue],me.content&&(he=me.content.length,!(he<4096)&&(me.start=ce,_e(he+511>>9)));for(_e(L[6]+7>>3);B.l&511;)B.write_shift(-4,ae.ENDOFCHAIN);for(ce=X=0,ue=0;ue<j.FileIndex.length;++ue)me=j.FileIndex[ue],me.content&&(he=me.content.length,!(!he||he>=4096)&&(me.start=ce,_e(he+63>>6)));for(;B.l&511;)B.write_shift(-4,ae.ENDOFCHAIN);for(X=0;X<L[4]<<2;++X){var Fe=j.FullPaths[X];if(!Fe||Fe.length===0){for(ue=0;ue<17;++ue)B.write_shift(4,0);for(ue=0;ue<3;++ue)B.write_shift(4,-1);for(ue=0;ue<12;++ue)B.write_shift(4,0);continue}me=j.FileIndex[X],X===0&&(me.start=me.size?me.start-1:le);var Be=X===0&&I.root||me.name;if(he=2*(Be.length+1),B.write_shift(64,Be,"utf16le"),B.write_shift(2,he),B.write_shift(1,me.type),B.write_shift(1,me.color),B.write_shift(-4,me.L),B.write_shift(-4,me.R),B.write_shift(-4,me.C),me.clsid)B.write_shift(16,me.clsid,"hex");else for(ue=0;ue<4;++ue)B.write_shift(4,0);B.write_shift(4,me.state||0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,me.start),B.write_shift(4,me.size),B.write_shift(4,0)}for(X=1;X<j.FileIndex.length;++X)if(me=j.FileIndex[X],me.size>=4096)if(B.l=me.start+1<<9,St&&Buffer.isBuffer(me.content))me.content.copy(B,B.l,0,me.size),B.l+=me.size+511&-512;else{for(ue=0;ue<me.size;++ue)B.write_shift(1,me.content[ue]);for(;ue&511;++ue)B.write_shift(1,0)}for(X=1;X<j.FileIndex.length;++X)if(me=j.FileIndex[X],me.size>0&&me.size<4096)if(St&&Buffer.isBuffer(me.content))me.content.copy(B,B.l,0,me.size),B.l+=me.size+63&-64;else{for(ue=0;ue<me.size;++ue)B.write_shift(1,me.content[ue]);for(;ue&63;++ue)B.write_shift(1,0)}if(St)B.l=B.length;else for(;B.l<B.length;)B.write_shift(1,0);return B}function Z(j,H){var I=j.FullPaths.map(function(ue){return ue.toUpperCase()}),L=I.map(function(ue){var he=ue.split("/");return he[he.length-(ue.slice(-1)=="/"?2:1)]}),B=!1;H.charCodeAt(0)===47?(B=!0,H=I[0].slice(0,-1)+H):B=H.indexOf("/")!==-1;var X=H.toUpperCase(),ce=B===!0?I.indexOf(X):L.indexOf(X);if(ce!==-1)return j.FileIndex[ce];var _e=!X.match(hc);for(X=X.replace(Oa,""),_e&&(X=X.replace(hc,"!")),ce=0;ce<I.length;++ce)if((_e?I[ce].replace(hc,"!"):I[ce]).replace(Oa,"")==X||(_e?L[ce].replace(hc,"!"):L[ce]).replace(Oa,"")==X)return j.FileIndex[ce];return null}var q=64,le=-2,ge="d0cf11e0a1b11ae1",Se=[208,207,17,224,161,177,26,225],te="00000000000000000000000000000000",ae={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:le,FREESECT:-1,HEADER_SIGNATURE:ge,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:te,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function De(j,H,I){d();var L=U(j,I);h.writeFileSync(H,L)}function ie(j){for(var H=new Array(j.length),I=0;I<j.length;++I)H[I]=String.fromCharCode(j[I]);return H.join("")}function Me(j,H){var I=U(j,H);switch(H&&H.type||"buffer"){case"file":return d(),h.writeFileSync(H.filename,I),I;case"binary":return typeof I=="string"?I:ie(I);case"base64":return Dc(typeof I=="string"?I:ie(I));case"buffer":if(St)return Buffer.isBuffer(I)?I:Es(I);case"array":return typeof I=="string"?nn(I):I}return I}var W;function O(j){try{var H=j.InflateRaw,I=new H;if(I._processChunk(new Uint8Array([3,0]),I._finishFlushFlag),I.bytesRead)W=j;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function P(j,H){if(!W)return Zn(j,H);var I=W.InflateRaw,L=new I,B=L._processChunk(j.slice(j.l),L._finishFlushFlag);return j.l+=L.bytesRead,B}function z(j){return W?W.deflateRawSync(j):nt(j)}var F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],re=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ee(j){var H=(j<<1|j<<11)&139536|(j<<5|j<<15)&558144;return(H>>16|H>>8|H)&255}for(var ye=typeof Uint8Array<"u",Oe=ye?new Uint8Array(256):[],tt=0;tt<256;++tt)Oe[tt]=Ee(tt);function J(j,H){var I=Oe[j&255];return H<=8?I>>>8-H:(I=I<<8|Oe[j>>8&255],H<=16?I>>>16-H:(I=I<<8|Oe[j>>16&255],I>>>24-H))}function wt(j,H){var I=H&7,L=H>>>3;return(j[L]|(I<=6?0:j[L+1]<<8))>>>I&3}function et(j,H){var I=H&7,L=H>>>3;return(j[L]|(I<=5?0:j[L+1]<<8))>>>I&7}function gt(j,H){var I=H&7,L=H>>>3;return(j[L]|(I<=4?0:j[L+1]<<8))>>>I&15}function it(j,H){var I=H&7,L=H>>>3;return(j[L]|(I<=3?0:j[L+1]<<8))>>>I&31}function Ce(j,H){var I=H&7,L=H>>>3;return(j[L]|(I<=1?0:j[L+1]<<8))>>>I&127}function Ae(j,H,I){var L=H&7,B=H>>>3,X=(1<<I)-1,ce=j[B]>>>L;return I<8-L||(ce|=j[B+1]<<8-L,I<16-L)||(ce|=j[B+2]<<16-L,I<24-L)||(ce|=j[B+3]<<24-L),ce&X}function Ge(j,H,I){var L=H&7,B=H>>>3;return L<=5?j[B]|=(I&7)<<L:(j[B]|=I<<L&255,j[B+1]=(I&7)>>8-L),H+3}function mt(j,H,I){var L=H&7,B=H>>>3;return I=(I&1)<<L,j[B]|=I,H+1}function Ue(j,H,I){var L=H&7,B=H>>>3;return I<<=L,j[B]|=I&255,I>>>=8,j[B+1]=I,H+8}function Ve(j,H,I){var L=H&7,B=H>>>3;return I<<=L,j[B]|=I&255,I>>>=8,j[B+1]=I&255,j[B+2]=I>>>8,H+16}function Tt(j,H){var I=j.length,L=2*I>H?2*I:H+5,B=0;if(I>=H)return j;if(St){var X=x_(L);if(j.copy)j.copy(X);else for(;B<j.length;++B)X[B]=j[B];return X}else if(ye){var ce=new Uint8Array(L);if(ce.set)ce.set(j);else for(;B<I;++B)ce[B]=j[B];return ce}return j.length=L,j}function Ke(j){for(var H=new Array(j),I=0;I<j;++I)H[I]=0;return H}function Rt(j,H,I){var L=1,B=0,X=0,ce=0,_e=0,ue=j.length,he=ye?new Uint16Array(32):Ke(32);for(X=0;X<32;++X)he[X]=0;for(X=ue;X<I;++X)j[X]=0;ue=j.length;var me=ye?new Uint16Array(ue):Ke(ue);for(X=0;X<ue;++X)he[B=j[X]]++,L<B&&(L=B),me[X]=0;for(he[0]=0,X=1;X<=L;++X)he[X+16]=_e=_e+he[X-1]<<1;for(X=0;X<ue;++X)_e=j[X],_e!=0&&(me[X]=he[_e+16]++);var Fe=0;for(X=0;X<ue;++X)if(Fe=j[X],Fe!=0)for(_e=J(me[X],L)>>L-Fe,ce=(1<<L+4-Fe)-1;ce>=0;--ce)H[_e|ce<<Fe]=Fe&15|X<<4;return L}var zt=ye?new Uint16Array(512):Ke(512),ua=ye?new Uint16Array(32):Ke(32);if(!ye){for(var ir=0;ir<512;++ir)zt[ir]=0;for(ir=0;ir<32;++ir)ua[ir]=0}(function(){for(var j=[],H=0;H<32;H++)j.push(5);Rt(j,ua,32);var I=[];for(H=0;H<=143;H++)I.push(8);for(;H<=255;H++)I.push(9);for(;H<=279;H++)I.push(7);for(;H<=287;H++)I.push(8);Rt(I,zt,288)})();var or=(function(){for(var H=ye?new Uint8Array(32768):[],I=0,L=0;I<re.length-1;++I)for(;L<re[I+1];++L)H[L]=I;for(;L<32768;++L)H[L]=29;var B=ye?new Uint8Array(259):[];for(I=0,L=0;I<Q.length-1;++I)for(;L<Q[I+1];++L)B[L]=I;function X(_e,ue){for(var he=0;he<_e.length;){var me=Math.min(65535,_e.length-he),Fe=he+me==_e.length;for(ue.write_shift(1,+Fe),ue.write_shift(2,me),ue.write_shift(2,~me&65535);me-- >0;)ue[ue.l++]=_e[he++]}return ue.l}function ce(_e,ue){for(var he=0,me=0,Fe=ye?new Uint16Array(32768):[];me<_e.length;){var Be=Math.min(65535,_e.length-me);if(Be<10){for(he=Ge(ue,he,+(me+Be==_e.length)),he&7&&(he+=8-(he&7)),ue.l=he/8|0,ue.write_shift(2,Be),ue.write_shift(2,~Be&65535);Be-- >0;)ue[ue.l++]=_e[me++];he=ue.l*8;continue}he=Ge(ue,he,+(me+Be==_e.length)+2);for(var qe=0;Be-- >0;){var Le=_e[me];qe=(qe<<5^Le)&32767;var $e=-1,Ye=0;if(($e=Fe[qe])&&($e|=me&-32768,$e>me&&($e-=32768),$e<me))for(;_e[$e+Ye]==_e[me+Ye]&&Ye<250;)++Ye;if(Ye>2){Le=B[Ye],Le<=22?he=Ue(ue,he,Oe[Le+1]>>1)-1:(Ue(ue,he,3),he+=5,Ue(ue,he,Oe[Le-23]>>5),he+=3);var Ot=Le<8?0:Le-4>>2;Ot>0&&(Ve(ue,he,Ye-Q[Le]),he+=Ot),Le=H[me-$e],he=Ue(ue,he,Oe[Le]>>3),he-=3;var Lt=Le<4?0:Le-2>>1;Lt>0&&(Ve(ue,he,me-$e-re[Le]),he+=Lt);for(var Xt=0;Xt<Ye;++Xt)Fe[qe]=me&32767,qe=(qe<<5^_e[me])&32767,++me;Be-=Ye-1}else Le<=143?Le=Le+48:he=mt(ue,he,1),he=Ue(ue,he,Oe[Le]),Fe[qe]=me&32767,++me}he=Ue(ue,he,0)-1}return ue.l=(he+7)/8|0,ue.l}return function(ue,he){return ue.length<8?X(ue,he):ce(ue,he)}})();function nt(j){var H=be(50+Math.floor(j.length*1.1)),I=or(j,H);return H.slice(0,I)}var Ht=ye?new Uint16Array(32768):Ke(32768),Hr=ye?new Uint16Array(32768):Ke(32768),It=ye?new Uint16Array(128):Ke(128),Gt=1,qr=1;function Vt(j,H){var I=it(j,H)+257;H+=5;var L=it(j,H)+1;H+=5;var B=gt(j,H)+4;H+=4;for(var X=0,ce=ye?new Uint8Array(19):Ke(19),_e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ue=1,he=ye?new Uint8Array(8):Ke(8),me=ye?new Uint8Array(8):Ke(8),Fe=ce.length,Be=0;Be<B;++Be)ce[F[Be]]=X=et(j,H),ue<X&&(ue=X),he[X]++,H+=3;var qe=0;for(he[0]=0,Be=1;Be<=ue;++Be)me[Be]=qe=qe+he[Be-1]<<1;for(Be=0;Be<Fe;++Be)(qe=ce[Be])!=0&&(_e[Be]=me[qe]++);var Le=0;for(Be=0;Be<Fe;++Be)if(Le=ce[Be],Le!=0){qe=Oe[_e[Be]]>>8-Le;for(var $e=(1<<7-Le)-1;$e>=0;--$e)It[qe|$e<<Le]=Le&7|Be<<3}var Ye=[];for(ue=1;Ye.length<I+L;)switch(qe=It[Ce(j,H)],H+=qe&7,qe>>>=3){case 16:for(X=3+wt(j,H),H+=2,qe=Ye[Ye.length-1];X-- >0;)Ye.push(qe);break;case 17:for(X=3+et(j,H),H+=3;X-- >0;)Ye.push(0);break;case 18:for(X=11+Ce(j,H),H+=7;X-- >0;)Ye.push(0);break;default:Ye.push(qe),ue<qe&&(ue=qe);break}var Ot=Ye.slice(0,I),Lt=Ye.slice(I);for(Be=I;Be<286;++Be)Ot[Be]=0;for(Be=L;Be<30;++Be)Lt[Be]=0;return Gt=Rt(Ot,Ht,286),qr=Rt(Lt,Hr,30),H}function Ns(j,H){if(j[0]==3&&!(j[1]&3))return[ni(H),2];for(var I=0,L=0,B=x_(H||1<<18),X=0,ce=B.length>>>0,_e=0,ue=0;(L&1)==0;){if(L=et(j,I),I+=3,L>>>1)L>>1==1?(_e=9,ue=5):(I=Vt(j,I),_e=Gt,ue=qr);else{I&7&&(I+=8-(I&7));var he=j[I>>>3]|j[(I>>>3)+1]<<8;if(I+=32,he>0)for(!H&&ce<X+he&&(B=Tt(B,X+he),ce=B.length);he-- >0;)B[X++]=j[I>>>3],I+=8;continue}for(;;){!H&&ce<X+32767&&(B=Tt(B,X+32767),ce=B.length);var me=Ae(j,I,_e),Fe=L>>>1==1?zt[me]:Ht[me];if(I+=Fe&15,Fe>>>=4,(Fe>>>8&255)===0)B[X++]=Fe;else{if(Fe==256)break;Fe-=257;var Be=Fe<8?0:Fe-4>>2;Be>5&&(Be=0);var qe=X+Q[Fe];Be>0&&(qe+=Ae(j,I,Be),I+=Be),me=Ae(j,I,ue),Fe=L>>>1==1?ua[me]:Hr[me],I+=Fe&15,Fe>>>=4;var Le=Fe<4?0:Fe-2>>1,$e=re[Fe];for(Le>0&&($e+=Ae(j,I,Le),I+=Le),!H&&ce<qe&&(B=Tt(B,qe+100),ce=B.length);X<qe;)B[X]=B[X-$e],++X}}}return H?[B,I+7>>>3]:[B.slice(0,X),I+7>>>3]}function Zn(j,H){var I=j.slice(j.l||0),L=Ns(I,H);return j.l+=L[1],L[0]}function es(j,H){if(j)typeof console<"u"&&console.error(H);else throw new Error(H)}function qa(j,H){var I=j;oa(I,0);var L=[],B=[],X={FileIndex:L,FullPaths:B};A(X,{root:H.root});for(var ce=I.length-4;(I[ce]!=80||I[ce+1]!=75||I[ce+2]!=5||I[ce+3]!=6)&&ce>=0;)--ce;I.l=ce+4,I.l+=4;var _e=I.read_shift(2);I.l+=6;var ue=I.read_shift(4);for(I.l=ue,ce=0;ce<_e;++ce){I.l+=20;var he=I.read_shift(4),me=I.read_shift(4),Fe=I.read_shift(2),Be=I.read_shift(2),qe=I.read_shift(2);I.l+=8;var Le=I.read_shift(4),$e=u(I.slice(I.l+Fe,I.l+Fe+Be));I.l+=Fe+Be+qe;var Ye=I.l;I.l=Le+4,zn(I,he,me,X,$e),I.l=Ye}return X}function zn(j,H,I,L,B){j.l+=2;var X=j.read_shift(2),ce=j.read_shift(2),_e=o(j);if(X&8257)throw new Error("Unsupported ZIP encryption");for(var ue=j.read_shift(4),he=j.read_shift(4),me=j.read_shift(4),Fe=j.read_shift(2),Be=j.read_shift(2),qe="",Le=0;Le<Fe;++Le)qe+=String.fromCharCode(j[j.l++]);if(Be){var $e=u(j.slice(j.l,j.l+Be));($e[21589]||{}).mt&&(_e=$e[21589].mt),((B||{})[21589]||{}).mt&&(_e=B[21589].mt)}j.l+=Be;var Ye=j.slice(j.l,j.l+he);switch(ce){case 8:Ye=P(j,me);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ce)}var Ot=!1;X&8&&(ue=j.read_shift(4),ue==134695760&&(ue=j.read_shift(4),Ot=!0),he=j.read_shift(4),me=j.read_shift(4)),he!=H&&es(Ot,"Bad compressed size: "+H+" != "+he),me!=I&&es(Ot,"Bad uncompressed size: "+I+" != "+me),Ie(L,qe,Ye,{unsafe:!0,mt:_e})}function cn(j,H){var I=H||{},L=[],B=[],X=be(1),ce=I.compression?8:0,_e=0,ue=0,he=0,me=0,Fe=0,Be=j.FullPaths[0],qe=Be,Le=j.FileIndex[0],$e=[],Ye=0;for(ue=1;ue<j.FullPaths.length;++ue)if(qe=j.FullPaths[ue].slice(Be.length),Le=j.FileIndex[ue],!(!Le.size||!Le.content||qe=="Sh33tJ5")){var Ot=me,Lt=be(qe.length);for(he=0;he<qe.length;++he)Lt.write_shift(1,qe.charCodeAt(he)&127);Lt=Lt.slice(0,Lt.l),$e[Fe]=bj.buf(Le.content,0);var Xt=Le.content;ce==8&&(Xt=z(Xt)),X=be(30),X.write_shift(4,67324752),X.write_shift(2,20),X.write_shift(2,_e),X.write_shift(2,ce),Le.mt?l(X,Le.mt):X.write_shift(4,0),X.write_shift(-4,$e[Fe]),X.write_shift(4,Xt.length),X.write_shift(4,Le.content.length),X.write_shift(2,Lt.length),X.write_shift(2,0),me+=X.length,L.push(X),me+=Lt.length,L.push(Lt),me+=Xt.length,L.push(Xt),X=be(46),X.write_shift(4,33639248),X.write_shift(2,0),X.write_shift(2,20),X.write_shift(2,_e),X.write_shift(2,ce),X.write_shift(4,0),X.write_shift(-4,$e[Fe]),X.write_shift(4,Xt.length),X.write_shift(4,Le.content.length),X.write_shift(2,Lt.length),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(4,0),X.write_shift(4,Ot),Ye+=X.l,B.push(X),Ye+=Lt.length,B.push(Lt),++Fe}return X=be(22),X.write_shift(4,101010256),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,Fe),X.write_shift(2,Fe),X.write_shift(4,Ye),X.write_shift(4,me),X.write_shift(2,0),Qr([Qr(L),Qr(B),X])}var fa={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ea(j,H){if(j.ctype)return j.ctype;var I=j.name||"",L=I.match(/\.([^\.]+)$/);return L&&fa[L[1]]||H&&(L=(I=H).match(/[\.\\]([^\.\\])+$/),L&&fa[L[1]])?fa[L[1]]:"application/octet-stream"}function Ea(j){for(var H=Dc(j),I=[],L=0;L<H.length;L+=76)I.push(H.slice(L,L+76));return I.join(`\r
`)+`\r
`}function st(j){var H=j.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(he){var me=he.charCodeAt(0).toString(16).toUpperCase();return"="+(me.length==1?"0"+me:me)});H=H.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),H.charAt(0)==`
`&&(H="=0D"+H.slice(1)),H=H.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var I=[],L=H.split(`\r
`),B=0;B<L.length;++B){var X=L[B];if(X.length==0){I.push("");continue}for(var ce=0;ce<X.length;){var _e=76,ue=X.slice(ce,ce+_e);ue.charAt(_e-1)=="="?_e--:ue.charAt(_e-2)=="="?_e-=2:ue.charAt(_e-3)=="="&&(_e-=3),ue=X.slice(ce,ce+_e),ce+=_e,ce<X.length&&(ue+="="),I.push(ue)}}return I.join(`\r
`)}function _r(j){for(var H=[],I=0;I<j.length;++I){for(var L=j[I];I<=j.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+j[++I];H.push(L)}for(var B=0;B<H.length;++B)H[B]=H[B].replace(/[=][0-9A-Fa-f]{2}/g,function(X){return String.fromCharCode(parseInt(X.slice(1),16))});return nn(H.join(`\r
`))}function tr(j,H,I){for(var L="",B="",X="",ce,_e=0;_e<10;++_e){var ue=H[_e];if(!ue||ue.match(/^\s*$/))break;var he=ue.match(/^(.*?):\s*([^\s].*)$/);if(he)switch(he[1].toLowerCase()){case"content-location":L=he[2].trim();break;case"content-type":X=he[2].trim();break;case"content-transfer-encoding":B=he[2].trim();break}}switch(++_e,B.toLowerCase()){case"base64":ce=nn(ln(H.slice(_e).join("")));break;case"quoted-printable":ce=_r(H.slice(_e));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+B)}var me=Ie(j,L.slice(I.length),ce,{unsafe:!0});X&&(me.ctype=X)}function $a(j,H){if(ie(j.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var I=H&&H.root||"",L=(St&&Buffer.isBuffer(j)?j.toString("binary"):ie(j)).split(`\r
`),B=0,X="";for(B=0;B<L.length;++B)if(X=L[B],!!/^Content-Location:/i.test(X)&&(X=X.slice(X.indexOf("file")),I||(I=X.slice(0,X.lastIndexOf("/")+1)),X.slice(0,I.length)!=I))for(;I.length>0&&(I=I.slice(0,I.length-1),I=I.slice(0,I.lastIndexOf("/")+1),X.slice(0,I.length)!=I););var ce=(L[1]||"").match(/boundary="(.*?)"/);if(!ce)throw new Error("MAD cannot find boundary");var _e="--"+(ce[1]||""),ue=[],he=[],me={FileIndex:ue,FullPaths:he};A(me);var Fe,Be=0;for(B=0;B<L.length;++B){var qe=L[B];qe!==_e&&qe!==_e+"--"||(Be++&&tr(me,L.slice(Fe,B),I),Fe=B)}return me}function Ca(j,H){var I=H||{},L=I.boundary||"SheetJS";L="------="+L;for(var B=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],X=j.FullPaths[0],ce=X,_e=j.FileIndex[0],ue=1;ue<j.FullPaths.length;++ue)if(ce=j.FullPaths[ue].slice(X.length),_e=j.FileIndex[ue],!(!_e.size||!_e.content||ce=="Sh33tJ5")){ce=ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ye){return"_x"+Ye.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ye){return"_u"+Ye.charCodeAt(0).toString(16)+"_"});for(var he=_e.content,me=St&&Buffer.isBuffer(he)?he.toString("binary"):ie(he),Fe=0,Be=Math.min(1024,me.length),qe=0,Le=0;Le<=Be;++Le)(qe=me.charCodeAt(Le))>=32&&qe<128&&++Fe;var $e=Fe>=Be*4/5;B.push(L),B.push("Content-Location: "+(I.root||"file:///C:/SheetJS/")+ce),B.push("Content-Transfer-Encoding: "+($e?"quoted-printable":"base64")),B.push("Content-Type: "+ea(_e,ce)),B.push(""),B.push($e?st(me):Ea(me))}return B.push(L+`--\r
`),B.join(`\r
`)}function K(j){var H={};return A(H,j),H}function Ie(j,H,I,L){var B=L&&L.unsafe;B||A(j);var X=!B&&at.find(j,H);if(!X){var ce=j.FullPaths[0];H.slice(0,ce.length)==ce?ce=H:(ce.slice(-1)!="/"&&(ce+="/"),ce=(ce+H).replace("//","/")),X={name:s(H),type:2},j.FileIndex.push(X),j.FullPaths.push(ce),B||at.utils.cfb_gc(j)}return X.content=I,X.size=I?I.length:0,L&&(L.CLSID&&(X.clsid=L.CLSID),L.mt&&(X.mt=L.mt),L.ct&&(X.ct=L.ct)),X}function ft(j,H){A(j);var I=at.find(j,H);if(I){for(var L=0;L<j.FileIndex.length;++L)if(j.FileIndex[L]==I)return j.FileIndex.splice(L,1),j.FullPaths.splice(L,1),!0}return!1}function qt(j,H,I){A(j);var L=at.find(j,H);if(L){for(var B=0;B<j.FileIndex.length;++B)if(j.FileIndex[B]==L)return j.FileIndex[B].name=s(I),j.FullPaths[B]=I,!0}return!1}function gr(j){C(j,!0)}return t.find=Z,t.read=V,t.parse=x,t.write=Me,t.writeFile=De,t.utils={cfb_new:K,cfb_add:Ie,cfb_del:ft,cfb_mov:qt,cfb_gc:gr,ReadShift:gc,CheckField:kw,prep_blob:oa,bconcat:Qr,use_zlib:O,_deflateRaw:nt,_inflateRaw:Zn,consts:ae},t})();function wj(e){return typeof e=="string"?Wf(e):Array.isArray(e)?WN(e):e}function Jc(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Wf(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?Yn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var s=new Blob([wj(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=l,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(e);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=oi(t)),u.write(t),u.close(),t}catch(h){if(!h.message||!h.message.match(/onstruct/))throw h}throw new Error("cannot save file "+e)}function Sj(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function jr(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function S_(e,t){for(var r=[],a=jr(e),s=0;s!==a.length;++s)r[e[a[s]][t]]==null&&(r[e[a[s]][t]]=a[s]);return r}function Yf(e){for(var t=[],r=jr(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function Jf(e){for(var t=[],r=jr(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function Ej(e){for(var t=[],r=jr(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var Af=new Date(1899,11,30,0,0,0);function Kr(e,t){var r=e.getTime(),a=Af.getTime()+(e.getTimezoneOffset()-Af.getTimezoneOffset())*6e4;return(r-a)/(1440*60*1e3)}var sw=new Date,Tj=Af.getTime()+(sw.getTimezoneOffset()-Af.getTimezoneOffset())*6e4,E_=sw.getTimezoneOffset();function Qf(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Tj),t.getTimezoneOffset()!==E_&&t.setTime(t.getTime()+(t.getTimezoneOffset()-E_)*6e4),t}function kj(e){var t=0,r=0,a=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=s.length;++l)if(s[l]){switch(r=1,l>3&&(a=!0),s[l].slice(s[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[l].slice(s[l].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[l],10)}return t}var T_=new Date("2017-02-19T19:06:09.000Z"),iw=isNaN(T_.getFullYear())?new Date("2/19/17"):T_,Nj=iw.getFullYear()==2017;function hr(e,t){var r=new Date(e);if(Nj)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(iw.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function $i(e,t){if(St&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Yn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Yn(Xb(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Yn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Yn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return r[l]||l})}catch{}for(var a=[],s=0;s!=e.length;++s)a.push(String.fromCharCode(e[s]));return a.join("")}function mr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=mr(e[r]));return t}function kr(e,t){for(var r="";r.length<t;)r+=e;return r}function Pn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(s,l){return r=-r,l}),!isNaN(t=Number(a)))?t/r:t}var jj=["january","february","march","april","may","june","july","august","september","october","november","december"];function ao(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),s=t.getMonth(),l=t.getDate();if(isNaN(l))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&jj.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return a<0||a>8099?r:(s>0||l>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Aj=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,s){if(e||typeof a=="string")return r.split(a);for(var l=r.split(a),o=[l[0]],u=1;u<l.length;++u)o.push(s),o.push(l[u]);return o}})();function lw(e){return e?e.content&&e.type?$i(e.content,!0):e.data?dc(e.data):e.asNodeBuffer&&St?dc(e.asNodeBuffer().toString("binary")):e.asBinary?dc(e.asBinary()):e._data&&e._data.getContent?dc($i(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function ow(e){if(!e)return null;if(e.data)return h_(e.data);if(e.asNodeBuffer&&St)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?h_(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Oj(e){return e&&e.name.slice(-4)===".bin"?ow(e):lw(e)}function wn(e,t){for(var r=e.FullPaths||jr(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),s=a.replace(/\\/g,"/"),l=0;l<r.length;++l){var o=r[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==o||s==o)return e.files?e.files[r[l]]:e.FileIndex[l]}return null}function hx(e,t){var r=wn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Pr(e,t,r){if(!r)return Oj(hx(e,t));if(!t)return null;try{return Pr(e,t)}catch{return null}}function sn(e,t,r){if(!r)return lw(hx(e,t));if(!t)return null;try{return sn(e,t)}catch{return null}}function Cj(e,t,r){return ow(hx(e,t))}function k_(e){for(var t=e.FullPaths||jr(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function bt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return St?a=Es(r):a=KN(r),at.utils.cfb_add(e,t,a)}at.utils.cfb_add(e,t,r)}else e.file(t,r)}function mx(){return at.utils.cfb_new()}function cw(e,t){switch(t.type){case"base64":return at.read(e,{type:"base64"});case"binary":return at.read(e,{type:"binary"});case"buffer":case"array":return at.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function mc(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var s=a.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Dr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Rj=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,N_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Dj=/<[^>]*>/g,Sa=Dr.match(N_)?N_:Dj,Fj=/<\w*:/,Mj=/<(\/?)\w+:/;function ht(e,t,r){for(var a={},s=0,l=0;s!==e.length&&!((l=e.charCodeAt(s))===32||l===10||l===13);++s);if(t||(a[0]=e.slice(0,s)),s===e.length)return a;var o=e.match(Rj),u=0,h="",d=0,x="",g="",p=1;if(o)for(d=0;d!=o.length;++d){for(g=o[d],l=0;l!=g.length&&g.charCodeAt(l)!==61;++l);for(x=g.slice(0,l).trim();g.charCodeAt(l+1)==32;)++l;for(p=(s=g.charCodeAt(l+1))==34||s==39?1:0,h=g.slice(l+1+p,g.length-p),u=0;u!=x.length&&x.charCodeAt(u)!==58;++u);if(u===x.length)x.indexOf("_")>0&&(x=x.slice(0,x.indexOf("_"))),a[x]=h,a[x.toLowerCase()]=h;else{var y=(u===5&&x.slice(0,5)==="xmlns"?"xmlns":"")+x.slice(u+1);if(a[y]&&x.slice(u-3,u)=="ext")continue;a[y]=h,a[y.toLowerCase()]=h}}return a}function Jn(e){return e.replace(Mj,"<$1")}var uw={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},xx=Yf(uw),Ft=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var s=a+"",l=s.indexOf("<![CDATA[");if(l==-1)return s.replace(e,function(u,h){return uw[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,h){return String.fromCharCode(parseInt(h,16))});var o=s.indexOf("]]>");return r(s.slice(0,l))+s.slice(l+9,o)+r(s.slice(o+3))}})(),px=/[&<>'"]/g,Ij=/[\u0000-\u0008\u000b-\u001f]/g;function er(e){var t=e+"";return t.replace(px,function(r){return xx[r]}).replace(Ij,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function j_(e){return er(e).replace(/ /g,"_x0020_")}var fw=/[\u0000-\u001f]/g;function gx(e){var t=e+"";return t.replace(px,function(r){return xx[r]}).replace(/\n/g,"<br/>").replace(fw,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Lj(e){var t=e+"";return t.replace(px,function(r){return xx[r]}).replace(fw,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var A_=(function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}})();function Bj(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function dr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Em(e){for(var t="",r=0,a=0,s=0,l=0,o=0,u=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),a>191&&a<224){o=(a&31)<<6,o|=s&63,t+=String.fromCharCode(o);continue}if(l=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(s&63)<<6|l&63);continue}o=e.charCodeAt(r++),u=((a&7)<<18|(s&63)<<12|(l&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function O_(e){var t=ni(2*e.length),r,a,s=1,l=0,o=0,u;for(a=0;a<e.length;a+=s)s=1,(u=e.charCodeAt(a))<128?r=u:u<224?(r=(u&31)*64+(e.charCodeAt(a+1)&63),s=2):u<240?(r=(u&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),s=3):(s=4,r=(u&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[l++]=o&255,t[l++]=o>>>8,o=0),t[l++]=r%256,t[l++]=r>>>8;return t.slice(0,l).toString("ucs2")}function C_(e){return Es(e,"binary").toString("utf8")}var df="foo bar baz",sr=St&&(C_(df)==Em(df)&&C_||O_(df)==Em(df)&&O_)||Em,Yn=St?function(e){return Es(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,s=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,s=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},Mc=(function(){var e={};return function(r,a){var s=r+"|"+(a||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}})(),dw=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)a=a.replace(e[s][0],e[s][1]);return a}})(),Pj=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),Uj=/<\/?(?:vt:)?variant>/g,zj=/<(?:vt:)([^>]*)>([\s\S]*)</;function R_(e,t){var r=ht(e),a=e.match(Pj(r.baseType))||[],s=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return s}return a.forEach(function(l){var o=l.replace(Uj,"").match(zj);o&&s.push({v:sr(o[2]),t:o[1]})}),s}var hw=/(^\s|\s$|\n)/;function ca(e,t){return"<"+e+(t.match(hw)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Ic(e){return jr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ze(e,t,r){return"<"+e+(r!=null?Ic(r):"")+(t!=null?(t.match(hw)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Xm(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function Hj(e,t){switch(typeof e){case"string":var r=ze("vt:lpwstr",er(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ze((e|0)==e?"vt:i4":"vt:r8",er(String(e)));case"boolean":return ze("vt:bool",e?"true":"false")}if(e instanceof Date)return ze("vt:filetime",Xm(e));throw new Error("Unable to serialize "+e)}function vx(e){if(St&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return sr(oi(ux(e)));throw new Error("Bad input format: expected Buffer or string")}var Lc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Wr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ki=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],tn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function qj(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,l=5;l>=0;--l)s=s*256+e[t+l];return a==2047?s==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,s+=Math.pow(2,52)),r*Math.pow(2,a-52)*s)}function $j(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,s=0,l=0,o=a?-t:t;isFinite(o)?o==0?s=l=0:(s=Math.floor(Math.log(o)/Math.LN2),l=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?s=-1022:(l-=Math.pow(2,52),s+=1023)):(s=2047,l=isNaN(t)?26985:0);for(var u=0;u<=5;++u,l/=256)e[r+u]=l&255;e[r+6]=(s&15)<<4|l&15,e[r+7]=s>>4|a}var D_=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var s=0,l=e[0][a].length;s<l;s+=r)t.push.apply(t,e[0][a].slice(s,s+r));return t},F_=St?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Es(t)})):D_(e)}:D_,M_=function(e,t,r){for(var a=[],s=t;s<r;s+=2)a.push(String.fromCharCode(vs(e,s)));return a.join("").replace(Oa,"")},yx=St?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Oa,""):M_(e,t,r)}:M_,I_=function(e,t,r){for(var a=[],s=t;s<t+r;++s)a.push(("0"+e[s].toString(16)).slice(-2));return a.join("")},mw=St?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):I_(e,t,r)}:I_,L_=function(e,t,r){for(var a=[],s=t;s<r;s++)a.push(String.fromCharCode(Kl(e,s)));return a.join("")},Qc=St?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):L_(t,r,a)}:L_,xw=function(e,t){var r=rn(e,t);return r>0?Qc(e,t+4,t+4+r-1):""},pw=xw,gw=function(e,t){var r=rn(e,t);return r>0?Qc(e,t+4,t+4+r-1):""},vw=gw,yw=function(e,t){var r=2*rn(e,t);return r>0?Qc(e,t+4,t+4+r-1):""},_w=yw,bw=function(t,r){var a=rn(t,r);return a>0?yx(t,r+4,r+4+a):""},ww=bw,Sw=function(e,t){var r=rn(e,t);return r>0?Qc(e,t+4,t+4+r):""},Ew=Sw,Tw=function(e,t){return qj(e,t)},Of=Tw,_x=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};St&&(pw=function(t,r){if(!Buffer.isBuffer(t))return xw(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},vw=function(t,r){if(!Buffer.isBuffer(t))return gw(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},_w=function(t,r){if(!Buffer.isBuffer(t))return yw(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},ww=function(t,r){if(!Buffer.isBuffer(t))return bw(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},Ew=function(t,r){if(!Buffer.isBuffer(t))return Sw(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},Of=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Tw(t,r)},_x=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Kl=function(e,t){return e[t]},vs=function(e,t){return e[t+1]*256+e[t]},Gj=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},rn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ii=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Vj=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function gc(e,t){var r="",a,s,l=[],o,u,h,d;switch(t){case"dbcs":if(d=this.l,St&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(h=0;h<e;++h)r+=String.fromCharCode(vs(this,d)),d+=2;e*=2;break;case"utf8":r=Qc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=yx(this,this.l,this.l+e);break;case"wstr":return gc.call(this,e,"dbcs");case"lpstr-ansi":r=pw(this,this.l),e=4+rn(this,this.l);break;case"lpstr-cp":r=vw(this,this.l),e=4+rn(this,this.l);break;case"lpwstr":r=_w(this,this.l),e=4+2*rn(this,this.l);break;case"lpp4":e=4+rn(this,this.l),r=ww(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+rn(this,this.l),r=Ew(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Kl(this,this.l+e++))!==0;)l.push(ff(o));r=l.join("");break;case"_wstr":for(e=0,r="";(o=vs(this,this.l+e))!==0;)l.push(ff(o)),e+=2;e+=2,r=l.join("");break;case"dbcs-cont":for(r="",d=this.l,h=0;h<e;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Kl(this,d),this.l=d+1,u=gc.call(this,e-h,o?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(ff(vs(this,d))),d+=2}r=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,h=0;h!=e;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Kl(this,d),this.l=d+1,u=gc.call(this,e-h,o?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(ff(Kl(this,d))),d+=1}r=l.join("");break;default:switch(e){case 1:return a=Kl(this,this.l),this.l++,a;case 2:return a=(t==="i"?Gj:vs)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(e>0?Ii:Vj)(this,this.l),this.l+=4,a):(s=rn(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=Of(this,this.l):s=Of([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=mw(this,this.l,e);break}}return this.l+=e,r}var Xj=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Wj=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Kj=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Yj(e,t,r){var a=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)Kj(this,t.charCodeAt(s),this.l+2*s);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;a=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var l=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var o=t.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,Xj(this,t,this.l);break;case 8:if(a=8,r==="f"){$j(this,t,this.l);break}case 16:break;case-4:a=4,Wj(this,t,this.l);break}return this.l+=a,this}function kw(e,t){var r=mw(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function oa(e,t){e.l=t,e.read_shift=gc,e.chk=kw,e.write_shift=Yj}function wa(e,t){e.l+=t}function be(e){var t=ni(e);return oa(t,0),t}function Ts(e,t,r){if(e){var a,s,l;oa(e,e.l||0);for(var o=e.length,u=0,h=0;e.l<o;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var d=qc[u]||qc[65535];for(a=e.read_shift(1),l=a&127,s=1;s<4&&a&128;++s)l+=((a=e.read_shift(1))&127)<<7*s;h=e.l+l;var x=d.f&&d.f(e,l,r);if(e.l=h,t(x,d,u))return}}}function za(){var e=[],t=St?256:2048,r=function(d){var x=be(d);return oa(x,0),x},a=r(t),s=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},l=function(d){return a&&d<a.length-a.l?a:(s(),a=r(Math.max(d+1,t)))},o=function(){return s(),Qr(e)},u=function(d){s(),a=d,a.l==null&&(a.l=a.length),l(t)};return{next:l,push:u,end:o,_bufs:e}}function Re(e,t,r,a){var s=+t,l;if(!isNaN(s)){a||(a=qc[s].p||(r||[]).length||0),l=1+(s>=128?1:0)+1,a>=128&&++l,a>=16384&&++l,a>=2097152&&++l;var o=e.next(l);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var u=0;u!=4;++u)if(a>=128)o.write_shift(1,(a&127)+128),a>>=7;else{o.write_shift(1,a);break}a>0&&_x(r)&&e.push(r)}}function vc(e,t,r){var a=mr(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function B_(e,t,r){var a=mr(e);return a.s=vc(a.s,t.s,r),a.e=vc(a.e,t.s,r),a}function yc(e,t){if(e.cRel&&e.c<0)for(e=mr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=mr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=dt(e);return!e.cRel&&e.cRel!=null&&(r=Zj(r)),!e.rRel&&e.rRel!=null&&(r=Jj(r)),r}function Tm(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+vr(e.s.c)+":"+(e.e.cRel?"":"$")+vr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Rr(e.s.r)+":"+(e.e.rRel?"":"$")+Rr(e.e.r):yc(e.s,t.biff)+":"+yc(e.e,t.biff)}function bx(e){return parseInt(Qj(e),10)-1}function Rr(e){return""+(e+1)}function Jj(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Qj(e){return e.replace(/\$(\d+)$/,"$1")}function wx(e){for(var t=eA(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function vr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Zj(e){return e.replace(/^([A-Z])/,"$$$1")}function eA(e){return e.replace(/^\$([A-Z])/,"$1")}function tA(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function yr(e){for(var t=0,r=0,a=0;a<e.length;++a){var s=e.charCodeAt(a);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function dt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ha(e){var t=e.indexOf(":");return t==-1?{s:yr(e),e:yr(e)}:{s:yr(e.slice(0,t)),e:yr(e.slice(t+1))}}function yt(e,t){return typeof t>"u"||typeof t=="number"?yt(e.s,e.e):(typeof e!="string"&&(e=dt(e)),typeof t!="string"&&(t=dt(t)),e==t?e:e+":"+t)}function Mt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,s=0,l=e.length;for(r=0;a<l&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.s.c=--r,r=0;a<l&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;if(t.s.r=--r,a===l||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=l&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.e.c=--r,r=0;a!=l&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;return t.e.r=--r,t}function P_(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Tn(e.z,r?Kr(t):t)}catch{}try{return e.w=Tn((e.XF||{}).numFmtId||(r?14:0),r?Kr(t):t)}catch{return""+t}}function ws(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ks[e.v]||e.v:t==null?P_(e,e.v):P_(e,t))}function ci(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function Nw(e,t,r){var a=r||{},s=e?Array.isArray(e):a.dense,l=e||(s?[]:{}),o=0,u=0;if(l&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var h=typeof a.origin=="string"?yr(a.origin):a.origin;o=h.r,u=h.c}l["!ref"]||(l["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var x=Mt(l["!ref"]);d.s.c=x.s.c,d.s.r=x.s.r,d.e.c=Math.max(d.e.c,x.e.c),d.e.r=Math.max(d.e.r,x.e.r),o==-1&&(d.e.r=o=x.e.r+1)}for(var g=0;g!=t.length;++g)if(t[g]){if(!Array.isArray(t[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[g].length;++p)if(!(typeof t[g][p]>"u")){var y={v:t[g][p]},w=o+g,_=u+p;if(d.s.r>w&&(d.s.r=w),d.s.c>_&&(d.s.c=_),d.e.r<w&&(d.e.r=w),d.e.c<_&&(d.e.c=_),t[g][p]&&typeof t[g][p]=="object"&&!Array.isArray(t[g][p])&&!(t[g][p]instanceof Date))y=t[g][p];else if(Array.isArray(y.v)&&(y.f=t[g][p][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(a.nullError)y.t="e",y.v=0;else if(a.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=a.dateNF||ut[14],a.cellDates?(y.t="d",y.w=Tn(y.z,Kr(y.v))):(y.t="n",y.v=Kr(y.v),y.w=Tn(y.z,y.v))):y.t="s";if(s)l[w]||(l[w]=[]),l[w][_]&&l[w][_].z&&(y.z=l[w][_].z),l[w][_]=y;else{var S=dt({c:_,r:w});l[S]&&l[S].z&&(y.z=l[S].z),l[S]=y}}}return d.s.c<1e7&&(l["!ref"]=yt(d)),l}function uo(e,t){return Nw(null,e,t)}function rA(e){return e.read_shift(4,"i")}function Un(e,t){return t||(t=be(4)),t.write_shift(4,e),t}function ba(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Zr(e,t){var r=!1;return t==null&&(r=!0,t=be(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function aA(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function nA(e,t){return t||(t=be(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Sx(e,t){var r=e.l,a=e.read_shift(1),s=ba(e),l=[],o={t:s,h:s};if((a&1)!==0){for(var u=e.read_shift(4),h=0;h!=u;++h)l.push(aA(e));o.r=l}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function sA(e,t){var r=!1;return t==null&&(r=!0,t=be(15+4*e.t.length)),t.write_shift(1,0),Zr(e.t,t),r?t.slice(0,t.l):t}var iA=Sx;function lA(e,t){var r=!1;return t==null&&(r=!0,t=be(23+4*e.t.length)),t.write_shift(1,1),Zr(e.t,t),t.write_shift(4,1),nA({},t),r?t.slice(0,t.l):t}function kn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Yi(e,t){return t==null&&(t=be(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Ji(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Qi(e,t){return t==null&&(t=be(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var oA=ba,jw=Zr;function Ex(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Cf(e,t){var r=!1;return t==null&&(r=!0,t=be(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var cA=ba,Wm=Ex,Tx=Cf;function kx(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var s=a===0?Of([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ii(t,0)>>2;return r?s/100:s}function Aw(e,t){t==null&&(t=be(4));var r=0,a=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Ow(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function uA(e,t){return t||(t=be(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Zi=Ow,fo=uA;function _a(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Gi(e,t){return(t||be(8)).write_shift(8,e,"f")}function fA(e){var t={},r=e.read_shift(1),a=r>>>1,s=e.read_shift(1),l=e.read_shift(2,"i"),o=e.read_shift(1),u=e.read_shift(1),h=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=s;var d=Pi[s];d&&(t.rgb=Pc(d));break;case 2:t.rgb=Pc([o,u,h]);break;case 3:t.theme=s;break}return l!=0&&(t.tint=l>0?l/32767:l/32768),t}function Rf(e,t){if(t||(t=be(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function dA(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function hA(e,t){t||(t=be(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function Cw(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function mA(e){return Cw(e,1)}function xA(e){return Cw(e,2)}var Nx=2,Ua=3,hf=11,U_=12,Df=19,mf=64,pA=65,gA=71,vA=4108,yA=4126,Jr=80,Rw=81,_A=[Jr,Rw],Km={1:{n:"CodePage",t:Nx},2:{n:"Category",t:Jr},3:{n:"PresentationFormat",t:Jr},4:{n:"ByteCount",t:Ua},5:{n:"LineCount",t:Ua},6:{n:"ParagraphCount",t:Ua},7:{n:"SlideCount",t:Ua},8:{n:"NoteCount",t:Ua},9:{n:"HiddenCount",t:Ua},10:{n:"MultimediaClipCount",t:Ua},11:{n:"ScaleCrop",t:hf},12:{n:"HeadingPairs",t:vA},13:{n:"TitlesOfParts",t:yA},14:{n:"Manager",t:Jr},15:{n:"Company",t:Jr},16:{n:"LinksUpToDate",t:hf},17:{n:"CharacterCount",t:Ua},19:{n:"SharedDoc",t:hf},22:{n:"HyperlinksChanged",t:hf},23:{n:"AppVersion",t:Ua,p:"version"},24:{n:"DigSig",t:pA},26:{n:"ContentType",t:Jr},27:{n:"ContentStatus",t:Jr},28:{n:"Language",t:Jr},29:{n:"Version",t:Jr},255:{},2147483648:{n:"Locale",t:Df},2147483651:{n:"Behavior",t:Df},1919054434:{}},Ym={1:{n:"CodePage",t:Nx},2:{n:"Title",t:Jr},3:{n:"Subject",t:Jr},4:{n:"Author",t:Jr},5:{n:"Keywords",t:Jr},6:{n:"Comments",t:Jr},7:{n:"Template",t:Jr},8:{n:"LastAuthor",t:Jr},9:{n:"RevNumber",t:Jr},10:{n:"EditTime",t:mf},11:{n:"LastPrinted",t:mf},12:{n:"CreatedDate",t:mf},13:{n:"ModifiedDate",t:mf},14:{n:"PageCount",t:Ua},15:{n:"WordCount",t:Ua},16:{n:"CharCount",t:Ua},17:{n:"Thumbnail",t:gA},18:{n:"Application",t:Jr},19:{n:"DocSecurity",t:Ua},255:{},2147483648:{n:"Locale",t:Df},2147483651:{n:"Behavior",t:Df},1919054434:{}},z_={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},bA=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function wA(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var SA=wA([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Pi=mr(SA),ks={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Dw={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Jm={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},xf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function jx(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function EA(e){var t=jx();if(!e||!e.match)return t;var r={};if((e.match(Sa)||[]).forEach(function(a){var s=ht(a);switch(s[0].replace(Fj,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[Jm[s.ContentType]]!==void 0&&t[Jm[s.ContentType]].push(s.PartName);break}}),t.xmlns!==Wr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function Fw(e,t){var r=Ej(Jm),a=[],s;a[a.length]=Dr,a[a.length]=ze("Types",null,{xmlns:Wr.CT,"xmlns:xsd":Wr.xsd,"xmlns:xsi":Wr.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return ze("Default",null,{Extension:h[0],ContentType:h[1]})}));var l=function(h){e[h]&&e[h].length>0&&(s=e[h][0],a[a.length]=ze("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:xf[h][t.bookType]||xf[h].xlsx}))},o=function(h){(e[h]||[]).forEach(function(d){a[a.length]=ze("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:xf[h][t.bookType]||xf[h].xlsx})})},u=function(h){(e[h]||[]).forEach(function(d){a[a.length]=ze("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[h][0]})})};return l("workbooks"),o("sheets"),o("charts"),u("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),o("metadata"),u("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var Et={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Bc(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function _c(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(Sa)||[]).forEach(function(s){var l=ht(s);if(l[0]==="<Relationship"){var o={};o.Type=l.Type,o.Target=l.Target,o.Id=l.Id,l.TargetMode&&(o.TargetMode=l.TargetMode);var u=l.TargetMode==="External"?l.Target:mc(l.Target,t);r[u]=o,a[l.Id]=o}}),r["!id"]=a,r}function eo(e){var t=[Dr,ze("Relationships",null,{xmlns:Wr.RELS})];return jr(e["!id"]).forEach(function(r){t[t.length]=ze("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Zt(e,t,r,a,s,l){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=a,s.Target=r,[Et.HLINK,Et.XPATH,Et.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var TA="application/vnd.oasis.opendocument.spreadsheet";function kA(e,t){for(var r=vx(e),a,s;a=Lc.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(s=ht(a[0],!1),s.path=="/"&&s.type!==TA)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function NA(e){var t=[Dr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function H_(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function jA(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function AA(e){var t=[Dr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(H_(e[r][0],e[r][1])),t.push(jA("",e[r][0]));return t.push(H_("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Mw(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Tf.version+"</meta:generator></office:meta></office:document-meta>"}var En=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],OA=(function(){for(var e=new Array(En.length),t=0;t<En.length;++t){var r=En[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e})();function Iw(e){var t={};e=sr(e);for(var r=0;r<En.length;++r){var a=En[r],s=e.match(OA[r]);s!=null&&s.length>0&&(t[a[1]]=Ft(s[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=hr(t[a[1]]))}return t}function km(e,t,r,a,s){s[e]!=null||t==null||t===""||(s[e]=t,t=er(t),a[a.length]=r?ze(e,t,r):ca(e,t))}function Lw(e,t){var r=t||{},a=[Dr,ze("cp:coreProperties",null,{"xmlns:cp":Wr.CORE_PROPS,"xmlns:dc":Wr.dc,"xmlns:dcterms":Wr.dcterms,"xmlns:dcmitype":Wr.dcmitype,"xmlns:xsi":Wr.xsi})],s={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&km("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Xm(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s),e.ModifiedDate!=null&&km("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Xm(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s));for(var l=0;l!=En.length;++l){var o=En[l],u=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&km(o[0],u,null,a,s)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var Ui=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Bw=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Pw(e,t,r,a){var s=[];if(typeof e=="string")s=R_(e,a);else for(var l=0;l<e.length;++l)s=s.concat(e[l].map(function(x){return{v:x}}));var o=typeof t=="string"?R_(t,a).map(function(x){return x.v}):t,u=0,h=0;if(o.length>0)for(var d=0;d!==s.length;d+=2){switch(h=+s[d+1].v,s[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=h,r.SheetNames=o.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=h,r.DefinedNames=o.slice(u,u+h);break;case"Charts":case"Diagramme":r.Chartsheets=h,r.ChartNames=o.slice(u,u+h);break}u+=h}}function CA(e,t,r){var a={};return t||(t={}),e=sr(e),Ui.forEach(function(s){var l=(e.match(Mc(s[0]))||[])[1];switch(s[2]){case"string":l&&(t[s[1]]=Ft(l));break;case"bool":t[s[1]]=l==="true";break;case"raw":var o=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(a[s[1]]=o[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&Pw(a.HeadingPairs,a.TitlesOfParts,t,r),t}function Uw(e){var t=[],r=ze;return e||(e={}),e.Application="SheetJS",t[t.length]=Dr,t[t.length]=ze("Properties",null,{xmlns:Wr.EXT_PROPS,"xmlns:vt":Wr.vt}),Ui.forEach(function(a){if(e[a[1]]!==void 0){var s;switch(a[2]){case"string":s=er(String(e[a[1]]));break;case"bool":s=e[a[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(a[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+er(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var RA=/<[^>]+>[^<]*/g;function DA(e,t){var r={},a="",s=e.match(RA);if(s)for(var l=0;l!=s.length;++l){var o=s[l],u=ht(o);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Ft(u.name);break;case"</property>":a=null;break;default:if(o.indexOf("<vt:")===0){var h=o.split(">"),d=h[0].slice(4),x=h[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[a]=Ft(x);break;case"bool":r[a]=dr(x);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(x,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(x);break;case"filetime":case"date":r[a]=hr(x);break;case"cy":case"error":r[a]=Ft(x);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,h)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function zw(e){var t=[Dr,ze("Properties",null,{xmlns:Wr.CUST_PROPS,"xmlns:vt":Wr.vt})];if(!e)return t.join("");var r=1;return jr(e).forEach(function(s){++r,t[t.length]=ze("property",Hj(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:er(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Qm={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Nm;function FA(e,t,r){Nm||(Nm=Yf(Qm)),t=Nm[t]||t,e[t]=r}function MA(e,t){var r=[];return jr(Qm).map(function(a){for(var s=0;s<En.length;++s)if(En[s][1]==a)return En[s];for(s=0;s<Ui.length;++s)if(Ui[s][1]==a)return Ui[s];throw a}).forEach(function(a){if(e[a[1]]!=null){var s=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(ca(Qm[a[1]]||a[1],s))}}),ze("DocumentProperties",r.join(""),{xmlns:tn.o})}function IA(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",s=[];return e&&jr(e).forEach(function(l){if(Object.prototype.hasOwnProperty.call(e,l)){for(var o=0;o<En.length;++o)if(l==En[o][1])return;for(o=0;o<Ui.length;++o)if(l==Ui[o][1])return;for(o=0;o<r.length;++o)if(l==r[o])return;var u=e[l],h="string";typeof u=="number"?(h="float",u=String(u)):u===!0||u===!1?(h="boolean",u=u?"1":"0"):u=String(u),s.push(ze(j_(l),u,{"dt:dt":h}))}}),t&&jr(t).forEach(function(l){if(Object.prototype.hasOwnProperty.call(t,l)&&!(e&&Object.prototype.hasOwnProperty.call(e,l))){var o=t[l],u="string";typeof o=="number"?(u="float",o=String(o)):o===!0||o===!1?(u="boolean",o=o?"1":"0"):o instanceof Date?(u="dateTime.tz",o=o.toISOString()):o=String(o),s.push(ze(j_(l),o,{"dt:dt":u}))}}),"<"+a+' xmlns="'+tn.o+'">'+s.join("")+"</"+a+">"}function Ax(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function LA(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),s=(r-a)/Math.pow(2,32);a*=1e7,s*=1e7;var l=a/Math.pow(2,32)|0;l>0&&(a=a%Math.pow(2,32),s+=l);var o=be(8);return o.write_shift(4,a),o.write_shift(4,s),o}function Hw(e,t,r){var a=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return s}function qw(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function $w(e,t,r){return t===31?qw(e):Hw(e,t,r)}function Zm(e,t,r){return $w(e,t,r===!1?0:4)}function BA(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return $w(e,t,0)}function PA(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var s=e.l;r[a]=e.read_shift(0,"lpwstr").replace(Oa,""),e.l-s&2&&(e.l+=2)}return r}function UA(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(Oa,"");return r}function zA(e){var t=e.l,r=Ff(e,Rw);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=Ff(e,Ua);return[r,a]}function HA(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(zA(e));return r}function q_(e,t){for(var r=e.read_shift(4),a={},s=0;s!=r;++s){var l=e.read_shift(4),o=e.read_shift(4);a[l]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Oa,"").replace(hc,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function Gw(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function qA(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Ff(e,t,r){var a=e.read_shift(2),s,l=r||{};if(e.l+=2,t!==U_&&a!==t&&_A.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===U_?a:t){case 2:return s=e.read_shift(2,"i"),l.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return Hw(e,a,4).replace(Oa,"");case 31:return qw(e);case 64:return Ax(e);case 65:return Gw(e);case 71:return qA(e);case 80:return Zm(e,a,!l.raw).replace(Oa,"");case 81:return BA(e,a).replace(Oa,"");case 4108:return HA(e);case 4126:case 4127:return a==4127?PA(e):UA(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function $_(e,t){var r=be(4),a=be(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=be(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=LA(t);break;case 31:case 80:for(a=be(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Qr([r,a])}function G_(e,t){var r=e.l,a=e.read_shift(4),s=e.read_shift(4),l=[],o=0,u=0,h=-1,d={};for(o=0;o!=s;++o){var x=e.read_shift(4),g=e.read_shift(4);l[o]=[x,g+r]}l.sort(function(N,E){return N[1]-E[1]});var p={};for(o=0;o!=s;++o){if(e.l!==l[o][1]){var y=!0;if(o>0&&t)switch(t[l[o-1][0]].t){case 2:e.l+2===l[o][1]&&(e.l+=2,y=!1);break;case 80:e.l<=l[o][1]&&(e.l=l[o][1],y=!1);break;case 4108:e.l<=l[o][1]&&(e.l=l[o][1],y=!1);break}if((!t||o==0)&&e.l<=l[o][1]&&(y=!1,e.l=l[o][1]),y)throw new Error("Read Error: Expected address "+l[o][1]+" at "+e.l+" :"+o)}if(t){var w=t[l[o][0]];if(p[w.n]=Ff(e,w.t,{raw:!0}),w.p==="version"&&(p[w.n]=String(p[w.n]>>16)+"."+("0000"+String(p[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(p[w.n]){case 0:p[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ln(u=p[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[w.n])}}else if(l[o][0]===1){if(u=p.CodePage=Ff(e,Nx),Ln(u),h!==-1){var _=e.l;e.l=l[h][1],d=q_(e,u),e.l=_}}else if(l[o][0]===0){if(u===0){h=o,e.l=l[o+1][1];continue}d=q_(e,u)}else{var S=d[l[o][0]],T;switch(e[e.l]){case 65:e.l+=4,T=Gw(e);break;case 30:e.l+=4,T=Zm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,T=Zm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,T=e.read_shift(4,"i");break;case 19:e.l+=4,T=e.read_shift(4);break;case 5:e.l+=4,T=e.read_shift(8,"f");break;case 11:e.l+=4,T=Cr(e,4);break;case 64:e.l+=4,T=hr(Ax(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[S]=T}}return e.l=r+a,p}var Vw=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function $A(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function V_(e,t,r){var a=be(8),s=[],l=[],o=8,u=0,h=be(8),d=be(8);if(h.write_shift(4,2),h.write_shift(4,1200),d.write_shift(4,1),l.push(h),s.push(d),o+=8+h.length,!t){d=be(8),d.write_shift(4,0),s.unshift(d);var x=[be(4)];for(x[0].write_shift(4,e.length),u=0;u<e.length;++u){var g=e[u][0];for(h=be(8+2*(g.length+1)+(g.length%2?0:2)),h.write_shift(4,u+2),h.write_shift(4,g.length+1),h.write_shift(0,g,"dbcs");h.l!=h.length;)h.write_shift(1,0);x.push(h)}h=Qr(x),l.unshift(h),o+=8+h.length}for(u=0;u<e.length;++u)if(!(t&&!t[e[u][0]])&&!(Vw.indexOf(e[u][0])>-1||Bw.indexOf(e[u][0])>-1)&&e[u][1]!=null){var p=e[u][1],y=0;if(t){y=+t[e[u][0]];var w=r[y];if(w.p=="version"&&typeof p=="string"){var _=p.split(".");p=(+_[0]<<16)+(+_[1]||0)}h=$_(w.t,p)}else{var S=$A(p);S==-1&&(S=31,p=String(p)),h=$_(S,p)}l.push(h),d=be(8),d.write_shift(4,t?y:2+u),s.push(d),o+=8+h.length}var T=8*(l.length+1);for(u=0;u<l.length;++u)s[u].write_shift(4,T),T+=l[u].length;return a.write_shift(4,o),a.write_shift(4,l.length),Qr([a].concat(s).concat(l))}function X_(e,t,r){var a=e.content;if(!a)return{};oa(a,0);var s,l,o,u,h=0;a.chk("feff","Byte Order: "),a.read_shift(2);var d=a.read_shift(4),x=a.read_shift(16);if(x!==at.utils.consts.HEADER_CLSID&&x!==r)throw new Error("Bad PropertySet CLSID "+x);if(s=a.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(l=a.read_shift(16),u=a.read_shift(4),s===1&&u!==a.l)throw new Error("Length mismatch: "+u+" !== "+a.l);s===2&&(o=a.read_shift(16),h=a.read_shift(4));var g=G_(a,t),p={SystemIdentifier:d};for(var y in g)p[y]=g[y];if(p.FMTID=l,s===1)return p;if(h-a.l==2&&(a.l+=2),a.l!==h)throw new Error("Length mismatch 2: "+a.l+" !== "+h);var w;try{w=G_(a,null)}catch{}for(y in w)p[y]=w[y];return p.FMTID=[l,o],p}function W_(e,t,r,a,s,l){var o=be(s?68:48),u=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,at.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,s?68:48);var h=V_(e,r,a);if(u.push(h),s){var d=V_(s,null,null);o.write_shift(16,l,"hex"),o.write_shift(4,68+h.length),u.push(d)}return Qr(u)}function Qs(e,t){return e.read_shift(t),null}function GA(e,t){t||(t=be(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function VA(e,t,r){for(var a=[],s=e.l+t;e.l<s;)a.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return a}function Cr(e,t){return e.read_shift(t)===1}function Aa(e,t){return t||(t=be(2)),t.write_shift(2,+!!e),t}function Ur(e){return e.read_shift(2,"u")}function Sn(e,t){return t||(t=be(2)),t.write_shift(2,e),t}function Xw(e,t){return VA(e,t,Ur)}function XA(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Ww(e,t,r){return r||(r=be(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Zc(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var l=e.read_shift(1);l&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=a?e.read_shift(a,s):"";return o}function WA(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,s=r&8,l=1+(r&1),o=0,u,h={};s&&(o=e.read_shift(2)),a&&(u=e.read_shift(4));var d=l==2?"dbcs-cont":"sbcs-cont",x=t===0?"":e.read_shift(t,d);return s&&(e.l+=4*o),a&&(e.l+=u),h.t=x,s||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function KA(e){var t=e.t||"",r=be(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=be(2*t.length);a.write_shift(2*t.length,t,"utf16le");var s=[r,a];return Qr(s)}function Vi(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function eu(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):Vi(e,a,r)}function el(e,t,r){if(r.biff>5)return eu(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Kw(e,t,r){return r||(r=be(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function YA(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function JA(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var s=e.read_shift((a?t-24:t)>>1,"utf16le").replace(Oa,"");return a&&(e.l+=24),s}function QA(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+a.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(l>>1,"utf16le").replace(Oa,"");return r+o}function ZA(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return JA(e);case"0303000000000000c000000000000046":return QA(e);default:throw new Error("Unsupported Moniker "+r)}}function pf(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Oa,""):"";return r}function K_(e,t){t||(t=be(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function e3(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var s=e.read_shift(2);e.l+=2;var l,o,u,h,d="",x,g;s&16&&(l=pf(e,r-e.l)),s&128&&(o=pf(e,r-e.l)),(s&257)===257&&(u=pf(e,r-e.l)),(s&257)===1&&(h=ZA(e,r-e.l)),s&8&&(d=pf(e,r-e.l)),s&32&&(x=e.read_shift(16)),s&64&&(g=Ax(e)),e.l=r;var p=o||u||h||"";p&&d&&(p+="#"+d),p||(p="#"+d),s&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var y={Target:p};return x&&(y.guid=x),g&&(y.time=g),l&&(y.Tooltip=l),y}function t3(e){var t=be(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var s=a.indexOf("#"),l=s>-1?31:23;switch(a.charAt(0)){case"#":l=28;break;case".":l&=-3;break}t.write_shift(4,2),t.write_shift(4,l);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(l==28)a=a.slice(1),K_(a,t);else if(l&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var u=s>-1?a.slice(0,s):a;for(t.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)t.write_shift(2,u.charCodeAt(r));t.write_shift(2,0),l&8&&K_(s>-1?a.slice(s+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var h=0;a.slice(h*3,h*3+3)=="../"||a.slice(h*3,h*3+3)=="..\\";)++h;for(t.write_shift(2,h),t.write_shift(4,a.length-3*h+1),r=0;r<a.length-3*h;++r)t.write_shift(1,a.charCodeAt(r+3*h)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Yw(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(1);return[t,r,a,s]}function Jw(e,t){var r=Yw(e);return r[3]=0,r}function Qn(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function Xi(e,t,r,a){return a||(a=be(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function r3(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function a3(e,t,r){return t===0?"":el(e,t,r)}function n3(e,t,r){var a=r.biff>8?4:2,s=e.read_shift(a),l=e.read_shift(a,"i"),o=e.read_shift(a,"i");return[s,l,o]}function Qw(e){var t=e.read_shift(2),r=kx(e);return[t,r]}function s3(e,t,r){e.l+=4,t-=4;var a=e.l+t,s=Zc(e,t,r),l=e.read_shift(2);if(a-=e.l,l!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+l);return e.l+=l,s}function Zf(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return{s:{c:a,r:t},e:{c:s,r}}}function Zw(e,t){return t||(t=be(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function e2(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1);return{s:{c:a,r:t},e:{c:s,r}}}var i3=e2;function t2(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function l3(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function o3(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function pa(e){e.l+=2,e.l+=e.read_shift(2)}var c3={0:pa,4:pa,5:pa,6:pa,7:o3,8:pa,9:pa,10:pa,11:pa,12:pa,13:l3,14:pa,15:pa,16:pa,17:pa,18:pa,19:pa,20:pa,21:t2};function u3(e,t){for(var r=e.l+t,a=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{a.push(c3[s](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function gf(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Ox(e,t,r){var a=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,s=8;break;case"biff4":a=4,s=6;break;case"biff3":a=3,s=6;break;case"biff2":a=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=be(s);return l.write_shift(2,a),l.write_shift(2,t),s>4&&l.write_shift(2,29282),s>6&&l.write_shift(2,1997),s>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function f3(e,t){return t===0||e.read_shift(2),1200}function d3(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,s=el(e,0,r);return e.read_shift(t+a-e.l),s}function h3(e,t){var r=!t||t.biff==8,a=be(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function m3(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function x3(e,t,r){var a=e.read_shift(4),s=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var o=Zc(e,0,r);return o.length===0&&(o="Sheet1"),{pos:a,hs:s,dt:l,name:o}}function p3(e,t){var r=!t||t.biff>=8?2:1,a=be(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=a.slice(0,a.l);return s.l=a.l,s}function g3(e,t){for(var r=e.l+t,a=e.read_shift(4),s=e.read_shift(4),l=[],o=0;o!=s&&e.l<r;++o)l.push(WA(e));return l.Count=a,l.Unique=s,l}function v3(e,t){var r=be(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],s=0;s<e.length;++s)a[s]=KA(e[s]);var l=Qr([r].concat(a));return l.parts=[r.length].concat(a.map(function(o){return o.length})),l}function y3(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function _3(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function b3(e){var t=r3(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function w3(e){return e.read_shift(2),e.read_shift(4)}function Y_(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(a=1-(s>>15),s&=32767);var l={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[l,s]}function S3(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2),h=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[a,s],Flags:l,CurTab:o,FirstTab:u,Selected:h,TabRatio:d}}function E3(){var e=be(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function T3(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function k3(e){var t=be(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function N3(){}function j3(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=Zc(e,0,r),a}function A3(e,t){var r=e.name||"Arial",a=t&&t.biff==5,s=a?15+r.length:16+2*r.length,l=be(s);return l.write_shift(2,e.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,r.length),a||l.write_shift(1,1),l.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),l}function O3(e){var t=Qn(e);return t.isst=e.read_shift(4),t}function C3(e,t,r,a){var s=be(10);return Xi(e,t,a,s),s.write_shift(4,r),s}function R3(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,s=Qn(e);r.biff==2&&e.l++;var l=eu(e,a-e.l,r);return s.val=l,s}function D3(e,t,r,a,s){var l=!s||s.biff==8,o=be(8+ +l+(1+l)*r.length);return Xi(e,t,a,o),o.write_shift(2,r.length),l&&o.write_shift(1,1),o.write_shift((1+l)*r.length,r,l?"utf16le":"sbcs"),o}function F3(e,t,r){var a=e.read_shift(2),s=el(e,0,r);return[a,s]}function M3(e,t,r,a){var s=r&&r.biff==5;a||(a=be(s?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(s?1:2,t.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var l=a.length>a.l?a.slice(0,a.l):a;return l.l==null&&(l.l=l.length),l}var I3=el;function J_(e,t,r){var a=e.l+t,s=r.biff==8||!r.biff?4:2,l=e.read_shift(s),o=e.read_shift(s),u=e.read_shift(2),h=e.read_shift(2);return e.l=a,{s:{r:l,c:u},e:{r:o,c:h}}}function L3(e,t){var r=t.biff==8||!t.biff?4:2,a=be(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function B3(e){var t=e.read_shift(2),r=e.read_shift(2),a=Qw(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function P3(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),l=[];e.l<r;)l.push(Qw(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(l.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:a,c:s,C:o,rkrec:l}}function U3(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),l=[];e.l<r;)l.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(l.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:a,c:s,C:o,ixfe:l}}function z3(e,t,r,a){var s={},l=e.read_shift(4),o=e.read_shift(4),u=e.read_shift(4),h=e.read_shift(2);return s.patternType=bA[u>>26],a.cellStyles&&(s.alc=l&7,s.fWrap=l>>3&1,s.alcV=l>>4&7,s.fJustLast=l>>7&1,s.trot=l>>8&255,s.cIndent=l>>16&15,s.fShrinkToFit=l>>20&1,s.iReadOrder=l>>22&2,s.fAtrNum=l>>26&1,s.fAtrFnt=l>>27&1,s.fAtrAlc=l>>28&1,s.fAtrBdr=l>>29&1,s.fAtrPat=l>>30&1,s.fAtrProt=l>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=u&127,s.icvBottom=u>>7&127,s.icvDiag=u>>14&127,s.dgDiag=u>>21&15,s.icvFore=h&127,s.icvBack=h>>7&127,s.fsxButton=h>>14&1),s}function H3(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=z3(e,t,a.fStyle,r),a}function Q_(e,t,r,a){var s=r&&r.biff==5;a||(a=be(s?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var l=0;return e.numFmtId>0&&s&&(l|=1024),a.write_shift(4,l),a.write_shift(4,0),s||a.write_shift(4,0),a.write_shift(2,0),a}function q3(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function $3(e){var t=be(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Z_(e,t,r){var a=Qn(e);(r.biff==2||t==9)&&++e.l;var s=XA(e);return a.val=s,a.t=s===!0||s===!1?"b":"e",a}function G3(e,t,r,a,s,l){var o=be(8);return Xi(e,t,a,o),Ww(r,l,o),o}function V3(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=Qn(e),s=_a(e);return a.val=s,a}function X3(e,t,r,a){var s=be(14);return Xi(e,t,a,s),Gi(r,s),s}var eb=a3;function W3(e,t,r){var a=e.l+t,s=e.read_shift(2),l=e.read_shift(2);if(r.sbcch=l,l==1025||l==14849)return[l,s];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var o=Vi(e,l),u=[];a>e.l;)u.push(eu(e));return[l,s,o,u]}function tb(e,t,r){var a=e.read_shift(2),s,l={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(s=s3(e,t-2,r)),l.body=s||e.read_shift(t-2),typeof s=="string"&&(l.Name=s),l}var K3=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function rb(e,t,r){var a=e.l+t,s=e.read_shift(2),l=e.read_shift(1),o=e.read_shift(1),u=e.read_shift(r&&r.biff==2?1:2),h=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),h=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=Vi(e,o,r);s&32&&(d=K3[d.charCodeAt(0)]);var x=a-e.l;r&&r.biff==2&&--x;var g=a==e.l||u===0||!(x>0)?[]:u8(e,x,r,u);return{chKey:l,Name:d,itab:h,rgce:g}}function r2(e,t,r){if(r.biff<8)return Y3(e,t,r);for(var a=[],s=e.l+t,l=e.read_shift(r.biff>8?4:2);l--!==0;)a.push(n3(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return a}function Y3(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=Zc(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function J3(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),s=e.read_shift(2),l=Vi(e,a,r),o=Vi(e,s,r);return[l,o]}function Q3(e,t,r){var a=e2(e);e.l++;var s=e.read_shift(1);return t-=8,[f8(e,t,r),s,a]}function ab(e,t,r){var a=i3(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,o8(e,t,r)]}function Z3(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function eO(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),u=el(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:s},u,o,l]}}function tO(e,t,r){return eO(e,t,r)}function rO(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(Zf(e));return r}function aO(e){var t=be(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Zw(e[r],t);return t}function nO(e,t,r){if(r&&r.biff<8)return iO(e,t,r);var a=t2(e),s=u3(e,t-22,a[1]);return{cmo:a,ft:s}}var sO={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:a}}};function iO(e,t,r){e.l+=4;var a=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((sO[a]||wa)(e,t,r)),{cmo:[s,a,l],ft:o}}function lO(e,t,r){var a=e.l,s="";try{e.l+=4;var l=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:o=YA(e,6,r);var u=e.read_shift(2);e.read_shift(2),Ur(e,2);var h=e.read_shift(2);e.l+=h;for(var d=1;d<e.lens.length-1;++d){if(e.l-a!=e.lens[d])throw new Error("TxO: bad continue record");var x=e[e.l],g=Vi(e,e.lens[d+1]-e.lens[d]-1);if(s+=g,s.length>=(x?u:2*u))break}if(s.length!==u&&s.length!==u*2)throw new Error("cchText: "+u+" != "+s.length);return e.l=a+t,{t:s}}catch{return e.l=a+t,{t:s}}}function oO(e,t){var r=Zf(e);e.l+=16;var a=e3(e,t-24);return[r,a]}function cO(e){var t=be(24),r=yr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(a[s],16));return Qr([t,t3(e[1])])}function uO(e,t){e.read_shift(2);var r=Zf(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(Oa,""),[r,a]}function fO(e){var t=e[1].Tooltip,r=be(10+2*(t.length+1));r.write_shift(2,2048);var a=yr(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function dO(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=z_[r]||r,r=e.read_shift(2),t[1]=z_[r]||r,t}function hO(e){return e||(e=be(4)),e.write_shift(2,1),e.write_shift(2,1),e}function mO(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Jw(e));return r}function xO(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Jw(e));return r}function pO(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function a2(e,t,r){if(!r.cellStyles)return wa(e,t);var a=r&&r.biff>=12?4:2,s=e.read_shift(a),l=e.read_shift(a),o=e.read_shift(a),u=e.read_shift(a),h=e.read_shift(2);a==2&&(e.l+=2);var d={s,e:l,w:o,ixfe:u,flags:h};return(r.biff>=5||!r.biff)&&(d.level=h>>8&7),d}function gO(e,t){var r=be(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function vO(e,t){var r={};return t<32||(e.l+=16,r.header=_a(e),r.footer=_a(e),e.l+=2),r}function yO(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var s=e.read_shift(1);return e.l+=3,s&16&&(a.area=!0),a}function _O(e){for(var t=be(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var bO=Qn,wO=Xw,SO=eu;function EO(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,s}function TO(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=Qn(e);++e.l;var s=el(e,t-7,r);return a.t="str",a.val=s,a}function kO(e){var t=Qn(e);++e.l;var r=_a(e);return t.t="n",t.val=r,t}function NO(e,t,r){var a=be(15);return nu(a,e,t),a.write_shift(8,r,"f"),a}function jO(e){var t=Qn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function AO(e,t,r){var a=be(9);return nu(a,e,t),a.write_shift(2,r),a}function OO(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function CO(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function RO(e,t,r){var a=e.l+t,s=Qn(e),l=e.read_shift(2),o=Vi(e,l,r);return e.l=a,s.t="str",s.val=o,s}var DO=[2,3,48,49,131,139,140,245],ex=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Yf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,h){var d=[],x=ni(1);switch(h.type){case"base64":x=nn(ln(u));break;case"binary":x=nn(u);break;case"buffer":case"array":x=u;break}oa(x,0);var g=x.read_shift(1),p=!!(g&136),y=!1,w=!1;switch(g){case 2:break;case 3:break;case 48:y=!0,p=!0;break;case 49:y=!0,p=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var _=0,S=521;g==2&&(_=x.read_shift(2)),x.l+=3,g!=2&&(_=x.read_shift(4)),_>1048576&&(_=1e6),g!=2&&(S=x.read_shift(2));var T=x.read_shift(2),N=h.codepage||1252;g!=2&&(x.l+=16,x.read_shift(1),x[x.l]!==0&&(N=e[x[x.l]]),x.l+=1,x.l+=2),w&&(x.l+=36);for(var E=[],D={},G=Math.min(x.length,g==2?521:S-10-(y?264:0)),V=w?32:11;x.l<G&&x[x.l]!=13;)switch(D={},D.name=Rc.utils.decode(N,x.slice(x.l,x.l+V)).replace(/[\u0000\r\n].*$/g,""),x.l+=V,D.type=String.fromCharCode(x.read_shift(1)),g!=2&&!w&&(D.offset=x.read_shift(4)),D.len=x.read_shift(1),g==2&&(D.offset=x.read_shift(2)),D.dec=x.read_shift(1),D.name.length&&E.push(D),g!=2&&(x.l+=w?13:14),D.type){case"B":(!y||D.len!=8)&&h.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+D.type)}if(x[x.l]!==13&&(x.l=S-1),x.read_shift(1)!==13)throw new Error("DBF Terminator not found "+x.l+" "+x[x.l]);x.l=S;var A=0,M=0;for(d[0]=[],M=0;M!=E.length;++M)d[0][M]=E[M].name;for(;_-- >0;){if(x[x.l]===42){x.l+=T;continue}for(++x.l,d[++A]=[],M=0,M=0;M!=E.length;++M){var C=x.slice(x.l,x.l+E[M].len);x.l+=E[M].len,oa(C,0);var U=Rc.utils.decode(N,C);switch(E[M].type){case"C":U.trim().length&&(d[A][M]=U.replace(/\s+$/,""));break;case"D":U.length===8?d[A][M]=new Date(+U.slice(0,4),+U.slice(4,6)-1,+U.slice(6,8)):d[A][M]=U;break;case"F":d[A][M]=parseFloat(U.trim());break;case"+":case"I":d[A][M]=w?C.read_shift(-4,"i")^2147483648:C.read_shift(4,"i");break;case"L":switch(U.trim().toUpperCase()){case"Y":case"T":d[A][M]=!0;break;case"N":case"F":d[A][M]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+U+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));d[A][M]="##MEMO##"+(w?parseInt(U.trim(),10):C.read_shift(4));break;case"N":U=U.replace(/\u0000/g,"").trim(),U&&U!="."&&(d[A][M]=+U||0);break;case"@":d[A][M]=new Date(C.read_shift(-8,"f")-621356832e5);break;case"T":d[A][M]=new Date((C.read_shift(4)-2440588)*864e5+C.read_shift(4));break;case"Y":d[A][M]=C.read_shift(4,"i")/1e4+C.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[A][M]=-C.read_shift(-8,"f");break;case"B":if(y&&E[M].len==8){d[A][M]=C.read_shift(8,"f");break}case"G":case"P":C.l+=E[M].len;break;case"0":if(E[M].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[M].type)}}}if(g!=2&&x.l<x.length&&x[x.l++]!=26)throw new Error("DBF EOF Marker missing "+(x.l-1)+" of "+x.length+" "+x[x.l-1].toString(16));return h&&h.sheetRows&&(d=d.slice(0,h.sheetRows)),h.DBF=E,d}function a(u,h){var d=h||{};d.dateNF||(d.dateNF="yyyymmdd");var x=uo(r(u,d),d);return x["!cols"]=d.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete d.DBF,x}function s(u,h){try{return ci(a(u,h),h)}catch(d){if(h&&h.WTF)throw d}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function o(u,h){var d=h||{};if(+d.codepage>=0&&Ln(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var x=za(),g=Bf(u,{header:1,raw:!0,cellDates:!0}),p=g[0],y=g.slice(1),w=u["!cols"]||[],_=0,S=0,T=0,N=1;for(_=0;_<p.length;++_){if(((w[_]||{}).DBF||{}).name){p[_]=w[_].DBF.name,++T;continue}if(p[_]!=null){if(++T,typeof p[_]=="number"&&(p[_]=p[_].toString(10)),typeof p[_]!="string")throw new Error("DBF Invalid column name "+p[_]+" |"+typeof p[_]+"|");if(p.indexOf(p[_])!==_){for(S=0;S<1024;++S)if(p.indexOf(p[_]+"_"+S)==-1){p[_]+="_"+S;break}}}}var E=Mt(u["!ref"]),D=[],G=[],V=[];for(_=0;_<=E.e.c-E.s.c;++_){var A="",M="",C=0,U=[];for(S=0;S<y.length;++S)y[S][_]!=null&&U.push(y[S][_]);if(U.length==0||p[_]==null){D[_]="?";continue}for(S=0;S<U.length;++S){switch(typeof U[S]){case"number":M="B";break;case"string":M="C";break;case"boolean":M="L";break;case"object":M=U[S]instanceof Date?"D":"C";break;default:M="C"}C=Math.max(C,String(U[S]).length),A=A&&A!=M?"C":M}C>250&&(C=250),M=((w[_]||{}).DBF||{}).type,M=="C"&&w[_].DBF.len>C&&(C=w[_].DBF.len),A=="B"&&M=="N"&&(A="N",V[_]=w[_].DBF.dec,C=w[_].DBF.len),G[_]=A=="C"||M=="N"?C:l[A]||0,N+=G[_],D[_]=A}var Z=x.next(32);for(Z.write_shift(4,318902576),Z.write_shift(4,y.length),Z.write_shift(2,296+32*T),Z.write_shift(2,N),_=0;_<4;++_)Z.write_shift(4,0);for(Z.write_shift(4,0|(+t[Vb]||3)<<8),_=0,S=0;_<p.length;++_)if(p[_]!=null){var q=x.next(32),le=(p[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);q.write_shift(1,le,"sbcs"),q.write_shift(1,D[_]=="?"?"C":D[_],"sbcs"),q.write_shift(4,S),q.write_shift(1,G[_]||l[D[_]]||0),q.write_shift(1,V[_]||0),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(1,0),q.write_shift(4,0),q.write_shift(4,0),S+=G[_]||l[D[_]]||0}var ge=x.next(264);for(ge.write_shift(4,13),_=0;_<65;++_)ge.write_shift(4,0);for(_=0;_<y.length;++_){var Se=x.next(N);for(Se.write_shift(1,0),S=0;S<p.length;++S)if(p[S]!=null)switch(D[S]){case"L":Se.write_shift(1,y[_][S]==null?63:y[_][S]?84:70);break;case"B":Se.write_shift(8,y[_][S]||0,"f");break;case"N":var te="0";for(typeof y[_][S]=="number"&&(te=y[_][S].toFixed(V[S]||0)),T=0;T<G[S]-te.length;++T)Se.write_shift(1,32);Se.write_shift(1,te,"sbcs");break;case"D":y[_][S]?(Se.write_shift(4,("0000"+y[_][S].getFullYear()).slice(-4),"sbcs"),Se.write_shift(2,("00"+(y[_][S].getMonth()+1)).slice(-2),"sbcs"),Se.write_shift(2,("00"+y[_][S].getDate()).slice(-2),"sbcs")):Se.write_shift(8,"00000000","sbcs");break;case"C":var ae=String(y[_][S]!=null?y[_][S]:"").slice(0,G[S]);for(Se.write_shift(1,ae,"sbcs"),T=0;T<G[S]-ae.length;++T)Se.write_shift(1,32);break}}return x.next(1).write_shift(1,26),x.end()}return{to_workbook:s,to_sheet:a,from_sheet:o}})(),n2=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+jr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,y){var w=e[y];return typeof w=="number"?m_(w):w},a=function(p,y,w){var _=y.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return _==59?p:m_(_)};e["|"]=254;function s(p,y){switch(y.type){case"base64":return l(ln(p),y);case"binary":return l(p,y);case"buffer":return l(St&&Buffer.isBuffer(p)?p.toString("binary"):oi(p),y);case"array":return l($i(p),y)}throw new Error("Unrecognized type "+y.type)}function l(p,y){var w=p.split(/[\n\r]+/),_=-1,S=-1,T=0,N=0,E=[],D=[],G=null,V={},A=[],M=[],C=[],U=0,Z;for(+y.codepage>=0&&Ln(+y.codepage);T!==w.length;++T){U=0;var q=w[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),le=q.replace(/;;/g,"\0").split(";").map(function(F){return F.replace(/\u0000/g,";")}),ge=le[0],Se;if(q.length>0)switch(ge){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":le[1].charAt(0)=="P"&&D.push(q.slice(3).replace(/;;/g,";"));break;case"C":var te=!1,ae=!1,De=!1,ie=!1,Me=-1,W=-1;for(N=1;N<le.length;++N)switch(le[N].charAt(0)){case"A":break;case"X":S=parseInt(le[N].slice(1))-1,ae=!0;break;case"Y":for(_=parseInt(le[N].slice(1))-1,ae||(S=0),Z=E.length;Z<=_;++Z)E[Z]=[];break;case"K":Se=le[N].slice(1),Se.charAt(0)==='"'?Se=Se.slice(1,Se.length-1):Se==="TRUE"?Se=!0:Se==="FALSE"?Se=!1:isNaN(Pn(Se))?isNaN(ao(Se).getDate())||(Se=hr(Se)):(Se=Pn(Se),G!==null&&oo(G)&&(Se=Qf(Se))),te=!0;break;case"E":ie=!0;var O=to(le[N].slice(1),{r:_,c:S});E[_][S]=[E[_][S],O];break;case"S":De=!0,E[_][S]=[E[_][S],"S5S"];break;case"G":break;case"R":Me=parseInt(le[N].slice(1))-1;break;case"C":W=parseInt(le[N].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+q)}if(te&&(E[_][S]&&E[_][S].length==2?E[_][S][0]=Se:E[_][S]=Se,G=null),De){if(ie)throw new Error("SYLK shared formula cannot have own formula");var P=Me>-1&&E[Me][W];if(!P||!P[1])throw new Error("SYLK shared formula cannot find base");E[_][S][1]=w2(P[1],{r:_-Me,c:S-W})}break;case"F":var z=0;for(N=1;N<le.length;++N)switch(le[N].charAt(0)){case"X":S=parseInt(le[N].slice(1))-1,++z;break;case"Y":for(_=parseInt(le[N].slice(1))-1,Z=E.length;Z<=_;++Z)E[Z]=[];break;case"M":U=parseInt(le[N].slice(1))/20;break;case"F":break;case"G":break;case"P":G=D[parseInt(le[N].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(C=le[N].slice(1).split(" "),Z=parseInt(C[0],10);Z<=parseInt(C[1],10);++Z)U=parseInt(C[2],10),M[Z-1]=U===0?{hidden:!0}:{wch:U},si(M[Z-1]);break;case"C":S=parseInt(le[N].slice(1))-1,M[S]||(M[S]={});break;case"R":_=parseInt(le[N].slice(1))-1,A[_]||(A[_]={}),U>0?(A[_].hpt=U,A[_].hpx=so(U)):U===0&&(A[_].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+q)}z<1&&(G=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+q)}}return A.length>0&&(V["!rows"]=A),M.length>0&&(V["!cols"]=M),y&&y.sheetRows&&(E=E.slice(0,y.sheetRows)),[E,V]}function o(p,y){var w=s(p,y),_=w[0],S=w[1],T=uo(_,y);return jr(S).forEach(function(N){T[N]=S[N]}),T}function u(p,y){return ci(o(p,y),y)}function h(p,y,w,_){var S="C;Y"+(w+1)+";X"+(_+1)+";K";switch(p.t){case"n":S+=p.v||0,p.f&&!p.F&&(S+=";E"+Ix(p.f,{r:w,c:_}));break;case"b":S+=p.v?"TRUE":"FALSE";break;case"e":S+=p.w||p.v;break;case"d":S+='"'+(p.w||p.v)+'"';break;case"s":S+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function d(p,y){y.forEach(function(w,_){var S="F;W"+(_+1)+" "+(_+1)+" ";w.hidden?S+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=Uc(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=zc(w.wpx)),typeof w.wch=="number"&&(S+=Math.round(w.wch))),S.charAt(S.length-1)!=" "&&p.push(S)})}function x(p,y){y.forEach(function(w,_){var S="F;";w.hidden?S+="M0;":w.hpt?S+="M"+20*w.hpt+";":w.hpx&&(S+="M"+20*Hc(w.hpx)+";"),S.length>2&&p.push(S+"R"+(_+1))})}function g(p,y){var w=["ID;PWXL;N;E"],_=[],S=Mt(p["!ref"]),T,N=Array.isArray(p),E=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),p["!cols"]&&d(w,p["!cols"]),p["!rows"]&&x(w,p["!rows"]),w.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var D=S.s.r;D<=S.e.r;++D)for(var G=S.s.c;G<=S.e.c;++G){var V=dt({r:D,c:G});T=N?(p[D]||[])[G]:p[V],!(!T||T.v==null&&(!T.f||T.F))&&_.push(h(T,p,D,G))}return w.join(E)+E+_.join(E)+E+"E"+E}return{to_workbook:u,to_sheet:o,from_sheet:g}})(),s2=(function(){function e(l,o){switch(o.type){case"base64":return t(ln(l),o);case"binary":return t(l,o);case"buffer":return t(St&&Buffer.isBuffer(l)?l.toString("binary"):oi(l),o);case"array":return t($i(l),o)}throw new Error("Unrecognized type "+o.type)}function t(l,o){for(var u=l.split(`
`),h=-1,d=-1,x=0,g=[];x!==u.length;++x){if(u[x].trim()==="BOT"){g[++h]=[],d=0;continue}if(!(h<0)){var p=u[x].trim().split(","),y=p[0],w=p[1];++x;for(var _=u[x]||"";(_.match(/["]/g)||[]).length&1&&x<u.length-1;)_+=`
`+u[++x];switch(_=_.trim(),+y){case-1:if(_==="BOT"){g[++h]=[],d=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?g[h][d]=!0:_==="FALSE"?g[h][d]=!1:isNaN(Pn(w))?isNaN(ao(w).getDate())?g[h][d]=w:g[h][d]=hr(w):g[h][d]=Pn(w),++d;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),g[h][d++]=_!==""?_:null;break}if(_==="EOD")break}}return o&&o.sheetRows&&(g=g.slice(0,o.sheetRows)),g}function r(l,o){return uo(e(l,o),o)}function a(l,o){return ci(r(l,o),o)}var s=(function(){var l=function(h,d,x,g,p){h.push(d),h.push(x+","+g),h.push('"'+p.replace(/"/g,'""')+'"')},o=function(h,d,x,g){h.push(d+","+x),h.push(d==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(h){var d=[],x=Mt(h["!ref"]),g,p=Array.isArray(h);l(d,"TABLE",0,1,"sheetjs"),l(d,"VECTORS",0,x.e.r-x.s.r+1,""),l(d,"TUPLES",0,x.e.c-x.s.c+1,""),l(d,"DATA",0,0,"");for(var y=x.s.r;y<=x.e.r;++y){o(d,-1,0,"BOT");for(var w=x.s.c;w<=x.e.c;++w){var _=dt({r:y,c:w});if(g=p?(h[y]||[])[w]:h[_],!g){o(d,1,0,"");continue}switch(g.t){case"n":var S=g.w;!S&&g.v!=null&&(S=g.v),S==null?g.f&&!g.F?o(d,1,0,"="+g.f):o(d,1,0,""):o(d,0,S,"V");break;case"b":o(d,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=Tn(g.z||ut[14],Kr(hr(g.v)))),o(d,0,g.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var T=`\r
`,N=d.join(T);return N}})();return{to_workbook:a,to_sheet:r,from_sheet:s}})(),i2=(function(){function e(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(g,p){for(var y=g.split(`
`),w=-1,_=-1,S=0,T=[];S!==y.length;++S){var N=y[S].trim().split(":");if(N[0]==="cell"){var E=yr(N[1]);if(T.length<=E.r)for(w=T.length;w<=E.r;++w)T[w]||(T[w]=[]);switch(w=E.r,_=E.c,N[2]){case"t":T[w][_]=e(N[3]);break;case"v":T[w][_]=+N[3];break;case"vtf":var D=N[N.length-1];case"vtc":switch(N[3]){case"nl":T[w][_]=!!+N[4];break;default:T[w][_]=+N[4];break}N[2]=="vtf"&&(T[w][_]=[T[w][_],D])}}}return p&&p.sheetRows&&(T=T.slice(0,p.sheetRows)),T}function a(g,p){return uo(r(g,p),p)}function s(g,p){return ci(a(g,p),p)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function d(g){if(!g||!g["!ref"])return"";for(var p=[],y=[],w,_="",S=Ha(g["!ref"]),T=Array.isArray(g),N=S.s.r;N<=S.e.r;++N)for(var E=S.s.c;E<=S.e.c;++E)if(_=dt({r:N,c:E}),w=T?(g[N]||[])[E]:g[_],!(!w||w.v==null||w.t==="z")){switch(y=["cell",_,"t"],w.t){case"s":case"str":y.push(t(w.v));break;case"n":w.f?(y[2]="vtf",y[3]="n",y[4]=w.v,y[5]=t(w.f)):(y[2]="v",y[3]=w.v);break;case"b":y[2]="vt"+(w.f?"f":"c"),y[3]="nl",y[4]=w.v?"1":"0",y[5]=t(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var D=Kr(hr(w.v));y[2]="vtc",y[3]="nd",y[4]=""+D,y[5]=w.w||Tn(w.z||ut[14],D);break;case"e":continue}p.push(y.join(":"))}return p.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function x(g){return[l,o,u,o,d(g),h].join(`
`)}return{to_workbook:s,to_sheet:a,from_sheet:x}})(),no=(function(){function e(x,g,p,y,w){w.raw?g[p][y]=x:x===""||(x==="TRUE"?g[p][y]=!0:x==="FALSE"?g[p][y]=!1:isNaN(Pn(x))?isNaN(ao(x).getDate())?g[p][y]=x:g[p][y]=hr(x):g[p][y]=Pn(x))}function t(x,g){var p=g||{},y=[];if(!x||x.length===0)return y;for(var w=x.split(/[\r\n]/),_=w.length-1;_>=0&&w[_].length===0;)--_;for(var S=10,T=0,N=0;N<=_;++N)T=w[N].indexOf(" "),T==-1?T=w[N].length:T++,S=Math.max(S,T);for(N=0;N<=_;++N){y[N]=[];var E=0;for(e(w[N].slice(0,S).trim(),y,N,E,p),E=1;E<=(w[N].length-S)/10+1;++E)e(w[N].slice(S+(E-1)*10,S+E*10).trim(),y,N,E,p)}return p.sheetRows&&(y=y.slice(0,p.sheetRows)),y}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function s(x){for(var g={},p=!1,y=0,w=0;y<x.length;++y)(w=x.charCodeAt(y))==34?p=!p:!p&&w in r&&(g[w]=(g[w]||0)+1);w=[];for(y in g)Object.prototype.hasOwnProperty.call(g,y)&&w.push([g[y],y]);if(!w.length){g=a;for(y in g)Object.prototype.hasOwnProperty.call(g,y)&&w.push([g[y],y])}return w.sort(function(_,S){return _[0]-S[0]||a[_[1]]-a[S[1]]}),r[w.pop()[1]]||44}function l(x,g){var p=g||{},y="",w=p.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};x.slice(0,4)=="sep="?x.charCodeAt(5)==13&&x.charCodeAt(6)==10?(y=x.charAt(4),x=x.slice(7)):x.charCodeAt(5)==13||x.charCodeAt(5)==10?(y=x.charAt(4),x=x.slice(6)):y=s(x.slice(0,1024)):p&&p.FS?y=p.FS:y=s(x.slice(0,1024));var S=0,T=0,N=0,E=0,D=0,G=y.charCodeAt(0),V=!1,A=0,M=x.charCodeAt(0);x=x.replace(/\r\n/mg,`
`);var C=p.dateNF!=null?yj(p.dateNF):null;function U(){var Z=x.slice(E,D),q={};if(Z.charAt(0)=='"'&&Z.charAt(Z.length-1)=='"'&&(Z=Z.slice(1,-1).replace(/""/g,'"')),Z.length===0)q.t="z";else if(p.raw)q.t="s",q.v=Z;else if(Z.trim().length===0)q.t="s",q.v=Z;else if(Z.charCodeAt(0)==61)Z.charCodeAt(1)==34&&Z.charCodeAt(Z.length-1)==34?(q.t="s",q.v=Z.slice(2,-1).replace(/""/g,'"')):W5(Z)?(q.t="n",q.f=Z.slice(1)):(q.t="s",q.v=Z);else if(Z=="TRUE")q.t="b",q.v=!0;else if(Z=="FALSE")q.t="b",q.v=!1;else if(!isNaN(N=Pn(Z)))q.t="n",p.cellText!==!1&&(q.w=Z),q.v=N;else if(!isNaN(ao(Z).getDate())||C&&Z.match(C)){q.z=p.dateNF||ut[14];var le=0;C&&Z.match(C)&&(Z=_j(Z,p.dateNF,Z.match(C)||[]),le=1),p.cellDates?(q.t="d",q.v=hr(Z,le)):(q.t="n",q.v=Kr(hr(Z,le))),p.cellText!==!1&&(q.w=Tn(q.z,q.v instanceof Date?Kr(q.v):q.v)),p.cellNF||delete q.z}else q.t="s",q.v=Z;if(q.t=="z"||(p.dense?(w[S]||(w[S]=[]),w[S][T]=q):w[dt({c:T,r:S})]=q),E=D+1,M=x.charCodeAt(E),_.e.c<T&&(_.e.c=T),_.e.r<S&&(_.e.r=S),A==G)++T;else if(T=0,++S,p.sheetRows&&p.sheetRows<=S)return!0}e:for(;D<x.length;++D)switch(A=x.charCodeAt(D)){case 34:M===34&&(V=!V);break;case G:case 10:case 13:if(!V&&U())break e;break}return D-E>0&&U(),w["!ref"]=yt(_),w}function o(x,g){return!(g&&g.PRN)||g.FS||x.slice(0,4)=="sep="||x.indexOf("	")>=0||x.indexOf(",")>=0||x.indexOf(";")>=0?l(x,g):uo(t(x,g),g)}function u(x,g){var p="",y=g.type=="string"?[0,0,0,0]:$x(x,g);switch(g.type){case"base64":p=ln(x);break;case"binary":p=x;break;case"buffer":g.codepage==65001?p=x.toString("utf8"):g.codepage&&typeof Rc<"u"||(p=St&&Buffer.isBuffer(x)?x.toString("binary"):oi(x));break;case"array":p=$i(x);break;case"string":p=x;break;default:throw new Error("Unrecognized type "+g.type)}return y[0]==239&&y[1]==187&&y[2]==191?p=sr(p.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?p=sr(p):g.type=="binary"&&typeof Rc<"u",p.slice(0,19)=="socialcalc:version:"?i2.to_sheet(g.type=="string"?p:sr(p),g):o(p,g)}function h(x,g){return ci(u(x,g),g)}function d(x){for(var g=[],p=Mt(x["!ref"]),y,w=Array.isArray(x),_=p.s.r;_<=p.e.r;++_){for(var S=[],T=p.s.c;T<=p.e.c;++T){var N=dt({r:_,c:T});if(y=w?(x[_]||[])[T]:x[N],!y||y.v==null){S.push("          ");continue}for(var E=(y.w||(ws(y),y.w)||"").slice(0,10);E.length<10;)E+=" ";S.push(E+(T===0?" ":""))}g.push(S.join(""))}return g.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:d}})();function FO(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var s=n2.to_workbook(e,r);return r.WTF=a,s}catch(l){if(r.WTF=a,!l.message.match(/SYLK bad record ID/)&&a)throw l;return no.to_workbook(e,t)}}var zi=(function(){function e(O,P,z){if(O){oa(O,O.l||0);for(var F=z.Enum||Me;O.l<O.length;){var Q=O.read_shift(2),re=F[Q]||F[65535],Ee=O.read_shift(2),ye=O.l+Ee,Oe=re.f&&re.f(O,Ee,z);if(O.l=ye,P(Oe,re,Q))return}}}function t(O,P){switch(P.type){case"base64":return r(nn(ln(O)),P);case"binary":return r(nn(O),P);case"buffer":case"array":return r(O,P)}throw"Unsupported type "+P.type}function r(O,P){if(!O)return O;var z=P||{},F=z.dense?[]:{},Q="Sheet1",re="",Ee=0,ye={},Oe=[],tt=[],J={s:{r:0,c:0},e:{r:0,c:0}},wt=z.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)z.Enum=Me,e(O,function(Ce,Ae,Ge){switch(Ge){case 0:z.vers=Ce,Ce>=4096&&(z.qpro=!0);break;case 6:J=Ce;break;case 204:Ce&&(re=Ce);break;case 222:re=Ce;break;case 15:case 51:z.qpro||(Ce[1].v=Ce[1].v.slice(1));case 13:case 14:case 16:Ge==14&&(Ce[2]&112)==112&&(Ce[2]&15)>1&&(Ce[2]&15)<15&&(Ce[1].z=z.dateNF||ut[14],z.cellDates&&(Ce[1].t="d",Ce[1].v=Qf(Ce[1].v))),z.qpro&&Ce[3]>Ee&&(F["!ref"]=yt(J),ye[Q]=F,Oe.push(Q),F=z.dense?[]:{},J={s:{r:0,c:0},e:{r:0,c:0}},Ee=Ce[3],Q=re||"Sheet"+(Ee+1),re="");var mt=z.dense?(F[Ce[0].r]||[])[Ce[0].c]:F[dt(Ce[0])];if(mt){mt.t=Ce[1].t,mt.v=Ce[1].v,Ce[1].z!=null&&(mt.z=Ce[1].z),Ce[1].f!=null&&(mt.f=Ce[1].f);break}z.dense?(F[Ce[0].r]||(F[Ce[0].r]=[]),F[Ce[0].r][Ce[0].c]=Ce[1]):F[dt(Ce[0])]=Ce[1];break}},z);else if(O[2]==26||O[2]==14)z.Enum=W,O[2]==14&&(z.qpro=!0,O.l=0),e(O,function(Ce,Ae,Ge){switch(Ge){case 204:Q=Ce;break;case 22:Ce[1].v=Ce[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ce[3]>Ee&&(F["!ref"]=yt(J),ye[Q]=F,Oe.push(Q),F=z.dense?[]:{},J={s:{r:0,c:0},e:{r:0,c:0}},Ee=Ce[3],Q="Sheet"+(Ee+1)),wt>0&&Ce[0].r>=wt)break;z.dense?(F[Ce[0].r]||(F[Ce[0].r]=[]),F[Ce[0].r][Ce[0].c]=Ce[1]):F[dt(Ce[0])]=Ce[1],J.e.c<Ce[0].c&&(J.e.c=Ce[0].c),J.e.r<Ce[0].r&&(J.e.r=Ce[0].r);break;case 27:Ce[14e3]&&(tt[Ce[14e3][0]]=Ce[14e3][1]);break;case 1537:tt[Ce[0]]=Ce[1],Ce[0]==Ee&&(Q=Ce[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(F["!ref"]=yt(J),ye[re||Q]=F,Oe.push(re||Q),!tt.length)return{SheetNames:Oe,Sheets:ye};for(var et={},gt=[],it=0;it<tt.length;++it)ye[Oe[it]]?(gt.push(tt[it]||Oe[it]),et[tt[it]]=ye[tt[it]]||ye[Oe[it]]):(gt.push(tt[it]),et[tt[it]]={"!ref":"A1"});return{SheetNames:gt,Sheets:et}}function a(O,P){var z=P||{};if(+z.codepage>=0&&Ln(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var F=za(),Q=Mt(O["!ref"]),re=Array.isArray(O),Ee=[];He(F,0,l(1030)),He(F,6,h(Q));for(var ye=Math.min(Q.e.r,8191),Oe=Q.s.r;Oe<=ye;++Oe)for(var tt=Rr(Oe),J=Q.s.c;J<=Q.e.c;++J){Oe===Q.s.r&&(Ee[J]=vr(J));var wt=Ee[J]+tt,et=re?(O[Oe]||[])[J]:O[wt];if(!(!et||et.t=="z"))if(et.t=="n")(et.v|0)==et.v&&et.v>=-32768&&et.v<=32767?He(F,13,y(Oe,J,et.v)):He(F,14,_(Oe,J,et.v));else{var gt=ws(et);He(F,15,g(Oe,J,gt.slice(0,239)))}}return He(F,1),F.end()}function s(O,P){var z=P||{};if(+z.codepage>=0&&Ln(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var F=za();He(F,0,o(O));for(var Q=0,re=0;Q<O.SheetNames.length;++Q)(O.Sheets[O.SheetNames[Q]]||{})["!ref"]&&He(F,27,ie(O.SheetNames[Q],re++));var Ee=0;for(Q=0;Q<O.SheetNames.length;++Q){var ye=O.Sheets[O.SheetNames[Q]];if(!(!ye||!ye["!ref"])){for(var Oe=Mt(ye["!ref"]),tt=Array.isArray(ye),J=[],wt=Math.min(Oe.e.r,8191),et=Oe.s.r;et<=wt;++et)for(var gt=Rr(et),it=Oe.s.c;it<=Oe.e.c;++it){et===Oe.s.r&&(J[it]=vr(it));var Ce=J[it]+gt,Ae=tt?(ye[et]||[])[it]:ye[Ce];if(!(!Ae||Ae.t=="z"))if(Ae.t=="n")He(F,23,U(et,it,Ee,Ae.v));else{var Ge=ws(Ae);He(F,22,A(et,it,Ee,Ge.slice(0,239)))}}++Ee}}return He(F,1),F.end()}function l(O){var P=be(2);return P.write_shift(2,O),P}function o(O){var P=be(26);P.write_shift(2,4096),P.write_shift(2,4),P.write_shift(4,0);for(var z=0,F=0,Q=0,re=0;re<O.SheetNames.length;++re){var Ee=O.SheetNames[re],ye=O.Sheets[Ee];if(!(!ye||!ye["!ref"])){++Q;var Oe=Ha(ye["!ref"]);z<Oe.e.r&&(z=Oe.e.r),F<Oe.e.c&&(F=Oe.e.c)}}return z>8191&&(z=8191),P.write_shift(2,z),P.write_shift(1,Q),P.write_shift(1,F),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(1,1),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(4,0),P}function u(O,P,z){var F={s:{c:0,r:0},e:{c:0,r:0}};return P==8&&z.qpro?(F.s.c=O.read_shift(1),O.l++,F.s.r=O.read_shift(2),F.e.c=O.read_shift(1),O.l++,F.e.r=O.read_shift(2),F):(F.s.c=O.read_shift(2),F.s.r=O.read_shift(2),P==12&&z.qpro&&(O.l+=2),F.e.c=O.read_shift(2),F.e.r=O.read_shift(2),P==12&&z.qpro&&(O.l+=2),F.s.c==65535&&(F.s.c=F.e.c=F.s.r=F.e.r=0),F)}function h(O){var P=be(8);return P.write_shift(2,O.s.c),P.write_shift(2,O.s.r),P.write_shift(2,O.e.c),P.write_shift(2,O.e.r),P}function d(O,P,z){var F=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(F[0].c=O.read_shift(1),F[3]=O.read_shift(1),F[0].r=O.read_shift(2),O.l+=2):(F[2]=O.read_shift(1),F[0].c=O.read_shift(2),F[0].r=O.read_shift(2)),F}function x(O,P,z){var F=O.l+P,Q=d(O,P,z);if(Q[1].t="s",z.vers==20768){O.l++;var re=O.read_shift(1);return Q[1].v=O.read_shift(re,"utf8"),Q}return z.qpro&&O.l++,Q[1].v=O.read_shift(F-O.l,"cstr"),Q}function g(O,P,z){var F=be(7+z.length);F.write_shift(1,255),F.write_shift(2,P),F.write_shift(2,O),F.write_shift(1,39);for(var Q=0;Q<F.length;++Q){var re=z.charCodeAt(Q);F.write_shift(1,re>=128?95:re)}return F.write_shift(1,0),F}function p(O,P,z){var F=d(O,P,z);return F[1].v=O.read_shift(2,"i"),F}function y(O,P,z){var F=be(7);return F.write_shift(1,255),F.write_shift(2,P),F.write_shift(2,O),F.write_shift(2,z,"i"),F}function w(O,P,z){var F=d(O,P,z);return F[1].v=O.read_shift(8,"f"),F}function _(O,P,z){var F=be(13);return F.write_shift(1,255),F.write_shift(2,P),F.write_shift(2,O),F.write_shift(8,z,"f"),F}function S(O,P,z){var F=O.l+P,Q=d(O,P,z);if(Q[1].v=O.read_shift(8,"f"),z.qpro)O.l=F;else{var re=O.read_shift(2);D(O.slice(O.l,O.l+re),Q),O.l+=re}return Q}function T(O,P,z){var F=P&32768;return P&=-32769,P=(F?O:0)+(P>=8192?P-16384:P),(F?"":"$")+(z?vr(P):Rr(P))}var N={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function D(O,P){oa(O,0);for(var z=[],F=0,Q="",re="",Ee="",ye="";O.l<O.length;){var Oe=O[O.l++];switch(Oe){case 0:z.push(O.read_shift(8,"f"));break;case 1:re=T(P[0].c,O.read_shift(2),!0),Q=T(P[0].r,O.read_shift(2),!1),z.push(re+Q);break;case 2:{var tt=T(P[0].c,O.read_shift(2),!0),J=T(P[0].r,O.read_shift(2),!1);re=T(P[0].c,O.read_shift(2),!0),Q=T(P[0].r,O.read_shift(2),!1),z.push(tt+J+":"+re+Q)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(O.read_shift(2));break;case 6:{for(var wt="";Oe=O[O.l++];)wt+=String.fromCharCode(Oe);z.push('"'+wt.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:ye=z.pop(),Ee=z.pop(),z.push(["AND","OR"][Oe-20]+"("+Ee+","+ye+")");break;default:if(Oe<32&&E[Oe])ye=z.pop(),Ee=z.pop(),z.push(Ee+E[Oe]+ye);else if(N[Oe]){if(F=N[Oe][1],F==69&&(F=O[O.l++]),F>z.length){console.error("WK1 bad formula parse 0x"+Oe.toString(16)+":|"+z.join("|")+"|");return}var et=z.slice(-F);z.length-=F,z.push(N[Oe][0]+"("+et.join(",")+")")}else return Oe<=7?console.error("WK1 invalid opcode "+Oe.toString(16)):Oe<=24?console.error("WK1 unsupported op "+Oe.toString(16)):Oe<=30?console.error("WK1 invalid opcode "+Oe.toString(16)):Oe<=115?console.error("WK1 unsupported function opcode "+Oe.toString(16)):console.error("WK1 unrecognized opcode "+Oe.toString(16))}}z.length==1?P[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function G(O){var P=[{c:0,r:0},{t:"n",v:0},0];return P[0].r=O.read_shift(2),P[3]=O[O.l++],P[0].c=O[O.l++],P}function V(O,P){var z=G(O);return z[1].t="s",z[1].v=O.read_shift(P-4,"cstr"),z}function A(O,P,z,F){var Q=be(6+F.length);Q.write_shift(2,O),Q.write_shift(1,z),Q.write_shift(1,P),Q.write_shift(1,39);for(var re=0;re<F.length;++re){var Ee=F.charCodeAt(re);Q.write_shift(1,Ee>=128?95:Ee)}return Q.write_shift(1,0),Q}function M(O,P){var z=G(O);z[1].v=O.read_shift(2);var F=z[1].v>>1;if(z[1].v&1)switch(F&7){case 0:F=(F>>3)*5e3;break;case 1:F=(F>>3)*500;break;case 2:F=(F>>3)/20;break;case 3:F=(F>>3)/200;break;case 4:F=(F>>3)/2e3;break;case 5:F=(F>>3)/2e4;break;case 6:F=(F>>3)/16;break;case 7:F=(F>>3)/64;break}return z[1].v=F,z}function C(O,P){var z=G(O),F=O.read_shift(4),Q=O.read_shift(4),re=O.read_shift(2);if(re==65535)return F===0&&Q===3221225472?(z[1].t="e",z[1].v=15):F===0&&Q===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var Ee=re&32768;return re=(re&32767)-16446,z[1].v=(1-Ee*2)*(Q*Math.pow(2,re+32)+F*Math.pow(2,re)),z}function U(O,P,z,F){var Q=be(14);if(Q.write_shift(2,O),Q.write_shift(1,z),Q.write_shift(1,P),F==0)return Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(2,65535),Q;var re=0,Ee=0,ye=0,Oe=0;return F<0&&(re=1,F=-F),Ee=Math.log2(F)|0,F/=Math.pow(2,Ee-31),Oe=F>>>0,(Oe&2147483648)==0&&(F/=2,++Ee,Oe=F>>>0),F-=Oe,Oe|=2147483648,Oe>>>=0,F*=Math.pow(2,32),ye=F>>>0,Q.write_shift(4,ye),Q.write_shift(4,Oe),Ee+=16383+(re?32768:0),Q.write_shift(2,Ee),Q}function Z(O,P){var z=C(O);return O.l+=P-14,z}function q(O,P){var z=G(O),F=O.read_shift(4);return z[1].v=F>>6,z}function le(O,P){var z=G(O),F=O.read_shift(8,"f");return z[1].v=F,z}function ge(O,P){var z=le(O);return O.l+=P-10,z}function Se(O,P){return O[O.l+P-1]==0?O.read_shift(P,"cstr"):""}function te(O,P){var z=O[O.l++];z>P-1&&(z=P-1);for(var F="";F.length<z;)F+=String.fromCharCode(O[O.l++]);return F}function ae(O,P,z){if(!(!z.qpro||P<21)){var F=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var Q=O.read_shift(P-21,"cstr");return[F,Q]}}function De(O,P){for(var z={},F=O.l+P;O.l<F;){var Q=O.read_shift(2);if(Q==14e3){for(z[Q]=[0,""],z[Q][0]=O.read_shift(2);O[O.l];)z[Q][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return z}function ie(O,P){var z=be(5+O.length);z.write_shift(2,14e3),z.write_shift(2,P);for(var F=0;F<O.length;++F){var Q=O.charCodeAt(F);z[z.l++]=Q>127?95:Q}return z[z.l++]=0,z}var Me={0:{n:"BOF",f:Ur},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:x},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:x},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Se},222:{n:"SHEETNAMELP",f:te},65535:{n:""}},W={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:V},23:{n:"NUMBER17",f:C},24:{n:"NUMBER18",f:M},25:{n:"FORMULA19",f:Z},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:De},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:q},38:{n:"??"},39:{n:"NUMBER27",f:le},40:{n:"FORMULA28",f:ge},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Se},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ae},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:s,to_workbook:t}})();function MO(e){var t={},r=e.match(Sa),a=0,s=!1;if(r)for(;a!=r.length;++a){var l=ht(r[a]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;t.cp=lx[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=l.val;break;case"<sz":t.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":l.rgb&&(t.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(l[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+l[0])}}return t}var IO=(function(){var e=Mc("t"),t=Mc("rPr");function r(l){var o=l.match(e);if(!o)return{t:"s",v:""};var u={t:"s",v:Ft(o[1])},h=l.match(t);return h&&(u.s=MO(h[1])),u}var a=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(a,"").split(s).map(r).filter(function(u){return u.v})}})(),LO=(function(){var t=/(\r\n|\n)/g;function r(s,l,o){var u=[];s.u&&u.push("text-decoration: underline;"),s.uval&&u.push("text-underline-style:"+s.uval+";"),s.sz&&u.push("font-size:"+s.sz+"pt;"),s.outline&&u.push("text-effect: outline;"),s.shadow&&u.push("text-shadow: auto;"),l.push('<span style="'+u.join("")+'">'),s.b&&(l.push("<b>"),o.push("</b>")),s.i&&(l.push("<i>"),o.push("</i>")),s.strike&&(l.push("<s>"),o.push("</s>"));var h=s.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(l.push("<"+h+">"),o.push("</"+h+">")),o.push("</span>"),s}function a(s){var l=[[],s.v,[]];return s.v?(s.s&&r(s.s,l[0],l[2]),l[0].join("")+l[1].replace(t,"<br/>")+l[2].join("")):""}return function(l){return l.map(a).join("")}})(),BO=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,PO=/<(?:\w+:)?r>/,UO=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Cx(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Ft(sr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=sr(e),r&&(a.h=gx(a.t))):e.match(PO)&&(a.r=sr(e),a.t=Ft(sr((e.replace(UO,"").match(BO)||[]).join("").replace(Sa,""))),r&&(a.h=LO(IO(a.r)))),a):{t:""}}var zO=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,HO=/<(?:\w+:)?(?:si|sstItem)>/g,qO=/<\/(?:\w+:)?(?:si|sstItem)>/;function $O(e,t){var r=[],a="";if(!e)return r;var s=e.match(zO);if(s){a=s[2].replace(HO,"").split(qO);for(var l=0;l!=a.length;++l){var o=Cx(a[l].trim(),t);o!=null&&(r[r.length]=o)}s=ht(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var GO=/^\s|\s$|[\t\n\r]/;function l2(e,t){if(!t.bookSST)return"";var r=[Dr];r[r.length]=ze("sst",null,{xmlns:Ki[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var s=e[a],l="<si>";s.r?l+=s.r:(l+="<t",s.t||(s.t=""),s.t.match(GO)&&(l+=' xml:space="preserve"'),l+=">"+er(s.t)+"</t>"),l+="</si>",r[r.length]=l}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function VO(e){return[e.read_shift(4),e.read_shift(4)]}function XO(e,t){var r=[],a=!1;return Ts(e,function(l,o,u){switch(u){case 159:r.Count=l[0],r.Unique=l[1];break;case 19:r.push(l);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(o.T,!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function WO(e,t){return t||(t=be(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var KO=sA;function YO(e){var t=za();Re(t,159,WO(e));for(var r=0;r<e.length;++r)Re(t,19,KO(e[r]));return Re(t,160),t.end()}function o2(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function bs(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function JO(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=bs(e,4),t.U=bs(e,4),t.W=bs(e,4),t}function QO(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},s=e.read_shift(4),l=[];s-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=l,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function ZO(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(QO(e));return t}function eC(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function tC(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=bs(e,4),t.U=bs(e,4),t.W=bs(e,4),t}function rC(e){var t=tC(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function c2(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var s=!1;switch(a.AlgID){case 26126:case 26127:case 26128:s=a.Flags==36;break;case 26625:s=a.Flags==4;break;case 0:s=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function u2(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function aC(e){var t=bs(e);switch(t.Minor){case 2:return[t.Minor,nC(e)];case 3:return[t.Minor,sC()];case 4:return[t.Minor,iC(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function nC(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=c2(e,r),s=u2(e,e.length-e.l);return{t:"Std",h:a,v:s}}function sC(){throw new Error("File is password-protected: ECMA-376 Extensible")}function iC(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(Sa,function(l){var o=ht(l);switch(Jn(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){a[u]=o[u]});break;case"<dataIntegrity":a.encryptedHmacKey=o.encryptedHmacKey,a.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(o);break;default:throw o[0]}}),a}function lC(e,t){var r={},a=r.EncryptionVersionInfo=bs(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=c2(e,s),t-=s,r.EncryptionVerifier=u2(e,t),r}function oC(e){var t={},r=t.EncryptionVersionInfo=bs(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Rx(e){var t=0,r,a=o2(e),s=a.length+1,l,o,u,h,d;for(r=ni(s),r[0]=a.length,l=1;l!=s;++l)r[l]=a[l-1];for(l=s-1;l>=0;--l)o=r[l],u=(t&16384)===0?0:1,h=t<<1&32767,d=u|h,t=d^o;return t^52811}var f2=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(o){return(o/2|o*128)&255},s=function(o,u){return a(o^u)},l=function(o){for(var u=t[o.length-1],h=104,d=o.length-1;d>=0;--d)for(var x=o[d],g=0;g!=7;++g)x&64&&(u^=r[h]),x*=2,--h;return u};return function(o){for(var u=o2(o),h=l(u),d=u.length,x=ni(16),g=0;g!=16;++g)x[g]=0;var p,y,w;for((d&1)===1&&(p=h>>8,x[d]=s(e[0],p),--d,p=h&255,y=u[u.length-1],x[d]=s(y,p));d>0;)--d,p=h>>8,x[d]=s(u[d],p),--d,p=h&255,x[d]=s(u[d],p);for(d=15,w=15-u.length;w>0;)p=h>>8,x[d]=s(e[w],p),--d,--w,p=h&255,x[d]=s(u[d],p),--d,--w;return x}})(),cC=function(e,t,r,a,s){s||(s=t),a||(a=f2(e));var l,o;for(l=0;l!=t.length;++l)o=t[l],o^=a[r],o=(o>>5|o<<3)&255,s[l]=o,++r;return[s,r,a]},uC=function(e){var t=0,r=f2(e);return function(a){var s=cC("",a,t,r);return t=s[1],s[0]}};function fC(e,t,r,a){var s={key:Ur(e),verificationBytes:Ur(e)};return r.password&&(s.verifier=Rx(r.password)),a.valid=s.verificationBytes===s.verifier,a.valid&&(a.insitu=uC(r.password)),s}function dC(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=oC(e):a.Data=lC(e,t),a}function hC(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?dC(e,t-2,a):fC(e,r.biff>=8?t:t-2,r,a),a}var d2=(function(){function e(s,l){switch(l.type){case"base64":return t(ln(s),l);case"binary":return t(s,l);case"buffer":return t(St&&Buffer.isBuffer(s)?s.toString("binary"):oi(s),l);case"array":return t($i(s),l)}throw new Error("Unrecognized type "+l.type)}function t(s,l){var o=l||{},u=o.dense?[]:{},h=s.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(x,g){Array.isArray(u)&&(u[g]=[]);for(var p=/\\\w+\b/g,y=0,w,_=-1;w=p.exec(x);){switch(w[0]){case"\\cell":var S=x.slice(y,p.lastIndex-w[0].length);if(S[0]==" "&&(S=S.slice(1)),++_,S.length){var T={v:S,t:"s"};Array.isArray(u)?u[g][_]=T:u[dt({r:g,c:_})]=T}break}y=p.lastIndex}_>d.e.c&&(d.e.c=_)}),u["!ref"]=yt(d),u}function r(s,l){return ci(e(s,l),l)}function a(s){for(var l=["{\\rtf1\\ansi"],o=Mt(s["!ref"]),u,h=Array.isArray(s),d=o.s.r;d<=o.e.r;++d){l.push("\\trowd\\trautofit1");for(var x=o.s.c;x<=o.e.c;++x)l.push("\\cellx"+(x+1));for(l.push("\\pard\\intbl"),x=o.s.c;x<=o.e.c;++x){var g=dt({r:d,c:x});u=h?(s[d]||[])[x]:s[g],!(!u||u.v==null&&(!u.f||u.F))&&(l.push(" "+(u.w||(ws(u),u.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}})();function mC(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Pc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function xC(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,s=Math.max(t,r,a),l=Math.min(t,r,a),o=s-l;if(o===0)return[0,0,t];var u=0,h=0,d=s+l;switch(h=o/(d>1?2-d:d),s){case t:u=((r-a)/o+6)%6;break;case r:u=(a-t)/o+2;break;case a:u=(t-r)/o+4;break}return[u/6,h,d/2]}function pC(e){var t=e[0],r=e[1],a=e[2],s=r*2*(a<.5?a:1-a),l=a-s/2,o=[l,l,l],u=6*t,h;if(r!==0)switch(u|0){case 0:case 6:h=s*u,o[0]+=s,o[1]+=h;break;case 1:h=s*(2-u),o[0]+=h,o[1]+=s;break;case 2:h=s*(u-2),o[1]+=s,o[2]+=h;break;case 3:h=s*(4-u),o[1]+=h,o[2]+=s;break;case 4:h=s*(u-4),o[2]+=s,o[0]+=h;break;case 5:h=s*(6-u),o[2]+=h,o[0]+=s;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function Mf(e,t){if(t===0)return e;var r=xC(mC(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Pc(pC(r))}var h2=6,gC=15,vC=1,ya=h2;function Uc(e){return Math.floor((e+Math.round(128/ya)/256)*ya)}function zc(e){return Math.floor((e-5)/ya*100+.5)/100}function If(e){return Math.round((e*ya+5)/ya*256)/256}function jm(e){return If(zc(Uc(e)))}function Dx(e){var t=Math.abs(e-jm(e)),r=ya;if(t>.005)for(ya=vC;ya<gC;++ya)Math.abs(e-jm(e))<=t&&(t=Math.abs(e-jm(e)),r=ya);ya=r}function si(e){e.width?(e.wpx=Uc(e.width),e.wch=zc(e.wpx),e.MDW=ya):e.wpx?(e.wch=zc(e.wpx),e.width=If(e.wch),e.MDW=ya):typeof e.wch=="number"&&(e.width=If(e.wch),e.wpx=Uc(e.width),e.MDW=ya),e.customWidth&&delete e.customWidth}var yC=96,m2=yC;function Hc(e){return e*96/m2}function so(e){return e*m2/96}var _C={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function bC(e,t,r,a){t.Borders=[];var s={},l=!1;(e[0].match(Sa)||[]).forEach(function(o){var u=ht(o);switch(Jn(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},u.diagonalUp&&(s.diagonalUp=dr(u.diagonalUp)),u.diagonalDown&&(s.diagonalDown=dr(u.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+u[0]+" in borders")}})}function wC(e,t,r,a){t.Fills=[];var s={},l=!1;(e[0].match(Sa)||[]).forEach(function(o){var u=ht(o);switch(Jn(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":u.patternType&&(s.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),u.indexed&&(s.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(s.bgColor.theme=parseInt(u.theme,10)),u.tint&&(s.bgColor.tint=parseFloat(u.tint)),u.rgb&&(s.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),u.theme&&(s.fgColor.theme=parseInt(u.theme,10)),u.tint&&(s.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(s.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fills")}})}function SC(e,t,r,a){t.Fonts=[];var s={},l=!1;(e[0].match(Sa)||[]).forEach(function(o){var u=ht(o);switch(Jn(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":u.val&&(s.name=sr(u.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=u.val?dr(u.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=u.val?dr(u.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(u.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=u.val?dr(u.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=u.val?dr(u.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=u.val?dr(u.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=u.val?dr(u.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=u.val?dr(u.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":u.val&&(s.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(s.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(s.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(s.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=lx[parseInt(u.val,10)];break;case"<color":if(s.color||(s.color={}),u.auto&&(s.color.auto=dr(u.auto)),u.rgb)s.color.rgb=u.rgb.slice(-6);else if(u.indexed){s.color.index=parseInt(u.indexed,10);var h=Pi[s.color.index];s.color.index==81&&(h=Pi[1]),h||(h=Pi[1]),s.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(s.color.theme=parseInt(u.theme,10),u.tint&&(s.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Mf(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fonts")}})}function EC(e,t,r){t.NumberFmt=[];for(var a=jr(ut),s=0;s<a.length;++s)t.NumberFmt[a[s]]=ut[a[s]];var l=e[0].match(Sa);if(l)for(s=0;s<l.length;++s){var o=ht(l[s]);switch(Jn(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Ft(sr(o.formatCode)),h=parseInt(o.numFmtId,10);if(t.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&t.NumberFmt[h]!=null;--h);t.NumberFmt[h]=u}_s(u,h)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function TC(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=ze("numFmt",null,{numFmtId:a,formatCode:er(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ze("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var vf=["numFmtId","fillId","fontId","borderId","xfId"],yf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function kC(e,t,r){t.CellXf=[];var a,s=!1;(e[0].match(Sa)||[]).forEach(function(l){var o=ht(l),u=0;switch(Jn(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=o,delete a[0],u=0;u<vf.length;++u)a[vf[u]]&&(a[vf[u]]=parseInt(a[vf[u]],10));for(u=0;u<yf.length;++u)a[yf[u]]&&(a[yf[u]]=dr(a[yf[u]]));if(t.NumberFmt&&a.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[u]){a.numFmtId=u;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};o.vertical&&(h.vertical=o.vertical),o.horizontal&&(h.horizontal=o.horizontal),o.textRotation!=null&&(h.textRotation=o.textRotation),o.indent&&(h.indent=o.indent),o.wrapText&&(h.wrapText=dr(o.wrapText)),a.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function NC(e){var t=[];return t[t.length]=ze("cellXfs",null),e.forEach(function(r){t[t.length]=ze("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ze("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var jC=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,h,d){var x={};if(!u)return x;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var g;return(g=u.match(t))&&EC(g,x,d),(g=u.match(s))&&SC(g,x,h,d),(g=u.match(a))&&wC(g,x,h,d),(g=u.match(l))&&bC(g,x,h,d),(g=u.match(r))&&kC(g,x,d),x}})();function x2(e,t){var r=[Dr,ze("styleSheet",null,{xmlns:Ki[0],"xmlns:vt":Wr.vt})],a;return e.SSF&&(a=TC(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=NC(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function AC(e,t){var r=e.read_shift(2),a=ba(e);return[r,a]}function OC(e,t,r){r||(r=be(6+4*t.length)),r.write_shift(2,e),Zr(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function CC(e,t,r){var a={};a.sz=e.read_shift(2)/20;var s=dA(e);s.fItalic&&(a.italic=1),s.fCondense&&(a.condense=1),s.fExtend&&(a.extend=1),s.fShadow&&(a.shadow=1),s.fOutline&&(a.outline=1),s.fStrikeout&&(a.strike=1);var l=e.read_shift(2);switch(l===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(a.underline=o);var u=e.read_shift(1);u>0&&(a.family=u);var h=e.read_shift(1);switch(h>0&&(a.charset=h),e.l++,a.color=fA(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=ba(e),a}function RC(e,t){t||(t=be(153)),t.write_shift(2,e.sz*20),hA(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Rf(e.color,t);var a=0;return a=2,t.write_shift(1,a),Zr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var DC=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Am,FC=wa;function nb(e,t){t||(t=be(84)),Am||(Am=Yf(DC));var r=Am[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(Rf({auto:1},t),Rf({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function MC(e,t){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:s}}function p2(e,t,r){r||(r=be(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function uc(e,t){return t||(t=be(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var IC=wa;function LC(e,t){return t||(t=be(51)),t.write_shift(1,0),uc(null,t),uc(null,t),uc(null,t),uc(null,t),uc(null,t),t.length>t.l?t.slice(0,t.l):t}function BC(e,t){return t||(t=be(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Cf(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function PC(e,t,r){var a=be(2052);return a.write_shift(4,e),Cf(t,a),Cf(r,a),a.length>a.l?a.slice(0,a.l):a}function UC(e,t,r){var a={};a.NumberFmt=[];for(var s in ut)a.NumberFmt[s]=ut[s];a.CellXf=[],a.Fonts=[];var l=[],o=!1;return Ts(e,function(h,d,x){switch(x){case 44:a.NumberFmt[h[0]]=h[1],_s(h[1],h[0]);break;case 43:a.Fonts.push(h),h.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(h.color.rgb=Mf(t.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&a.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:l.push(x),o=!0;break;case 38:l.pop(),o=!1;break;default:if(d.T>0)l.push(x);else if(d.T<0)l.pop();else if(!o||r.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+x.toString(16))}}),a}function zC(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&++r}),r!=0&&(Re(e,615,Un(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&Re(e,44,OC(s,t[s]))}),Re(e,616))}}function HC(e){var t=1;Re(e,611,Un(t)),Re(e,43,RC({sz:12,color:{theme:1},name:"Calibri",family:2})),Re(e,612)}function qC(e){var t=2;Re(e,603,Un(t)),Re(e,45,nb({patternType:"none"})),Re(e,45,nb({patternType:"gray125"})),Re(e,604)}function $C(e){var t=1;Re(e,613,Un(t)),Re(e,46,LC()),Re(e,614)}function GC(e){var t=1;Re(e,626,Un(t)),Re(e,47,p2({numFmtId:0},65535)),Re(e,627)}function VC(e,t){Re(e,617,Un(t.length)),t.forEach(function(r){Re(e,47,p2(r,0))}),Re(e,618)}function XC(e){var t=1;Re(e,619,Un(t)),Re(e,48,BC({xfId:0,name:"Normal"})),Re(e,620)}function WC(e){var t=0;Re(e,505,Un(t)),Re(e,506)}function KC(e){var t=0;Re(e,508,PC(t,"TableStyleMedium9","PivotStyleMedium4")),Re(e,509)}function YC(e,t){var r=za();return Re(r,278),zC(r,e.SSF),HC(r),qC(r),$C(r),GC(r),VC(r,t.cellXfs),XC(r),WC(r),KC(r),Re(r,279),r.end()}var JC=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function QC(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(Sa)||[]).forEach(function(s){var l=ht(s);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=l.val;break;case"<a:sysClr":a.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(t.themeElements.clrScheme[JC.indexOf(l[0])]=a,a={}):a.name=l[0].slice(3,l[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function ZC(){}function e5(){}var t5=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,r5=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,a5=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function n5(e,t,r){t.themeElements={};var a;[["clrScheme",t5,QC],["fontScheme",r5,ZC],["fmtScheme",a5,e5]].forEach(function(s){if(!(a=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](a,t,r)})}var s5=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function g2(e,t){(!e||e.length===0)&&(e=Fx());var r,a={};if(!(r=e.match(s5)))throw new Error("themeElements not found in theme");return n5(r[0],a,t),a.raw=e,a}function Fx(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Dr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function i5(e,t,r){var a=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=a;return}var l=e.slice(e.l);e.l=a;var o;try{o=cw(l,{type:"array"})}catch{return}var u=sn(o,"theme/theme/theme1.xml",!0);if(u)return g2(u,r)}}function l5(e){return e.read_shift(4)}function o5(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=c5(e,4);break;case 2:t.xclrValue=Yw(e);break;case 3:t.xclrValue=l5(e);break;case 4:e.l+=4;break}return e.l+=8,t}function c5(e,t){return wa(e,t)}function u5(e,t){return wa(e,t)}function f5(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=o5(e);break;case 6:a[1]=u5(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function d5(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),l=[];s-- >0;)l.push(f5(e,r-e.l));return{ixfe:a,ext:l}}function h5(e,t){t.forEach(function(r){r[0]})}function m5(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ba(e)}}function x5(e){var t=be(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Zr(e.name,t),t.slice(0,t.l)}function p5(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function g5(e){var t=be(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function v5(e,t){var r=be(8+2*t.length);return r.write_shift(4,e),Zr(t,r),r.slice(0,r.l)}function y5(e){return e.l+=4,e.read_shift(4)!=0}function _5(e,t){var r=be(8);return r.write_shift(4,e),r.write_shift(4,1),r}function b5(e,t,r){var a={Types:[],Cell:[],Value:[]},s=r||{},l=[],o=!1,u=2;return Ts(e,function(h,d,x){switch(x){case 335:a.Types.push({name:h.name});break;case 51:h.forEach(function(g){u==1?a.Cell.push({type:a.Types[g[0]-1].name,index:g[1]}):u==0&&a.Value.push({type:a.Types[g[0]-1].name,index:g[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:l.push(x),o=!0;break;case 36:l.pop(),o=!1;break;default:if(!d.T){if(!o||s.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+x.toString(16))}}}),a}function w5(){var e=za();return Re(e,332),Re(e,334,Un(1)),Re(e,335,x5({name:"XLDAPR",version:12e4,flags:3496657072})),Re(e,336),Re(e,339,v5(1,"XLDAPR")),Re(e,52),Re(e,35,Un(514)),Re(e,4096,Un(0)),Re(e,4097,Sn(1)),Re(e,36),Re(e,53),Re(e,340),Re(e,337,_5(1)),Re(e,51,g5([[1,0]])),Re(e,338),Re(e,333),e.end()}function S5(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var s=!1,l=2,o;return e.replace(Sa,function(u){var h=ht(u);switch(Jn(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<a.Types.length;++d)a.Types[d].name==h.name&&(o=a.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?a.Cell.push({type:a.Types[h.t-1].name,index:+h.v}):l==0&&a.Value.push({type:a.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+h.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return u}),a}function v2(){var e=[Dr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function E5(e){var t=[];if(!e)return t;var r=1;return(e.match(Sa)||[]).forEach(function(a){var s=ht(a);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function T5(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=dt(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function k5(e,t,r){var a=[];return Ts(e,function(l,o,u){switch(u){case 63:a.push(l);break;default:if(!o.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),a}function N5(e,t,r,a){if(!e)return e;var s=a||{},l=!1;Ts(e,function(u,h,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!h.T){if(!l||s.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},s)}function j5(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Jl=1024;function y2(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[ze("xml",null,{"xmlns:v":tn.v,"xmlns:o":tn.o,"xmlns:x":tn.x,"xmlns:mv":tn.mv}).replace(/\/>/,">"),ze("o:shapelayout",ze("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ze("v:shapetype",[ze("v:stroke",null,{joinstyle:"miter"}),ze("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];Jl<e*1e3;)Jl+=1e3;return t.forEach(function(l){var o=yr(l[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var h=u.type=="gradient"?ze("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=ze("v:fill",h,u),x={on:"t",obscured:"t"};++Jl,s=s.concat(["<v:shape"+Ic({id:"_x0000_s"+Jl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,ze("v:shadow",null,x),ze("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ca("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),ca("x:AutoFill","False"),ca("x:Row",String(o.r)),ca("x:Column",String(o.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function sb(e,t,r,a){var s=Array.isArray(e),l;t.forEach(function(o){var u=yr(o.ref);if(s?(e[u.r]||(e[u.r]=[]),l=e[u.r][u.c]):l=e[o.ref],!l){l={t:"z"},s?e[u.r][u.c]=l:e[o.ref]=l;var h=Mt(e["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var d=yt(h);d!==e["!ref"]&&(e["!ref"]=d)}l.c||(l.c=[]);var x={a:o.author,t:o.t,r:o.r,T:r};o.h&&(x.h=o.h);for(var g=l.c.length-1;g>=0;--g){if(!r&&l.c[g].T)return;r&&!l.c[g].T&&l.c.splice(g,1)}if(r&&a){for(g=0;g<a.length;++g)if(x.a==a[g].id){x.a=a[g].name||x.a;break}}l.c.push(x)})}function A5(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?comment[^>]*>/);if(u){var h=ht(u[0]),d={author:h.authorId&&r[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},x=yr(h.ref);if(!(t.sheetRows&&t.sheetRows<=x.r)){var g=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!g&&!!g[1]&&Cx(g[1])||{r:"",t:"",h:""};d.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),d.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=p.h),a.push(d)}}}}),a}function _2(e){var t=[Dr,ze("comments",null,{xmlns:Ki[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(s){var l=er(s.a);r.indexOf(l)==-1&&(r.push(l),t.push("<author>"+l+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var s=0,l=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?s=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(h){h.a&&(s=r.indexOf(er(h.a))),l.push(h.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+s+'"><text>'),l.length<=1)t.push(ca("t",er(l[0]||"")));else{for(var o=`Comment:
    `+l[0]+`
`,u=1;u<l.length;++u)o+=`Reply:
    `+l[u]+`
`;t.push(ca("t",er(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function O5(e,t){var r=[],a=!1,s={},l=0;return e.replace(Sa,function(u,h){var d=ht(u);switch(Jn(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":l=h+u.length;break;case"</text>":s.t=e.slice(l,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),r}function C5(e,t,r){var a=[Dr,ze("ThreadedComments",null,{xmlns:Wr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var l="";(s[1]||[]).forEach(function(o,u){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var h={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?l=h.id:h.parentId=l,o.ID=h.id,o.a&&(h.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),a.push(ze("threadedComment",ca("text",o.t||""),h))})}),a.push("</ThreadedComments>"),a.join("")}function R5(e,t){var r=[],a=!1;return e.replace(Sa,function(l){var o=ht(l);switch(Jn(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return l}),r}function D5(e){var t=[Dr,ze("personList",null,{xmlns:Wr.TCMNT,"xmlns:x":Ki[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(ze("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function F5(e){var t={};t.iauthor=e.read_shift(4);var r=Zi(e);return t.rfx=r.s,t.ref=dt(r.s),e.l+=16,t}function M5(e,t){return t==null&&(t=be(36)),t.write_shift(4,e[1].iauthor),fo(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var I5=ba;function L5(e){return Zr(e.slice(0,54))}function B5(e,t){var r=[],a=[],s={},l=!1;return Ts(e,function(u,h,d){switch(d){case 632:a.push(u);break;case 635:s=u;break;case 637:s.t=u.t,s.h=u.h,s.r=u.r;break;case 636:if(s.author=a[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!l||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function P5(e){var t=za(),r=[];return Re(t,628),Re(t,630),e.forEach(function(a){a[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),Re(t,632,L5(s.a)))})}),Re(t,631),Re(t,633),e.forEach(function(a){a[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var l={s:yr(a[0]),e:yr(a[0])};Re(t,635,M5([l,s])),s.t&&s.t.length>0&&Re(t,637,lA(s)),Re(t,636),delete s.iauthor})}),Re(t,634),Re(t,629),t.end()}var U5="application/vnd.ms-office.vbaProject";function z5(e){var t=at.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");at.utils.cfb_add(t,s,e.FileIndex[a].content)}}),at.write(t)}function H5(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&at.utils.cfb_add(e,s,t.FileIndex[a].content)}})}var b2=["xlsb","xlsm","xlam","biff8","xla"];function q5(){return{"!type":"dialog"}}function $5(){return{"!type":"dialog"}}function G5(){return{"!type":"macro"}}function V5(){return{"!type":"macro"}}var to=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,s,l,o){var u=!1,h=!1;l.length==0?h=!0:l.charAt(0)=="["&&(h=!0,l=l.slice(1,-1)),o.length==0?u=!0:o.charAt(0)=="["&&(u=!0,o=o.slice(1,-1));var d=l.length>0?parseInt(l,10)|0:0,x=o.length>0?parseInt(o,10)|0:0;return u?x+=t.c:--x,h?d+=t.r:--d,s+(u?"":"$")+vr(x)+(h?"":"$")+Rr(d)}return function(s,l){return t=l,s.replace(e,r)}})(),Mx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Ix=(function(){return function(t,r){return t.replace(Mx,function(a,s,l,o,u,h){var d=wx(o)-(l?0:r.c),x=bx(h)-(u?0:r.r),g=x==0?"":u?x+1:"["+x+"]",p=d==0?"":l?d+1:"["+d+"]";return s+"R"+g+"C"+p})}})();function w2(e,t){return e.replace(Mx,function(r,a,s,l,o,u){return a+(s=="$"?s+l:vr(wx(l)+t.c))+(o=="$"?o+u:Rr(bx(u)+t.r))})}function X5(e,t,r){var a=Ha(t),s=a.s,l=yr(r),o={r:l.r-s.r,c:l.c-s.c};return w2(e,o)}function W5(e){return e.length!=1}function ib(e){return e.replace(/_xlfn\./g,"")}function Br(e){e.l+=1}function ii(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function S2(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return E2(e);r.biff==12&&(a=4)}var s=e.read_shift(a),l=e.read_shift(a),o=ii(e),u=ii(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:l,c:u[0],cRel:u[1],rRel:u[2]}}}function E2(e){var t=ii(e),r=ii(e),a=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function K5(e,t,r){if(r.biff<8)return E2(e);var a=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),l=ii(e),o=ii(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function T2(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Y5(e);var a=e.read_shift(r&&r.biff==12?4:2),s=ii(e);return{r:a,c:s[0],cRel:s[1],rRel:s[2]}}function Y5(e){var t=ii(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function J5(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Q5(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return Z5(e);var s=e.read_shift(a>=12?4:2),l=e.read_shift(2),o=(l&16384)>>14,u=(l&32768)>>15;if(l&=16383,u==1)for(;s>524287;)s-=1048576;if(o==1)for(;l>8191;)l=l-16384;return{r:s,c:l,cRel:o,rRel:u}}function Z5(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:a}}function e6(e,t,r){var a=(e[e.l++]&96)>>5,s=S2(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,s]}function t6(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var o=S2(e,l,r);return[a,s,o]}function r6(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function a6(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[a,s]}function n6(e,t,r){var a=(e[e.l++]&96)>>5,s=K5(e,t-1,r);return[a,s]}function s6(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function lb(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function i6(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),s=[],l=0;l<=a;++l)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function l6(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function o6(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function c6(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function u6(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function k2(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function f6(e){return e.read_shift(2),k2(e)}function d6(e){return e.read_shift(2),k2(e)}function h6(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=T2(e,0,r);return[a,s]}function m6(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=Q5(e,0,r);return[a,s]}function x6(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var l=T2(e,0,r);return[a,s,l]}function p6(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[y8[s],A2[s],a]}function g6(e,t,r){var a=e[e.l++],s=e.read_shift(1),l=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:v6(e);return[s,(l[0]===0?A2:v8)[l[1]]]}function v6(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function y6(e,t,r){e.l+=r&&r.biff==2?3:4}function _6(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function b6(e){return e.l++,ks[e.read_shift(1)]}function w6(e){return e.l++,e.read_shift(2)}function S6(e){return e.l++,e.read_shift(1)!==0}function E6(e){return e.l++,_a(e)}function T6(e,t,r){return e.l++,Zc(e,t-1,r)}function k6(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Cr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ks[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=_a(e);break;case 2:r[1]=el(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function N6(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),s=[],l=0;l!=a;++l)s.push((r.biff==12?Zi:Zf)(e));return s}function j6(e,t,r){var a=0,s=0;r.biff==12?(a=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--s==0&&(s=256));for(var l=0,o=[];l!=a&&(o[l]=[]);++l)for(var u=0;u!=s;++u)o[l][u]=k6(e,r.biff);return o}function A6(e,t,r){var a=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,l=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,l]}function O6(e,t,r){if(r.biff==5)return C6(e);var a=e.read_shift(1)>>>5&3,s=e.read_shift(2),l=e.read_shift(4);return[a,s,l]}function C6(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function R6(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function D6(e,t,r){var a=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function F6(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function M6(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),l=4;if(r)switch(r.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[a,s]}var I6=wa,L6=wa,B6=wa;function tu(e,t,r){return e.l+=2,[J5(e)]}function Lx(e){return e.l+=6,[]}var P6=tu,U6=Lx,z6=Lx,H6=tu;function N2(e){return e.l+=2,[Ur(e),e.read_shift(2)&1]}var q6=tu,$6=N2,G6=Lx,V6=tu,X6=tu,W6=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function K6(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s=e.read_shift(2),l=e.read_shift(2),o=W6[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:a,c:s,C:l}}function Y6(e){return e.l+=2,[e.read_shift(4)]}function J6(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Q6(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Z6(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function e8(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function t8(e){return e.l+=4,[0,0]}var ob={1:{n:"PtgExp",f:_6},2:{n:"PtgTbl",f:B6},3:{n:"PtgAdd",f:Br},4:{n:"PtgSub",f:Br},5:{n:"PtgMul",f:Br},6:{n:"PtgDiv",f:Br},7:{n:"PtgPower",f:Br},8:{n:"PtgConcat",f:Br},9:{n:"PtgLt",f:Br},10:{n:"PtgLe",f:Br},11:{n:"PtgEq",f:Br},12:{n:"PtgGe",f:Br},13:{n:"PtgGt",f:Br},14:{n:"PtgNe",f:Br},15:{n:"PtgIsect",f:Br},16:{n:"PtgUnion",f:Br},17:{n:"PtgRange",f:Br},18:{n:"PtgUplus",f:Br},19:{n:"PtgUminus",f:Br},20:{n:"PtgPercent",f:Br},21:{n:"PtgParen",f:Br},22:{n:"PtgMissArg",f:Br},23:{n:"PtgStr",f:T6},26:{n:"PtgSheet",f:J6},27:{n:"PtgEndSheet",f:Q6},28:{n:"PtgErr",f:b6},29:{n:"PtgBool",f:S6},30:{n:"PtgInt",f:w6},31:{n:"PtgNum",f:E6},32:{n:"PtgArray",f:s6},33:{n:"PtgFunc",f:p6},34:{n:"PtgFuncVar",f:g6},35:{n:"PtgName",f:A6},36:{n:"PtgRef",f:h6},37:{n:"PtgArea",f:e6},38:{n:"PtgMemArea",f:R6},39:{n:"PtgMemErr",f:I6},40:{n:"PtgMemNoMem",f:L6},41:{n:"PtgMemFunc",f:D6},42:{n:"PtgRefErr",f:F6},43:{n:"PtgAreaErr",f:r6},44:{n:"PtgRefN",f:m6},45:{n:"PtgAreaN",f:n6},46:{n:"PtgMemAreaN",f:Z6},47:{n:"PtgMemNoMemN",f:e8},57:{n:"PtgNameX",f:O6},58:{n:"PtgRef3d",f:x6},59:{n:"PtgArea3d",f:t6},60:{n:"PtgRefErr3d",f:M6},61:{n:"PtgAreaErr3d",f:a6},255:{}},r8={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},a8={1:{n:"PtgElfLel",f:N2},2:{n:"PtgElfRw",f:V6},3:{n:"PtgElfCol",f:P6},6:{n:"PtgElfRwV",f:X6},7:{n:"PtgElfColV",f:H6},10:{n:"PtgElfRadical",f:q6},11:{n:"PtgElfRadicalS",f:G6},13:{n:"PtgElfColS",f:U6},15:{n:"PtgElfColSV",f:z6},16:{n:"PtgElfRadicalLel",f:$6},25:{n:"PtgList",f:K6},29:{n:"PtgSxName",f:Y6},255:{}},n8={0:{n:"PtgAttrNoop",f:t8},1:{n:"PtgAttrSemi",f:u6},2:{n:"PtgAttrIf",f:o6},4:{n:"PtgAttrChoose",f:i6},8:{n:"PtgAttrGoto",f:l6},16:{n:"PtgAttrSum",f:y6},32:{n:"PtgAttrBaxcel",f:lb},33:{n:"PtgAttrBaxcel",f:lb},64:{n:"PtgAttrSpace",f:f6},65:{n:"PtgAttrSpaceSemi",f:d6},128:{n:"PtgAttrIfError",f:c6},255:{}};function ru(e,t,r,a){if(a.biff<8)return wa(e,t);for(var s=e.l+t,l=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=j6(e,0,a),l.push(r[o][1]);break;case"PtgMemArea":r[o][2]=N6(e,r[o][1],a),l.push(r[o][2]);break;case"PtgExp":a&&a.biff==12&&(r[o][1][1]=e.read_shift(4),l.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=s-e.l,t!==0&&l.push(wa(e,t)),l}function au(e,t,r){for(var a=e.l+t,s,l,o=[];a!=e.l;)t=a-e.l,l=e[e.l],s=ob[l]||ob[r8[l]],(l===24||l===25)&&(s=(l===24?a8:n8)[e[e.l+1]]),!s||!s.f?wa(e,t):o.push([s.n,s.f(e,t,r)]);return o}function s8(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],s=[],l=0;l<a.length;++l){var o=a[l];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var i8={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function l8(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function j2(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[a[0]][0]){case 357:return s=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return s=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[a[0]][0][3]?(s=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?s:s+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function cb(e,t,r){var a=j2(e,t,r);return a=="#REF"?a:l8(a,r)}function va(e,t,r,a,s){var l=s&&s.biff||8,o={s:{c:0,r:0}},u=[],h,d,x,g=0,p=0,y,w="";if(!e[0]||!e[0][0])return"";for(var _=-1,S="",T=0,N=e[0].length;T<N;++T){var E=e[0][T];switch(E[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),d=u.pop(),_>=0){switch(e[0][_][1][0]){case 0:S=kr(" ",e[0][_][1][1]);break;case 1:S=kr("\r",e[0][_][1][1]);break;default:if(S="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}d=d+S,_=-1}u.push(d+i8[E[0]]+h);break;case"PtgIsect":h=u.pop(),d=u.pop(),u.push(d+" "+h);break;case"PtgUnion":h=u.pop(),d=u.pop(),u.push(d+","+h);break;case"PtgRange":h=u.pop(),d=u.pop(),u.push(d+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":x=vc(E[1][1],o,s),u.push(yc(x,l));break;case"PtgRefN":x=r?vc(E[1][1],r,s):E[1][1],u.push(yc(x,l));break;case"PtgRef3d":g=E[1][1],x=vc(E[1][2],o,s),w=cb(a,g,s),u.push(w+"!"+yc(x,l));break;case"PtgFunc":case"PtgFuncVar":var D=E[1][0],G=E[1][1];D||(D=0),D&=127;var V=D==0?[]:u.slice(-D);u.length-=D,G==="User"&&(G=V.shift()),u.push(G+"("+V.join(",")+")");break;case"PtgBool":u.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(E[1]);break;case"PtgNum":u.push(String(E[1]));break;case"PtgStr":u.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(E[1]);break;case"PtgAreaN":y=B_(E[1][1],r?{s:r}:o,s),u.push(Tm(y,s));break;case"PtgArea":y=B_(E[1][1],o,s),u.push(Tm(y,s));break;case"PtgArea3d":g=E[1][1],y=E[1][2],w=cb(a,g,s),u.push(w+"!"+Tm(y,s));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=E[1][2];var A=(a.names||[])[p-1]||(a[0]||[])[p],M=A?A.Name:"SH33TJSNAME"+String(p);M&&M.slice(0,6)=="_xlfn."&&!s.xlfn&&(M=M.slice(6)),u.push(M);break;case"PtgNameX":var C=E[1][1];p=E[1][2];var U;if(s.biff<=5)C<0&&(C=-C),a[C]&&(U=a[C][p]);else{var Z="";if(((a[C]||[])[0]||[])[0]==14849||(((a[C]||[])[0]||[])[0]==1025?a[C][p]&&a[C][p].itab>0&&(Z=a.SheetNames[a[C][p].itab-1]+"!"):Z=a.SheetNames[p-1]+"!"),a[C]&&a[C][p])Z+=a[C][p].Name;else if(a[0]&&a[0][p])Z+=a[0][p].Name;else{var q=(j2(a,C,s)||"").split(";;");q[p-1]?Z=q[p-1]:Z+="SH33TJSERRX"}u.push(Z);break}U||(U={Name:"SH33TJSERRY"}),u.push(U.Name);break;case"PtgParen":var le="(",ge=")";if(_>=0){switch(S="",e[0][_][1][0]){case 2:le=kr(" ",e[0][_][1][1])+le;break;case 3:le=kr("\r",e[0][_][1][1])+le;break;case 4:ge=kr(" ",e[0][_][1][1])+ge;break;case 5:ge=kr("\r",e[0][_][1][1])+ge;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}_=-1}u.push(le+u.pop()+ge);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":x={c:E[1][1],r:E[1][0]};var Se={c:r.c,r:r.r};if(a.sharedf[dt(x)]){var te=a.sharedf[dt(x)];u.push(va(te,o,Se,a,s))}else{var ae=!1;for(h=0;h!=a.arrayf.length;++h)if(d=a.arrayf[h],!(x.c<d[0].s.c||x.c>d[0].e.c)&&!(x.r<d[0].s.r||x.r>d[0].e.r)){u.push(va(d[1],o,Se,a,s)),ae=!0;break}ae||u.push(E[1])}break;case"PtgArray":u.push("{"+s8(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var De=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&_>=0&&De.indexOf(e[0][T][0])==-1){E=e[0][_];var ie=!0;switch(E[1][0]){case 4:ie=!1;case 0:S=kr(" ",E[1][1]);break;case 5:ie=!1;case 1:S=kr("\r",E[1][1]);break;default:if(S="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}u.push((ie?S:"")+u.pop()+(ie?"":S)),_=-1}}if(u.length>1&&s.WTF)throw new Error("bad formula stack");return u[0]}function o8(e,t,r){var a=e.l+t,s=r.biff==2?1:2,l,o=e.read_shift(s);if(o==65535)return[[],wa(e,t-2)];var u=au(e,o,r);return t!==o+s&&(l=ru(e,t-o-s,u,r)),e.l=a,[u,l]}function c8(e,t,r){var a=e.l+t,s=r.biff==2?1:2,l,o=e.read_shift(s);if(o==65535)return[[],wa(e,t-2)];var u=au(e,o,r);return t!==o+s&&(l=ru(e,t-o-s,u,r)),e.l=a,[u,l]}function u8(e,t,r,a){var s=e.l+t,l=au(e,a,r),o;return s!==e.l&&(o=ru(e,s-e.l,l,r)),[l,o]}function f8(e,t,r){var a=e.l+t,s,l=e.read_shift(2),o=au(e,l,r);return l==65535?[[],wa(e,t-2)]:(t!==l+2&&(s=ru(e,a-l-2,o,r)),[o,s])}function d8(e){var t;if(vs(e,e.l+6)!==65535)return[_a(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function h8(e){if(e==null){var t=be(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Gi(e);return Gi(0)}function Om(e,t,r){var a=e.l+t,s=Qn(e);r.biff==2&&++e.l;var l=d8(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var u=c8(e,a-e.l,r);return{cell:s,val:l[0],formula:u,shared:o>>3&1,tt:l[1]}}function m8(e,t,r,a,s){var l=Xi(t,r,s),o=h8(e.v),u=be(6),h=33;u.write_shift(2,h),u.write_shift(4,0);for(var d=be(e.bf.length),x=0;x<e.bf.length;++x)d[x]=e.bf[x];var g=Qr([l,o,u,d]);return g}function ed(e,t,r){var a=e.read_shift(4),s=au(e,a,r),l=e.read_shift(4),o=l>0?ru(e,l,s,r):null;return[s,o]}var x8=ed,td=ed,p8=ed,g8=ed,v8={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},A2={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},y8={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ub(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function _8(e){var t="of:="+e.replace(Mx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Cm(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function b8(e){return e.replace(/\./,"!")}var bc={},ro={},wc=typeof Map<"u";function Bx(e,t,r){var a=0,s=e.length;if(r){if(wc?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var l=wc?r.get(t):r[t];a<l.length;++a)if(e[l[a]].t===t)return e.Count++,l[a]}}else for(;a<s;++a)if(e[a].t===t)return e.Count++,a;return e[s]={t},e.Count++,e.Unique++,r&&(wc?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function rd(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(ya=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=zc(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=If(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Hi(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ui(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],s=60,l=e.length;if(a==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){_s(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=a=s;break}}for(s=0;s!=l;++s)if(e[s].numFmtId===a)return s;return e[l]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function O2(e,t,r,a,s,l){try{a.cellNF&&(e.z=ut[t])}catch(u){if(a.WTF)throw u}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=hr(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(ut[t]==null&&_s(vj[t]||"General",t),e.t==="e")e.w=e.w||ks[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Fc(e.v);else if(e.t==="d"){var o=Kr(e.v);(o|0)===o?e.w=o.toString(10):e.w=Fc(o)}else{if(e.v===void 0)return"";e.w=qi(e.v,ro)}else e.t==="d"?e.w=Tn(t,Kr(e.v),ro):e.w=Tn(t,e.v,ro)}catch(u){if(a.WTF)throw u}if(a.cellStyles&&r!=null)try{e.s=l.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Mf(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Mf(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(a.WTF&&l.Fills)throw u}}}function w8(e,t,r){if(e&&e["!ref"]){var a=Mt(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function S8(e,t){var r=Mt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=yt(r))}var E8=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,T8=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,k8=/<(?:\w:)?hyperlink [^>]*>/mg,N8=/"(\w*:\w*)"/,j8=/<(?:\w:)?col\b[^>]*[\/]?>/g,A8=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,O8=/<(?:\w:)?pageMargins[^>]*\/>/g,C2=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,C8=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,R8=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function D8(e,t,r,a,s,l,o){if(!e)return e;a||(a={"!id":{}});var u=t.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",x="",g=e.match(T8);g?(d=e.slice(0,g.index),x=e.slice(g.index+g[0].length)):d=x=e;var p=d.match(C2);p?Px(p[0],u,s,r):(p=d.match(C8))&&M8(p[0],p[1]||"",u,s,r);var y=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var w=d.slice(y,y+50).match(N8);w&&S8(u,w[1])}var _=d.match(R8);_&&_[1]&&W8(_[1],s);var S=[];if(t.cellStyles){var T=d.match(j8);T&&q8(S,T)}g&&J8(g[1],u,t,h,l,o);var N=x.match(A8);N&&(u["!autofilter"]=G8(N[0]));var E=[],D=x.match(E8);if(D)for(y=0;y!=D.length;++y)E[y]=Mt(D[y].slice(D[y].indexOf('"')+1));var G=x.match(k8);G&&U8(u,G,a);var V=x.match(O8);if(V&&(u["!margins"]=z8(ht(V[0]))),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=yt(h)),t.sheetRows>0&&u["!ref"]){var A=Mt(u["!ref"]);t.sheetRows<=+A.e.r&&(A.e.r=t.sheetRows-1,A.e.r>h.e.r&&(A.e.r=h.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>h.e.c&&(A.e.c=h.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),u["!fullref"]=u["!ref"],u["!ref"]=yt(A))}return S.length>0&&(u["!cols"]=S),E.length>0&&(u["!merges"]=E),u}function F8(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+yt(e[r])+'"/>';return t+"</mergeCells>"}function Px(e,t,r,a){var s=ht(e);r.Sheets[a]||(r.Sheets[a]={}),s.codeName&&(r.Sheets[a].CodeName=Ft(sr(s.codeName)))}function M8(e,t,r,a,s){Px(e.slice(0,e.indexOf(">")),r,a,s)}function I8(e,t,r,a,s){var l=!1,o={},u=null;if(a.bookType!=="xlsx"&&t.vbaraw){var h=t.SheetNames[r];try{t.Workbook&&(h=t.Workbook.Sheets[r].CodeName||h)}catch{}l=!0,o.codeName=Yn(er(h))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),u=(u||"")+ze("outlinePr",null,d)}!l&&!u||(s[s.length]=ze("sheetPr",u,o))}var L8=["objects","scenarios","selectLockedCells","selectUnlockedCells"],B8=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function P8(e){var t={sheet:1};return L8.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),B8.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Rx(e.password).toString(16).toUpperCase()),ze("sheetProtection",null,t)}function U8(e,t,r){for(var a=Array.isArray(e),s=0;s!=t.length;++s){var l=ht(sr(t[s]),!0);if(!l.ref)return;var o=((r||{})["!id"]||[])[l.id];o?(l.Target=o.Target,l.location&&(l.Target+="#"+Ft(l.location))):(l.Target="#"+Ft(l.location),o={Target:l.Target,TargetMode:"Internal"}),l.Rel=o,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var u=Mt(l.ref),h=u.s.r;h<=u.e.r;++h)for(var d=u.s.c;d<=u.e.c;++d){var x=dt({c:d,r:h});a?(e[h]||(e[h]=[]),e[h][d]||(e[h][d]={t:"z",v:void 0}),e[h][d].l=l):(e[x]||(e[x]={t:"z",v:void 0}),e[x].l=l)}}}function z8(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function H8(e){return Hi(e),ze("pageMargins",null,e)}function q8(e,t){for(var r=!1,a=0;a!=t.length;++a){var s=ht(t[a],!0);s.hidden&&(s.hidden=dr(s.hidden));var l=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,Dx(s.width)),si(s);l<=o;)e[l++]=mr(s)}}function $8(e,t){for(var r=["<cols>"],a,s=0;s!=t.length;++s)(a=t[s])&&(r[r.length]=ze("col",null,rd(s,a)));return r[r.length]="</cols>",r.join("")}function G8(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function V8(e,t,r,a){var s=typeof e.ref=="string"?e.ref:yt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=Ha(s);o.s.r==o.e.r&&(o.e.r=Ha(t["!ref"]).e.r,s=yt(o));for(var u=0;u<l.length;++u){var h=l[u];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==a){h.Ref="'"+r.SheetNames[a]+"'!"+s;break}}return u==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),ze("autoFilter",null,{ref:s})}var X8=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function W8(e,t){t.Views||(t.Views=[{}]),(e.match(X8)||[]).forEach(function(r,a){var s=ht(r);t.Views[a]||(t.Views[a]={}),+s.zoomScale&&(t.Views[a].zoom=+s.zoomScale),dr(s.rightToLeft)&&(t.Views[a].RTL=!0)})}function K8(e,t,r,a){var s={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),ze("sheetViews",ze("sheetView",null,s),{})}function Y8(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",l=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=ks[e.v];break;case"d":a&&a.cellDates?s=hr(e.v,-1).toISOString():(e=mr(e),e.t="n",s=""+(e.v=Kr(hr(e.v)))),typeof e.z>"u"&&(e.z=ut[14]);break;default:s=e.v;break}var u=ca("v",er(s)),h={r:t},d=ui(a.cellXfs,e,a);switch(d!==0&&(h.s=d),e.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){u=ca("v",""+Bx(a.Strings,e.v,a.revStrings)),h.t="s";break}h.t="str";break}if(e.t!=l&&(e.t=l,e.v=o),typeof e.f=="string"&&e.f){var x=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;u=ze("f",er(e.f),x)+(e.v!=null?u:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(h.cm=1),ze("c",u,h)}var J8=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,l=Mc("v"),o=Mc("f");return function(h,d,x,g,p,y){for(var w=0,_="",S=[],T=[],N=0,E=0,D=0,G="",V,A,M=0,C=0,U,Z,q=0,le=0,ge=Array.isArray(y.CellXf),Se,te=[],ae=[],De=Array.isArray(d),ie=[],Me={},W=!1,O=!!x.sheetStubs,P=h.split(t),z=0,F=P.length;z!=F;++z){_=P[z].trim();var Q=_.length;if(Q!==0){var re=0;e:for(w=0;w<Q;++w)switch(_[w]){case">":if(_[w-1]!="/"){++w;break e}if(x&&x.cellStyles){if(A=ht(_.slice(re,w),!0),M=A.r!=null?parseInt(A.r,10):M+1,C=-1,x.sheetRows&&x.sheetRows<M)continue;Me={},W=!1,A.ht&&(W=!0,Me.hpt=parseFloat(A.ht),Me.hpx=so(Me.hpt)),A.hidden=="1"&&(W=!0,Me.hidden=!0),A.outlineLevel!=null&&(W=!0,Me.level=+A.outlineLevel),W&&(ie[M-1]=Me)}break;case"<":re=w;break}if(re>=w)break;if(A=ht(_.slice(re,w),!0),M=A.r!=null?parseInt(A.r,10):M+1,C=-1,!(x.sheetRows&&x.sheetRows<M)){g.s.r>M-1&&(g.s.r=M-1),g.e.r<M-1&&(g.e.r=M-1),x&&x.cellStyles&&(Me={},W=!1,A.ht&&(W=!0,Me.hpt=parseFloat(A.ht),Me.hpx=so(Me.hpt)),A.hidden=="1"&&(W=!0,Me.hidden=!0),A.outlineLevel!=null&&(W=!0,Me.level=+A.outlineLevel),W&&(ie[M-1]=Me)),S=_.slice(w).split(e);for(var Ee=0;Ee!=S.length&&S[Ee].trim().charAt(0)=="<";++Ee);for(S=S.slice(Ee),w=0;w!=S.length;++w)if(_=S[w].trim(),_.length!==0){if(T=_.match(r),N=w,E=0,D=0,_="<c "+(_.slice(0,1)=="<"?">":"")+_,T!=null&&T.length===2){for(N=0,G=T[1],E=0;E!=G.length&&!((D=G.charCodeAt(E)-64)<1||D>26);++E)N=26*N+D;--N,C=N}else++C;for(E=0;E!=_.length&&_.charCodeAt(E)!==62;++E);if(++E,A=ht(_.slice(0,E),!0),A.r||(A.r=dt({r:M-1,c:C})),G=_.slice(E),V={t:""},(T=G.match(l))!=null&&T[1]!==""&&(V.v=Ft(T[1])),x.cellFormula){if((T=G.match(o))!=null&&T[1]!==""){if(V.f=Ft(sr(T[1])).replace(/\r\n/g,`
`),x.xlfn||(V.f=ib(V.f)),T[0].indexOf('t="array"')>-1)V.F=(G.match(s)||[])[1],V.F.indexOf(":")>-1&&te.push([Mt(V.F),V.F]);else if(T[0].indexOf('t="shared"')>-1){Z=ht(T[0]);var ye=Ft(sr(T[1]));x.xlfn||(ye=ib(ye)),ae[parseInt(Z.si,10)]=[Z,ye,A.r]}}else(T=G.match(/<f[^>]*\/>/))&&(Z=ht(T[0]),ae[Z.si]&&(V.f=X5(ae[Z.si][1],ae[Z.si][2],A.r)));var Oe=yr(A.r);for(E=0;E<te.length;++E)Oe.r>=te[E][0].s.r&&Oe.r<=te[E][0].e.r&&Oe.c>=te[E][0].s.c&&Oe.c<=te[E][0].e.c&&(V.F=te[E][1])}if(A.t==null&&V.v===void 0)if(V.f||V.F)V.v=0,V.t="n";else if(O)V.t="z";else continue;else V.t=A.t||"n";switch(g.s.c>C&&(g.s.c=C),g.e.c<C&&(g.e.c=C),V.t){case"n":if(V.v==""||V.v==null){if(!O)continue;V.t="z"}else V.v=parseFloat(V.v);break;case"s":if(typeof V.v>"u"){if(!O)continue;V.t="z"}else U=bc[parseInt(V.v,10)],V.v=U.t,V.r=U.r,x.cellHTML&&(V.h=U.h);break;case"str":V.t="s",V.v=V.v!=null?sr(V.v):"",x.cellHTML&&(V.h=gx(V.v));break;case"inlineStr":T=G.match(a),V.t="s",T!=null&&(U=Cx(T[1]))?(V.v=U.t,x.cellHTML&&(V.h=U.h)):V.v="";break;case"b":V.v=dr(V.v);break;case"d":x.cellDates?V.v=hr(V.v,1):(V.v=Kr(hr(V.v,1)),V.t="n");break;case"e":(!x||x.cellText!==!1)&&(V.w=V.v),V.v=Dw[V.v];break}if(q=le=0,Se=null,ge&&A.s!==void 0&&(Se=y.CellXf[A.s],Se!=null&&(Se.numFmtId!=null&&(q=Se.numFmtId),x.cellStyles&&Se.fillId!=null&&(le=Se.fillId))),O2(V,q,le,x,p,y),x.cellDates&&ge&&V.t=="n"&&oo(ut[q])&&(V.t="d",V.v=Qf(V.v)),A.cm&&x.xlmeta){var tt=(x.xlmeta.Cell||[])[+A.cm-1];tt&&tt.type=="XLDAPR"&&(V.D=!0)}if(De){var J=yr(A.r);d[J.r]||(d[J.r]=[]),d[J.r][J.c]=V}else d[A.r]=V}}}}ie.length>0&&(d["!rows"]=ie)}})();function Q8(e,t,r,a){var s=[],l=[],o=Mt(e["!ref"]),u="",h,d="",x=[],g=0,p=0,y=e["!rows"],w=Array.isArray(e),_={r:d},S,T=-1;for(p=o.s.c;p<=o.e.c;++p)x[p]=vr(p);for(g=o.s.r;g<=o.e.r;++g){for(l=[],d=Rr(g),p=o.s.c;p<=o.e.c;++p){h=x[p]+d;var N=w?(e[g]||[])[p]:e[h];N!==void 0&&(u=Y8(N,h,e,t))!=null&&l.push(u)}(l.length>0||y&&y[g])&&(_={r:d},y&&y[g]&&(S=y[g],S.hidden&&(_.hidden=1),T=-1,S.hpx?T=Hc(S.hpx):S.hpt&&(T=S.hpt),T>-1&&(_.ht=T,_.customHeight=1),S.level&&(_.outlineLevel=S.level)),s[s.length]=ze("row",l.join(""),_))}if(y)for(;g<y.length;++g)y&&y[g]&&(_={r:g+1},S=y[g],S.hidden&&(_.hidden=1),T=-1,S.hpx?T=Hc(S.hpx):S.hpt&&(T=S.hpt),T>-1&&(_.ht=T,_.customHeight=1),S.level&&(_.outlineLevel=S.level),s[s.length]=ze("row","",_));return s.join("")}function R2(e,t,r,a){var s=[Dr,ze("worksheet",null,{xmlns:Ki[0],"xmlns:r":Wr.r})],l=r.SheetNames[e],o=0,u="",h=r.Sheets[l];h==null&&(h={});var d=h["!ref"]||"A1",x=Mt(d);if(x.e.c>16383||x.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");x.e.c=Math.min(x.e.c,16383),x.e.r=Math.min(x.e.c,1048575),d=yt(x)}a||(a={}),h["!comments"]=[];var g=[];I8(h,r,e,t,s),s[s.length]=ze("dimension",null,{ref:d}),s[s.length]=K8(h,t,e,r),t.sheetFormat&&(s[s.length]=ze("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),h["!cols"]!=null&&h["!cols"].length>0&&(s[s.length]=$8(h,h["!cols"])),s[o=s.length]="<sheetData/>",h["!links"]=[],h["!ref"]!=null&&(u=Q8(h,t),u.length>0&&(s[s.length]=u)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),h["!protect"]&&(s[s.length]=P8(h["!protect"])),h["!autofilter"]!=null&&(s[s.length]=V8(h["!autofilter"],h,r,e)),h["!merges"]!=null&&h["!merges"].length>0&&(s[s.length]=F8(h["!merges"]));var p=-1,y,w=-1;return h["!links"].length>0&&(s[s.length]="<hyperlinks>",h["!links"].forEach(function(_){_[1].Target&&(y={ref:_[0]},_[1].Target.charAt(0)!="#"&&(w=Zt(a,-1,er(_[1].Target).replace(/#.*$/,""),Et.HLINK),y["r:id"]="rId"+w),(p=_[1].Target.indexOf("#"))>-1&&(y.location=er(_[1].Target.slice(p+1))),_[1].Tooltip&&(y.tooltip=er(_[1].Tooltip)),s[s.length]=ze("hyperlink",null,y))}),s[s.length]="</hyperlinks>"),delete h["!links"],h["!margins"]!=null&&(s[s.length]=H8(h["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=ca("ignoredErrors",ze("ignoredError",null,{numberStoredAsText:1,sqref:d}))),g.length>0&&(w=Zt(a,-1,"../drawings/drawing"+(e+1)+".xml",Et.DRAW),s[s.length]=ze("drawing",null,{"r:id":"rId"+w}),h["!drawing"]=g),h["!comments"].length>0&&(w=Zt(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Et.VML),s[s.length]=ze("legacyDrawing",null,{"r:id":"rId"+w}),h["!legacy"]=w),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function Z8(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=a,l&7&&(r.level=l&7),l&16&&(r.hidden=!0),l&32&&(r.hpt=s/20),r}function eR(e,t,r){var a=be(145),s=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var l=320;s.hpx?l=Hc(s.hpx)*20:s.hpt&&(l=s.hpt*20),a.write_shift(2,l),a.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),a.write_shift(1,o),a.write_shift(1,0);var u=0,h=a.l;a.l+=4;for(var d={r:e,c:0},x=0;x<16;++x)if(!(t.s.c>x+1<<10||t.e.c<x<<10)){for(var g=-1,p=-1,y=x<<10;y<x+1<<10;++y){d.c=y;var w=Array.isArray(r)?(r[d.r]||[])[d.c]:r[dt(d)];w&&(g<0&&(g=y),p=y)}g<0||(++u,a.write_shift(4,g),a.write_shift(4,p))}var _=a.l;return a.l=h,a.write_shift(4,u),a.l=_,a.length>a.l?a.slice(0,a.l):a}function tR(e,t,r,a){var s=eR(a,r,t);(s.length>17||(t["!rows"]||[])[a])&&Re(e,0,s)}var rR=Zi,aR=fo;function nR(){}function sR(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=oA(e),r}function iR(e,t,r){r==null&&(r=be(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var s=1;s<3;++s)r.write_shift(1,0);return Rf({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),jw(e,r),r.slice(0,r.l)}function lR(e){var t=kn(e);return[t]}function oR(e,t,r){return r==null&&(r=be(8)),Yi(t,r)}function cR(e){var t=Ji(e);return[t]}function uR(e,t,r){return r==null&&(r=be(4)),Qi(t,r)}function fR(e){var t=kn(e),r=e.read_shift(1);return[t,r,"b"]}function dR(e,t,r){return r==null&&(r=be(9)),Yi(t,r),r.write_shift(1,e.v?1:0),r}function hR(e){var t=Ji(e),r=e.read_shift(1);return[t,r,"b"]}function mR(e,t,r){return r==null&&(r=be(5)),Qi(t,r),r.write_shift(1,e.v?1:0),r}function xR(e){var t=kn(e),r=e.read_shift(1);return[t,r,"e"]}function pR(e,t,r){return r==null&&(r=be(9)),Yi(t,r),r.write_shift(1,e.v),r}function gR(e){var t=Ji(e),r=e.read_shift(1);return[t,r,"e"]}function vR(e,t,r){return r==null&&(r=be(8)),Qi(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function yR(e){var t=kn(e),r=e.read_shift(4);return[t,r,"s"]}function _R(e,t,r){return r==null&&(r=be(12)),Yi(t,r),r.write_shift(4,t.v),r}function bR(e){var t=Ji(e),r=e.read_shift(4);return[t,r,"s"]}function wR(e,t,r){return r==null&&(r=be(8)),Qi(t,r),r.write_shift(4,t.v),r}function SR(e){var t=kn(e),r=_a(e);return[t,r,"n"]}function ER(e,t,r){return r==null&&(r=be(16)),Yi(t,r),Gi(e.v,r),r}function D2(e){var t=Ji(e),r=_a(e);return[t,r,"n"]}function TR(e,t,r){return r==null&&(r=be(12)),Qi(t,r),Gi(e.v,r),r}function kR(e){var t=kn(e),r=kx(e);return[t,r,"n"]}function NR(e,t,r){return r==null&&(r=be(12)),Yi(t,r),Aw(e.v,r),r}function jR(e){var t=Ji(e),r=kx(e);return[t,r,"n"]}function AR(e,t,r){return r==null&&(r=be(8)),Qi(t,r),Aw(e.v,r),r}function OR(e){var t=kn(e),r=Sx(e);return[t,r,"is"]}function CR(e){var t=kn(e),r=ba(e);return[t,r,"str"]}function RR(e,t,r){return r==null&&(r=be(12+4*e.v.length)),Yi(t,r),Zr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function DR(e){var t=Ji(e),r=ba(e);return[t,r,"str"]}function FR(e,t,r){return r==null&&(r=be(8+4*e.v.length)),Qi(t,r),Zr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function MR(e,t,r){var a=e.l+t,s=kn(e);s.r=r["!row"];var l=e.read_shift(1),o=[s,l,"b"];if(r.cellFormula){e.l+=2;var u=td(e,a-e.l,r);o[3]=va(u,null,s,r.supbooks,r)}else e.l=a;return o}function IR(e,t,r){var a=e.l+t,s=kn(e);s.r=r["!row"];var l=e.read_shift(1),o=[s,l,"e"];if(r.cellFormula){e.l+=2;var u=td(e,a-e.l,r);o[3]=va(u,null,s,r.supbooks,r)}else e.l=a;return o}function LR(e,t,r){var a=e.l+t,s=kn(e);s.r=r["!row"];var l=_a(e),o=[s,l,"n"];if(r.cellFormula){e.l+=2;var u=td(e,a-e.l,r);o[3]=va(u,null,s,r.supbooks,r)}else e.l=a;return o}function BR(e,t,r){var a=e.l+t,s=kn(e);s.r=r["!row"];var l=ba(e),o=[s,l,"str"];if(r.cellFormula){e.l+=2;var u=td(e,a-e.l,r);o[3]=va(u,null,s,r.supbooks,r)}else e.l=a;return o}var PR=Zi,UR=fo;function zR(e,t){return t==null&&(t=be(4)),t.write_shift(4,e),t}function HR(e,t){var r=e.l+t,a=Zi(e),s=Ex(e),l=ba(e),o=ba(e),u=ba(e);e.l=r;var h={rfx:a,relId:s,loc:l,display:u};return o&&(h.Tooltip=o),h}function qR(e,t){var r=be(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));fo({s:yr(e[0]),e:yr(e[0])},r),Tx("rId"+t,r);var a=e[1].Target.indexOf("#"),s=a==-1?"":e[1].Target.slice(a+1);return Zr(s||"",r),Zr(e[1].Tooltip||"",r),Zr("",r),r.slice(0,r.l)}function $R(){}function GR(e,t,r){var a=e.l+t,s=Ow(e),l=e.read_shift(1),o=[s];if(o[2]=l,r.cellFormula){var u=x8(e,a-e.l,r);o[1]=u}else e.l=a;return o}function VR(e,t,r){var a=e.l+t,s=Zi(e),l=[s];if(r.cellFormula){var o=g8(e,a-e.l,r);l[1]=o,e.l=a}else e.l=a;return l}function XR(e,t,r){r==null&&(r=be(18));var a=rd(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof a.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var F2=["left","right","top","bottom","header","footer"];function WR(e){var t={};return F2.forEach(function(r){t[r]=_a(e)}),t}function KR(e,t){return t==null&&(t=be(48)),Hi(e),F2.forEach(function(r){Gi(e[r],t)}),t}function YR(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function JR(e,t,r){r==null&&(r=be(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function QR(e){var t=be(24);return t.write_shift(4,4),t.write_shift(4,1),fo(e,t),t}function ZR(e,t){return t==null&&(t=be(66)),t.write_shift(2,e.password?Rx(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function eD(){}function tD(){}function rD(e,t,r,a,s,l,o){if(!e)return e;var u=t||{};a||(a={"!id":{}});var h=u.dense?[]:{},d,x={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=!1,p=!1,y,w,_,S,T,N,E,D,G,V=[];u.biff=12,u["!row"]=0;var A=0,M=!1,C=[],U={},Z=u.supbooks||s.supbooks||[[]];if(Z.sharedf=U,Z.arrayf=C,Z.SheetNames=s.SheetNames||s.Sheets.map(function(De){return De.name}),!u.supbooks&&(u.supbooks=Z,s.Names))for(var q=0;q<s.Names.length;++q)Z[0][q+1]=s.Names[q];var le=[],ge=[],Se=!1;qc[16]={n:"BrtShortReal",f:D2};var te;if(Ts(e,function(ie,Me,W){if(!p)switch(W){case 148:d=ie;break;case 0:y=ie,u.sheetRows&&u.sheetRows<=y.r&&(p=!0),D=Rr(S=y.r),u["!row"]=y.r,(ie.hidden||ie.hpt||ie.level!=null)&&(ie.hpt&&(ie.hpx=so(ie.hpt)),ge[ie.r]=ie);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:ie[2]},ie[2]){case"n":w.v=ie[1];break;case"s":E=bc[ie[1]],w.v=E.t,w.r=E.r;break;case"b":w.v=!!ie[1];break;case"e":w.v=ie[1],u.cellText!==!1&&(w.w=ks[w.v]);break;case"str":w.t="s",w.v=ie[1];break;case"is":w.t="s",w.v=ie[1].t;break}if((_=o.CellXf[ie[0].iStyleRef])&&O2(w,_.numFmtId,null,u,l,o),T=ie[0].c==-1?T+1:ie[0].c,u.dense?(h[S]||(h[S]=[]),h[S][T]=w):h[vr(T)+D]=w,u.cellFormula){for(M=!1,A=0;A<C.length;++A){var O=C[A];y.r>=O[0].s.r&&y.r<=O[0].e.r&&T>=O[0].s.c&&T<=O[0].e.c&&(w.F=yt(O[0]),M=!0)}!M&&ie.length>3&&(w.f=ie[3])}if(x.s.r>y.r&&(x.s.r=y.r),x.s.c>T&&(x.s.c=T),x.e.r<y.r&&(x.e.r=y.r),x.e.c<T&&(x.e.c=T),u.cellDates&&_&&w.t=="n"&&oo(ut[_.numFmtId])){var P=Bi(w.v);P&&(w.t="d",w.v=new Date(P.y,P.m-1,P.d,P.H,P.M,P.S,P.u))}te&&(te.type=="XLDAPR"&&(w.D=!0),te=void 0);break;case 1:case 12:if(!u.sheetStubs||g)break;w={t:"z",v:void 0},T=ie[0].c==-1?T+1:ie[0].c,u.dense?(h[S]||(h[S]=[]),h[S][T]=w):h[vr(T)+D]=w,x.s.r>y.r&&(x.s.r=y.r),x.s.c>T&&(x.s.c=T),x.e.r<y.r&&(x.e.r=y.r),x.e.c<T&&(x.e.c=T),te&&(te.type=="XLDAPR"&&(w.D=!0),te=void 0);break;case 176:V.push(ie);break;case 49:te=((u.xlmeta||{}).Cell||[])[ie-1];break;case 494:var z=a["!id"][ie.relId];for(z?(ie.Target=z.Target,ie.loc&&(ie.Target+="#"+ie.loc),ie.Rel=z):ie.relId==""&&(ie.Target="#"+ie.loc),S=ie.rfx.s.r;S<=ie.rfx.e.r;++S)for(T=ie.rfx.s.c;T<=ie.rfx.e.c;++T)u.dense?(h[S]||(h[S]=[]),h[S][T]||(h[S][T]={t:"z",v:void 0}),h[S][T].l=ie):(N=dt({c:T,r:S}),h[N]||(h[N]={t:"z",v:void 0}),h[N].l=ie);break;case 426:if(!u.cellFormula)break;C.push(ie),G=u.dense?h[S][T]:h[vr(T)+D],G.f=va(ie[1],x,{r:y.r,c:T},Z,u),G.F=yt(ie[0]);break;case 427:if(!u.cellFormula)break;U[dt(ie[0].s)]=ie[1],G=u.dense?h[S][T]:h[vr(T)+D],G.f=va(ie[1],x,{r:y.r,c:T},Z,u);break;case 60:if(!u.cellStyles)break;for(;ie.e>=ie.s;)le[ie.e--]={width:ie.w/256,hidden:!!(ie.flags&1),level:ie.level},Se||(Se=!0,Dx(ie.w/256)),si(le[ie.e+1]);break;case 161:h["!autofilter"]={ref:yt(ie)};break;case 476:h["!margins"]=ie;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),ie.name&&(s.Sheets[r].CodeName=ie.name),(ie.above||ie.left)&&(h["!outline"]={above:ie.above,left:ie.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),ie.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:g=!0;break;case 36:g=!1;break;case 37:g=!0;break;case 38:g=!1;break;default:if(!Me.T){if(!g||u.WTF)throw new Error("Unexpected record 0x"+W.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(x.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(h["!ref"]=yt(d||x)),u.sheetRows&&h["!ref"]){var ae=Mt(h["!ref"]);u.sheetRows<=+ae.e.r&&(ae.e.r=u.sheetRows-1,ae.e.r>x.e.r&&(ae.e.r=x.e.r),ae.e.r<ae.s.r&&(ae.s.r=ae.e.r),ae.e.c>x.e.c&&(ae.e.c=x.e.c),ae.e.c<ae.s.c&&(ae.s.c=ae.e.c),h["!fullref"]=h["!ref"],h["!ref"]=yt(ae))}return V.length>0&&(h["!merges"]=V),le.length>0&&(h["!cols"]=le),ge.length>0&&(h["!rows"]=ge),h}function aD(e,t,r,a,s,l,o){if(t.v===void 0)return!1;var u="";switch(t.t){case"b":u=t.v?"1":"0";break;case"d":t=mr(t),t.z=t.z||ut[14],t.v=Kr(hr(t.v)),t.t="n";break;case"n":case"e":u=""+t.v;break;default:u=t.v;break}var h={r,c:a};switch(h.s=ui(s.cellXfs,t,s),t.l&&l["!links"].push([dt(h),t.l]),t.c&&l["!comments"].push([dt(h),t.c]),t.t){case"s":case"str":return s.bookSST?(u=Bx(s.Strings,t.v,s.revStrings),h.t="s",h.v=u,o?Re(e,18,wR(t,h)):Re(e,7,_R(t,h))):(h.t="str",o?Re(e,17,FR(t,h)):Re(e,6,RR(t,h))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?Re(e,13,AR(t,h)):Re(e,2,NR(t,h)):o?Re(e,16,TR(t,h)):Re(e,5,ER(t,h)),!0;case"b":return h.t="b",o?Re(e,15,mR(t,h)):Re(e,4,dR(t,h)),!0;case"e":return h.t="e",o?Re(e,14,vR(t,h)):Re(e,3,pR(t,h)),!0}return o?Re(e,12,uR(t,h)):Re(e,1,oR(t,h)),!0}function nD(e,t,r,a){var s=Mt(t["!ref"]||"A1"),l,o="",u=[];Re(e,145);var h=Array.isArray(t),d=s.e.r;t["!rows"]&&(d=Math.max(s.e.r,t["!rows"].length-1));for(var x=s.s.r;x<=d;++x){o=Rr(x),tR(e,t,s,x);var g=!1;if(x<=s.e.r)for(var p=s.s.c;p<=s.e.c;++p){x===s.s.r&&(u[p]=vr(p)),l=u[p]+o;var y=h?(t[x]||[])[p]:t[l];if(!y){g=!1;continue}g=aD(e,y,x,p,a,t,g)}}Re(e,146)}function sD(e,t){!t||!t["!merges"]||(Re(e,177,zR(t["!merges"].length)),t["!merges"].forEach(function(r){Re(e,176,UR(r))}),Re(e,178))}function iD(e,t){!t||!t["!cols"]||(Re(e,390),t["!cols"].forEach(function(r,a){r&&Re(e,60,XR(a,r))}),Re(e,391))}function lD(e,t){!t||!t["!ref"]||(Re(e,648),Re(e,649,QR(Mt(t["!ref"]))),Re(e,650))}function oD(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var s=Zt(r,-1,a[1].Target.replace(/#.*$/,""),Et.HLINK);Re(e,494,qR(a,s))}}),delete t["!links"]}function cD(e,t,r,a){if(t["!comments"].length>0){var s=Zt(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Et.VML);Re(e,551,Tx("rId"+s)),t["!legacy"]=s}}function uD(e,t,r,a){if(t["!autofilter"]){var s=t["!autofilter"],l=typeof s.ref=="string"?s.ref:yt(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,u=Ha(l);u.s.r==u.e.r&&(u.e.r=Ha(t["!ref"]).e.r,l=yt(u));for(var h=0;h<o.length;++h){var d=o[h];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a){d.Ref="'"+r.SheetNames[a]+"'!"+l;break}}h==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+l}),Re(e,161,fo(Mt(l))),Re(e,162)}}function fD(e,t,r){Re(e,133),Re(e,137,JR(t,r)),Re(e,138),Re(e,134)}function dD(e,t){t["!protect"]&&Re(e,535,ZR(t["!protect"]))}function hD(e,t,r,a){var s=za(),l=r.SheetNames[e],o=r.Sheets[l]||{},u=l;try{r&&r.Workbook&&(u=r.Workbook.Sheets[e].CodeName||u)}catch{}var h=Mt(o["!ref"]||"A1");if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Re(s,129),(r.vbaraw||o["!outline"])&&Re(s,147,iR(u,o["!outline"])),Re(s,148,aR(h)),fD(s,o,r.Workbook),iD(s,o),nD(s,o,e,t),dD(s,o),uD(s,o,r,e),sD(s,o),oD(s,o,a),o["!margins"]&&Re(s,476,KR(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&lD(s,o),cD(s,o,e,a),Re(s,130),s.end()}function mD(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var o=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var s=Ft((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){a=l.replace(/<.*?>/g,"")}),[t,s,a]}function xD(e,t,r,a,s,l){var o=l||{"!type":"chart"};if(!e)return l;var u=0,h=0,d="A",x={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(g){var p=mD(g);x.s.r=x.s.c=0,x.e.c=u,d=vr(u),p[0].forEach(function(y,w){o[d+Rr(w)]={t:"n",v:y,z:p[1]},h=w}),x.e.r<h&&(x.e.r=h),++u}),u>0&&(o["!ref"]=yt(x)),o}function pD(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o,u=e.match(C2);return u&&Px(u[0],l,s,r),(o=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=o[1]),a["!id"][l["!rel"]]&&(l["!drawel"]=a["!id"][l["!rel"]]),l}function gD(e,t){e.l+=10;var r=ba(e);return{name:r}}function vD(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Ts(e,function(h,d,x){switch(x){case 550:l["!rel"]=h;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),h.name&&(s.Sheets[r].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}}},t),a["!id"][l["!rel"]]&&(l["!drawel"]=a["!id"][l["!rel"]]),l}var Ux=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],yD=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],_D=[],bD=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function fb(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],s=0;s!=t.length;++s){var l=t[s];if(a[l[0]]==null)a[l[0]]=l[1];else switch(l[2]){case"bool":typeof a[l[0]]=="string"&&(a[l[0]]=dr(a[l[0]]));break;case"int":typeof a[l[0]]=="string"&&(a[l[0]]=parseInt(a[l[0]],10));break}}}function db(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=dr(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function M2(e){db(e.WBProps,Ux),db(e.CalcPr,bD),fb(e.WBView,yD),fb(e.Sheets,_D),ro.date1904=dr(e.WBProps.date1904)}function wD(e){return!e.Workbook||!e.Workbook.WBProps?"false":dr(e.Workbook.WBProps.date1904)?"true":"false"}var SD="][*?/\\".split("");function I2(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return SD.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function ED(e,t,r){e.forEach(function(a,s){I2(a);for(var l=0;l<s;++l)if(a==e[l])throw new Error("Duplicate Sheet Name: "+a);if(r){var o=t&&t[s]&&t[s].CodeName||a;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function TD(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];ED(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)w8(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var kD=/<\w+:workbook/;function ND(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,s="xmlns",l={},o=0;if(e.replace(Sa,function(h,d){var x=ht(h);switch(Jn(x[0])){case"<?xml":break;case"<workbook":h.match(kD)&&(s="xmlns"+h.match(/<(\w+):/)[1]),r.xmlns=x[s];break;case"</workbook>":break;case"<fileVersion":delete x[0],r.AppVersion=x;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Ux.forEach(function(g){if(x[g[0]]!=null)switch(g[2]){case"bool":r.WBProps[g[0]]=dr(x[g[0]]);break;case"int":r.WBProps[g[0]]=parseInt(x[g[0]],10);break;default:r.WBProps[g[0]]=x[g[0]]}}),x.codeName&&(r.WBProps.CodeName=sr(x.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete x[0],r.WBView.push(x);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(x.state){case"hidden":x.Hidden=1;break;case"veryHidden":x.Hidden=2;break;default:x.Hidden=0}delete x.state,x.name=Ft(sr(x.name)),delete x[0],r.Sheets.push(x);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":l={},l.Name=sr(x.name),x.comment&&(l.Comment=x.comment),x.localSheetId&&(l.Sheet=+x.localSheetId),dr(x.hidden||"0")&&(l.Hidden=!0),o=d+h.length;break;case"</definedName>":l.Ref=Ft(sr(e.slice(o,d))),r.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete x[0],r.CalcPr=x;break;case"<calcPr/>":delete x[0],r.CalcPr=x;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+x[0]+" in workbook")}return h}),Ki.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return M2(r),r}function L2(e){var t=[Dr];t[t.length]=ze("workbook",null,{xmlns:Ki[0],"xmlns:r":Wr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Ux.forEach(function(u){e.Workbook.WBProps[u[0]]!=null&&e.Workbook.WBProps[u[0]]!=u[1]&&(a[u[0]]=e.Workbook.WBProps[u[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=ze("workbookPr",null,a);var s=e.Workbook&&e.Workbook.Sheets||[],l=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",l=0;l!=e.SheetNames.length&&!(!s[l]||!s[l].Hidden);++l);l==e.SheetNames.length&&(l=0),t[t.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",l=0;l!=e.SheetNames.length;++l){var o={name:er(e.SheetNames[l].slice(0,31))};if(o.sheetId=""+(l+1),o["r:id"]="rId"+(l+1),s[l])switch(s[l].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=ze("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(u){var h={name:u.Name};u.Comment&&(h.comment=u.Comment),u.Sheet!=null&&(h.localSheetId=""+u.Sheet),u.Hidden&&(h.hidden="1"),u.Ref&&(t[t.length]=ze("definedName",er(u.Ref),h))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function jD(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Wm(e),r.name=ba(e),r}function AD(e,t){return t||(t=be(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Tx(e.strRelID,t),Zr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function OD(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?ba(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function CD(e,t){t||(t=be(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),jw(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function RD(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function DD(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),l=cA(e),o=p8(e,0,r),u=Ex(e);e.l=a;var h={Name:l,Ptg:o};return s<268435455&&(h.Sheet=s),u&&(h.Comment=u),h}function FD(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],s=!1;t||(t={}),t.biff=12;var l=[],o=[[]];return o.SheetNames=[],o.XTI=[],qc[16]={n:"BrtFRTArchID$",f:RD},Ts(e,function(h,d,x){switch(x){case 156:o.SheetNames.push(h.name),r.Sheets.push(h);break;case 153:r.WBProps=h;break;case 39:h.Sheet!=null&&(t.SID=h.Sheet),h.Ref=va(h.Ptg,null,null,o,t),delete t.SID,delete h.Ptg,l.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([x,h]):o[0]=[x,h],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(h),o.XTI=o.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(x),s=!0;break;case 36:a.pop(),s=!1;break;case 37:a.push(x),s=!0;break;case 38:a.pop(),s=!1;break;case 16:break;default:if(!d.T){if(!s||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+x.toString(16))}}},t),M2(r),r.Names=l,r.supbooks=o,r}function MD(e,t){Re(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Re(e,156,AD(s))}Re(e,144)}function ID(e,t){t||(t=be(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Zr("SheetJS",t),Zr(Tf.version,t),Zr(Tf.version,t),Zr("7262",t),t.length>t.l?t.slice(0,t.l):t}function LD(e,t){t||(t=be(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function BD(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,s=-1,l=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&s==-1?s=a:r[a].Hidden==1&&l==-1&&(l=a);l>s||(Re(e,135),Re(e,158,LD(s)),Re(e,136))}}function PD(e,t){var r=za();return Re(r,131),Re(r,128,ID()),Re(r,153,CD(e.Workbook&&e.Workbook.WBProps||null)),BD(r,e),MD(r,e),Re(r,132),r.end()}function UD(e,t,r){return t.slice(-4)===".bin"?FD(e,r):ND(e,r)}function zD(e,t,r,a,s,l,o,u){return t.slice(-4)===".bin"?rD(e,a,r,s,l,o,u):D8(e,a,r,s,l,o,u)}function HD(e,t,r,a,s,l,o,u){return t.slice(-4)===".bin"?vD(e,a,r,s,l):pD(e,a,r,s,l)}function qD(e,t,r,a,s,l,o,u){return t.slice(-4)===".bin"?G5():V5()}function $D(e,t,r,a,s,l,o,u){return t.slice(-4)===".bin"?q5():$5()}function GD(e,t,r,a){return t.slice(-4)===".bin"?UC(e,r,a):jC(e,r,a)}function VD(e,t,r){return g2(e,r)}function XD(e,t,r){return t.slice(-4)===".bin"?XO(e,r):$O(e,r)}function WD(e,t,r){return t.slice(-4)===".bin"?B5(e,r):A5(e,r)}function KD(e,t,r){return t.slice(-4)===".bin"?k5(e):E5(e)}function YD(e,t,r,a){return r.slice(-4)===".bin"?N5(e,t,r,a):void 0}function JD(e,t,r){return t.slice(-4)===".bin"?b5(e,t,r):S5(e,t,r)}function QD(e,t,r){return(t.slice(-4)===".bin"?PD:L2)(e)}function ZD(e,t,r,a,s){return(t.slice(-4)===".bin"?hD:R2)(e,r,a,s)}function eF(e,t,r){return(t.slice(-4)===".bin"?YC:x2)(e,r)}function tF(e,t,r){return(t.slice(-4)===".bin"?YO:l2)(e,r)}function rF(e,t,r){return(t.slice(-4)===".bin"?P5:_2)(e)}function aF(e){return(e.slice(-4)===".bin"?w5:v2)()}var B2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,P2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Dn(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var s=e.match(B2),l,o,u,h;if(s)for(h=0;h!=s.length;++h)l=s[h].match(P2),(o=l[1].indexOf(":"))===-1?a[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?u="xmlns"+l[1].slice(6):u=l[1].slice(o+1),a[u]=l[2].slice(1,l[2].length-1));return a}function nF(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(B2),s,l,o,u;if(a)for(u=0;u!=a.length;++u)s=a[u].match(P2),(l=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(l+1),r[o]=s[2].slice(1,s[2].length-1));return r}var Sc;function sF(e,t){var r=Sc[e]||Ft(e);return r==="General"?qi(t):Tn(r,t)}function iF(e,t,r,a){var s=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=dr(a);break;case"i2":case"int":s=parseInt(a,10);break;case"r4":case"float":s=parseFloat(a);break;case"date":case"dateTime.tz":s=hr(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ft(t)]=s}function lF(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ks[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Fc(e.v):e.w=qi(e.v):e.w=sF(t||"General",e.v)}catch(l){if(r.WTF)throw l}try{var a=Sc[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&oo(a)){var s=Bi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(l){if(r.WTF)throw l}}}function oF(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=_C[a.Pattern]||a.Pattern)}e[t.ID]=t}function cF(e,t,r,a,s,l,o,u,h,d){var x="General",g=a.StyleID,p={};d=d||{};var y=[],w=0;for(g===void 0&&u&&(g=u.StyleID),g===void 0&&o&&(g=o.StyleID);l[g]!==void 0&&(l[g].nf&&(x=l[g].nf),l[g].Interior&&y.push(l[g].Interior),!!l[g].Parent);)g=l[g].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=dr(e);break;case"String":a.t="s",a.r=A_(Ft(e)),a.v=e.indexOf("<")>-1?Ft(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(hr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=Ft(e):a.v<60&&(a.v=a.v-1),(!x||x=="General")&&(x="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=Dw[e],d.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=A_(t||e));break}if(lF(a,x,d),d.cellFormula!==!1)if(a.Formula){var _=Ft(a.Formula);_.charCodeAt(0)==61&&(_=_.slice(1)),a.f=to(_,s),delete a.Formula,a.ArrayRange=="RC"?a.F=to("RC:RC",s):a.ArrayRange&&(a.F=to(a.ArrayRange,s),h.push([Mt(a.F),a.F]))}else for(w=0;w<h.length;++w)s.r>=h[w][0].s.r&&s.r<=h[w][0].e.r&&s.c>=h[w][0].s.c&&s.c<=h[w][0].e.c&&(a.F=h[w][1]);d.cellStyles&&(y.forEach(function(S){!p.patternType&&S.patternType&&(p.patternType=S.patternType)}),a.s=p),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function uF(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Rm(e,t){var r=t||{};co();var a=dc(vx(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=sr(a));var s=a.slice(0,1024).toLowerCase(),l=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=mr(r);return o.type="string",no.to_workbook(a,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ae){s.indexOf("<"+Ae)>=0&&(l=!0)}),l)return KF(a,r);Sc={"General Number":"General","General Date":ut[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ut[15],"Short Date":ut[14],"Long Time":ut[19],"Medium Time":ut[18],"Short Time":ut[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ut[2],Standard:ut[4],Percent:ut[10],Scientific:ut[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],d,x={},g=[],p=r.dense?[]:{},y="",w={},_={},S=Dn('<Data ss:Type="String">'),T=0,N=0,E=0,D={s:{r:2e6,c:2e6},e:{r:0,c:0}},G={},V={},A="",M=0,C=[],U={},Z={},q=0,le=[],ge=[],Se={},te=[],ae,De=!1,ie=[],Me=[],W={},O=0,P=0,z={Sheets:[],WBProps:{date1904:!1}},F={};Lc.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var Q="";u=Lc.exec(a);)switch(u[3]=(Q=u[3]).toLowerCase()){case"data":if(Q=="data"){if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?cF(a.slice(T,u.index),A,S,h[h.length-1][0]=="comment"?Se:w,{c:N,r:E},G,te[N],_,ie,r):(A="",S=Dn(u[0]),T=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(ge.length>0&&(w.c=ge),(!r.sheetRows||r.sheetRows>E)&&w.v!==void 0&&(r.dense?(p[E]||(p[E]=[]),p[E][N]=w):p[vr(N)+Rr(E)]=w),w.HRef&&(w.l={Target:Ft(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(O=N+(parseInt(w.MergeAcross,10)|0),P=E+(parseInt(w.MergeDown,10)|0),C.push({s:{c:N,r:E},e:{c:O,r:P}})),!r.sheetStubs)w.MergeAcross?N=O+1:++N;else if(w.MergeAcross||w.MergeDown){for(var re=N;re<=O;++re)for(var Ee=E;Ee<=P;++Ee)(re>N||Ee>E)&&(r.dense?(p[Ee]||(p[Ee]=[]),p[Ee][re]={t:"z"}):p[vr(re)+Rr(Ee)]={t:"z"});N=O+1}else++N;else w=nF(u[0]),w.Index&&(N=+w.Index-1),N<D.s.c&&(D.s.c=N),N>D.e.c&&(D.e.c=N),u[0].slice(-2)==="/>"&&++N,ge=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(E<D.s.r&&(D.s.r=E),E>D.e.r&&(D.e.r=E),u[0].slice(-2)==="/>"&&(_=Dn(u[0]),_.Index&&(E=+_.Index-1)),N=0,++E):(_=Dn(u[0]),_.Index&&(E=+_.Index-1),W={},(_.AutoFitHeight=="0"||_.Height)&&(W.hpx=parseInt(_.Height,10),W.hpt=Hc(W.hpx),Me[E]=W),_.Hidden=="1"&&(W.hidden=!0,Me[E]=W));break;case"worksheet":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));g.push(y),D.s.r<=D.e.r&&D.s.c<=D.e.c&&(p["!ref"]=yt(D),r.sheetRows&&r.sheetRows<=D.e.r&&(p["!fullref"]=p["!ref"],D.e.r=r.sheetRows-1,p["!ref"]=yt(D))),C.length&&(p["!merges"]=C),te.length>0&&(p["!cols"]=te),Me.length>0&&(p["!rows"]=Me),x[y]=p}else D={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=N=0,h.push([u[3],!1]),d=Dn(u[0]),y=Ft(d.Name),p=r.dense?[]:{},C=[],ie=[],Me=[],F={name:y,Hidden:0},z.Sheets.push(F);break;case"table":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),te=[],De=!1}break;case"style":u[1]==="/"?oF(G,V,r):V=Dn(u[0]);break;case"numberformat":V.nf=Ft(Dn(u[0]).Format||"General"),Sc[V.nf]&&(V.nf=Sc[V.nf]);for(var ye=0;ye!=392&&ut[ye]!=V.nf;++ye);if(ye==392){for(ye=57;ye!=392;++ye)if(ut[ye]==null){_s(V.nf,ye);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(ae=Dn(u[0]),ae.Hidden&&(ae.hidden=!0,delete ae.Hidden),ae.Width&&(ae.wpx=parseInt(ae.Width,10)),!De&&ae.wpx>10){De=!0,ya=h2;for(var Oe=0;Oe<te.length;++Oe)te[Oe]&&si(te[Oe])}De&&si(ae),te[ae.Index-1||te.length]=ae;for(var tt=0;tt<+ae.Span;++tt)te[te.length]=mr(ae);break;case"namedrange":if(u[1]==="/")break;z.Names||(z.Names=[]);var J=ht(u[0]),wt={Name:J.Name,Ref:to(J.RefersTo.slice(1),{r:0,c:0})};z.Sheets.length>0&&(wt.Sheet=z.Sheets.length-1),z.Names.push(wt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?A+=a.slice(M,u.index):M=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;V.Interior=Dn(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?FA(U,Q,a.slice(q,u.index)):q=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));uF(Se),ge.push(Se)}else h.push([u[3],!1]),d=Dn(u[0]),Se={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var et=Dn(u[0]);p["!autofilter"]={ref:to(et.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return gb(a,r);var gt=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:gt=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:gt=!1}break;case"excelworkbook":switch(u[3]){case"date1904":z.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:gt=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:gt=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(a.slice(q,u.index)){case"SheetHidden":F.Hidden=1;break;case"SheetVeryHidden":F.Hidden=2;break}else q=u.index+u[0].length;break;case"header":p["!margins"]||Hi(p["!margins"]={},"xlml"),isNaN(+ht(u[0]).Margin)||(p["!margins"].header=+ht(u[0]).Margin);break;case"footer":p["!margins"]||Hi(p["!margins"]={},"xlml"),isNaN(+ht(u[0]).Margin)||(p["!margins"].footer=+ht(u[0]).Margin);break;case"pagemargins":var it=ht(u[0]);p["!margins"]||Hi(p["!margins"]={},"xlml"),isNaN(+it.Top)||(p["!margins"].top=+it.Top),isNaN(+it.Left)||(p["!margins"].left=+it.Left),isNaN(+it.Right)||(p["!margins"].right=+it.Right),isNaN(+it.Bottom)||(p["!margins"].bottom=+it.Bottom);break;case"displayrighttoleft":z.Views||(z.Views=[]),z.Views[0]||(z.Views[0]={}),z.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:gt=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:gt=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:gt=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:gt=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:gt=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:gt=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:gt=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:gt=!1}break;case"smarttags":break;default:gt=!1;break}if(gt||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?iF(Z,Q,le,a.slice(q,u.index)):(le=u,q=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var Ce={};return!r.bookSheets&&!r.bookProps&&(Ce.Sheets=x),Ce.SheetNames=g,Ce.Workbook=z,Ce.SSF=mr(ut),Ce.Props=U,Ce.Custprops=Z,Ce}function tx(e,t){switch(Hx(t=t||{}),t.type||"base64"){case"base64":return Rm(ln(e),t);case"binary":case"buffer":case"file":return Rm(e,t);case"array":return Rm(oi(e),t)}}function fF(e,t){var r=[];return e.Props&&r.push(MA(e.Props,t)),e.Custprops&&r.push(IA(e.Props,e.Custprops)),r.join("")}function dF(){return""}function hF(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,s){var l=[];l.push(ze("NumberFormat",null,{"ss:Format":er(ut[a.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(ze("Style",l.join(""),o))}),ze("Styles",r.join(""))}function U2(e){return ze("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Ix(e.Ref,{r:0,c:0})})}function mF(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var s=t[a];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(U2(s)))}return ze("Names",r.join(""))}function xF(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var s=a.Workbook.Names,l=[],o=0;o<s.length;++o){var u=s[o];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||l.push(U2(u)))}return l.join("")}function pF(e,t,r,a){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(ze("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(ze("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(ze("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)s.push(ze("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<r&&!(a.Workbook.Sheets[l]&&!a.Workbook.Sheets[l].Hidden);++l);l==r&&s.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(ca("ProtectContents","True")),e["!protect"].objects&&s.push(ca("ProtectObjects","True")),e["!protect"].scenarios&&s.push(ca("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(ca("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(ca("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":ze("WorksheetOptions",s.join(""),{xmlns:tn.x})}function gF(e){return e.map(function(t){var r=Bj(t.t||""),a=ze("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ze("Comment",a,{"ss:Author":t.a})}).join("")}function vF(e,t,r,a,s,l,o){if(!e||e.v==null&&e.f==null)return"";var u={};if(e.f&&(u["ss:Formula"]="="+er(Ix(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var h=yr(e.F.slice(t.length+1));u["ss:ArrayRange"]="RC:R"+(h.r==o.r?"":"["+(h.r-o.r)+"]")+"C"+(h.c==o.c?"":"["+(h.c-o.c)+"]")}if(e.l&&e.l.Target&&(u["ss:HRef"]=er(e.l.Target),e.l.Tooltip&&(u["x:HRefScreenTip"]=er(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],x=0;x!=d.length;++x)d[x].s.c!=o.c||d[x].s.r!=o.r||(d[x].e.c>d[x].s.c&&(u["ss:MergeAcross"]=d[x].e.c-d[x].s.c),d[x].e.r>d[x].s.r&&(u["ss:MergeDown"]=d[x].e.r-d[x].s.r));var g="",p="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":g="Number",p=String(e.v);break;case"b":g="Boolean",p=e.v?"1":"0";break;case"e":g="Error",p=ks[e.v];break;case"d":g="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ut[14]);break;case"s":g="String",p=Lj(e.v||"");break}var y=ui(a.cellXfs,e,a);u["ss:StyleID"]="s"+(21+y),u["ss:Index"]=o.c+1;var w=e.v!=null?p:"",_=e.t=="z"?"":'<Data ss:Type="'+g+'">'+w+"</Data>";return(e.c||[]).length>0&&(_+=gF(e.c)),ze("Cell",_,u)}function yF(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=so(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function _F(e,t,r,a){if(!e["!ref"])return"";var s=Mt(e["!ref"]),l=e["!merges"]||[],o=0,u=[];e["!cols"]&&e["!cols"].forEach(function(S,T){si(S);var N=!!S.width,E=rd(T,S),D={"ss:Index":T+1};N&&(D["ss:Width"]=Uc(E.width)),S.hidden&&(D["ss:Hidden"]="1"),u.push(ze("Column",null,D))});for(var h=Array.isArray(e),d=s.s.r;d<=s.e.r;++d){for(var x=[yF(d,(e["!rows"]||[])[d])],g=s.s.c;g<=s.e.c;++g){var p=!1;for(o=0;o!=l.length;++o)if(!(l[o].s.c>g)&&!(l[o].s.r>d)&&!(l[o].e.c<g)&&!(l[o].e.r<d)){(l[o].s.c!=g||l[o].s.r!=d)&&(p=!0);break}if(!p){var y={r:d,c:g},w=dt(y),_=h?(e[d]||[])[g]:e[w];x.push(vF(_,w,e,t,r,a,y))}}x.push("</Row>"),x.length>2&&u.push(x.join(""))}return u.join("")}function bF(e,t,r){var a=[],s=r.SheetNames[e],l=r.Sheets[s],o=l?xF(l,t,e,r):"";return o.length>0&&a.push("<Names>"+o+"</Names>"),o=l?_F(l,t,e,r):"",o.length>0&&a.push("<Table>"+o+"</Table>"),a.push(pF(l,t,e,r)),a.join("")}function wF(e,t){t||(t={}),e.SSF||(e.SSF=mr(ut)),e.SSF&&(co(),Kf(e.SSF),t.revssf=Jf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ui(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(fF(e,t)),r.push(dF()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(ze("Worksheet",bF(a,t,e),{"ss:Name":er(e.SheetNames[a])}));return r[2]=hF(e,t),r[3]=mF(e),Dr+ze("Workbook",r.join(""),{xmlns:tn.ss,"xmlns:o":tn.o,"xmlns:x":tn.x,"xmlns:ss":tn.ss,"xmlns:dt":tn.dt,"xmlns:html":tn.html})}function SF(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=mA(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=xA(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var EF=[60,1084,2066,2165,2175];function TF(e,t,r,a,s){var l=a,o=[],u=r.slice(r.l,r.l+l);if(s&&s.enc&&s.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(u)}o.push(u),r.l+=l;for(var h=vs(r,r.l),d=rx[h],x=0;d!=null&&EF.indexOf(h)>-1;)l=vs(r,r.l+2),x=r.l+4,h==2066?x+=4:(h==2165||h==2175)&&(x+=12),u=r.slice(x,r.l+4+l),o.push(u),r.l+=4+l,d=rx[h=vs(r,r.l)];var g=Qr(o);oa(g,0);var p=0;g.lens=[];for(var y=0;y<o.length;++y)g.lens.push(p),p+=o[y].length;if(g.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+g.length+" < "+a;return t.f(g,g.length,s)}function Xn(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ut[a])}catch(l){if(t.WTF)throw l}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ks[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Fc(e.v):e.w=qi(e.v):e.w=Tn(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(l){if(t.WTF)throw l}if(t.cellDates&&a&&e.t=="n"&&oo(ut[a]||String(a))){var s=Bi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function _f(e,t,r){return{v:e,ixfe:t,t:r}}function kF(e,t){var r={opts:{}},a={},s=t.dense?[]:{},l={},o={},u=null,h=[],d="",x={},g,p="",y,w,_,S,T={},N=[],E,D,G=[],V=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},M={},C=function(nt){return nt<8?Pi[nt]:nt<64&&V[nt-8]||Pi[nt]},U=function(nt,Ht,Hr){var It=Ht.XF.data;if(!(!It||!It.patternType||!Hr||!Hr.cellStyles)){Ht.s={},Ht.s.patternType=It.patternType;var Gt;(Gt=Pc(C(It.icvFore)))&&(Ht.s.fgColor={rgb:Gt}),(Gt=Pc(C(It.icvBack)))&&(Ht.s.bgColor={rgb:Gt})}},Z=function(nt,Ht,Hr){if(!(W>1)&&!(Hr.sheetRows&&nt.r>=Hr.sheetRows)){if(Hr.cellStyles&&Ht.XF&&Ht.XF.data&&U(nt,Ht,Hr),delete Ht.ixfe,delete Ht.XF,g=nt,p=dt(nt),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),nt.r<o.s.r&&(o.s.r=nt.r),nt.c<o.s.c&&(o.s.c=nt.c),nt.r+1>o.e.r&&(o.e.r=nt.r+1),nt.c+1>o.e.c&&(o.e.c=nt.c+1),Hr.cellFormula&&Ht.f){for(var It=0;It<N.length;++It)if(!(N[It][0].s.c>nt.c||N[It][0].s.r>nt.r)&&!(N[It][0].e.c<nt.c||N[It][0].e.r<nt.r)){Ht.F=yt(N[It][0]),(N[It][0].s.c!=nt.c||N[It][0].s.r!=nt.r)&&delete Ht.f,Ht.f&&(Ht.f=""+va(N[It][1],o,nt,ie,q));break}}Hr.dense?(s[nt.r]||(s[nt.r]=[]),s[nt.r][nt.c]=Ht):s[p]=Ht}},q={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:N,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(q.password=t.password);var le,ge=[],Se=[],te=[],ae=[],De=!1,ie=[];ie.SheetNames=q.snames,ie.sharedf=q.sharedf,ie.arrayf=q.arrayf,ie.names=[],ie.XTI=[];var Me=0,W=0,O=0,P=[],z=[],F;q.codepage=1200,Ln(1200);for(var Q=!1;e.l<e.length-1;){var re=e.l,Ee=e.read_shift(2);if(Ee===0&&Me===10)break;var ye=e.l===e.length?0:e.read_shift(2),Oe=rx[Ee];if(Oe&&Oe.f){if(t.bookSheets&&Me===133&&Ee!==133)break;if(Me=Ee,Oe.r===2||Oe.r==12){var tt=e.read_shift(2);if(ye-=2,!q.enc&&tt!==Ee&&((tt&255)<<8|tt>>8)!==Ee)throw new Error("rt mismatch: "+tt+"!="+Ee);Oe.r==12&&(e.l+=10,ye-=10)}var J={};if(Ee===10?J=Oe.f(e,ye,q):J=TF(Ee,Oe,e,ye,q),W==0&&[9,521,1033,2057].indexOf(Me)===-1)continue;switch(Ee){case 34:r.opts.Date1904=A.WBProps.date1904=J;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(q.enc||(e.l=0),q.enc=J,!t.password)throw new Error("File is password-protected");if(J.valid==null)throw new Error("Encryption scheme unsupported");if(!J.valid)throw new Error("Password is incorrect");break;case 92:q.lastuser=J;break;case 66:var wt=Number(J);switch(wt){case 21010:wt=1200;break;case 32768:wt=1e4;break;case 32769:wt=1252;break}Ln(q.codepage=wt),Q=!0;break;case 317:q.rrtabid=J;break;case 25:q.winlocked=J;break;case 439:r.opts.RefreshAll=J;break;case 12:r.opts.CalcCount=J;break;case 16:r.opts.CalcDelta=J;break;case 17:r.opts.CalcIter=J;break;case 13:r.opts.CalcMode=J;break;case 14:r.opts.CalcPrecision=J;break;case 95:r.opts.CalcSaveRecalc=J;break;case 15:q.CalcRefMode=J;break;case 2211:r.opts.FullCalc=J;break;case 129:J.fDialog&&(s["!type"]="dialog"),J.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),J.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:G.push(J);break;case 430:ie.push([J]),ie[ie.length-1].XTI=[];break;case 35:case 547:ie[ie.length-1].push(J);break;case 24:case 536:F={Name:J.Name,Ref:va(J.rgce,o,null,ie,q)},J.itab>0&&(F.Sheet=J.itab-1),ie.names.push(F),ie[0]||(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].push(J),J.Name=="_xlnm._FilterDatabase"&&J.itab>0&&J.rgce&&J.rgce[0]&&J.rgce[0][0]&&J.rgce[0][0][0]=="PtgArea3d"&&(z[J.itab-1]={ref:yt(J.rgce[0][0][1][2])});break;case 22:q.ExternCount=J;break;case 23:ie.length==0&&(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].XTI=ie[ie.length-1].XTI.concat(J),ie.XTI=ie.XTI.concat(J);break;case 2196:if(q.biff<8)break;F!=null&&(F.Comment=J[1]);break;case 18:s["!protect"]=J;break;case 19:J!==0&&q.WTF&&console.error("Password verifier: "+J);break;case 133:l[J.pos]=J,q.snames.push(J.name);break;case 10:{if(--W)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=yt(o),t.sheetRows&&t.sheetRows<=o.e.r){var et=o.e.r;o.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=yt(o),o.e.r=et}o.e.r++,o.e.c++}ge.length>0&&(s["!merges"]=ge),Se.length>0&&(s["!objects"]=Se),te.length>0&&(s["!cols"]=te),ae.length>0&&(s["!rows"]=ae),A.Sheets.push(M)}d===""?x=s:a[d]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(q.biff===8&&(q.biff={9:2,521:3,1033:4}[Ee]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[J.BIFFVer]||8),q.biffguess=J.BIFFVer==0,J.BIFFVer==0&&J.dt==4096&&(q.biff=5,Q=!0,Ln(q.codepage=28591)),q.biff==8&&J.BIFFVer==0&&J.dt==16&&(q.biff=2),W++)break;if(s=t.dense?[]:{},q.biff<8&&!Q&&(Q=!0,Ln(q.codepage=t.codepage||1252)),q.biff<5||J.BIFFVer==0&&J.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var gt={pos:e.l-ye,name:d};l[gt.pos]=gt,q.snames.push(d)}else d=(l[re]||{name:""}).name;J.dt==32&&(s["!type"]="chart"),J.dt==64&&(s["!type"]="macro"),ge=[],Se=[],q.arrayf=N=[],te=[],ae=[],De=!1,M={Hidden:(l[re]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[J.r]||[])[J.c]:s[dt({c:J.c,r:J.r})])&&++J.c,E={ixfe:J.ixfe,XF:G[J.ixfe]||{},v:J.val,t:"n"},O>0&&(E.z=P[E.ixfe>>8&63]),Xn(E,t,r.opts.Date1904),Z({c:J.c,r:J.r},E,t);break;case 5:case 517:E={ixfe:J.ixfe,XF:G[J.ixfe],v:J.val,t:J.t},O>0&&(E.z=P[E.ixfe>>8&63]),Xn(E,t,r.opts.Date1904),Z({c:J.c,r:J.r},E,t);break;case 638:E={ixfe:J.ixfe,XF:G[J.ixfe],v:J.rknum,t:"n"},O>0&&(E.z=P[E.ixfe>>8&63]),Xn(E,t,r.opts.Date1904),Z({c:J.c,r:J.r},E,t);break;case 189:for(var it=J.c;it<=J.C;++it){var Ce=J.rkrec[it-J.c][0];E={ixfe:Ce,XF:G[Ce],v:J.rkrec[it-J.c][1],t:"n"},O>0&&(E.z=P[E.ixfe>>8&63]),Xn(E,t,r.opts.Date1904),Z({c:it,r:J.r},E,t)}break;case 6:case 518:case 1030:{if(J.val=="String"){u=J;break}if(E=_f(J.val,J.cell.ixfe,J.tt),E.XF=G[E.ixfe],t.cellFormula){var Ae=J.formula;if(Ae&&Ae[0]&&Ae[0][0]&&Ae[0][0][0]=="PtgExp"){var Ge=Ae[0][0][1][0],mt=Ae[0][0][1][1],Ue=dt({r:Ge,c:mt});T[Ue]?E.f=""+va(J.formula,o,J.cell,ie,q):E.F=((t.dense?(s[Ge]||[])[mt]:s[Ue])||{}).F}else E.f=""+va(J.formula,o,J.cell,ie,q)}O>0&&(E.z=P[E.ixfe>>8&63]),Xn(E,t,r.opts.Date1904),Z(J.cell,E,t),u=J}break;case 7:case 519:if(u)u.val=J,E=_f(J,u.cell.ixfe,"s"),E.XF=G[E.ixfe],t.cellFormula&&(E.f=""+va(u.formula,o,u.cell,ie,q)),O>0&&(E.z=P[E.ixfe>>8&63]),Xn(E,t,r.opts.Date1904),Z(u.cell,E,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{N.push(J);var Ve=dt(J[0].s);if(y=t.dense?(s[J[0].s.r]||[])[J[0].s.c]:s[Ve],t.cellFormula&&y){if(!u||!Ve||!y)break;y.f=""+va(J[1],o,J[0],ie,q),y.F=yt(J[0])}}break;case 1212:{if(!t.cellFormula)break;if(p){if(!u)break;T[dt(u.cell)]=J[0],y=t.dense?(s[u.cell.r]||[])[u.cell.c]:s[dt(u.cell)],(y||{}).f=""+va(J[0],o,g,ie,q)}}break;case 253:E=_f(h[J.isst].t,J.ixfe,"s"),h[J.isst].h&&(E.h=h[J.isst].h),E.XF=G[E.ixfe],O>0&&(E.z=P[E.ixfe>>8&63]),Xn(E,t,r.opts.Date1904),Z({c:J.c,r:J.r},E,t);break;case 513:t.sheetStubs&&(E={ixfe:J.ixfe,XF:G[J.ixfe],t:"z"},O>0&&(E.z=P[E.ixfe>>8&63]),Xn(E,t,r.opts.Date1904),Z({c:J.c,r:J.r},E,t));break;case 190:if(t.sheetStubs)for(var Tt=J.c;Tt<=J.C;++Tt){var Ke=J.ixfe[Tt-J.c];E={ixfe:Ke,XF:G[Ke],t:"z"},O>0&&(E.z=P[E.ixfe>>8&63]),Xn(E,t,r.opts.Date1904),Z({c:Tt,r:J.r},E,t)}break;case 214:case 516:case 4:E=_f(J.val,J.ixfe,"s"),E.XF=G[E.ixfe],O>0&&(E.z=P[E.ixfe>>8&63]),Xn(E,t,r.opts.Date1904),Z({c:J.c,r:J.r},E,t);break;case 0:case 512:W===1&&(o=J);break;case 252:h=J;break;case 1054:if(q.biff==4){P[O++]=J[1];for(var Rt=0;Rt<O+163&&ut[Rt]!=J[1];++Rt);Rt>=163&&_s(J[1],O+163)}else _s(J[1],J[0]);break;case 30:{P[O++]=J;for(var zt=0;zt<O+163&&ut[zt]!=J;++zt);zt>=163&&_s(J,O+163)}break;case 229:ge=ge.concat(J);break;case 93:Se[J.cmo[0]]=q.lastobj=J;break;case 438:q.lastobj.TxO=J;break;case 127:q.lastobj.ImData=J;break;case 440:for(S=J[0].s.r;S<=J[0].e.r;++S)for(_=J[0].s.c;_<=J[0].e.c;++_)y=t.dense?(s[S]||[])[_]:s[dt({c:_,r:S})],y&&(y.l=J[1]);break;case 2048:for(S=J[0].s.r;S<=J[0].e.r;++S)for(_=J[0].s.c;_<=J[0].e.c;++_)y=t.dense?(s[S]||[])[_]:s[dt({c:_,r:S})],y&&y.l&&(y.l.Tooltip=J[1]);break;case 28:{if(q.biff<=5&&q.biff>=2)break;y=t.dense?(s[J[0].r]||[])[J[0].c]:s[dt(J[0])];var ua=Se[J[2]];y||(t.dense?(s[J[0].r]||(s[J[0].r]=[]),y=s[J[0].r][J[0].c]={t:"z"}):y=s[dt(J[0])]={t:"z"},o.e.r=Math.max(o.e.r,J[0].r),o.s.r=Math.min(o.s.r,J[0].r),o.e.c=Math.max(o.e.c,J[0].c),o.s.c=Math.min(o.s.c,J[0].c)),y.c||(y.c=[]),w={a:J[1],t:ua.TxO.t},y.c.push(w)}break;case 2173:h5(G[J.ixfe],J.ext);break;case 125:{if(!q.cellStyles)break;for(;J.e>=J.s;)te[J.e--]={width:J.w/256,level:J.level||0,hidden:!!(J.flags&1)},De||(De=!0,Dx(J.w/256)),si(te[J.e+1])}break;case 520:{var ir={};J.level!=null&&(ae[J.r]=ir,ir.level=J.level),J.hidden&&(ae[J.r]=ir,ir.hidden=!0),J.hpt&&(ae[J.r]=ir,ir.hpt=J.hpt,ir.hpx=so(J.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Hi(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ee]]=J;break;case 161:s["!margins"]||Hi(s["!margins"]={}),s["!margins"].header=J.header,s["!margins"].footer=J.footer;break;case 574:J.RTL&&(A.Views[0].RTL=!0);break;case 146:V=J;break;case 2198:le=J;break;case 140:D=J;break;case 442:d?M.CodeName=J||M.name:A.WBProps.CodeName=J||"ThisWorkbook";break}}else Oe||console.error("Missing Info for XLS Record 0x"+Ee.toString(16)),e.l+=ye}return r.SheetNames=jr(l).sort(function(or,nt){return Number(or)-Number(nt)}).map(function(or){return l[or].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&x["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=x)):r.Preamble=x,r.Sheets&&z.forEach(function(or,nt){r.Sheets[r.SheetNames[nt]]["!autofilter"]=or}),r.Strings=h,r.SSF=mr(ut),q.enc&&(r.Encryption=q.enc),le&&(r.Themes=le),r.Metadata={},D!==void 0&&(r.Metadata.Country=D),ie.names.length>0&&(A.Names=ie.names),r.Workbook=A,r}var Ec={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function NF(e,t,r){var a=at.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var s=X_(a,Km,Ec.DSI);for(var l in s)t[l]=s[l]}catch(d){if(r.WTF)throw d}var o=at.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var u=X_(o,Ym,Ec.SI);for(var h in u)t[h]==null&&(t[h]=u[h])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(Pw(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function jF(e,t){var r=[],a=[],s=[],l=0,o,u=S_(Km,"n"),h=S_(Ym,"n");if(e.Props)for(o=jr(e.Props),l=0;l<o.length;++l)(Object.prototype.hasOwnProperty.call(u,o[l])?r:Object.prototype.hasOwnProperty.call(h,o[l])?a:s).push([o[l],e.Props[o[l]]]);if(e.Custprops)for(o=jr(e.Custprops),l=0;l<o.length;++l)Object.prototype.hasOwnProperty.call(e.Props||{},o[l])||(Object.prototype.hasOwnProperty.call(u,o[l])?r:Object.prototype.hasOwnProperty.call(h,o[l])?a:s).push([o[l],e.Custprops[o[l]]]);var d=[];for(l=0;l<s.length;++l)Vw.indexOf(s[l][0])>-1||Bw.indexOf(s[l][0])>-1||s[l][1]!=null&&d.push(s[l]);a.length&&at.utils.cfb_add(t,"/SummaryInformation",W_(a,Ec.SI,h,Ym)),(r.length||d.length)&&at.utils.cfb_add(t,"/DocumentSummaryInformation",W_(r,Ec.DSI,u,Km,d.length?d:null,Ec.UDI))}function z2(e,t){t||(t={}),Hx(t),cx(),t.codepage&&ox(t.codepage);var r,a;if(e.FullPaths){if(at.find(e,"/encryption"))throw new Error("File is password-protected");r=at.find(e,"!CompObj"),a=at.find(e,"/Workbook")||at.find(e,"/Book")}else{switch(t.type){case"base64":e=nn(ln(e));break;case"binary":e=nn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}oa(e,0),a={content:e}}var s,l;if(r&&SF(r),t.bookProps&&!t.bookSheets)s={};else{var o=St?"buffer":"array";if(a&&a.content)s=kF(a.content,t);else if((l=at.find(e,"PerfectOffice_MAIN"))&&l.content)s=zi.to_workbook(l.content,(t.type=o,t));else if((l=at.find(e,"NativeContent_MAIN"))&&l.content)s=zi.to_workbook(l.content,(t.type=o,t));else throw(l=at.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&at.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=z5(e))}var u={};return e.FullPaths&&NF(e,u,t),s.Props=s.Custprops=u,t.bookFiles&&(s.cfb=e),s}function AF(e,t){var r=t||{},a=at.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return at.utils.cfb_add(a,s,H2(e,r)),r.biff==8&&(e.Props||e.Custprops)&&jF(e,a),r.biff==8&&e.vbaraw&&H5(a,at.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var qc={0:{f:Z8},1:{f:lR},2:{f:kR},3:{f:xR},4:{f:fR},5:{f:SR},6:{f:CR},7:{f:yR},8:{f:BR},9:{f:LR},10:{f:MR},11:{f:IR},12:{f:cR},13:{f:jR},14:{f:gR},15:{f:hR},16:{f:D2},17:{f:DR},18:{f:bR},19:{f:Sx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:DD},40:{},42:{},43:{f:CC},44:{f:AC},45:{f:FC},46:{f:IC},47:{f:MC},48:{},49:{f:rA},50:{},51:{f:p5},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:a2},62:{f:OR},63:{f:T5},64:{f:eD},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:wa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:YR},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:sR},148:{f:rR,p:16},151:{f:$R},152:{},153:{f:OD},154:{},155:{},156:{f:jD},157:{},158:{},159:{T:1,f:VO},160:{T:-1},161:{T:1,f:Zi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:PR},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:m5},336:{T:-1},337:{f:y5,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Wm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:r2},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:GR},427:{f:VR},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:WR},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:nR},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:HR},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Wm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:I5},633:{T:1},634:{T:-1},635:{T:1,f:F5},636:{T:-1},637:{f:iA},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:gD},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:tD},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},rx={6:{f:Om},10:{f:Qs},12:{f:Ur},13:{f:Ur},14:{f:Cr},15:{f:Cr},16:{f:_a},17:{f:Cr},18:{f:Cr},19:{f:Ur},20:{f:eb},21:{f:eb},23:{f:r2},24:{f:rb},25:{f:Cr},26:{},27:{},28:{f:tO},29:{},34:{f:Cr},35:{f:tb},38:{f:_a},39:{f:_a},40:{f:_a},41:{f:_a},42:{f:Cr},43:{f:Cr},47:{f:hC},49:{f:j3},51:{f:Ur},60:{},61:{f:S3},64:{f:Cr},65:{f:N3},66:{f:Ur},77:{},80:{},81:{},82:{},85:{f:Ur},89:{},90:{},91:{},92:{f:d3},93:{f:nO},94:{},95:{f:Cr},96:{},97:{},99:{f:Cr},125:{f:a2},128:{f:q3},129:{f:m3},130:{f:Ur},131:{f:Cr},132:{f:Cr},133:{f:x3},134:{},140:{f:dO},141:{f:Ur},144:{},146:{f:xO},151:{},152:{},153:{},154:{},155:{},156:{f:Ur},157:{},158:{},160:{f:wO},161:{f:vO},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:P3},190:{f:U3},193:{f:Qs},197:{},198:{},199:{},200:{},201:{},202:{f:Cr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ur},220:{},221:{f:Cr},222:{},224:{f:H3},225:{f:f3},226:{f:Qs},227:{},229:{f:rO},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:g3},253:{f:O3},255:{f:y3},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Xw},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Cr},353:{f:Qs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:W3},431:{f:Cr},432:{},433:{},434:{},437:{},438:{f:lO},439:{f:Cr},440:{f:oO},441:{},442:{f:eu},443:{},444:{f:Ur},445:{},446:{},448:{f:Qs},449:{f:w3,r:2},450:{f:Qs},512:{f:J_},513:{f:bO},515:{f:V3},516:{f:R3},517:{f:Z_},519:{f:SO},520:{f:_3},523:{},545:{f:ab},549:{f:Y_},566:{},574:{f:T3},638:{f:B3},659:{},1048:{},1054:{f:F3},1084:{},1212:{f:Q3},2048:{f:uO},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:gf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Qs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:pO,r:12},2173:{f:d5,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Cr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:J3,r:12},2197:{},2198:{f:i5,r:12},2199:{},2200:{},2201:{},2202:{f:Z3,r:12},2203:{f:Qs},2204:{},2205:{},2206:{},2207:{},2211:{f:b3},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ur},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:yO},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:mO},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:J_},1:{},2:{f:jO},3:{f:kO},4:{f:TO},5:{f:Z_},7:{f:OO},8:{},9:{f:gf},11:{},22:{f:Ur},30:{f:I3},31:{},32:{},33:{f:ab},36:{},37:{f:Y_},50:{f:CO},62:{},52:{},67:{},68:{f:Ur},69:{},86:{},126:{},127:{f:EO},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:RO},223:{},234:{},354:{},421:{},518:{f:Om},521:{f:gf},536:{f:rb},547:{f:tb},561:{},579:{},1030:{f:Om},1033:{f:gf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function He(e,t,r,a){var s=t;if(!isNaN(s)){var l=a||(r||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,l),l>0&&_x(r)&&e.push(r)}}function OF(e,t,r,a){var s=(r||[]).length||0;if(s<=8224)return He(e,t,r,s);var l=t;if(!isNaN(l)){for(var o=r.parts||[],u=0,h=0,d=0;d+(o[u]||8224)<=8224;)d+=o[u]||8224,u++;var x=e.next(4);for(x.write_shift(2,l),x.write_shift(2,d),e.push(r.slice(h,h+d)),h+=d;h<s;){for(x=e.next(4),x.write_shift(2,60),d=0;d+(o[u]||8224)<=8224;)d+=o[u]||8224,u++;x.write_shift(2,d),e.push(r.slice(h,h+d)),h+=d}}}function nu(e,t,r){return e||(e=be(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function CF(e,t,r,a){var s=be(9);return nu(s,e,t),Ww(r,a||"b",s),s}function RF(e,t,r){var a=be(8+2*r.length);return nu(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function DF(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Kr(hr(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?He(e,2,AO(r,a,s)):He(e,3,NO(r,a,s));return;case"b":case"e":He(e,5,CF(r,a,t.v,t.t));return;case"s":case"str":He(e,4,RF(r,a,(t.v||"").slice(0,255)));return}He(e,1,nu(null,r,a))}function FF(e,t,r,a){var s=Array.isArray(t),l=Mt(t["!ref"]||"A1"),o,u="",h=[];if(l.e.c>255||l.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),o=yt(l)}for(var d=l.s.r;d<=l.e.r;++d){u=Rr(d);for(var x=l.s.c;x<=l.e.c;++x){d===l.s.r&&(h[x]=vr(x)),o=h[x]+u;var g=s?(t[d]||[])[x]:t[o];g&&DF(e,g,d,x)}}}function MF(e,t){for(var r=t||{},a=za(),s=0,l=0;l<e.SheetNames.length;++l)e.SheetNames[l]==r.sheet&&(s=l);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return He(a,r.biff==4?1033:r.biff==3?521:9,Ox(e,16,r)),FF(a,e.Sheets[e.SheetNames[s]],s,r),He(a,10),a.end()}function IF(e,t,r){He(e,49,A3({sz:12,name:"Arial"},r))}function LF(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&He(e,1054,M3(s,t[s],r))})}function BF(e,t){var r=be(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),He(e,2151,r),r=be(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Zw(Mt(t["!ref"]||"A1"),r),r.write_shift(4,4),He(e,2152,r)}function PF(e,t){for(var r=0;r<16;++r)He(e,224,Q_({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){He(e,224,Q_(a,0,t))})}function UF(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];He(e,440,cO(a)),a[1].Tooltip&&He(e,2048,fO(a))}delete t["!links"]}function zF(e,t){if(t){var r=0;t.forEach(function(a,s){++r<=256&&a&&He(e,125,gO(rd(s,a),s))})}}function HF(e,t,r,a,s){var l=16+ui(s.cellXfs,t,s);if(t.v==null&&!t.bf){He(e,513,Xi(r,a,l));return}if(t.bf)He(e,6,m8(t,r,a,s,l));else switch(t.t){case"d":case"n":var o=t.t=="d"?Kr(hr(t.v)):t.v;He(e,515,X3(r,a,o,l));break;case"b":case"e":He(e,517,G3(r,a,t.v,l,s,t.t));break;case"s":case"str":if(s.bookSST){var u=Bx(s.Strings,t.v,s.revStrings);He(e,253,C3(r,a,u,l))}else He(e,516,D3(r,a,(t.v||"").slice(0,255),l,s));break;default:He(e,513,Xi(r,a,l))}}function qF(e,t,r){var a=za(),s=r.SheetNames[e],l=r.Sheets[s]||{},o=(r||{}).Workbook||{},u=(o.Sheets||[])[e]||{},h=Array.isArray(l),d=t.biff==8,x,g="",p=[],y=Mt(l["!ref"]||"A1"),w=d?65536:16384;if(y.e.c>255||y.e.r>=w){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,w-1)}He(a,2057,Ox(r,16,t)),He(a,13,Sn(1)),He(a,12,Sn(100)),He(a,15,Aa(!0)),He(a,17,Aa(!1)),He(a,16,Gi(.001)),He(a,95,Aa(!0)),He(a,42,Aa(!1)),He(a,43,Aa(!1)),He(a,130,Sn(1)),He(a,128,$3()),He(a,131,Aa(!1)),He(a,132,Aa(!1)),d&&zF(a,l["!cols"]),He(a,512,L3(y,t)),d&&(l["!links"]=[]);for(var _=y.s.r;_<=y.e.r;++_){g=Rr(_);for(var S=y.s.c;S<=y.e.c;++S){_===y.s.r&&(p[S]=vr(S)),x=p[S]+g;var T=h?(l[_]||[])[S]:l[x];T&&(HF(a,T,_,S,t),d&&T.l&&l["!links"].push([x,T.l]))}}var N=u.CodeName||u.name||s;return d&&He(a,574,k3((o.Views||[])[0])),d&&(l["!merges"]||[]).length&&He(a,229,aO(l["!merges"])),d&&UF(a,l),He(a,442,Kw(N)),d&&BF(a,l),He(a,10),a.end()}function $F(e,t,r){var a=za(),s=(e||{}).Workbook||{},l=s.Sheets||[],o=s.WBProps||{},u=r.biff==8,h=r.biff==5;if(He(a,2057,Ox(e,5,r)),r.bookType=="xla"&&He(a,135),He(a,225,u?Sn(1200):null),He(a,193,GA(2)),h&&He(a,191),h&&He(a,192),He(a,226),He(a,92,h3("SheetJS",r)),He(a,66,Sn(u?1200:1252)),u&&He(a,353,Sn(0)),u&&He(a,448),He(a,317,_O(e.SheetNames.length)),u&&e.vbaraw&&He(a,211),u&&e.vbaraw){var d=o.CodeName||"ThisWorkbook";He(a,442,Kw(d))}He(a,156,Sn(17)),He(a,25,Aa(!1)),He(a,18,Aa(!1)),He(a,19,Sn(0)),u&&He(a,431,Aa(!1)),u&&He(a,444,Sn(0)),He(a,61,E3()),He(a,64,Aa(!1)),He(a,141,Sn(0)),He(a,34,Aa(wD(e)=="true")),He(a,14,Aa(!0)),u&&He(a,439,Aa(!1)),He(a,218,Sn(0)),IF(a,e,r),LF(a,e.SSF,r),PF(a,r),u&&He(a,352,Aa(!1));var x=a.end(),g=za();u&&He(g,140,hO()),u&&r.Strings&&OF(g,252,v3(r.Strings)),He(g,10);var p=g.end(),y=za(),w=0,_=0;for(_=0;_<e.SheetNames.length;++_)w+=(u?12:11)+(u?2:1)*e.SheetNames[_].length;var S=x.length+w+p.length;for(_=0;_<e.SheetNames.length;++_){var T=l[_]||{};He(y,133,p3({pos:S,hs:T.Hidden||0,dt:0,name:e.SheetNames[_]},r)),S+=t[_].length}var N=y.end();if(w!=N.length)throw new Error("BS8 "+w+" != "+N.length);var E=[];return x.length&&E.push(x),N.length&&E.push(N),p.length&&E.push(p),Qr(E)}function GF(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=mr(ut)),e&&e.SSF&&(co(),Kf(e.SSF),r.revssf=Jf(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,qx(r),r.cellXfs=[],ui(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)a[a.length]=qF(s,r,e);return a.unshift($F(e,a,r)),Qr(a)}function H2(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var s=Ha(a["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var l=t||{};switch(l.biff||2){case 8:case 5:return GF(e,t);case 4:case 3:case 2:return MF(e,t)}throw new Error("invalid type "+l.bookType+" for BIFF")}function hb(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),o=s.index,u=l&&l.index||e.length,h=Aj(e.slice(o,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,x=0,g=0,p=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(o=0;o<h.length;++o){var _=h[o].trim(),S=_.slice(0,3).toLowerCase();if(S=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}x=0;continue}if(!(S!="<td"&&S!="<th")){var T=_.split(/<\/t[dh]>/i);for(u=0;u<T.length;++u){var N=T[u].trim();if(N.match(/<t[dh]/i)){for(var E=N,D=0;E.charAt(0)=="<"&&(D=E.indexOf(">"))>-1;)E=E.slice(D+1);for(var G=0;G<w.length;++G){var V=w[G];V.s.c==x&&V.s.r<d&&d<=V.e.r&&(x=V.e.c+1,G=-1)}var A=ht(N.slice(0,N.indexOf(">")));p=A.colspan?+A.colspan:1,((g=+A.rowspan)>1||p>1)&&w.push({s:{r:d,c:x},e:{r:d+(g||1)-1,c:x+p-1}});var M=A.t||A["data-t"]||"";if(!E.length){x+=p;continue}if(E=dw(E),y.s.r>d&&(y.s.r=d),y.e.r<d&&(y.e.r=d),y.s.c>x&&(y.s.c=x),y.e.c<x&&(y.e.c=x),!E.length){x+=p;continue}var C={t:"s",v:E};r.raw||!E.trim().length||M=="s"||(E==="TRUE"?C={t:"b",v:!0}:E==="FALSE"?C={t:"b",v:!1}:isNaN(Pn(E))?isNaN(ao(E).getDate())||(C={t:"d",v:hr(E)},r.cellDates||(C={t:"n",v:Kr(C.v)}),C.z=r.dateNF||ut[14]):C={t:"n",v:Pn(E)}),r.dense?(a[d]||(a[d]=[]),a[d][x]=C):a[dt({r:d,c:x})]=C,x+=p}}}}return a["!ref"]=yt(y),w.length&&(a["!merges"]=w),a}function VF(e,t,r,a){for(var s=e["!merges"]||[],l=[],o=t.s.c;o<=t.e.c;++o){for(var u=0,h=0,d=0;d<s.length;++d)if(!(s[d].s.r>r||s[d].s.c>o)&&!(s[d].e.r<r||s[d].e.c<o)){if(s[d].s.r<r||s[d].s.c<o){u=-1;break}u=s[d].e.r-s[d].s.r+1,h=s[d].e.c-s[d].s.c+1;break}if(!(u<0)){var x=dt({r,c:o}),g=a.dense?(e[r]||[])[o]:e[x],p=g&&g.v!=null&&(g.h||gx(g.w||(ws(g),g.w)||""))||"",y={};u>1&&(y.rowspan=u),h>1&&(y.colspan=h),a.editable?p='<span contenteditable="true">'+p+"</span>":g&&(y["data-t"]=g&&g.t||"z",g.v!=null&&(y["data-v"]=g.v),g.z!=null&&(y["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+g.l.Target+'">'+p+"</a>")),y.id=(a.id||"sjs")+"-"+x,l.push(ze("td",p,y))}}var w="<tr>";return w+l.join("")+"</tr>"}var XF='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',WF="</body></html>";function KF(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ci(hb(r[0],t),t);var a=Vx();return r.forEach(function(s,l){Xx(a,hb(s,t),"Sheet"+(l+1))}),a}function YF(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function q2(e,t){var r=t||{},a=r.header!=null?r.header:XF,s=r.footer!=null?r.footer:WF,l=[a],o=Ha(e["!ref"]);r.dense=Array.isArray(e),l.push(YF(e,o,r));for(var u=o.s.r;u<=o.e.r;++u)l.push(VF(e,o,u,r));return l.push("</table>"+s),l.join("")}function $2(e,t,r){var a=r||{},s=0,l=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var o=typeof a.origin=="string"?yr(a.origin):a.origin;s=o.r,l=o.c}var u=t.getElementsByTagName("tr"),h=Math.min(a.sheetRows||1e7,u.length),d={s:{r:0,c:0},e:{r:s,c:l}};if(e["!ref"]){var x=Ha(e["!ref"]);d.s.r=Math.min(d.s.r,x.s.r),d.s.c=Math.min(d.s.c,x.s.c),d.e.r=Math.max(d.e.r,x.e.r),d.e.c=Math.max(d.e.c,x.e.c),s==-1&&(d.e.r=s=x.e.r+1)}var g=[],p=0,y=e["!rows"]||(e["!rows"]=[]),w=0,_=0,S=0,T=0,N=0,E=0;for(e["!cols"]||(e["!cols"]=[]);w<u.length&&_<h;++w){var D=u[w];if(mb(D)){if(a.display)continue;y[_]={hidden:!0}}var G=D.children;for(S=T=0;S<G.length;++S){var V=G[S];if(!(a.display&&mb(V))){var A=V.hasAttribute("data-v")?V.getAttribute("data-v"):V.hasAttribute("v")?V.getAttribute("v"):dw(V.innerHTML),M=V.getAttribute("data-z")||V.getAttribute("z");for(p=0;p<g.length;++p){var C=g[p];C.s.c==T+l&&C.s.r<_+s&&_+s<=C.e.r&&(T=C.e.c+1-l,p=-1)}E=+V.getAttribute("colspan")||1,((N=+V.getAttribute("rowspan")||1)>1||E>1)&&g.push({s:{r:_+s,c:T+l},e:{r:_+s+(N||1)-1,c:T+l+(E||1)-1}});var U={t:"s",v:A},Z=V.getAttribute("data-t")||V.getAttribute("t")||"";A!=null&&(A.length==0?U.t=Z||"z":a.raw||A.trim().length==0||Z=="s"||(A==="TRUE"?U={t:"b",v:!0}:A==="FALSE"?U={t:"b",v:!1}:isNaN(Pn(A))?isNaN(ao(A).getDate())||(U={t:"d",v:hr(A)},a.cellDates||(U={t:"n",v:Kr(U.v)}),U.z=a.dateNF||ut[14]):U={t:"n",v:Pn(A)})),U.z===void 0&&M!=null&&(U.z=M);var q="",le=V.getElementsByTagName("A");if(le&&le.length)for(var ge=0;ge<le.length&&!(le[ge].hasAttribute("href")&&(q=le[ge].getAttribute("href"),q.charAt(0)!="#"));++ge);q&&q.charAt(0)!="#"&&(U.l={Target:q}),a.dense?(e[_+s]||(e[_+s]=[]),e[_+s][T+l]=U):e[dt({c:T+l,r:_+s})]=U,d.e.c<T+l&&(d.e.c=T+l),T+=E}}++_}return g.length&&(e["!merges"]=(e["!merges"]||[]).concat(g)),d.e.r=Math.max(d.e.r,_-1+s),e["!ref"]=yt(d),_>=h&&(e["!fullref"]=yt((d.e.r=u.length-w+_-1+s,d))),e}function G2(e,t){var r=t||{},a=r.dense?[]:{};return $2(a,e,t)}function JF(e,t){return ci(G2(e,t),t)}function mb(e){var t="",r=QF(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function QF(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function ZF(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ft(t.replace(/<[^>]*>/g,""));return[r]}var xb={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function V2(e,t){var r=t||{},a=vx(e),s=[],l,o,u={name:""},h="",d=0,x,g,p={},y=[],w=r.dense?[]:{},_,S,T={value:""},N="",E=0,D=[],G=-1,V=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},M=0,C={},U=[],Z={},q=0,le=0,ge=[],Se=1,te=1,ae=[],De={Names:[]},ie={},Me=["",""],W=[],O={},P="",z=0,F=!1,Q=!1,re=0;for(Lc.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");_=Lc.exec(a);)switch(_[3]=_[3].replace(/_.*$/,"")){case"table":case"":_[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?w["!ref"]=yt(A):w["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(w["!fullref"]=w["!ref"],A.e.r=r.sheetRows-1,w["!ref"]=yt(A)),U.length&&(w["!merges"]=U),ge.length&&(w["!rows"]=ge),x.name=x.||x.name,typeof JSON<"u"&&JSON.stringify(x),y.push(x.name),p[x.name]=w,Q=!1):_[0].charAt(_[0].length-2)!=="/"&&(x=ht(_[0],!1),G=V=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,w=r.dense?[]:{},U=[],ge=[],Q=!0);break;case"table-row-group":_[1]==="/"?--M:++M;break;case"table-row":case"":if(_[1]==="/"){G+=Se,Se=1;break}if(g=ht(_[0],!1),g.?G=g.-1:G==-1&&(G=0),Se=+g["number-rows-repeated"]||1,Se<10)for(re=0;re<Se;++re)M>0&&(ge[G+re]={level:M});V=-1;break;case"covered-table-cell":_[1]!=="/"&&++V,r.sheetStubs&&(r.dense?(w[G]||(w[G]=[]),w[G][V]={t:"z"}):w[dt({r:G,c:V})]={t:"z"}),N="",D=[];break;case"table-cell":case"":if(_[0].charAt(_[0].length-2)==="/")++V,T=ht(_[0],!1),te=parseInt(T["number-columns-repeated"]||"1",10),S={t:"z",v:null},T.formula&&r.cellFormula!=!1&&(S.f=ub(Ft(T.formula))),(T.||T["value-type"])=="string"&&(S.t="s",S.v=Ft(T["string-value"]||""),r.dense?(w[G]||(w[G]=[]),w[G][V]=S):w[dt({r:G,c:V})]=S),V+=te-1;else if(_[1]!=="/"){++V,N="",E=0,D=[],te=1;var Ee=Se?G+Se-1:G;if(V>A.e.c&&(A.e.c=V),V<A.s.c&&(A.s.c=V),G<A.s.r&&(A.s.r=G),Ee>A.e.r&&(A.e.r=Ee),T=ht(_[0],!1),W=[],O={},S={t:T.||T["value-type"],v:null},r.cellFormula)if(T.formula&&(T.formula=Ft(T.formula)),T["number-matrix-columns-spanned"]&&T["number-matrix-rows-spanned"]&&(q=parseInt(T["number-matrix-rows-spanned"],10)||0,le=parseInt(T["number-matrix-columns-spanned"],10)||0,Z={s:{r:G,c:V},e:{r:G+q-1,c:V+le-1}},S.F=yt(Z),ae.push([Z,S.F])),T.formula)S.f=ub(T.formula);else for(re=0;re<ae.length;++re)G>=ae[re][0].s.r&&G<=ae[re][0].e.r&&V>=ae[re][0].s.c&&V<=ae[re][0].e.c&&(S.F=ae[re][1]);switch((T["number-columns-spanned"]||T["number-rows-spanned"])&&(q=parseInt(T["number-rows-spanned"],10)||0,le=parseInt(T["number-columns-spanned"],10)||0,Z={s:{r:G,c:V},e:{r:G+q-1,c:V+le-1}},U.push(Z)),T["number-columns-repeated"]&&(te=parseInt(T["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=dr(T["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(T.value);break;case"percentage":S.t="n",S.v=parseFloat(T.value);break;case"currency":S.t="n",S.v=parseFloat(T.value);break;case"date":S.t="d",S.v=hr(T["date-value"]),r.cellDates||(S.t="n",S.v=Kr(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=kj(T["time-value"])/86400,r.cellDates&&(S.t="d",S.v=Qf(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(T.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",T["string-value"]!=null&&(N=Ft(T["string-value"]),D=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(F=!1,S.t==="s"&&(S.v=N||"",D.length&&(S.R=D),F=E==0),ie.Target&&(S.l=ie),W.length>0&&(S.c=W,W=[]),N&&r.cellText!==!1&&(S.w=N),F&&(S.t="z",delete S.v),(!F||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=G))for(var ye=0;ye<Se;++ye){if(te=parseInt(T["number-columns-repeated"]||"1",10),r.dense)for(w[G+ye]||(w[G+ye]=[]),w[G+ye][V]=ye==0?S:mr(S);--te>0;)w[G+ye][V+te]=mr(S);else for(w[dt({r:G+ye,c:V})]=S;--te>0;)w[dt({r:G+ye,c:V+te})]=mr(S);A.e.c<=V&&(A.e.c=V)}te=parseInt(T["number-columns-repeated"]||"1",10),V+=te-1,te=0,S={},N="",D=[]}ie={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(_[1]==="/"){if((l=s.pop())[0]!==_[3])throw"Bad state: "+l}else _[0].charAt(_[0].length-2)!=="/"&&s.push([_[3],!0]);break;case"annotation":if(_[1]==="/"){if((l=s.pop())[0]!==_[3])throw"Bad state: "+l;O.t=N,D.length&&(O.R=D),O.a=P,W.push(O)}else _[0].charAt(_[0].length-2)!=="/"&&s.push([_[3],!1]);P="",z=0,N="",E=0,D=[];break;case"creator":_[1]==="/"?P=a.slice(z,_.index):z=_.index+_[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(_[1]==="/"){if((l=s.pop())[0]!==_[3])throw"Bad state: "+l}else _[0].charAt(_[0].length-2)!=="/"&&s.push([_[3],!1]);N="",E=0,D=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(_[1]==="/"){if(C[u.name]=h,(l=s.pop())[0]!==_[3])throw"Bad state: "+l}else _[0].charAt(_[0].length-2)!=="/"&&(h="",u=ht(_[0],!1),s.push([_[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=ht(_[0],!1),h+=xb[_[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=ht(_[0],!1),h+=xb[_[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(_[0].slice(-2)==="/>")break;if(_[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":h+=a.slice(d,_.index);break}else d=_.index+_[0].length;break;case"named-range":o=ht(_[0],!1),Me=Cm(o["cell-range-address"]);var Oe={Name:o.name,Ref:Me[0]+"!"+Me[1]};Q&&(Oe.Sheet=y.length),De.Names.push(Oe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(_[1]==="/"&&(!T||!T["string-value"])){var tt=ZF(a.slice(E,_.index));N=(N.length>0?N+`
`:"")+tt[0]}else ht(_[0],!1),E=_.index+_[0].length;break;case"s":break;case"database-range":if(_[1]==="/")break;try{Me=Cm(ht(_[0])["target-range-address"]),p[Me[0]]["!autofilter"]={ref:Me[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(_[1]!=="/"){if(ie=ht(_[0],!1),!ie.href)break;ie.Target=Ft(ie.href),delete ie.href,ie.Target.charAt(0)=="#"&&ie.Target.indexOf(".")>-1?(Me=Cm(ie.Target.slice(1)),ie.Target="#"+Me[0]+"!"+Me[1]):ie.Target.match(/^\.\.[\\\/]/)&&(ie.Target=ie.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(_[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(_)}}var J={Sheets:p,SheetNames:y,Workbook:De};return r.bookSheets&&delete J.Sheets,J}function pb(e,t){t=t||{},wn(e,"META-INF/manifest.xml")&&kA(Pr(e,"META-INF/manifest.xml"),t);var r=sn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=V2(sr(r),t);return wn(e,"meta.xml")&&(a.Props=Iw(Pr(e,"meta.xml"))),a}function gb(e,t){return V2(e,t)}var eM=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Ic({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Dr+t}})(),vb=(function(){var e=function(l){return er(l).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(l,o,u){var h=[];h.push('      <table:table table:name="'+er(o.SheetNames[u])+`" table:style-name="ta1">
`);var d=0,x=0,g=Ha(l["!ref"]||"A1"),p=l["!merges"]||[],y=0,w=Array.isArray(l);if(l["!cols"])for(x=0;x<=g.e.c;++x)h.push("        <table:table-column"+(l["!cols"][x]?' table:style-name="co'+l["!cols"][x].ods+'"':"")+`></table:table-column>
`);var _="",S=l["!rows"]||[];for(d=0;d<g.s.r;++d)_=S[d]?' table:style-name="ro'+S[d].ods+'"':"",h.push("        <table:table-row"+_+`></table:table-row>
`);for(;d<=g.e.r;++d){for(_=S[d]?' table:style-name="ro'+S[d].ods+'"':"",h.push("        <table:table-row"+_+`>
`),x=0;x<g.s.c;++x)h.push(t);for(;x<=g.e.c;++x){var T=!1,N={},E="";for(y=0;y!=p.length;++y)if(!(p[y].s.c>x)&&!(p[y].s.r>d)&&!(p[y].e.c<x)&&!(p[y].e.r<d)){(p[y].s.c!=x||p[y].s.r!=d)&&(T=!0),N["table:number-columns-spanned"]=p[y].e.c-p[y].s.c+1,N["table:number-rows-spanned"]=p[y].e.r-p[y].s.r+1;break}if(T){h.push(r);continue}var D=dt({r:d,c:x}),G=w?(l[d]||[])[x]:l[D];if(G&&G.f&&(N["table:formula"]=er(_8(G.f)),G.F&&G.F.slice(0,D.length)==D)){var V=Ha(G.F);N["table:number-matrix-columns-spanned"]=V.e.c-V.s.c+1,N["table:number-matrix-rows-spanned"]=V.e.r-V.s.r+1}if(!G){h.push(t);continue}switch(G.t){case"b":E=G.v?"TRUE":"FALSE",N["office:value-type"]="boolean",N["office:boolean-value"]=G.v?"true":"false";break;case"n":E=G.w||String(G.v||0),N["office:value-type"]="float",N["office:value"]=G.v||0;break;case"s":case"str":E=G.v==null?"":G.v,N["office:value-type"]="string";break;case"d":E=G.w||hr(G.v).toISOString(),N["office:value-type"]="date",N["office:date-value"]=hr(G.v).toISOString(),N["table:style-name"]="ce1";break;default:h.push(t);continue}var A=e(E);if(G.l&&G.l.Target){var M=G.l.Target;M=M.charAt(0)=="#"?"#"+b8(M.slice(1)):M,M.charAt(0)!="#"&&!M.match(/^\w+:/)&&(M="../"+M),A=ze("text:a",A,{"xlink:href":M.replace(/&/g,"&amp;")})}h.push("          "+ze("table:table-cell",ze("text:p",A,{}),N)+`
`)}h.push(`        </table:table-row>
`)}return h.push(`      </table:table>
`),h.join("")},s=function(l,o){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var u=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var x=0;x<d["!cols"].length;++x)if(d["!cols"][x]){var g=d["!cols"][x];if(g.width==null&&g.wpx==null&&g.wch==null)continue;si(g),g.ods=u;var p=d["!cols"][x].wpx+"px";l.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),l.push(`  </style:style>
`),++u}}});var h=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var x=0;x<d["!rows"].length;++x)if(d["!rows"][x]){d["!rows"][x].ods=h;var g=d["!rows"][x].hpx+"px";l.push('  <style:style style:name="ro'+h+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),l.push(`  </style:style>
`),++h}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(o,u){var h=[Dr],d=Ic({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),x=Ic({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(h.push("<office:document"+d+x+`>
`),h.push(Mw().replace(/office:document-meta/g,"office:meta"))):h.push("<office:document-content"+d+`>
`),s(h,o),h.push(`  <office:body>
`),h.push(`    <office:spreadsheet>
`);for(var g=0;g!=o.SheetNames.length;++g)h.push(a(o.Sheets[o.SheetNames[g]],o,g));return h.push(`    </office:spreadsheet>
`),h.push(`  </office:body>
`),u.bookType=="fods"?h.push("</office:document>"):h.push("</office:document-content>"),h.join("")}})();function X2(e,t){if(t.bookType=="fods")return vb(e,t);var r=mx(),a="",s=[],l=[];return a="mimetype",bt(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",bt(r,a,vb(e,t)),s.push([a,"text/xml"]),l.push([a,"ContentFile"]),a="styles.xml",bt(r,a,eM(e,t)),s.push([a,"text/xml"]),l.push([a,"StylesFile"]),a="meta.xml",bt(r,a,Dr+Mw()),s.push([a,"text/xml"]),l.push([a,"MetadataFile"]),a="manifest.rdf",bt(r,a,AA(l)),s.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",bt(r,a,NA(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Wi(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function ax(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):sr(oi(e))}function tM(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):nn(Yn(e))}function rM(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function li(e){var t=e.reduce(function(s,l){return s+l.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(s){r.set(s,a),a+=s.length}),r}function yb(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function aM(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,s=t+13;s>=t;--s)a=a*256+e[s];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function nM(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var l=0;s>=1;++l,s/=256)e[t+l]=s&255;e[t+15]|=r>=0?0:128}function $c(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Qt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Nr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ut(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],s=$c(e,r),l=s&7;s=Math.floor(s/8);var o=0,u;if(s==0)break;switch(l){case 0:{for(var h=r[0];e[r[0]++]>=128;);u=e.slice(h,r[0])}break;case 5:o=4,u=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,u=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=$c(e,r),u=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(s," at offset ").concat(a))}var d={data:u,type:l};t[s]==null?t[s]=[d]:t[s].push(d)}return t}function la(e){var t=[];return e.forEach(function(r,a){r.forEach(function(s){s.data&&(t.push(Qt(a*8+s.type)),s.type==2&&t.push(Qt(s.data.length)),t.push(s.data))})}),li(t)}function zx(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function _n(e){for(var t,r=[],a=[0];a[0]<e.length;){var s=$c(e,a),l=Ut(e.slice(a[0],a[0]+s));a[0]+=s;var o={id:Nr(l[1][0].data),messages:[]};l[2].forEach(function(u){var h=Ut(u.data),d=Nr(h[3][0].data);o.messages.push({meta:h,data:e.slice(a[0],a[0]+d)}),a[0]+=d}),(t=l[3])!=null&&t[0]&&(o.merge=Nr(l[3][0].data)>>>0>0),r.push(o)}return r}function $l(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:Qt(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:Qt(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:Qt(o.data.length)}],a[2].push({data:la(o.meta),type:2})});var l=la(a);t.push(Qt(l.length)),t.push(l),s.forEach(function(o){return t.push(o)})}),li(t)}function sM(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=$c(t,r),s=[];r[0]<t.length;){var l=t[r[0]]&3;if(l==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var u=o-59;o=t[r[0]],u>1&&(o|=t[r[0]+1]<<8),u>2&&(o|=t[r[0]+2]<<16),u>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=u}s.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var h=0,d=0;if(l==1?(d=(t[r[0]]>>2&7)+4,h=(t[r[0]++]&224)<<3,h|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,l==2?(h=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(h=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[li(s)],h==0)throw new Error("Invalid offset 0");if(h>s[0].length)throw new Error("Invalid offset beyond length");if(d>=h)for(s.push(s[0].slice(-h)),d-=h;d>=s[s.length-1].length;)s.push(s[s.length-1]),d-=s[s.length-1].length;s.push(s[0].slice(-h,-h+d))}}var x=li(s);if(x.length!=a)throw new Error("Unexpected length: ".concat(x.length," != ").concat(a));return x}function bn(e){for(var t=[],r=0;r<e.length;){var a=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(sM(a,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return li(t)}function Gl(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var l=Qt(a),o=l.length;t.push(l),a<=60?(o++,t.push(new Uint8Array([a-1<<2]))):a<=256?(o+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(o+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(o+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(o+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),o+=a,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=a}return li(t)}function iM(e,t,r,a){var s=Wi(e),l=s.getUint32(4,!0),o=(a>1?12:8)+yb(l&(a>1?3470:398))*4,u=-1,h=-1,d=NaN,x=new Date(2001,0,1);l&512&&(u=s.getUint32(o,!0),o+=4),o+=yb(l&(a>1?12288:4096))*4,l&16&&(h=s.getUint32(o,!0),o+=4),l&32&&(d=s.getFloat64(o,!0),o+=8),l&64&&(x.setTime(x.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var g;switch(e[2]){case 0:break;case 2:g={t:"n",v:d};break;case 3:g={t:"s",v:t[h]};break;case 5:g={t:"d",v:x};break;case 6:g={t:"b",v:d>0};break;case 7:g={t:"n",v:d/86400};break;case 8:g={t:"e",v:0};break;case 9:if(u>-1)g={t:"s",v:r[u]};else if(h>-1)g={t:"s",v:t[h]};else if(!isNaN(d))g={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return g}function lM(e,t,r){var a=Wi(e),s=a.getUint32(8,!0),l=12,o=-1,u=-1,h=NaN,d=NaN,x=new Date(2001,0,1);s&1&&(h=aM(e,l),l+=16),s&2&&(d=a.getFloat64(l,!0),l+=8),s&4&&(x.setTime(x.getTime()+a.getFloat64(l,!0)*1e3),l+=8),s&8&&(u=a.getUint32(l,!0),l+=4),s&16&&(o=a.getUint32(l,!0),l+=4);var g;switch(e[1]){case 0:break;case 2:g={t:"n",v:h};break;case 3:g={t:"s",v:t[u]};break;case 5:g={t:"d",v:x};break;case 6:g={t:"b",v:d>0};break;case 7:g={t:"n",v:d/86400};break;case 8:g={t:"e",v:0};break;case 9:if(o>-1)g={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:g={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return g}function Dm(e,t){var r=new Uint8Array(32),a=Wi(r),s=12,l=0;switch(r[0]=5,e.t){case"n":r[1]=2,nM(r,s,e.v),l|=1,s+=16;break;case"b":r[1]=6,a.setFloat64(s,e.v?1:0,!0),l|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(s,t.indexOf(e.v),!0),l|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,l,!0),r.slice(0,s)}function Fm(e,t){var r=new Uint8Array(32),a=Wi(r),s=12,l=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(s,e.v,!0),l|=32,s+=8;break;case"b":r[2]=6,a.setFloat64(s,e.v?1:0,!0),l|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(s,t.indexOf(e.v),!0),l|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,l,!0),r.slice(0,s)}function oM(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return iM(e,t,r,e[0]);case 5:return lM(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ga(e){var t=Ut(e);return $c(t[1][0].data)}function _b(e,t){var r=Ut(t.data),a=Nr(r[1][0].data),s=r[3],l=[];return(s||[]).forEach(function(o){var u=Ut(o.data),h=Nr(u[1][0].data)>>>0;switch(a){case 1:l[h]=ax(u[3][0].data);break;case 8:{var d=e[ga(u[9][0].data)][0],x=Ut(d.data),g=e[ga(x[1][0].data)][0],p=Nr(g.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var y=Ut(g.data);l[h]=y[3].map(function(w){return ax(w.data)}).join("")}break}}),l}function cM(e,t){var r,a,s,l,o,u,h,d,x,g,p,y,w,_,S=Ut(e),T=Nr(S[1][0].data)>>>0,N=Nr(S[2][0].data)>>>0,E=((a=(r=S[8])==null?void 0:r[0])==null?void 0:a.data)&&Nr(S[8][0].data)>0||!1,D,G;if((l=(s=S[7])==null?void 0:s[0])!=null&&l.data&&t!=0)D=(u=(o=S[7])==null?void 0:o[0])==null?void 0:u.data,G=(d=(h=S[6])==null?void 0:h[0])==null?void 0:d.data;else if((g=(x=S[4])==null?void 0:x[0])!=null&&g.data&&t!=1)D=(y=(p=S[4])==null?void 0:p[0])==null?void 0:y.data,G=(_=(w=S[3])==null?void 0:w[0])==null?void 0:_.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var V=E?4:1,A=Wi(D),M=[],C=0;C<D.length/2;++C){var U=A.getUint16(C*2,!0);U<65535&&M.push([C,U])}if(M.length!=N)throw"Expected ".concat(N," cells, found ").concat(M.length);var Z=[];for(C=0;C<M.length-1;++C)Z[M[C][0]]=G.subarray(M[C][1]*V,M[C+1][1]*V);return M.length>=1&&(Z[M[M.length-1][0]]=G.subarray(M[M.length-1][1]*V)),{R:T,cells:Z}}function uM(e,t){var r,a=Ut(t.data),s=(r=a==null?void 0:a[7])!=null&&r[0]?Nr(a[7][0].data)>>>0>0?1:0:-1,l=zx(a[5],function(o){return cM(o,s)});return{nrows:Nr(a[4][0].data)>>>0,data:l.reduce(function(o,u){return o[u.R]||(o[u.R]=[]),u.cells.forEach(function(h,d){if(o[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));o[u.R][d]=h}),o},[])}}function fM(e,t,r){var a,s=Ut(t.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(Nr(s[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(l.e.c=(Nr(s[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=yt(l);var o=Ut(s[4][0].data),u=_b(e,e[ga(o[4][0].data)][0]),h=(a=o[17])!=null&&a[0]?_b(e,e[ga(o[17][0].data)][0]):[],d=Ut(o[3][0].data),x=0;d[1].forEach(function(g){var p=Ut(g.data),y=e[ga(p[2][0].data)][0],w=Nr(y.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var _=uM(e,y);_.data.forEach(function(S,T){S.forEach(function(N,E){var D=dt({r:x+T,c:E}),G=oM(N,u,h);G&&(r[D]=G)})}),x+=_.nrows})}function dM(e,t){var r=Ut(t.data),a={"!ref":"A1"},s=e[ga(r[2][0].data)],l=Nr(s[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return fM(e,s[0],a),a}function hM(e,t){var r,a=Ut(t.data),s={name:(r=a[1])!=null&&r[0]?ax(a[1][0].data):"",sheets:[]},l=zx(a[2],ga);return l.forEach(function(o){e[o].forEach(function(u){var h=Nr(u.meta[1][0].data);h==6e3&&s.sheets.push(dM(e,u))})}),s}function mM(e,t){var r=Vx(),a=Ut(t.data),s=zx(a[1],ga);if(s.forEach(function(l){e[l].forEach(function(o){var u=Nr(o.meta[1][0].data);if(u==2){var h=hM(e,o);h.sheets.forEach(function(d,x){Xx(r,d,x==0?h.name:h.name+"_"+x,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Mm(e){var t,r,a,s,l={},o=[];if(e.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var d;try{d=bn(h.content)}catch(g){return console.log("?? "+h.content.length+" "+(g.message||g))}var x;try{x=_n(d)}catch(g){return console.log("## "+(g.message||g))}x.forEach(function(g){l[g.id]=g.messages,o.push(g.id)})}}),!o.length)throw new Error("File has no messages");var u=((s=(a=(r=(t=l==null?void 0:l[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:s[0].data)&&Nr(l[1][0].meta[1][0].data)==1&&l[1][0];if(u||o.forEach(function(h){l[h].forEach(function(d){var x=Nr(d.meta[1][0].data)>>>0;if(x==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return mM(l,u)}function xM(e,t,r){var a,s,l,o;if(!((a=e[6])!=null&&a[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var u=((o=(l=e[8])==null?void 0:l[0])==null?void 0:o.data)&&Nr(e[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var h=0,d=Wi(e[7][0].data),x=0,g=[],p=Wi(e[4][0].data),y=0,w=[],_=0;_<t.length;++_){if(t[_]==null){d.setUint16(_*2,65535,!0),p.setUint16(_*2,65535);continue}d.setUint16(_*2,x,!0),p.setUint16(_*2,y,!0);var S,T;switch(typeof t[_]){case"string":S=Dm({t:"s",v:t[_]},r),T=Fm({t:"s",v:t[_]},r);break;case"number":S=Dm({t:"n",v:t[_]},r),T=Fm({t:"n",v:t[_]},r);break;case"boolean":S=Dm({t:"b",v:t[_]},r),T=Fm({t:"b",v:t[_]},r);break;default:throw new Error("Unsupported value "+t[_])}g.push(S),x+=S.length,w.push(T),y+=T.length,++h}for(e[2][0].data=Qt(h);_<e[7][0].data.length/2;++_)d.setUint16(_*2,65535,!0),p.setUint16(_*2,65535,!0);return e[6][0].data=li(g),e[3][0].data=li(w),h}function pM(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Ha(r["!ref"]);a.s.r=a.s.c=0;var s=!1;a.e.c>9&&(s=!0,a.e.c=9),a.e.r>49&&(s=!0,a.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(yt(a)));var l=Bf(r,{range:a,header:1}),o=["~Sh33tJ5~"];l.forEach(function(P){return P.forEach(function(z){typeof z=="string"&&o.push(z)})});var u={},h=[],d=at.read(t.numbers,{type:"base64"});d.FileIndex.map(function(P,z){return[P,d.FullPaths[z]]}).forEach(function(P){var z=P[0],F=P[1];if(z.type==2&&z.name.match(/\.iwa/)){var Q=z.content,re=bn(Q),Ee=_n(re);Ee.forEach(function(ye){h.push(ye.id),u[ye.id]={deps:[],location:F,type:Nr(ye.messages[0].meta[1][0].data)}})}}),h.sort(function(P,z){return P-z});var x=h.filter(function(P){return P>1}).map(function(P){return[P,Qt(P)]});d.FileIndex.map(function(P,z){return[P,d.FullPaths[z]]}).forEach(function(P){var z=P[0];if(P[1],!!z.name.match(/\.iwa/)){var F=_n(bn(z.content));F.forEach(function(Q){Q.messages.forEach(function(re){x.forEach(function(Ee){Q.messages.some(function(ye){return Nr(ye.meta[1][0].data)!=11006&&rM(ye.data,Ee[1])})&&u[Ee[0]].deps.push(Q.id)})})})}});for(var g=at.find(d,u[1].location),p=_n(bn(g.content)),y,w=0;w<p.length;++w){var _=p[w];_.id==1&&(y=_)}var S=ga(Ut(y.messages[0].data)[1][0].data);for(g=at.find(d,u[S].location),p=_n(bn(g.content)),w=0;w<p.length;++w)_=p[w],_.id==S&&(y=_);for(S=ga(Ut(y.messages[0].data)[2][0].data),g=at.find(d,u[S].location),p=_n(bn(g.content)),w=0;w<p.length;++w)_=p[w],_.id==S&&(y=_);for(S=ga(Ut(y.messages[0].data)[2][0].data),g=at.find(d,u[S].location),p=_n(bn(g.content)),w=0;w<p.length;++w)_=p[w],_.id==S&&(y=_);var T=Ut(y.messages[0].data);{T[6][0].data=Qt(a.e.r+1),T[7][0].data=Qt(a.e.c+1);var N=ga(T[46][0].data),E=at.find(d,u[N].location),D=_n(bn(E.content));{for(var G=0;G<D.length&&D[G].id!=N;++G);if(D[G].id!=N)throw"Bad ColumnRowUIDMapArchive";var V=Ut(D[G].messages[0].data);V[1]=[],V[2]=[],V[3]=[];for(var A=0;A<=a.e.c;++A){var M=[];M[1]=M[2]=[{type:0,data:Qt(A+420690)}],V[1].push({type:2,data:la(M)}),V[2].push({type:0,data:Qt(A)}),V[3].push({type:0,data:Qt(A)})}V[4]=[],V[5]=[],V[6]=[];for(var C=0;C<=a.e.r;++C)M=[],M[1]=M[2]=[{type:0,data:Qt(C+726270)}],V[4].push({type:2,data:la(M)}),V[5].push({type:0,data:Qt(C)}),V[6].push({type:0,data:Qt(C)});D[G].messages[0].data=la(V)}E.content=Gl($l(D)),E.size=E.content.length,delete T[46];var U=Ut(T[4][0].data);{U[7][0].data=Qt(a.e.r+1);var Z=Ut(U[1][0].data),q=ga(Z[2][0].data);E=at.find(d,u[q].location),D=_n(bn(E.content));{if(D[0].id!=q)throw"Bad HeaderStorageBucket";var le=Ut(D[0].messages[0].data);for(C=0;C<l.length;++C){var ge=Ut(le[2][0].data);ge[1][0].data=Qt(C),ge[4][0].data=Qt(l[C].length),le[2][C]={type:le[2][0].type,data:la(ge)}}D[0].messages[0].data=la(le)}E.content=Gl($l(D)),E.size=E.content.length;var Se=ga(U[2][0].data);E=at.find(d,u[Se].location),D=_n(bn(E.content));{if(D[0].id!=Se)throw"Bad HeaderStorageBucket";for(le=Ut(D[0].messages[0].data),A=0;A<=a.e.c;++A)ge=Ut(le[2][0].data),ge[1][0].data=Qt(A),ge[4][0].data=Qt(a.e.r+1),le[2][A]={type:le[2][0].type,data:la(ge)};D[0].messages[0].data=la(le)}E.content=Gl($l(D)),E.size=E.content.length;var te=ga(U[4][0].data);(function(){for(var P=at.find(d,u[te].location),z=_n(bn(P.content)),F,Q=0;Q<z.length;++Q){var re=z[Q];re.id==te&&(F=re)}var Ee=Ut(F.messages[0].data);{Ee[3]=[];var ye=[];o.forEach(function(J,wt){ye[1]=[{type:0,data:Qt(wt)}],ye[2]=[{type:0,data:Qt(1)}],ye[3]=[{type:2,data:tM(J)}],Ee[3].push({type:2,data:la(ye)})})}F.messages[0].data=la(Ee);var Oe=$l(z),tt=Gl(Oe);P.content=tt,P.size=P.content.length})();var ae=Ut(U[3][0].data);{var De=ae[1][0];delete ae[2];var ie=Ut(De.data);{var Me=ga(ie[2][0].data);(function(){for(var P=at.find(d,u[Me].location),z=_n(bn(P.content)),F,Q=0;Q<z.length;++Q){var re=z[Q];re.id==Me&&(F=re)}var Ee=Ut(F.messages[0].data);{delete Ee[6],delete ae[7];var ye=new Uint8Array(Ee[5][0].data);Ee[5]=[];for(var Oe=0,tt=0;tt<=a.e.r;++tt){var J=Ut(ye);Oe+=xM(J,l[tt],o),J[1][0].data=Qt(tt),Ee[5].push({data:la(J),type:2})}Ee[1]=[{type:0,data:Qt(a.e.c+1)}],Ee[2]=[{type:0,data:Qt(a.e.r+1)}],Ee[3]=[{type:0,data:Qt(Oe)}],Ee[4]=[{type:0,data:Qt(a.e.r+1)}]}F.messages[0].data=la(Ee);var wt=$l(z),et=Gl(wt);P.content=et,P.size=P.content.length})()}De.data=la(ie)}U[3][0].data=la(ae)}T[4][0].data=la(U)}y.messages[0].data=la(T);var W=$l(p),O=Gl(W);return g.content=O,g.size=g.content.length,d}function W2(e){return function(r){for(var a=0;a!=e.length;++a){var s=e[a];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Hx(e){W2([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function qx(e){W2([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function gM(e){return Et.WS.indexOf(e)>-1?"sheet":e==Et.CS?"chart":e==Et.DS?"dialog":e==Et.MS?"macro":e&&e.length?e:"sheet"}function vM(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,gM(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function yM(e,t,r,a,s,l,o,u,h,d,x,g){try{l[a]=_c(sn(e,r,!0),t);var p=Pr(e,t),y;switch(u){case"sheet":y=zD(p,t,s,h,l[a],d,x,g);break;case"chart":if(y=HD(p,t,s,h,l[a],d,x,g),!y||!y["!drawel"])break;var w=mc(y["!drawel"].Target,t),_=Bc(w),S=j5(sn(e,w,!0),_c(sn(e,_,!0),w)),T=mc(S,w),N=Bc(T);y=xD(sn(e,T,!0),T,h,_c(sn(e,N,!0),T),d,y);break;case"macro":y=qD(p,t,s,h,l[a],d,x,g);break;case"dialog":y=$D(p,t,s,h,l[a],d,x,g);break;default:throw new Error("Unrecognized sheet type "+u)}o[a]=y;var E=[];l&&l[a]&&jr(l[a]).forEach(function(D){var G="";if(l[a][D].Type==Et.CMNT){G=mc(l[a][D].Target,t);var V=WD(Pr(e,G,!0),G,h);if(!V||!V.length)return;sb(y,V,!1)}l[a][D].Type==Et.TCMNT&&(G=mc(l[a][D].Target,t),E=E.concat(O5(Pr(e,G,!0),h)))}),E&&E.length&&sb(y,E,!0,h.people||[])}catch(D){if(h.WTF)throw D}}function vn(e){return e.charAt(0)=="/"?e.slice(1):e}function _M(e,t){if(co(),t=t||{},Hx(t),wn(e,"META-INF/manifest.xml")||wn(e,"objectdata.xml"))return pb(e,t);if(wn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Mm<"u"){if(e.FileIndex)return Mm(e);var r=at.utils.cfb_new();return k_(e).forEach(function(ge){bt(r,ge,Cj(e,ge))}),Mm(r)}throw new Error("Unsupported NUMBERS file")}if(!wn(e,"[Content_Types].xml"))throw wn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):wn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=k_(e),s=EA(sn(e,"[Content_Types].xml")),l=!1,o,u;if(s.workbooks.length===0&&(u="xl/workbook.xml",Pr(e,u,!0)&&s.workbooks.push(u)),s.workbooks.length===0){if(u="xl/workbook.bin",!Pr(e,u,!0))throw new Error("Could not find workbook");s.workbooks.push(u),l=!0}s.workbooks[0].slice(-3)=="bin"&&(l=!0);var h={},d={};if(!t.bookSheets&&!t.bookProps){if(bc=[],s.sst)try{bc=XD(Pr(e,vn(s.sst)),s.sst,t)}catch(ge){if(t.WTF)throw ge}t.cellStyles&&s.themes.length&&(h=VD(sn(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(d=GD(Pr(e,vn(s.style)),s.style,h,t))}s.links.map(function(ge){try{var Se=_c(sn(e,Bc(vn(ge))),ge);return YD(Pr(e,vn(ge)),Se,ge,t)}catch{}});var x=UD(Pr(e,vn(s.workbooks[0])),s.workbooks[0],t),g={},p="";s.coreprops.length&&(p=Pr(e,vn(s.coreprops[0]),!0),p&&(g=Iw(p)),s.extprops.length!==0&&(p=Pr(e,vn(s.extprops[0]),!0),p&&CA(p,g,t)));var y={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(p=sn(e,vn(s.custprops[0]),!0),p&&(y=DA(p,t)));var w={};if((t.bookSheets||t.bookProps)&&(x.Sheets?o=x.Sheets.map(function(Se){return Se.name}):g.Worksheets&&g.SheetNames.length>0&&(o=g.SheetNames),t.bookProps&&(w.Props=g,w.Custprops=y),t.bookSheets&&typeof o<"u"&&(w.SheetNames=o),t.bookSheets?w.SheetNames:t.bookProps))return w;o={};var _={};t.bookDeps&&s.calcchain&&(_=KD(Pr(e,vn(s.calcchain)),s.calcchain));var S=0,T={},N,E;{var D=x.Sheets;g.Worksheets=D.length,g.SheetNames=[];for(var G=0;G!=D.length;++G)g.SheetNames[G]=D[G].name}var V=l?"bin":"xml",A=s.workbooks[0].lastIndexOf("/"),M=(s.workbooks[0].slice(0,A+1)+"_rels/"+s.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");wn(e,M)||(M="xl/_rels/workbook."+V+".rels");var C=_c(sn(e,M,!0),M.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=JD(Pr(e,vn(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=R5(Pr(e,vn(s.people[0])),t)),C&&(C=vM(C,x.Sheets));var U=Pr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=g.Worksheets;++S){var Z="sheet";if(C&&C[S]?(N="xl/"+C[S][1].replace(/[\/]?xl\//,""),wn(e,N)||(N=C[S][1]),wn(e,N)||(N=M.replace(/_rels\/.*$/,"")+C[S][1]),Z=C[S][2]):(N="xl/worksheets/sheet"+(S+1-U)+"."+V,N=N.replace(/sheet0\./,"sheet.")),E=N.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(S!=t.sheets)continue e;break;case"string":if(g.SheetNames[S].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var q=!1,le=0;le!=t.sheets.length;++le)typeof t.sheets[le]=="number"&&t.sheets[le]==S&&(q=1),typeof t.sheets[le]=="string"&&t.sheets[le].toLowerCase()==g.SheetNames[S].toLowerCase()&&(q=1);if(!q)continue e}}yM(e,N,E,g.SheetNames[S],S,T,o,Z,t,x,h,d)}return w={Directory:s,Workbook:x,Props:g,Custprops:y,Deps:_,Sheets:o,SheetNames:g.SheetNames,Strings:bc,Styles:d,Themes:h,SSF:mr(ut)},t&&t.bookFiles&&(e.files?(w.keys=a,w.files=e.files):(w.keys=[],w.files={},e.FullPaths.forEach(function(ge,Se){ge=ge.replace(/^Root Entry[\/]/,""),w.keys.push(ge),w.files[ge]=e.FileIndex[Se]}))),t&&t.bookVBA&&(s.vba.length>0?w.vbaraw=Pr(e,vn(s.vba[0]),!0):s.defaults&&s.defaults.bin===U5&&(w.vbaraw=Pr(e,"xl/vbaProject.bin",!0))),w}function bM(e,t){var r=t||{},a="Workbook",s=at.find(e,a);try{if(a="/!DataSpaces/Version",s=at.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(JO(s.content),a="/!DataSpaces/DataSpaceMap",s=at.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=ZO(s.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=at.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=eC(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=at.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);rC(s.content)}catch{}if(a="/EncryptionInfo",s=at.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var u=aC(s.content);if(a="/EncryptedPackage",s=at.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],s.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function wM(e,t){return t.bookType=="ods"?X2(e,t):t.bookType=="numbers"?pM(e,t):t.bookType=="xlsb"?SM(e,t):EM(e,t)}function SM(e,t){Jl=1024,e&&!e.SSF&&(e.SSF=mr(ut)),e&&e.SSF&&(co(),Kf(e.SSF),t.revssf=Jf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,wc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=b2.indexOf(t.bookType)>-1,s=jx();qx(t=t||{});var l=mx(),o="",u=0;if(t.cellXfs=[],ui(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",bt(l,o,Lw(e.Props,t)),s.coreprops.push(o),Zt(t.rels,2,o,Et.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var h=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(e.SheetNames[d]);e.Props.SheetNames=h}for(e.Props.Worksheets=e.Props.SheetNames.length,bt(l,o,Uw(e.Props)),s.extprops.push(o),Zt(t.rels,3,o,Et.EXT_PROPS),e.Custprops!==e.Props&&jr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",bt(l,o,zw(e.Custprops)),s.custprops.push(o),Zt(t.rels,4,o,Et.CUST_PROPS)),u=1;u<=e.SheetNames.length;++u){var x={"!id":{}},g=e.Sheets[e.SheetNames[u-1]],p=(g||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+u+"."+r,bt(l,o,ZD(u-1,o,t,e,x)),s.sheets.push(o),Zt(t.wbrels,-1,"worksheets/sheet"+u+"."+r,Et.WS[0])}if(g){var y=g["!comments"],w=!1,_="";y&&y.length>0&&(_="xl/comments"+u+"."+r,bt(l,_,rF(y,_)),s.comments.push(_),Zt(x,-1,"../comments"+u+"."+r,Et.CMNT),w=!0),g["!legacy"]&&w&&bt(l,"xl/drawings/vmlDrawing"+u+".vml",y2(u,g["!comments"])),delete g["!comments"],delete g["!legacy"]}x["!id"].rId1&&bt(l,Bc(o),eo(x))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,bt(l,o,tF(t.Strings,o,t)),s.strs.push(o),Zt(t.wbrels,-1,"sharedStrings."+r,Et.SST)),o="xl/workbook."+r,bt(l,o,QD(e,o)),s.workbooks.push(o),Zt(t.rels,1,o,Et.WB),o="xl/theme/theme1.xml",bt(l,o,Fx(e.Themes,t)),s.themes.push(o),Zt(t.wbrels,-1,"theme/theme1.xml",Et.THEME),o="xl/styles."+r,bt(l,o,eF(e,o,t)),s.styles.push(o),Zt(t.wbrels,-1,"styles."+r,Et.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",bt(l,o,e.vbaraw),s.vba.push(o),Zt(t.wbrels,-1,"vbaProject.bin",Et.VBA)),o="xl/metadata."+r,bt(l,o,aF(o)),s.metadata.push(o),Zt(t.wbrels,-1,"metadata."+r,Et.XLMETA),bt(l,"[Content_Types].xml",Fw(s,t)),bt(l,"_rels/.rels",eo(t.rels)),bt(l,"xl/_rels/workbook."+r+".rels",eo(t.wbrels)),delete t.revssf,delete t.ssf,l}function EM(e,t){Jl=1024,e&&!e.SSF&&(e.SSF=mr(ut)),e&&e.SSF&&(co(),Kf(e.SSF),t.revssf=Jf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,wc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=b2.indexOf(t.bookType)>-1,s=jx();qx(t=t||{});var l=mx(),o="",u=0;if(t.cellXfs=[],ui(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",bt(l,o,Lw(e.Props,t)),s.coreprops.push(o),Zt(t.rels,2,o,Et.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var h=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(e.SheetNames[d]);e.Props.SheetNames=h}e.Props.Worksheets=e.Props.SheetNames.length,bt(l,o,Uw(e.Props)),s.extprops.push(o),Zt(t.rels,3,o,Et.EXT_PROPS),e.Custprops!==e.Props&&jr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",bt(l,o,zw(e.Custprops)),s.custprops.push(o),Zt(t.rels,4,o,Et.CUST_PROPS));var x=["SheetJ5"];for(t.tcid=0,u=1;u<=e.SheetNames.length;++u){var g={"!id":{}},p=e.Sheets[e.SheetNames[u-1]],y=(p||{})["!type"]||"sheet";switch(y){case"chart":default:o="xl/worksheets/sheet"+u+"."+r,bt(l,o,R2(u-1,t,e,g)),s.sheets.push(o),Zt(t.wbrels,-1,"worksheets/sheet"+u+"."+r,Et.WS[0])}if(p){var w=p["!comments"],_=!1,S="";if(w&&w.length>0){var T=!1;w.forEach(function(N){N[1].forEach(function(E){E.T==!0&&(T=!0)})}),T&&(S="xl/threadedComments/threadedComment"+u+"."+r,bt(l,S,C5(w,x,t)),s.threadedcomments.push(S),Zt(g,-1,"../threadedComments/threadedComment"+u+"."+r,Et.TCMNT)),S="xl/comments"+u+"."+r,bt(l,S,_2(w)),s.comments.push(S),Zt(g,-1,"../comments"+u+"."+r,Et.CMNT),_=!0}p["!legacy"]&&_&&bt(l,"xl/drawings/vmlDrawing"+u+".vml",y2(u,p["!comments"])),delete p["!comments"],delete p["!legacy"]}g["!id"].rId1&&bt(l,Bc(o),eo(g))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,bt(l,o,l2(t.Strings,t)),s.strs.push(o),Zt(t.wbrels,-1,"sharedStrings."+r,Et.SST)),o="xl/workbook."+r,bt(l,o,L2(e)),s.workbooks.push(o),Zt(t.rels,1,o,Et.WB),o="xl/theme/theme1.xml",bt(l,o,Fx(e.Themes,t)),s.themes.push(o),Zt(t.wbrels,-1,"theme/theme1.xml",Et.THEME),o="xl/styles."+r,bt(l,o,x2(e,t)),s.styles.push(o),Zt(t.wbrels,-1,"styles."+r,Et.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",bt(l,o,e.vbaraw),s.vba.push(o),Zt(t.wbrels,-1,"vbaProject.bin",Et.VBA)),o="xl/metadata."+r,bt(l,o,v2()),s.metadata.push(o),Zt(t.wbrels,-1,"metadata."+r,Et.XLMETA),x.length>1&&(o="xl/persons/person.xml",bt(l,o,D5(x)),s.people.push(o),Zt(t.wbrels,-1,"persons/person.xml",Et.PEOPLE)),bt(l,"[Content_Types].xml",Fw(s,t)),bt(l,"_rels/.rels",eo(t.rels)),bt(l,"xl/_rels/workbook."+r+".rels",eo(t.wbrels)),delete t.revssf,delete t.ssf,l}function $x(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ln(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function TM(e,t){return at.find(e,"EncryptedPackage")?bM(e,t):z2(e,t)}function kM(e,t){var r,a=e,s=t||{};return s.type||(s.type=St&&Buffer.isBuffer(e)?"buffer":"base64"),r=cw(a,s),_M(r,s)}function K2(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return tx(e.slice(r),t);default:break e}return no.to_workbook(e,t)}function NM(e,t){var r="",a=$x(e,t);switch(t.type){case"base64":r=ln(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=$i(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=sr(r)),t.type="binary",K2(r,t)}function jM(e,t){var r=e;return t.type=="base64"&&(r=ln(r)),r=Rc.utils.decode(1200,r.slice(2),"str"),t.type="binary",K2(r,t)}function AM(e){return e.match(/[^\x00-\x7F]/)?Yn(e):e}function Im(e,t,r,a){return a?(r.type="string",no.to_workbook(e,r)):no.to_workbook(t,r)}function Lf(e,t){cx();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Lf(new Uint8Array(e),(r=mr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,s=[0,0,0,0],l=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ro={},r.dateNF&&(ro.dateNF=r.dateNF),r.type||(r.type=St&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=St?"buffer":"binary",a=Sj(e),typeof Uint8Array<"u"&&!St&&(r.type="array")),r.type=="string"&&(l=!0,r.type="binary",r.codepage=65001,a=AM(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),u=new Uint8Array(o);if(u.foo="bar",!u.foo)return r=mr(r),r.type="array",Lf(ux(a),r)}switch((s=$x(a,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return TM(at.read(a,r),r);break;case 9:if(s[1]<=8)return z2(a,r);break;case 60:return tx(a,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return FO(a,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return s2.to_workbook(a,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?kM(a,r):Im(e,a,r,l);case 239:return s[3]===60?tx(a,r):Im(e,a,r,l);case 255:if(s[1]===254)return jM(a,r);if(s[1]===0&&s[2]===2&&s[3]===0)return zi.to_workbook(a,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return zi.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return ex.to_workbook(a,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return d2.to_workbook(a,r);break;case 10:case 13:case 32:return NM(a,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return DO.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?ex.to_workbook(a,r):Im(e,a,r,l)}function Y2(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Jc(t.file,at.write(e,{type:St?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return at.write(e,t)}function OM(e,t){var r=mr(t||{}),a=wM(e,r);return CM(a,r)}function CM(e,t){var r={},a=St?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?at.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(Wf(s))}return t.password&&typeof encrypt_agile<"u"?Y2(encrypt_agile(s,t.password),t):t.type==="file"?Jc(t.file,s):t.type=="string"?sr(s):s}function RM(e,t){var r=t||{},a=AF(e,r);return Y2(a,r)}function Kn(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return Dc(Yn(a));case"binary":return Yn(a);case"string":return e;case"file":return Jc(t.file,a,"utf8");case"buffer":return St?Es(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):Kn(a,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function DM(e,t){switch(t.type){case"base64":return Dc(e);case"binary":return e;case"string":return e;case"file":return Jc(t.file,e,"binary");case"buffer":return St?Es(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function bf(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?Dc(r):t.type=="string"?sr(r):r;case"file":return Jc(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function J2(e,t){cx(),TD(e);var r=mr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=J2(e,r);return r.type="array",Wf(a)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Kn(wF(e,r),r);case"slk":case"sylk":return Kn(n2.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Kn(q2(e.Sheets[e.SheetNames[s]],r),r);case"txt":return DM(Z2(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Kn(Gx(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Kn(s2.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return bf(ex.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Kn(no.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Kn(d2.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Kn(i2.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Kn(X2(e,r),r);case"wk1":return bf(zi.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return bf(zi.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),bf(H2(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),RM(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return OM(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function FM(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Q2(e,t,r){var a={};return a.type="file",a.file=t,FM(a),J2(e,a)}function MM(e,t,r,a,s,l,o,u){var h=Rr(r),d=u.defval,x=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),g=!0,p=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!o||e[r])for(var y=t.s.c;y<=t.e.c;++y){var w=o?e[r][y]:e[a[y]+h];if(w===void 0||w.t===void 0){if(d===void 0)continue;l[y]!=null&&(p[l[y]]=d);continue}var _=w.v;switch(w.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(l[y]!=null){if(_==null)if(w.t=="e"&&_===null)p[l[y]]=null;else if(d!==void 0)p[l[y]]=d;else if(x&&_===null)p[l[y]]=null;else continue;else p[l[y]]=x&&(w.t!=="n"||w.t==="n"&&u.rawNumbers!==!1)?_:ws(w,_,u);_!=null&&(g=!1)}}return{row:p,isempty:g}}function Bf(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,s=1,l=[],o=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},x=d.range!=null?d.range:e["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)?a=3:d.header==null&&(a=0),typeof x){case"string":h=Mt(x);break;case"number":h=Mt(e["!ref"]),h.s.r=x;break;default:h=x}a>0&&(s=0);var g=Rr(h.s.r),p=[],y=[],w=0,_=0,S=Array.isArray(e),T=h.s.r,N=0,E={};S&&!e[T]&&(e[T]=[]);var D=d.skipHidden&&e["!cols"]||[],G=d.skipHidden&&e["!rows"]||[];for(N=h.s.c;N<=h.e.c;++N)if(!(D[N]||{}).hidden)switch(p[N]=vr(N),r=S?e[T][N]:e[p[N]+g],a){case 1:l[N]=N-h.s.c;break;case 2:l[N]=p[N];break;case 3:l[N]=d.header[N-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=o=ws(r,null,d),_=E[o]||0,!_)E[o]=1;else{do u=o+"_"+_++;while(E[u]);E[o]=_,E[u]=1}l[N]=u}for(T=h.s.r+s;T<=h.e.r;++T)if(!(G[T]||{}).hidden){var V=MM(e,h,T,p,a,l,S,d);(V.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows))&&(y[w++]=V.row)}return y.length=w,y}var bb=/"/g;function IM(e,t,r,a,s,l,o,u){for(var h=!0,d=[],x="",g=Rr(r),p=t.s.c;p<=t.e.c;++p)if(a[p]){var y=u.dense?(e[r]||[])[p]:e[a[p]+g];if(y==null)x="";else if(y.v!=null){h=!1,x=""+(u.rawNumbers&&y.t=="n"?y.v:ws(y,null,u));for(var w=0,_=0;w!==x.length;++w)if((_=x.charCodeAt(w))===s||_===l||_===34||u.forceQuotes){x='"'+x.replace(bb,'""')+'"';break}x=="ID"&&(x='"ID"')}else y.f!=null&&!y.F?(h=!1,x="="+y.f,x.indexOf(",")>=0&&(x='"'+x.replace(bb,'""')+'"')):x="";d.push(x)}return u.blankrows===!1&&h?null:d.join(o)}function Gx(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var s=Mt(e["!ref"]),l=a.FS!==void 0?a.FS:",",o=l.charCodeAt(0),u=a.RS!==void 0?a.RS:`
`,h=u.charCodeAt(0),d=new RegExp((l=="|"?"\\|":l)+"+$"),x="",g=[];a.dense=Array.isArray(e);for(var p=a.skipHidden&&e["!cols"]||[],y=a.skipHidden&&e["!rows"]||[],w=s.s.c;w<=s.e.c;++w)(p[w]||{}).hidden||(g[w]=vr(w));for(var _=0,S=s.s.r;S<=s.e.r;++S)(y[S]||{}).hidden||(x=IM(e,s,S,g,o,h,l,a),x!=null&&(a.strip&&(x=x.replace(d,"")),(x||a.blankrows!==!1)&&r.push((_++?u:"")+x)));return delete a.dense,r.join("")}function Z2(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Gx(e,t);return r}function LM(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var s=Mt(e["!ref"]),l="",o=[],u,h=[],d=Array.isArray(e);for(u=s.s.c;u<=s.e.c;++u)o[u]=vr(u);for(var x=s.s.r;x<=s.e.r;++x)for(l=Rr(x),u=s.s.c;u<=s.e.c;++u)if(t=o[u]+l,r=d?(e[x]||[])[u]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}h[h.length]=t+"="+a}return h}function eS(e,t,r){var a=r||{},s=+!a.skipHeader,l=e||{},o=0,u=0;if(l&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var h=typeof a.origin=="string"?yr(a.origin):a.origin;o=h.r,u=h.c}var d,x={s:{c:0,r:0},e:{c:u,r:o+t.length-1+s}};if(l["!ref"]){var g=Mt(l["!ref"]);x.e.c=Math.max(x.e.c,g.e.c),x.e.r=Math.max(x.e.r,g.e.r),o==-1&&(o=g.e.r+1,x.e.r=o+t.length-1+s)}else o==-1&&(o=0,x.e.r=t.length-1+s);var p=a.header||[],y=0;t.forEach(function(_,S){jr(_).forEach(function(T){(y=p.indexOf(T))==-1&&(p[y=p.length]=T);var N=_[T],E="z",D="",G=dt({c:u+y,r:o+S+s});d=Gc(l,G),N&&typeof N=="object"&&!(N instanceof Date)?l[G]=N:(typeof N=="number"?E="n":typeof N=="boolean"?E="b":typeof N=="string"?E="s":N instanceof Date?(E="d",a.cellDates||(E="n",N=Kr(N)),D=a.dateNF||ut[14]):N===null&&a.nullError&&(E="e",N=0),d?(d.t=E,d.v=N,delete d.w,delete d.R,D&&(d.z=D)):l[G]=d={t:E,v:N},D&&(d.z=D))})}),x.e.c=Math.max(x.e.c,u+p.length-1);var w=Rr(o);if(s)for(y=0;y<p.length;++y)l[vr(y+u)+w]={t:"s",v:p[y]};return l["!ref"]=yt(x),l}function BM(e,t){return eS(null,e,t)}function Gc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=yr(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Gc(e,dt(t)):Gc(e,dt({r:t,c:r||0}))}function PM(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Vx(){return{SheetNames:[],Sheets:{}}}function Xx(e,t,r,a){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var l=r.match(/(^.*?)(\d+)$/);s=l&&+l[2]||0;var o=l&&l[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=o+s)!=-1;++s);}if(I2(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function UM(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=PM(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function zM(e,t){return e.z=t,e}function tS(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function HM(e,t,r){return tS(e,"#"+t,r)}function qM(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function $M(e,t,r,a){for(var s=typeof t!="string"?t:Mt(t),l=typeof t=="string"?t:yt(t),o=s.s.r;o<=s.e.r;++o)for(var u=s.s.c;u<=s.e.c;++u){var h=Gc(e,o,u);h.t="n",h.F=l,delete h.v,o==s.s.r&&u==s.s.c&&(h.f=r,a&&(h.D=!0))}return e}var ai={encode_col:vr,encode_row:Rr,encode_cell:dt,encode_range:yt,decode_col:wx,decode_row:bx,split_cell:tA,decode_cell:yr,decode_range:Ha,format_cell:ws,sheet_add_aoa:Nw,sheet_add_json:eS,sheet_add_dom:$2,aoa_to_sheet:uo,json_to_sheet:BM,table_to_sheet:G2,table_to_book:JF,sheet_to_csv:Gx,sheet_to_txt:Z2,sheet_to_json:Bf,sheet_to_html:q2,sheet_to_formulae:LM,sheet_to_row_object_array:Bf,sheet_get_cell:Gc,book_new:Vx,book_append_sheet:Xx,book_set_sheet_visibility:UM,cell_set_number_format:zM,cell_set_hyperlink:tS,cell_set_internal_link:HM,cell_add_comment:qM,sheet_set_array_formula:$M,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const GM=({user:e})=>{const[t,r]=ne.useState([]),[a,s]=ne.useState(!0),[l,o]=ne.useState(!1),[u,h]=ne.useState({}),[d,x]=ne.useState(!1),[g,p]=ne.useState([]),[y,w]=ne.useState(""),[_,S]=ne.useState([]);ne.useEffect(()=>{N(),T()},[]);const T=async()=>{const{data:M}=await Te.from("projects").select("id, name");M&&p(M)},N=async()=>{s(!0);let M=Te.from("hr_employees").select("*");if(e.role==="project_manager"&&e.projectId){const{data:U}=await Te.from("projects").select("name").eq("id",e.projectId).single();U?M=M.or(`project.eq.${U.name},project.eq.${e.projectId}`):M=M.eq("project",e.projectId)}const{data:C}=await M.order("created_at",{ascending:!1});C&&r(C),s(!1),S([])},E=async()=>{if(_.length===0||!confirm(`     ${_.length} ()        .`))return;const{error:M}=await Te.rpc("hr_delete_employees",{p_ids:_});M?alert("   : "+M.message):N()},D=async M=>{M.preventDefault();const C=parseFloat(u.basic_salary||"0"),U=parseFloat(u.variable_salary||"0"),Z=parseFloat(u.insurance_salary||"0");if(C<=0){alert("Basic salary must be greater than 0");return}const{error:q}=await Te.rpc("hr_update_employee",{p_id:u.id||null,p_full_name:u.full_name||null,p_email:u.email||null,p_phone:u.phone||null,p_national_id:u.national_id||null,p_employee_code:u.employee_code||null,p_address:u.address||null,p_insurance_number:u.insurance_number||null,p_insurance_date:u.insurance_date||null,p_insurance_salary:Z,p_gender:u.gender||null,p_date_of_birth:u.date_of_birth||null,p_education:u.education||null,p_hire_date:u.hire_date||null,p_job_title:u.job_title||null,p_department:u.department||null,p_project:u.project||null,p_basic_salary:C,p_variable_salary:U,p_status:u.status||"active"});q?alert(`Error saving employee: ${q.message}`):(o(!1),h({}),N())},G=async M=>{var U;const C=(U=M.target.files)==null?void 0:U[0];if(C){x(!0);try{const Z=await C.arrayBuffer(),q=Lf(Z),le=q.Sheets[q.SheetNames[0]],ge=ai.sheet_to_json(le);let Se=0,te=0;for(const ae of ge){const De=parseFloat(ae.basic_salary)||0;if(De<=0||!ae.full_name||!ae.email||!ae.hire_date){te++;continue}const{error:ie}=await Te.rpc("hr_update_employee",{p_id:null,p_full_name:ae.full_name,p_email:ae.email,p_phone:ae.phone?String(ae.phone):null,p_national_id:ae.national_id?String(ae.national_id):null,p_employee_code:ae.employee_code?String(ae.employee_code):null,p_address:ae.address||null,p_insurance_number:ae.insurance_number?String(ae.insurance_number):null,p_insurance_date:ae.insurance_date?new Date(ae.insurance_date).toISOString().split("T")[0]:null,p_insurance_salary:parseFloat(ae.insurance_salary)||0,p_gender:ae.gender||null,p_date_of_birth:ae.date_of_birth?new Date(ae.date_of_birth).toISOString().split("T")[0]:null,p_education:ae.education||null,p_hire_date:new Date(ae.hire_date).toISOString().split("T")[0],p_job_title:ae.job_title||null,p_department:ae.department||null,p_project:ae.project||null,p_basic_salary:De,p_variable_salary:parseFloat(ae.variable_salary)||0,p_status:ae.status||"active"});ie?(console.error("Error inserting row",ae,ie),te++):Se++}alert(` :  (${Se})   (${te})`),N()}catch(Z){alert("    : "+Z.message)}finally{x(!1),M.target.value=""}}},V=()=>{const M=["full_name","email","phone","national_id","employee_code","address","insurance_number","insurance_date","insurance_salary","gender","date_of_birth","education","hire_date","job_title","department","project","basic_salary","variable_salary","status"],C=ai.aoa_to_sheet([M]),U=ai.book_new();ai.book_append_sheet(U,C,"Template"),Q2(U,"Employees_Upload_Template.xlsx")},A=t.filter(M=>M.full_name.toLowerCase().includes(y.toLowerCase())||M.employee_code&&M.employee_code.includes(y)||M.national_id&&M.national_id.includes(y));return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center bg-white p-4 rounded-xl shadow-sm border border-gray-100 gap-4",children:[f.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 mb-2 md:mb-0",children:[f.jsx("span",{className:"material-icons text-indigo-500",children:"groups"})," "]}),f.jsx("div",{className:"flex-1 w-full md:w-auto max-w-md",children:f.jsxs("div",{className:"relative",children:[f.jsx("span",{className:"material-icons absolute top-2.5 right-3 text-gray-400",children:"search"}),f.jsx("input",{type:"text",placeholder:"      ...",value:y,onChange:M=>w(M.target.value),className:"w-full border border-gray-200 rounded-lg py-2 pr-10 pl-4 focus:ring-2 focus:ring-primary focus:border-transparent outline-none"})]})}),f.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[_.length>0&&f.jsxs("button",{onClick:E,className:"bg-red-50 text-red-600 px-4 py-2 rounded-lg font-bold flex items-center gap-2 hover:bg-red-100 transition shadow-sm",children:[f.jsx("span",{className:"material-icons",children:"delete"}),"  (",_.length,")"]}),f.jsxs("button",{onClick:V,className:"bg-white border text-gray-600 px-4 py-2 rounded-lg font-bold flex items-center gap-2 hover:bg-gray-50 transition shadow-sm",title:"  ",children:[f.jsx("span",{className:"material-icons",children:"download"})," "]}),f.jsxs("label",{className:`bg-white border-2 border-primary text-primary px-4 py-2 rounded-lg font-bold flex items-center gap-2 ${d?"opacity-50 cursor-not-allowed":"hover:bg-blue-50 cursor-pointer"} transition`,children:[f.jsx("span",{className:"material-icons",children:d?"hourglass_empty":"upload_file"}),d?" ...":" (CSV/Excel)",f.jsx("input",{type:"file",hidden:!0,accept:".xlsx, .xls, .csv",onChange:G,disabled:d})]}),f.jsxs("button",{onClick:()=>{h({hire_date:new Date().toISOString().split("T")[0],status:"active"}),o(!0)},className:"bg-primary text-white px-4 py-2 rounded-lg font-bold flex items-center gap-2 hover:bg-blue-700 transition",children:[f.jsx("span",{className:"material-icons",children:"add"})," "]})]})]}),f.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:a?f.jsx("div",{className:"p-8 text-center text-gray-500",children:" ..."}):f.jsxs("table",{className:"w-full text-right",children:[f.jsx("thead",{className:"bg-gray-50 border-b",children:f.jsxs("tr",{children:[f.jsx("th",{className:"p-4 w-10",children:f.jsx("input",{type:"checkbox",className:"w-4 h-4 text-primary rounded border-gray-300 focus:ring-primary",checked:A.length>0&&_.length===A.length,onChange:M=>{M.target.checked?S(A.map(C=>C.id)):S([])}})}),f.jsx("th",{className:"p-4 font-bold text-gray-600",children:""}),f.jsx("th",{className:"p-4 font-bold text-gray-600",children:" "}),f.jsx("th",{className:"p-4 font-bold text-gray-600",children:" "}),f.jsx("th",{className:"p-4 font-bold text-gray-600",children:""}),f.jsx("th",{className:"p-4 font-bold text-gray-600",children:""}),f.jsx("th",{className:"p-4 font-bold text-gray-600",children:""})]})}),f.jsxs("tbody",{children:[A.map(M=>f.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[f.jsx("td",{className:"p-4",children:f.jsx("input",{type:"checkbox",className:"w-4 h-4 text-primary rounded border-gray-300 focus:ring-primary",checked:_.includes(M.id),onChange:C=>{C.target.checked?S([..._,M.id]):S(_.filter(U=>U!==M.id))}})}),f.jsxs("td",{className:"p-4",children:[f.jsx("div",{className:"font-bold",children:M.full_name}),f.jsxs("div",{className:"text-xs text-gray-500",children:[M.email," ",f.jsx("span",{className:"opacity-50 mx-1",children:"|"})," ",M.phone||" "]})]}),f.jsx("td",{className:"p-4 font-mono text-sm text-gray-500",children:M.employee_code||"-"}),f.jsxs("td",{className:"p-4",children:[f.jsx("div",{children:M.job_title||"-"}),f.jsx("div",{className:"text-xs text-gray-500",children:M.department||"-"})]}),f.jsxs("td",{className:"p-4 text-green-600 font-bold",children:[M.basic_salary," EGP"]}),f.jsx("td",{className:"p-4",children:f.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${M.status==="active"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:M.status==="active"?"":" "})}),f.jsxs("td",{className:"p-4 flex gap-2",children:[f.jsx("button",{onClick:()=>{h(M),o(!0)},className:"text-blue-500 hover:text-blue-700 p-2 bg-blue-50 rounded",title:"",children:f.jsx("span",{className:"material-icons text-sm",children:"edit"})}),f.jsx("button",{onClick:()=>{confirm(`     ${M.full_name}`)&&Te.rpc("hr_delete_employees",{p_ids:[M.id]}).then(()=>N())},className:"text-red-500 hover:text-red-700 p-2 bg-red-50 rounded",title:"",children:f.jsx("span",{className:"material-icons text-sm",children:"delete"})})]})]},M.id)),A.length===0&&f.jsx("tr",{children:f.jsx("td",{colSpan:7,className:"p-8 text-center text-gray-400",children:"   ."})})]})]})}),l&&f.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[f.jsxs("div",{className:"p-4 border-b flex justify-between items-center sticky top-0 bg-white",children:[f.jsx("h3",{className:"font-bold text-lg",children:u.id?" ":"  "}),f.jsx("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-red-500",children:f.jsx("span",{className:"material-icons",children:"close"})})]}),f.jsxs("form",{onSubmit:D,className:"p-6",children:[f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"  *"}),f.jsx("input",{required:!0,type:"text",className:"w-full border rounded p-2",value:u.full_name||"",onChange:M=>h({...u,full_name:M.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"  *"}),f.jsx("input",{required:!0,type:"email",className:"w-full border rounded p-2",value:u.email||"",onChange:M=>h({...u,email:M.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:" "}),f.jsx("input",{type:"text",className:"w-full border rounded p-2",value:u.phone||"",onChange:M=>h({...u,phone:M.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:" "}),f.jsx("input",{type:"text",className:"w-full border rounded p-2",value:u.national_id||"",onChange:M=>h({...u,national_id:M.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:" "}),f.jsx("input",{type:"text",className:"w-full border rounded p-2",value:u.employee_code||"",onChange:M=>h({...u,employee_code:M.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:""}),f.jsx("input",{type:"text",className:"w-full border rounded p-2",value:u.address||"",onChange:M=>h({...u,address:M.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:" "}),f.jsx("input",{type:"text",className:"w-full border rounded p-2",value:u.insurance_number||"",onChange:M=>h({...u,insurance_number:M.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"  "}),f.jsx("input",{type:"date",className:"w-full border rounded p-2",value:u.insurance_date||"",onChange:M=>h({...u,insurance_date:M.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:" "}),f.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded p-2",value:u.insurance_salary||"",onChange:M=>h({...u,insurance_salary:parseFloat(M.target.value)})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:" "}),f.jsx("input",{type:"date",className:"w-full border rounded p-2",value:u.date_of_birth||"",onChange:M=>h({...u,date_of_birth:M.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:""}),f.jsxs("select",{className:"w-full border rounded p-2",value:u.gender||"",onChange:M=>h({...u,gender:M.target.value}),children:[f.jsx("option",{value:"",children:"..."}),f.jsx("option",{value:"male",children:""}),f.jsx("option",{value:"female",children:""})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:" "}),f.jsx("input",{type:"text",className:"w-full border rounded p-2",value:u.education||"",onChange:M=>h({...u,education:M.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"  *"}),f.jsx("input",{required:!0,type:"date",className:"w-full border rounded p-2",value:u.hire_date||"",onChange:M=>h({...u,hire_date:M.target.value})})]}),f.jsx("div",{className:"col-span-2 border-t pt-4 mt-2",children:f.jsx("h4",{className:"font-bold text-primary mb-3",children:" "})}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:" "}),f.jsx("input",{type:"text",className:"w-full border rounded p-2",value:u.job_title||"",onChange:M=>h({...u,job_title:M.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:" / "}),f.jsx("input",{type:"text",className:"w-full border rounded p-2",value:u.department||"",onChange:M=>h({...u,department:M.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:""}),f.jsxs("select",{className:"w-full border rounded p-2",value:u.project||"",onChange:M=>h({...u,project:M.target.value}),children:[f.jsx("option",{value:"",children:"( )"}),g.map(M=>f.jsx("option",{value:M.name,children:M.name},M.id))]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:""}),f.jsxs("select",{className:"w-full border rounded p-2",value:u.status||"active",onChange:M=>h({...u,status:M.target.value}),children:[f.jsx("option",{value:"active",children:""}),f.jsx("option",{value:"inactive",children:" "})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"  *"}),f.jsx("input",{required:!0,min:"1",type:"number",step:"0.01",className:"w-full border rounded p-2",value:u.basic_salary||"",onChange:M=>h({...u,basic_salary:parseFloat(M.target.value)})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:" ()"}),f.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded p-2",value:u.variable_salary||"",onChange:M=>h({...u,variable_salary:parseFloat(M.target.value)})})]})]}),f.jsxs("div",{className:"mt-6 flex justify-end gap-3 border-t pt-4 sticky bottom-0 bg-white",children:[f.jsx("button",{type:"button",onClick:()=>o(!1),className:"px-4 py-2 border rounded font-bold text-gray-600 hover:bg-gray-50",children:""}),f.jsx("button",{type:"submit",className:"px-6 py-2 bg-primary text-white rounded font-bold hover:bg-blue-700",children:" "})]})]})]})})]})},VM=({user:e})=>{const[t,r]=ne.useState([]),[a,s]=ne.useState([]),[l,o]=ne.useState(!0),[u,h]=ne.useState(new Date().toISOString().split("T")[0]),[d,x]=ne.useState(!1),[g,p]=ne.useState(!1);ne.useEffect(()=>{y()},[u]);const y=async()=>{o(!0);try{let E=Te.from("hr_employees").select("id, full_name, employee_code, email").eq("status","active");if(e.role==="project_manager"&&e.projectId){const{data:M}=await Te.from("projects").select("name").eq("id",e.projectId).single();M?E=E.or(`project.eq.${M.name},project.eq.${e.projectId}`):E=E.eq("project",e.projectId)}const{data:D}=await E;D&&s(D);let G=Te.from("hr_attendance").select("*").eq("date",u);if(e.role==="project_manager"&&e.projectId){const M=(D==null?void 0:D.map(C=>C.id))||[];G=G.in("employee_id",M)}const{data:V}=await G,A=(D||[]).map(M=>{const C=V==null?void 0:V.find(U=>U.employee_id===M.id);return{id:(C==null?void 0:C.id)||`new-${M.id}`,employee_id:M.id,employee_name:M.full_name,date:u,check_in:(C==null?void 0:C.check_in)||null,check_out:(C==null?void 0:C.check_out)||null,late_minutes:(C==null?void 0:C.late_minutes)||0,overtime_minutes:(C==null?void 0:C.overtime_minutes)||0}});r(A)}catch(E){console.error("Error fetching attendance:",E)}finally{o(!1)}},w=async E=>{var G;const D=(G=E.target.files)==null?void 0:G[0];if(D){p(!0);try{const V=await D.arrayBuffer(),A=Lf(V),M=A.Sheets[A.SheetNames[0]],C=ai.sheet_to_json(M),{data:U}=await Te.from("hr_employees").select("id, employee_code, email");if(!U)throw new Error("Could not fetch employees for mapping");const Z=new Map;U.forEach(ge=>{ge.employee_code&&Z.set(String(ge.employee_code).trim(),ge.id),ge.email&&Z.set(ge.email.toLowerCase().trim(),ge.id)});let q=0;const le=[];for(const ge of C){const Se=String(ge.employee_code||ge.email||"").trim().toLowerCase(),te=Z.get(Se)||Z.get(String(ge.employee_code).trim());let ae=ge.date;if(!ae){q++;continue}if(typeof ae=="number")ae=new Date((ae-25569)*86400*1e3).toISOString().split("T")[0];else try{ae=new Date(ae).toISOString().split("T")[0]}catch{q++;continue}te&&ae?le.push({employee_id:te,date:ae,check_in:ge.check_in||null,check_out:ge.check_out||null,late_minutes:parseInt(ge.late_minutes)||0,overtime_minutes:parseInt(ge.overtime_minutes)||0}):q++}if(le.length>0){const{error:ge}=await Te.from("hr_attendance").upsert(le,{onConflict:"employee_id,date"});ge?alert("   : "+ge.message):(alert(`  :   (${le.length})   (${q})`),y())}else alert("      .        .")}catch(V){alert("    : "+V.message)}finally{p(!1),E.target&&(E.target.value="")}}},_=()=>{const E=["employee_code","date","check_in","check_out","late_minutes","overtime_minutes"],D=[["EMP001","2024-03-20","08:30","16:30","0","60"],["EMP002","2024-03-20","09:15","17:00","45","0"]],G=ai.aoa_to_sheet([E,...D]),V=ai.book_new();ai.book_append_sheet(V,G,"Attendance"),Q2(V,"Attendance_Template.xlsx")},S=(E,D,G)=>{r(V=>V.map(A=>A.employee_id===E?{...A,[D]:G||null}:A))},T=(E,D,G)=>{const V=parseInt(G)||0;r(A=>A.map(M=>M.employee_id===E?{...M,[D]:V}:M))},N=async()=>{x(!0);try{const E=t.filter(A=>!A.id.startsWith("new-")).map(A=>Te.from("hr_attendance").update({check_in:A.check_in,check_out:A.check_out,late_minutes:A.late_minutes,overtime_minutes:A.overtime_minutes}).eq("id",A.id)),D=t.filter(A=>A.id.startsWith("new-")&&(A.check_in||A.check_out||A.late_minutes>0||A.overtime_minutes>0)).map(A=>Te.from("hr_attendance").insert({employee_id:A.employee_id,date:A.date,check_in:A.check_in,check_out:A.check_out,late_minutes:A.late_minutes,overtime_minutes:A.overtime_minutes})),V=(await Promise.all([...E,...D])).filter(A=>A.error).map(A=>{var M;return(M=A.error)==null?void 0:M.message});V.length>0?alert("     : "+V[0]):alert("    "),y()}catch(E){alert("   : "+E.message)}finally{x(!1)}};return f.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[f.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center bg-white p-4 rounded-xl shadow-sm border border-gray-100 gap-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"p-2 bg-blue-50 text-blue-600 rounded-lg",children:f.jsx("span",{className:"material-icons",children:"how_to_reg"})}),f.jsxs("div",{children:[f.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"   "}),f.jsx("p",{className:"text-xs text-gray-500",children:"      "})]})]}),f.jsxs("div",{className:"flex items-center gap-2 flex-wrap w-full md:w-auto",children:[f.jsx("input",{type:"date",value:u,onChange:E=>h(E.target.value),className:"border border-gray-200 rounded-lg px-4 py-2 font-bold text-gray-700 focus:ring-2 focus:ring-primary outline-none"}),f.jsxs("button",{onClick:_,className:"bg-white border text-gray-600 px-4 py-2 rounded-lg font-bold flex items-center gap-2 hover:bg-gray-50 transition shadow-sm",title:"  ",children:[f.jsx("span",{className:"material-icons",children:"download"}),"Template"]}),f.jsxs("label",{className:`bg-white border-2 border-primary text-primary px-4 py-2 rounded-lg font-bold flex items-center gap-2 ${g?"opacity-50 cursor-not-allowed":"hover:bg-blue-50 cursor-pointer"} transition`,children:[f.jsx("span",{className:"material-icons",children:g?"hourglass_empty":"upload_file"}),g?" ...":"  ",f.jsx("input",{type:"file",hidden:!0,accept:".xlsx, .xls, .csv",onChange:w,disabled:g})]}),f.jsxs("button",{onClick:N,disabled:d,className:"bg-primary text-white px-6 py-2 rounded-lg font-bold flex items-center gap-2 hover:bg-blue-700 transition shadow-sm disabled:opacity-50",children:[f.jsx("span",{className:"material-icons",children:d?"hourglass_top":"save"}),d?" ...":" "]})]})]}),f.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:l?f.jsxs("div",{className:"p-20 text-center",children:[f.jsx("div",{className:"animate-spin h-10 w-10 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),f.jsx("p",{className:"text-gray-500",children:"   ..."})]}):f.jsxs("table",{className:"w-full text-right border-collapse",children:[f.jsx("thead",{className:"bg-gray-50 text-gray-600 border-b",children:f.jsxs("tr",{children:[f.jsx("th",{className:"p-4 font-bold",children:" "}),f.jsx("th",{className:"p-4 font-bold text-center",children:""}),f.jsx("th",{className:"p-4 font-bold text-center",children:""}),f.jsx("th",{className:"p-4 font-bold text-center",children:" "}),f.jsx("th",{className:"p-4 font-bold text-center",children:" "}),f.jsx("th",{className:"p-4 font-bold text-center",children:""})]})}),f.jsx("tbody",{className:"divide-y divide-gray-100",children:t.map(E=>f.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[f.jsx("td",{className:"p-4 font-bold text-gray-800",children:E.employee_name}),f.jsx("td",{className:"p-4",children:f.jsx("input",{type:"time",value:E.check_in||"",onChange:D=>S(E.employee_id,"check_in",D.target.value),className:"w-full p-2 border border-gray-200 rounded text-center focus:ring-1 focus:ring-primary outline-none"})}),f.jsx("td",{className:"p-4",children:f.jsx("input",{type:"time",value:E.check_out||"",onChange:D=>S(E.employee_id,"check_out",D.target.value),className:"w-full p-2 border border-gray-200 rounded text-center focus:ring-1 focus:ring-primary outline-none"})}),f.jsx("td",{className:"p-4",children:f.jsx("input",{type:"number",value:E.late_minutes,onChange:D=>T(E.employee_id,"late_minutes",D.target.value),className:`w-24 p-2 border rounded text-center focus:ring-1 focus:ring-primary outline-none mx-auto block ${E.late_minutes>0?"bg-red-50 text-red-600 border-red-200 font-bold":"border-gray-200"}`})}),f.jsx("td",{className:"p-4",children:f.jsx("input",{type:"number",value:E.overtime_minutes,onChange:D=>T(E.employee_id,"overtime_minutes",D.target.value),className:`w-24 p-2 border rounded text-center focus:ring-1 focus:ring-primary outline-none mx-auto block ${E.overtime_minutes>0?"bg-green-50 text-green-600 border-green-200 font-bold":"border-gray-200"}`})}),f.jsx("td",{className:"p-4 text-center",children:!E.check_in&&!E.check_out?f.jsx("span",{className:"bg-orange-100 text-orange-600 px-3 py-1 rounded-full text-[10px] font-bold",children:" "}):f.jsx("span",{className:"bg-green-100 text-green-600 px-3 py-1 rounded-full text-[10px] font-bold",children:""})})]},E.id))})]})}),f.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl border border-gray-200 text-xs text-gray-500 flex items-center gap-2",children:[f.jsx("span",{className:"material-icons text-sm",children:"lightbulb"}),f.jsx("span",{children:":             ."})]})]})},XM=({user:e})=>{const[t,r]=ne.useState([]),[a,s]=ne.useState([]),[l,o]=ne.useState(!0),[u,h]=ne.useState(new Date().toISOString().slice(0,7)),[d,x]=ne.useState(!1);ne.useEffect(()=>{g()},[u]);const g=async()=>{o(!0);try{let _=Te.from("hr_employees").select("id, full_name, department, employee_code").eq("status","active");if(e.role==="project_manager"&&e.projectId){const{data:D}=await Te.from("projects").select("name").eq("id",e.projectId).single();D?_=_.or(`project.eq.${D.name},project.eq.${e.projectId}`):_=_.eq("project",e.projectId)}const{data:S}=await _;S&&r(S);let T=Te.from("hr_kpis").select("*").eq("month",u);if(e.role==="project_manager"&&e.projectId){const D=(S==null?void 0:S.map(G=>G.id))||[];T=T.in("employee_id",D)}const{data:N}=await T,E=(S||[]).map(D=>{const G=N==null?void 0:N.find(V=>V.employee_id===D.id);return{employee_id:D.id,employee_name:D.full_name,month:u,productivity_score:(G==null?void 0:G.productivity_score)||0,quality_score:(G==null?void 0:G.quality_score)||0,attendance_score:(G==null?void 0:G.attendance_score)||0,commitment_score:(G==null?void 0:G.commitment_score)||0,notes:(G==null?void 0:G.notes)||""}});s(E)}catch(_){console.error("Error fetching KPIs:",_)}finally{o(!1)}},p=(_,S,T)=>{s(N=>N.map(E=>E.employee_id===_?{...E,[S]:T}:E))},y=async()=>{x(!0);try{const _=a.map(T=>({employee_id:T.employee_id,month:T.month,productivity_score:T.productivity_score,quality_score:T.quality_score,attendance_score:T.attendance_score,commitment_score:T.commitment_score,notes:T.notes})),{error:S}=await Te.from("hr_kpis").upsert(_,{onConflict:"employee_id,month"});if(S)throw S;alert("    "),g()}catch(_){alert("   : "+_.message)}finally{x(!1)}},w=_=>((_.productivity_score+_.quality_score+_.attendance_score+_.commitment_score)/4).toFixed(1);return f.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[f.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center bg-white p-4 rounded-xl shadow-sm border border-gray-100 gap-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"p-2 bg-purple-50 text-purple-600 rounded-lg",children:f.jsx("span",{className:"material-icons",children:"analytics"})}),f.jsxs("div",{children:[f.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"   (KPIs)"}),f.jsx("p",{className:"text-xs text-gray-500",children:"    "})]})]}),f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("input",{type:"month",value:u,onChange:_=>h(_.target.value),className:"border border-gray-200 rounded-lg px-4 py-2 font-bold text-gray-700 focus:ring-2 focus:ring-primary outline-none"}),f.jsxs("button",{onClick:y,disabled:d,className:"bg-primary text-white px-6 py-2 rounded-lg font-bold flex items-center gap-2 hover:bg-blue-700 transition shadow-sm disabled:opacity-50",children:[f.jsx("span",{className:"material-icons",children:d?"hourglass_top":"save"})," "]})]})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[f.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[f.jsxs("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 p-6 rounded-2xl text-white shadow-lg",children:[f.jsx("h4",{className:"text-indigo-100 text-sm mb-1",children:"  "}),f.jsxs("div",{className:"text-4xl font-black mb-4",children:[(a.reduce((_,S)=>_+parseFloat(w(S)),0)/(a.length||1)).toFixed(1),"%"]}),f.jsx("div",{className:"w-full bg-white/20 rounded-full h-2 overflow-hidden",children:f.jsx("div",{className:"bg-white h-full transition-all duration-1000",style:{width:`${a.reduce((_,S)=>_+parseFloat(w(S)),0)/(a.length||1)}%`}})})]}),f.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[f.jsxs("h4",{className:"font-bold text-gray-700 mb-4 flex items-center gap-2 text-sm",children:[f.jsx("span",{className:"material-icons text-orange-400",children:"workspace_premium"}),"  "]}),f.jsx("div",{className:"space-y-4",children:[...a].sort((_,S)=>parseFloat(w(S))-parseFloat(w(_))).slice(0,3).map((_,S)=>f.jsxs("div",{className:"flex items-center justify-between group",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsxs("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold ${S===0?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-400"}`,children:["#",S+1]}),f.jsx("span",{className:"text-sm font-medium text-gray-600 group-hover:text-primary transition",children:_.employee_name})]}),f.jsxs("span",{className:"text-xs font-black text-gray-400",children:[w(_),"%"]})]},_.employee_id))})]})]}),f.jsx("div",{className:"lg:col-span-2 bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:l?f.jsx("div",{className:"p-20 text-center text-gray-400",children:"  ..."}):f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full text-right",children:[f.jsx("thead",{className:"bg-gray-50 text-gray-500 text-xs border-b",children:f.jsxs("tr",{children:[f.jsx("th",{className:"p-4 font-bold",children:""}),f.jsx("th",{className:"p-4 font-bold text-center",children:""}),f.jsx("th",{className:"p-4 font-bold text-center",children:""}),f.jsx("th",{className:"p-4 font-bold text-center",children:""}),f.jsx("th",{className:"p-4 font-bold text-center",children:""}),f.jsx("th",{className:"p-4 font-bold text-center",children:""})]})}),f.jsx("tbody",{className:"divide-y divide-gray-50",children:a.map(_=>{var S;return f.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[f.jsxs("td",{className:"p-4",children:[f.jsx("div",{className:"font-bold text-gray-800 text-sm",children:_.employee_name}),f.jsx("div",{className:"text-[10px] text-gray-400",children:((S=t.find(T=>T.id===_.employee_id))==null?void 0:S.department)||"HR"})]}),f.jsx("td",{className:"p-4",children:f.jsx("input",{type:"number",min:"0",max:"100",value:_.productivity_score,onChange:T=>p(_.employee_id,"productivity_score",parseInt(T.target.value)||0),className:"w-16 p-1 border rounded text-center text-xs focus:ring-1 focus:ring-primary"})}),f.jsx("td",{className:"p-4",children:f.jsx("input",{type:"number",min:"0",max:"100",value:_.quality_score,onChange:T=>p(_.employee_id,"quality_score",parseInt(T.target.value)||0),className:"w-16 p-1 border rounded text-center text-xs focus:ring-1 focus:ring-primary"})}),f.jsx("td",{className:"p-4",children:f.jsx("input",{type:"number",min:"0",max:"100",value:_.attendance_score,onChange:T=>p(_.employee_id,"attendance_score",parseInt(T.target.value)||0),className:"w-16 p-1 border rounded text-center text-xs focus:ring-1 focus:ring-primary"})}),f.jsx("td",{className:"p-4",children:f.jsx("input",{type:"number",min:"0",max:"100",value:_.commitment_score,onChange:T=>p(_.employee_id,"commitment_score",parseInt(T.target.value)||0),className:"w-16 p-1 border rounded text-center text-xs focus:ring-1 focus:ring-primary"})}),f.jsx("td",{className:"p-4 text-center",children:f.jsxs("span",{className:`px-2 py-1 rounded-full text-[10px] font-black ${parseFloat(w(_))>75?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:[w(_),"%"]})})]},_.employee_id)})})]})})})]})]})},WM=({user:e})=>{const[t,r]=ne.useState([]),[a,s]=ne.useState(!0),[l,o]=ne.useState(!1),[u,h]=ne.useState(null),[d,x]=ne.useState(null),[g,p]=ne.useState(null),y=e.role==="super_admin"||e.role==="power_admin"||e.role==="it_specialist"||e.role==="hr_admin";ne.useEffect(()=>{w()},[]);const w=async()=>{s(!0);const{data:N,error:E}=await Te.from("hr_holidays").select("*").order("start_date",{ascending:!0});E?x({message:"   ",type:"error"}):r(N||[]),s(!1)},_=async N=>{if(N.preventDefault(),!(u!=null&&u.name)||!(u!=null&&u.start_date)||!(u!=null&&u.end_date)){x({message:"    ",type:"error"});return}const E={name:u.name,start_date:u.start_date,end_date:u.end_date,type:u.type||"public",description:u.description||""};let D;if(u.id){const{error:G}=await Te.from("hr_holidays").update(E).eq("id",u.id);D=G}else{const{error:G}=await Te.from("hr_holidays").insert(E);D=G}D?x({message:"   ",type:"error"}):(x({message:"   ",type:"success"}),o(!1),w())},S=async N=>{const{error:E}=await Te.from("hr_holidays").delete().eq("id",N);E?x({message:"   ",type:"error"}):(x({message:"   ",type:"success"}),p(null),w())},T=(N=null)=>{h(N||{type:"public",start_date:new Date().toISOString().split("T")[0],end_date:new Date().toISOString().split("T")[0]}),o(!0)};return f.jsxs("div",{className:"space-y-6 animate-fade-in",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"  "}),f.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"     "})]}),y&&f.jsxs("button",{onClick:()=>T(),className:"bg-primary hover:bg-primary-dark text-white px-4 py-2 rounded-xl font-bold flex items-center gap-2 shadow-sm transition-all active:scale-95",children:[f.jsx("span",{className:"material-icons text-sm",children:"add"})," "]})]}),a?f.jsxs("div",{className:"bg-white rounded-2xl p-12 text-center shadow-sm border border-gray-100",children:[f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),f.jsx("p",{className:"text-gray-500",children:"  ..."})]}):t.length===0?f.jsxs("div",{className:"bg-white rounded-2xl p-16 text-center shadow-sm border border-gray-100",children:[f.jsx("span",{className:"material-icons text-6xl text-gray-200 mb-4",children:"event_busy"}),f.jsx("h3",{className:"text-xl font-bold text-gray-400",children:"   "}),f.jsx("p",{className:"text-gray-400 mt-2",children:"    "})]}):f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(N=>f.jsxs("div",{className:"bg-white rounded-2xl overflow-hidden shadow-sm border border-gray-100 hover:shadow-md transition-shadow group relative",children:[f.jsx("div",{className:`h-2 ${N.type==="public"?"bg-indigo-500":"bg-orange-500"}`}),f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex justify-between items-start mb-4",children:[f.jsxs("div",{children:[f.jsx("span",{className:`inline-block px-2 py-1 rounded text-[10px] font-bold uppercase tracking-wider mb-2 ${N.type==="public"?"bg-indigo-50 text-indigo-600":"bg-orange-50 text-orange-600"}`,children:N.type==="public"?" ":" "}),f.jsx("h3",{className:"text-lg font-bold text-gray-800",children:N.name})]}),f.jsxs("div",{className:"bg-gray-50 p-2 rounded-xl text-center min-w-[60px]",children:[f.jsx("p",{className:"text-[10px] text-gray-400 font-bold uppercase",children:""}),f.jsx("p",{className:"text-lg font-black text-primary",children:Math.ceil((new Date(N.end_date).getTime()-new Date(N.start_date).getTime())/(1e3*60*60*24))+1})]})]}),f.jsxs("div",{className:"space-y-3 mb-6",children:[f.jsxs("div",{className:"flex items-center gap-3 text-gray-500 text-sm",children:[f.jsx("span",{className:"material-icons text-sm text-gray-300",children:"calendar_today"}),f.jsxs("span",{children:[": ",new Date(N.start_date).toLocaleDateString("ar-EG",{day:"numeric",month:"long",year:"numeric"})]})]}),f.jsxs("div",{className:"flex items-center gap-3 text-gray-500 text-sm",children:[f.jsx("span",{className:"material-icons text-sm text-gray-300",children:"event"}),f.jsxs("span",{children:[": ",new Date(N.end_date).toLocaleDateString("ar-EG",{day:"numeric",month:"long",year:"numeric"})]})]}),N.description&&f.jsxs("p",{className:"text-gray-400 text-xs mt-4 line-clamp-2 italic",children:['"',N.description,'"']})]}),y&&f.jsxs("div",{className:"flex gap-2 pt-4 border-t border-gray-50",children:[f.jsxs("button",{onClick:()=>T(N),className:"flex-1 bg-gray-50 hover:bg-blue-50 hover:text-blue-600 text-gray-600 p-2 rounded-xl transition-colors flex items-center justify-center gap-2 text-sm font-bold",children:[f.jsx("span",{className:"material-icons text-sm",children:"edit"}),""]}),f.jsxs("button",{onClick:()=>p({isOpen:!0,id:N.id}),className:"flex-1 bg-gray-50 hover:bg-red-50 hover:text-red-600 text-gray-600 p-2 rounded-xl transition-colors flex items-center justify-center gap-2 text-sm font-bold",children:[f.jsx("span",{className:"material-icons text-sm",children:"delete"}),""]})]})]})]},N.id))}),l&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-fade-in",children:f.jsxs("div",{className:"bg-white rounded-3xl w-full max-w-md overflow-hidden shadow-2xl animate-scale-in",children:[f.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center",children:[f.jsx("h3",{className:"text-xl font-bold text-gray-800",children:u!=null&&u.id?" ":"  "}),f.jsx("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-gray-600",children:f.jsx("span",{className:"material-icons",children:"close"})})]}),f.jsxs("form",{onSubmit:_,className:"p-8 space-y-6",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:" "}),f.jsx("input",{type:"text",required:!0,className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all",placeholder:":  ",value:(u==null?void 0:u.name)||"",onChange:N=>h({...u,name:N.target.value})})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:" "}),f.jsx("input",{type:"date",required:!0,className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all",value:(u==null?void 0:u.start_date)||"",onChange:N=>h({...u,start_date:N.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:" "}),f.jsx("input",{type:"date",required:!0,className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all",value:(u==null?void 0:u.end_date)||"",onChange:N=>h({...u,end_date:N.target.value})})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:""}),f.jsxs("select",{className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all appearance-none bg-white",value:(u==null?void 0:u.type)||"public",onChange:N=>h({...u,type:N.target.value}),children:[f.jsx("option",{value:"public",children:"  ()"}),f.jsx("option",{value:"company",children:"  "})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:" ()"}),f.jsx("textarea",{rows:3,className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all resize-none",placeholder:" ...",value:(u==null?void 0:u.description)||"",onChange:N=>h({...u,description:N.target.value})})]})]}),f.jsxs("div",{className:"flex gap-3 pt-4",children:[f.jsx("button",{type:"submit",className:"flex-1 bg-primary hover:bg-primary-dark text-white py-4 rounded-2xl font-black text-lg shadow-lg shadow-primary/20 transition-all active:scale-95",children:" "}),f.jsx("button",{type:"button",onClick:()=>o(!1),className:"flex-1 bg-gray-50 hover:bg-gray-100 text-gray-500 py-4 rounded-2xl font-bold transition-all",children:""})]})]})]})}),d&&f.jsx(lo,{message:d.message,type:d.type,onClose:()=>x(null)}),g&&f.jsx($f,{isOpen:g.isOpen,title:" ",message:"            .",onConfirm:()=>S(g.id),onCancel:()=>p(null),isDangerous:!0})]})},KM=({user:e})=>{var G,V,A,M,C;const[t,r]=ne.useState([]),[a,s]=ne.useState([]),[l,o]=ne.useState(!0),[u,h]=ne.useState(!1),[d,x]=ne.useState({employee_id:"",start_date:new Date().toISOString().split("T")[0],end_date:new Date().toISOString().split("T")[0],leave_type:"annual"}),[g,p]=ne.useState(null),[y,w]=ne.useState(!1),_=e.role==="super_admin"||e.role==="power_admin"||e.role==="it_specialist"||e.role==="hr_admin";ne.useEffect(()=>{S()},[]);const S=async()=>{o(!0);try{const{data:U}=await Te.from("hr_employees").select("id, full_name, annual_leave_balance, status").eq("status","active").order("full_name");U&&r(U);const{data:Z}=await Te.from("hr_leave_requests").select(`
                    *,
                    hr_employees (
                        full_name,
                        annual_leave_balance
                    )
                `).order("created_at",{ascending:!1});Z&&s(Z)}catch(U){console.error("Error fetching data:",U)}o(!1)},T=(U,Z)=>{const q=new Date(U),le=new Date(Z),ge=Math.abs(le.getTime()-q.getTime());return Math.ceil(ge/(1e3*60*60*24))+1},N=async U=>{if(U.preventDefault(),!d.employee_id)return;const Z=T(d.start_date,d.end_date);if(Z<=0){p({message:"       ",type:"error"});return}const q=t.find(ge=>ge.id===d.employee_id);if(q&&q.annual_leave_balance<Z&&d.leave_type==="annual"){p({message:"   ",type:"error"});return}w(!0);const{error:le}=await Te.from("hr_leave_requests").insert({employee_id:d.employee_id,leave_type:d.leave_type,start_date:d.start_date,end_date:d.end_date,total_days:Z,status:"pending"});le?p({message:"   ",type:"error"}):(p({message:"    ",type:"success"}),h(!1),S()),w(!1)},E=async U=>{const{error:Z}=await Te.rpc("hr_approve_leave",{p_leave_id:U});Z?p({message:"     ",type:"error"}):(p({message:"     ",type:"success"}),S())},D=async U=>{const{error:Z}=await Te.rpc("hr_reject_leave",{p_leave_id:U});Z?p({message:"   ",type:"error"}):(p({message:"   ",type:"success"}),S())};return f.jsxs("div",{className:"space-y-6 animate-fade-in",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h2",{className:"text-xl font-bold text-gray-800",children:" "}),f.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"      "})]}),f.jsxs("button",{onClick:()=>h(!0),className:"bg-primary hover:bg-primary-dark text-white px-4 py-2 rounded-xl font-bold flex items-center gap-2 shadow-sm transition-all active:scale-95",children:[f.jsx("span",{className:"material-icons text-sm",children:"add"}),"  "]})]}),f.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full text-right border-collapse",children:[f.jsx("thead",{children:f.jsxs("tr",{className:"bg-gray-50 text-gray-400 text-xs uppercase font-bold border-b border-gray-100",children:[f.jsx("th",{className:"px-6 py-4",children:""}),f.jsx("th",{className:"px-4 py-4 text-center",children:""}),f.jsx("th",{className:"px-4 py-4 text-center",children:""}),f.jsx("th",{className:"px-4 py-4 text-center",children:""}),f.jsx("th",{className:"px-4 py-4 text-center",children:""}),f.jsx("th",{className:"px-4 py-4 text-center",children:" "}),f.jsx("th",{className:"px-4 py-4 text-center",children:""}),f.jsx("th",{className:"px-6 py-4 text-left",children:""})]})}),f.jsx("tbody",{className:"divide-y divide-gray-50 text-sm",children:l?f.jsx("tr",{children:f.jsxs("td",{colSpan:8,className:"px-6 py-12 text-center text-gray-400",children:[f.jsx("div",{className:"animate-spin h-6 w-6 border-2 border-primary border-t-transparent rounded-full mx-auto mb-2"})," ..."]})}):a.length===0?f.jsx("tr",{children:f.jsx("td",{colSpan:8,className:"px-6 py-12 text-center text-gray-400",children:"    "})}):a.map(U=>{var Z,q;return f.jsxs("tr",{className:"hover:bg-gray-50 transition-colors group",children:[f.jsx("td",{className:"px-6 py-4 font-bold text-gray-800",children:(Z=U.hr_employees)==null?void 0:Z.full_name}),f.jsx("td",{className:"px-4 py-4 text-center",children:f.jsx("span",{className:`px-2 py-1 rounded-lg text-[10px] font-bold ${U.leave_type==="annual"?"bg-blue-50 text-blue-600":U.leave_type==="sick"?"bg-orange-50 text-orange-600":"bg-gray-100 text-gray-500"}`,children:U.leave_type==="annual"?"":U.leave_type==="sick"?"":" "})}),f.jsx("td",{className:"px-4 py-4 text-center text-gray-500",children:U.start_date}),f.jsx("td",{className:"px-4 py-4 text-center text-gray-500",children:U.end_date}),f.jsx("td",{className:"px-4 py-4 text-center font-bold",children:U.total_days}),f.jsxs("td",{className:"px-4 py-4 text-center text-gray-400",children:[(q=U.hr_employees)==null?void 0:q.annual_leave_balance," "]}),f.jsx("td",{className:"px-4 py-4 text-center",children:f.jsx("span",{className:`px-2 py-1 rounded-lg text-[10px] font-bold ${U.status==="approved"?"bg-green-100 text-green-700":U.status==="rejected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:U.status==="approved"?"":U.status==="rejected"?"":" "})}),f.jsx("td",{className:"px-6 py-4",children:_&&U.status==="pending"&&f.jsxs("div",{className:"flex gap-2 justify-end opacity-0 group-hover:opacity-100 transition-opacity",children:[f.jsx("button",{onClick:()=>E(U.id),className:"bg-green-500 hover:bg-green-600 text-white p-2 rounded-lg shadow-sm",title:"",children:f.jsx("span",{className:"material-icons text-sm",children:"check"})}),f.jsx("button",{onClick:()=>D(U.id),className:"bg-red-500 hover:bg-red-600 text-white p-2 rounded-lg shadow-sm",title:"",children:f.jsx("span",{className:"material-icons text-sm",children:"close"})})]})})]},U.id)})})]})})}),u&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-fade-in",children:f.jsxs("div",{className:"bg-white rounded-3xl w-full max-w-md overflow-hidden shadow-2xl animate-scale-in",children:[f.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center",children:[f.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"  "}),f.jsx("button",{onClick:()=>h(!1),className:"text-gray-400 hover:text-gray-600 outline-none",children:f.jsx("span",{className:"material-icons",children:"close"})})]}),f.jsxs("form",{onSubmit:N,className:"p-8 space-y-6",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:""}),f.jsxs("select",{required:!0,className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all bg-white",value:d.employee_id,onChange:U=>x({...d,employee_id:U.target.value}),children:[f.jsx("option",{value:"",children:" ..."}),t.map(U=>f.jsxs("option",{value:U.id,children:[U.full_name," (: ",U.annual_leave_balance,")"]},U.id))]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:" "}),f.jsxs("select",{className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all bg-white",value:d.leave_type,onChange:U=>x({...d,leave_type:U.target.value}),children:[f.jsx("option",{value:"annual",children:""}),f.jsx("option",{value:"sick",children:""}),f.jsx("option",{value:"unpaid",children:" "})]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:" "}),f.jsx("input",{type:"date",required:!0,className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all",value:d.start_date,onChange:U=>x({...d,start_date:U.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:" "}),f.jsx("input",{type:"date",required:!0,className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all",value:d.end_date,onChange:U=>x({...d,end_date:U.target.value})})]})]}),f.jsxs("div",{className:`p-4 rounded-xl flex items-center justify-between ${d.employee_id&&T(d.start_date,d.end_date)>(((G=t.find(U=>U.id===d.employee_id))==null?void 0:G.annual_leave_balance)||0)&&d.leave_type==="annual"?"bg-red-50 text-red-700":"bg-blue-50 text-blue-700"}`,children:[f.jsxs("div",{className:"flex flex-col",children:[f.jsx("span",{className:"text-xs font-bold opacity-70",children:"  :"}),f.jsxs("span",{className:"text-xl font-black",children:[T(d.start_date,d.end_date)," "]})]}),d.employee_id&&f.jsxs("div",{className:"text-left",children:[f.jsx("span",{className:"text-xs font-bold opacity-70 block text-right",children:" :"}),f.jsxs("span",{className:"text-lg font-bold",children:[(V=t.find(U=>U.id===d.employee_id))==null?void 0:V.annual_leave_balance," "]})]})]}),d.employee_id&&d.leave_type==="annual"&&T(d.start_date,d.end_date)>(((A=t.find(U=>U.id===d.employee_id))==null?void 0:A.annual_leave_balance)||0)&&f.jsxs("div",{className:"flex items-center gap-2 text-red-600 bg-red-50 p-3 rounded-xl border border-red-100 animate-pulse",children:[f.jsx("span",{className:"material-icons text-sm",children:"warning"}),f.jsx("span",{className:"text-xs font-bold",children:"      "})]})]}),f.jsxs("button",{type:"submit",disabled:y||d.employee_id&&d.leave_type==="annual"&&T(d.start_date,d.end_date)>(((M=t.find(U=>U.id===d.employee_id))==null?void 0:M.annual_leave_balance)||0),className:`w-full py-4 rounded-2xl font-black text-lg shadow-lg transition-all active:scale-95 flex items-center justify-center gap-2 ${y||d.employee_id&&d.leave_type==="annual"&&T(d.start_date,d.end_date)>(((C=t.find(U=>U.id===d.employee_id))==null?void 0:C.annual_leave_balance)||0)?"bg-gray-300 text-gray-500 cursor-not-allowed shadow-none":"bg-primary hover:bg-primary-dark text-white shadow-primary/20"}`,children:[y?" ...":" ",!y&&f.jsx("span",{className:"material-icons",children:"send"})]})]})]})}),g&&f.jsx(lo,{message:g.message,type:g.type,onClose:()=>p(null)})]})},YM=({user:e})=>{const[t,r]=ne.useState(null),[a,s]=ne.useState(!0),[l,o]=ne.useState("overview"),[u,h]=ne.useState(""),[d,x]=ne.useState(e.projectId||"all"),[g,p]=ne.useState([]),y=e.role==="super_admin"||e.role==="power_admin"||e.role==="it_specialist"||e.role==="hr_admin";return ne.useEffect(()=>{async function w(){if(y){const{data:_}=await Te.from("projects").select("id, name");_&&p(_)}}w()},[y]),ne.useEffect(()=>{async function w(){try{if(console.log("HRDashboard: Fetching initial data for user",e.id,"Project:",d),s(!0),d!=="all"){const{data:T}=await Te.from("projects").select("name").eq("id",d).single();T&&h(T.name)}else h(" ");console.log("HRDashboard: Fetching metrics for",d);const{data:_,error:S}=await Te.rpc("get_dashboard_metrics",{p_project_id:d==="all"?null:d});S?console.error("HRDashboard: Error calling get_dashboard_metrics:",S):_&&r(_),s(!1)}catch(_){console.error("HRDashboard: Critical error in fetchInitialData:",_),s(!1)}}w()},[e.id,d]),a?f.jsx("div",{className:"p-8 text-center text-gray-500",children:" ..."}):f.jsxs("div",{className:"space-y-6 animate-fade-in",children:[f.jsxs("div",{className:"flex bg-white rounded-xl shadow-sm border border-gray-100 p-2 gap-2 overflow-x-auto",children:[f.jsxs("button",{onClick:()=>o("overview"),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-all text-sm whitespace-nowrap ${l==="overview"?"bg-primary text-white shadow-md":"text-gray-500 hover:bg-gray-50"}`,children:[f.jsx("span",{className:"material-icons text-[18px]",children:"dashboard"})," "]}),f.jsxs("button",{onClick:()=>o("employees"),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-all text-sm whitespace-nowrap ${l==="employees"?"bg-primary text-white shadow-md":"text-gray-500 hover:bg-gray-50"}`,children:[f.jsx("span",{className:"material-icons text-[18px]",children:"badge"})," "]}),f.jsxs("button",{onClick:()=>o("attendance"),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-all text-sm whitespace-nowrap ${l==="attendance"?"bg-primary text-white shadow-md":"text-gray-500 hover:bg-gray-50"}`,children:[f.jsx("span",{className:"material-icons text-[18px]",children:"how_to_reg"})," "]}),f.jsxs("button",{onClick:()=>o("leave"),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-all text-sm whitespace-nowrap ${l==="leave"?"bg-primary text-white shadow-md":"text-gray-500 hover:bg-gray-50"}`,children:[f.jsx("span",{className:"material-icons text-[18px]",children:"flight_takeoff"}),""]}),f.jsxs("button",{onClick:()=>o("payroll"),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-all text-sm whitespace-nowrap ${l==="payroll"?"bg-primary text-white shadow-md":"text-gray-500 hover:bg-gray-50"}`,children:[f.jsx("span",{className:"material-icons text-[18px]",children:"payments"})," "]}),f.jsxs("button",{onClick:()=>o("kpi"),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-all text-sm whitespace-nowrap ${l==="kpi"?"bg-primary text-white shadow-md":"text-gray-500 hover:bg-gray-50"}`,children:[f.jsx("span",{className:"material-icons text-[18px]",children:"analytics"}),"  (KPIs)"]}),f.jsxs("button",{onClick:()=>o("holidays"),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-all text-sm whitespace-nowrap ${l==="holidays"?"bg-primary text-white shadow-md":"text-gray-500 hover:bg-gray-50"}`,children:[f.jsx("span",{className:"material-icons text-[18px]",children:"event"}),""]})]}),l==="overview"&&f.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[f.jsxs("div",{className:"bg-blue-50 border border-blue-200 text-blue-800 px-4 py-3 rounded-lg flex items-start gap-3 shadow-sm",children:[f.jsx("span",{className:"material-icons mt-0.5 text-blue-500",children:"info"}),f.jsxs("div",{children:[f.jsx("p",{className:"font-bold",children:"     "}),f.jsx("p",{className:"text-sm opacity-90",children:"    "})]})]}),y&&f.jsxs("div",{className:"flex items-center gap-4 bg-white p-4 rounded-xl shadow-sm border border-gray-100",children:[f.jsx("span",{className:"material-icons text-gray-400",children:"filter_list"}),f.jsx("span",{className:"text-sm font-bold text-gray-600",children:" :"}),f.jsx("div",{className:"flex-1 max-w-xs",children:f.jsxs("select",{className:"w-full p-2 bg-gray-50 border rounded-lg text-sm font-bold outline-none focus:ring-2 focus:ring-primary cursor-pointer",value:d,onChange:w=>x(w.target.value),children:[f.jsx("option",{value:"all",children:" "}),g.map(w=>f.jsx("option",{value:w.id,children:w.name},w.id))]})})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[f.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex items-center gap-4 hover:shadow-md transition-shadow",children:[f.jsx("div",{className:"p-3 bg-indigo-50 text-indigo-500 rounded-lg",children:f.jsx("span",{className:"material-icons text-3xl",children:"badge"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-gray-500 text-sm font-medium",children:" "}),f.jsx("p",{className:"text-2xl font-bold mt-1 text-gray-800",children:(t==null?void 0:t.total_employees)||0})]})]}),f.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex items-center gap-4 hover:shadow-md transition-shadow",children:[f.jsx("div",{className:"p-3 bg-green-50 text-green-500 rounded-lg",children:f.jsx("span",{className:"material-icons text-3xl",children:"check_circle"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-gray-500 text-sm font-medium",children:" "}),f.jsx("p",{className:"text-2xl font-bold mt-1 text-gray-800",children:(t==null?void 0:t.active_employees)||0})]})]}),f.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex items-center gap-4 hover:shadow-md transition-shadow",children:[f.jsx("div",{className:"p-3 bg-blue-50 text-blue-500 rounded-lg",children:f.jsx("span",{className:"material-icons text-3xl",children:"how_to_reg"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-gray-500 text-sm font-medium",children:" "}),f.jsx("p",{className:"text-2xl font-bold mt-1 text-gray-800",children:(t==null?void 0:t.attendance_today_count)||0})]})]}),f.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex items-center gap-4 hover:shadow-md transition-shadow",children:[f.jsx("div",{className:"p-3 bg-orange-50 text-orange-500 rounded-lg",children:f.jsx("span",{className:"material-icons text-3xl",children:"flight_takeoff"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-gray-500 text-sm font-medium",children:"  "}),f.jsx("p",{className:"text-2xl font-bold mt-1 text-gray-800",children:(t==null?void 0:t.employees_on_leave_today)||0})]})]})]})]}),l==="employees"&&f.jsx(GM,{user:e}),l==="attendance"&&f.jsx(VM,{user:e}),l==="leave"&&f.jsx(KM,{user:e}),l==="kpi"&&f.jsx(XM,{user:e}),l==="holidays"&&f.jsx(WM,{user:e}),l==="payroll"&&f.jsxs("div",{className:"mt-8 bg-white border border-gray-100 shadow-sm rounded-xl p-8 text-center text-gray-400",children:[f.jsx("span",{className:"material-icons text-6xl opacity-20 mb-4 block",children:"engineering"}),f.jsx("p",{className:"font-bold text-lg mb-2",children:"    ..."}),f.jsx("p",{className:"text-sm",children:"      ."})]})]})},JM=({user:e,activePage:t,onNavigate:r,onLogout:a,isOpen:s,toggleSidebar:l})=>{const o=ne.useMemo(()=>{const h=[{id:"dashboard",label:" ",icon:"dashboard"},{id:"reports",label:"",icon:"analytics"},{id:"hr",label:" ",icon:"badge"}],d=[{id:"structure",label:" ",icon:"account_tree"},{id:"approvals",label:"",icon:"fact_check"},{id:"history",label:" ",icon:"manage_search"},{id:"requests",label:"",icon:"notifications_active"},{id:"teams",label:" ",icon:"groups"},{id:"operators",label:" ",icon:"badge"},{id:"assets",label:"",icon:"precision_manufacturing"},{id:"tickets",label:" ",icon:"confirmation_number"},{id:"upload",label:" ",icon:"upload_file"}];switch(e.role){case"super_admin":case"power_admin":return[...h,{id:"project-management",label:" ",icon:"manage_accounts"},...d,{id:"health-check",label:" ",icon:"monitor_heart"},{id:"debug",label:"DB Debugger",icon:"pest_control"}];case"project_manager":return[{id:"sites",label:"  ",icon:"grid_view"},...h,...d];case"supervisor":return[{id:"dashboard",label:"",icon:"people"},{id:"kpi",label:"",icon:"assignment"},{id:"assets",label:"",icon:"precision_manufacturing"},{id:"tickets",label:" ",icon:"confirmation_number"}];case"it_specialist":return[{id:"assets",label:" ",icon:"inventory"},{id:"tickets",label:" ",icon:"confirmation_number"},{id:"reports",label:"",icon:"analytics"}];case"hr_admin":return[{id:"hr",label:" ",icon:"badge"},{id:"reports",label:"",icon:"analytics"},{id:"teams",label:" ",icon:"groups"},{id:"operators",label:" ",icon:"badge"},{id:"assets",label:" ",icon:"inventory"},{id:"tickets",label:" ",icon:"confirmation_number"},{id:"approvals",label:"",icon:"fact_check"},{id:"history",label:" ",icon:"manage_search"},{id:"upload",label:" ",icon:"upload_file"}];default:return[]}},[e.role]),u={super_admin:"  (Super)",power_admin:"  (Power)",project_manager:" ",supervisor:" ",it_specialist:"  ",hr_admin:"  "}[e.role]||"";return f.jsxs(f.Fragment,{children:[s&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-20 md:hidden",onClick:l}),f.jsxs("aside",{className:`
          fixed top-0 right-0 h-full w-64 bg-[#232b3e] text-gray-300 z-30 transition-transform duration-300 ease-in-out flex flex-col
          ${s?"translate-x-0":"translate-x-full"}
          md:translate-x-0 md:static border-l border-gray-800
        `,children:[f.jsxs("div",{className:"h-20 flex flex-col justify-center px-6 bg-[#1b2130] shadow-sm",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"material-icons text-primary text-2xl",children:"bar_chart"}),f.jsx("h1",{className:"text-xl font-bold text-white tracking-wide",children:"Capture Flow"})]}),f.jsx("div",{className:"text-[10px] text-gray-500 font-medium pr-8 -mt-0.5 tracking-wider",children:"(Powered by Capture Doc)"})]}),f.jsx("div",{className:"px-6 py-6",children:f.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[f.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center text-white font-bold uppercase",children:e.name.charAt(0)}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm font-bold text-white leading-tight",children:e.name}),f.jsx("p",{className:"text-xs text-gray-400",children:u})]})]})}),f.jsx("nav",{className:"flex-1 px-3 space-y-1 overflow-y-auto custom-scrollbar",children:o.map(h=>f.jsxs("button",{onClick:()=>{r(h.id),window.innerWidth<768&&l()},className:`
                w-full flex items-center space-x-reverse space-x-3 px-4 py-3 rounded-md transition-all duration-200
                ${t===h.id?"bg-primary text-white shadow-lg shadow-blue-900/50 font-bold":"hover:bg-[#2d3648] hover:text-white text-gray-400"}
              `,children:[f.jsx("span",{className:`material-icons ${t===h.id?"text-white":"text-gray-500"}`,children:h.icon}),f.jsx("span",{children:h.label})]},h.id))}),f.jsx("div",{className:"p-4 bg-[#1b2130]",children:f.jsxs("button",{onClick:a,className:"w-full flex items-center justify-center space-x-reverse space-x-2 px-4 py-2 text-red-400 hover:bg-red-500/10 rounded-md transition-colors text-sm font-medium",children:[f.jsx("span",{className:"material-icons text-lg",children:"logout"}),f.jsx("span",{children:" "})]})})]})]})},QM=()=>{const[e,t]=ne.useState(null),[r,a]=ne.useState("reports"),[s,l]=ne.useState(!1),[o,u]=ne.useState(new Set);ne.useEffect(()=>{const g=new URLSearchParams(window.location.search);g.get("page")==="health-check"?a("health-check"):g.get("page")==="debug"&&a("debug")},[]),ne.useEffect(()=>{if(e){const g=Te.channel("online-users");return g.on("presence",{event:"sync"},()=>{const p=g.presenceState(),y=new Set;Object.values(p).forEach(w=>{w.forEach(_=>{_.user_id&&y.add(_.user_id)})}),u(y)}).subscribe(async p=>{p==="SUBSCRIBED"&&await g.track({user_id:e.id,role:e.role,online_at:new Date().toISOString()})}),()=>{Te.removeChannel(g)}}},[e]);const h=g=>{console.log("App: handleLogin called with user:",g),t(g);const p=new URLSearchParams(window.location.search);if(p.get("page")==="health-check")a("health-check");else if(p.get("page")==="debug")a("debug");else if(g.role==="it_specialist")a("assets");else if(g.role==="hr_admin")a("hr");else{const y=g.role==="super_admin"||g.role==="power_admin"||g.role==="project_manager";a(y?"reports":"dashboard")}},d=()=>{t(null),a("reports"),u(new Set)};if(!e)return f.jsx(W4,{onLogin:h});const x=e.role==="super_admin"||e.role==="power_admin"||e.role==="project_manager"||e.role==="hr_admin";return f.jsxs("div",{className:"flex h-screen bg-background overflow-hidden",children:[f.jsx(JM,{user:e,activePage:r,onNavigate:a,onLogout:d,isOpen:s,toggleSidebar:()=>l(!s)}),f.jsxs("div",{className:"flex-1 flex flex-col h-full overflow-hidden w-full relative",children:[f.jsxs("header",{className:"bg-white shadow-sm px-4 py-3 flex items-center justify-between md:hidden z-10 sticky top-0",children:[f.jsxs("div",{className:"flex flex-col",children:[f.jsx("h1",{className:"text-xl font-bold text-primary",children:"Capture Flow"}),f.jsx("span",{className:"text-[10px] text-gray-500 font-bold",children:"(Powered by Capture Doc)"})]}),f.jsx("button",{onClick:()=>l(!0),className:"p-2 -ml-2 rounded-lg hover:bg-gray-100 text-gray-600 active:bg-gray-200 transition-colors","aria-label":"Open menu",children:f.jsx("span",{className:"material-icons text-2xl",children:"menu"})})]}),f.jsx("main",{className:"flex-1 overflow-y-auto bg-[#f0f3f6]",children:f.jsxs("div",{className:"max-w-7xl mx-auto p-4 md:p-8 pb-20 md:pb-8",children:[r!=="health-check"&&r!=="debug"&&f.jsx("div",{className:"flex items-center justify-between mb-6 md:mb-8",children:f.jsxs("div",{children:[f.jsxs("h1",{className:"text-2xl font-bold text-gray-800",children:[r==="dashboard"&&" ",r==="reports"&&" ",r==="requests"&&" ",r==="teams"&&" ",r==="operators"&&" ",r==="upload"&&" ",r==="kpi"&&"  ",r==="project-management"&&" ",r==="structure"&&" ",r==="approvals"&&"",r==="history"&&" ",r==="sites"&&"  ",r==="assets"&&"  ",r==="tickets"&&"   ",r==="hr"&&"   (HR)"]}),f.jsx("p",{className:"text-gray-500 text-sm mt-1",children:new Date().toLocaleDateString("ar-EG",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]})}),r==="health-check"?f.jsx(qN,{user:e}):r==="debug"?f.jsx($N,{}):r==="assets"?f.jsx(zN,{user:e}):r==="tickets"?f.jsx(HN,{user:e}):r==="hr"?f.jsx(YM,{user:e}):x?f.jsx(K4,{activeTab:r,currentUser:e,onNavigate:a,onlineUsers:o}):f.jsx(Y4,{user:e,activeTab:r})]})})]})]})},rS=document.getElementById("root");if(!rS)throw new Error("Could not find root element to mount to");const ZM=pT.createRoot(rS);ZM.render(f.jsx(oT.StrictMode,{children:f.jsx(QM,{})}));
